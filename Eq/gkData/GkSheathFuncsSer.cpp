#include <GyrokineticModDecl.h> 
#include <CartFieldBinOpModDecl.h> 
void calcSheathPartialReflectionScaled1x1vSer_P1(const double wv, const double dv, const double zVal, const double vcut, const double *f, double *fhat) 
{ 
  double u[2]; 
  double uhat[2]; 
  double c[2]; 
  double zVal2 = zVal*zVal; 
  double wv2 = wv*wv; 
  double wv3 = wv2*wv; 
  double wv4 = wv3*wv; 
  double wv5 = wv4*wv; 
  double dv2 = dv*dv; 
  double dv3 = dv2*dv; 
  double dv4 = dv3*dv; 
  double dv5 = dv4*dv; 
  double vcut2 = vcut*vcut; 
  double vcut3 = vcut2*vcut; 
  double vcut4 = vcut3*vcut; 
  double vcut5 = vcut4*vcut; 
  u[0] = (0.3333333333333333*((7.348469228349534*f[1]*dv*wv+4.242640687119286*f[3])*zVal+4.242640687119286*f[0]*dv*wv+2.449489742783178*f[2]))/dv; 
  u[1] = 0.0; 
  if(zVal == 1) {
  uhat[0] = (0.08333333333333333*(((50.91168824543144*f[3]*dv2-67.8822509939086*f[3])*wv3+((203.6467529817258*f[3]-101.8233764908629*f[3]*dv2)*vcut-29.39387691339815*f[1]*dv3+29.39387691339815*f[1]*dv)*wv2+((50.91168824543144*f[3]*dv2-203.6467529817258*f[3])*vcut2+(29.39387691339815*f[1]*dv3-58.7877538267963*f[1]*dv)*vcut+(14.69693845669907*f[1]-12.72792206135786*f[3])*dv4)*wv+67.8822509939086*f[3]*vcut3+29.39387691339815*f[1]*dv*vcut2+(8.485281374238571*f[3]-7.348469228349534*f[1])*dv3)*zVal+(29.39387691339815*f[2]*dv2-39.19183588453087*f[2])*wv3+((117.5755076535926*f[2]-58.7877538267963*f[2]*dv2)*vcut-16.97056274847715*f[0]*dv3+16.97056274847715*f[0]*dv)*wv2+((29.39387691339815*f[2]*dv2-117.5755076535926*f[2])*vcut2+(16.97056274847715*f[0]*dv3-33.9411254969543*f[0]*dv)*vcut+(8.485281374238571*f[0]-7.348469228349534*f[2])*dv4)*wv+39.19183588453087*f[2]*vcut3+16.97056274847715*f[0]*dv*vcut2+(4.898979485566357*f[2]-4.242640687119286*f[0])*dv3))/dv4; 
  uhat[1] = 0.0; 
  } else {
  uhat[0] = -(0.08333333333333333*(((50.91168824543144*f[3]*dv2-67.8822509939086*f[3])*wv3+((101.8233764908629*f[3]*dv2-203.6467529817258*f[3])*vcut-29.39387691339815*f[1]*dv3+29.39387691339815*f[1]*dv)*wv2+((50.91168824543144*f[3]*dv2-203.6467529817258*f[3])*vcut2+(58.7877538267963*f[1]*dv-29.39387691339815*f[1]*dv3)*vcut+((-12.72792206135786*f[3])-14.69693845669907*f[1])*dv4)*wv-67.8822509939086*f[3]*vcut3+29.39387691339815*f[1]*dv*vcut2+((-8.485281374238571*f[3])-7.348469228349534*f[1])*dv3)*zVal+(29.39387691339815*f[2]*dv2-39.19183588453087*f[2])*wv3+((58.7877538267963*f[2]*dv2-117.5755076535926*f[2])*vcut-16.97056274847715*f[0]*dv3+16.97056274847715*f[0]*dv)*wv2+((29.39387691339815*f[2]*dv2-117.5755076535926*f[2])*vcut2+(33.9411254969543*f[0]*dv-16.97056274847715*f[0]*dv3)*vcut+((-7.348469228349534*f[2])-8.485281374238571*f[0])*dv4)*wv-39.19183588453087*f[2]*vcut3+16.97056274847715*f[0]*dv*vcut2+((-4.898979485566357*f[2])-4.242640687119286*f[0])*dv3))/dv4; 
  uhat[1] = 0.0; 
  }
  // calculate c = uhat/u 
  CartFieldBinOpDivide1xSer_P1(u, uhat, 1, 1, c); 
  // calculate fhat = c*f 
  CartFieldBinOpMultiply1x1vSer_P1(c, f, 1, 1, fhat); 
} 

void calcSheathPartialReflectionScaled1x1vSer_P2(const double wv, const double dv, const double zVal, const double vcut, const double *f, double *fhat) 
{ 
  double u[3]; 
  double uhat[3]; 
  double c[3]; 
  double zVal2 = zVal*zVal; 
  double wv2 = wv*wv; 
  double wv3 = wv2*wv; 
  double wv4 = wv3*wv; 
  double wv5 = wv4*wv; 
  double dv2 = dv*dv; 
  double dv3 = dv2*dv; 
  double dv4 = dv3*dv; 
  double dv5 = dv4*dv; 
  double vcut2 = vcut*vcut; 
  double vcut3 = vcut2*vcut; 
  double vcut4 = vcut3*vcut; 
  double vcut5 = vcut4*vcut; 
  u[0] = (0.1666666666666667*((28.46049894151542*f[4]*dv*wv+16.43167672515499*f[6])*zVal2+(14.69693845669907*f[1]*dv*wv+8.485281374238571*f[3])*zVal+(8.485281374238571*f[0]-9.48683298050514*f[4])*dv*wv-5.477225575051662*f[6]+4.898979485566357*f[2]))/dv; 
  u[1] = 0.0; 
  u[2] = 0.0; 
  if(zVal == 1) {
  uhat[0] = (0.02083333333333333*(((394.3602414037198*f[6]*dv3-525.8136552049599*f[6]*dv)*wv3+((1577.44096561488*f[6]*dv-788.7204828074397*f[6]*dv3)*vcut-227.6839915321235*f[4]*dv4+227.6839915321235*f[4]*dv2)*wv2+((394.3602414037198*f[6]*dv3-1577.44096561488*f[6]*dv)*vcut2+(227.6839915321235*f[4]*dv4-455.3679830642469*f[4]*dv2)*vcut+(113.8419957660617*f[4]-98.59006035092993*f[6])*dv5)*wv+525.8136552049599*f[6]*dv*vcut3+227.6839915321235*f[4]*dv2*vcut2+(65.72670690061996*f[6]-56.92099788303084*f[4])*dv4)*zVal2+((788.7204828074397*f[7]-525.8136552049599*f[7]*dv2)*wv4+((1577.44096561488*f[7]*dv2-3154.88193122976*f[7])*vcut+203.6467529817258*f[3]*dv3-271.5290039756345*f[3]*dv)*wv3+((4732.322896844638*f[7]-1577.44096561488*f[7]*dv2)*vcut2+(814.5870119269034*f[3]*dv-407.2935059634517*f[3]*dv3)*vcut+(131.4534138012399*f[7]-117.5755076535926*f[1])*dv4+(117.5755076535926*f[1]-131.4534138012399*f[7])*dv2)*wv2+((525.8136552049599*f[7]*dv2-3154.88193122976*f[7])*vcut3+(203.6467529817258*f[3]*dv3-814.5870119269034*f[3]*dv)*vcut2+((117.5755076535926*f[1]-131.4534138012399*f[7])*dv4+(262.9068276024799*f[7]-235.1510153071852*f[1])*dv2)*vcut+(58.7877538267963*f[1]-50.91168824543144*f[3])*dv5)*wv+788.7204828074397*f[7]*vcut4+271.5290039756345*f[3]*dv*vcut3+(117.5755076535926*f[1]-131.4534138012399*f[7])*dv2*vcut2+((-16.43167672515499*f[7])+33.9411254969543*f[3]-29.39387691339815*f[1])*dv4)*zVal+(455.3679830642469*f[5]-303.5786553761646*f[5]*dv2)*wv4+((910.7359661284939*f[5]*dv2-1821.471932256988*f[5])*vcut+(117.5755076535926*f[2]-131.4534138012399*f[6])*dv3+(175.2712184016533*f[6]-156.7673435381235*f[2])*dv)*wv3+((2732.207898385482*f[5]-910.7359661284939*f[5]*dv2)*vcut2+((262.9068276024799*f[6]-235.1510153071852*f[2])*dv3+(470.3020306143706*f[2]-525.8136552049599*f[6])*dv)*vcut+(75.89466384404115*f[5]+75.89466384404115*f[4]-67.8822509939086*f[0])*dv4+((-75.89466384404115*f[5])-75.89466384404115*f[4]+67.8822509939086*f[0])*dv2)*wv2+((303.5786553761646*f[5]*dv2-1821.471932256988*f[5])*vcut3+((117.5755076535926*f[2]-131.4534138012399*f[6])*dv3+(525.8136552049599*f[6]-470.3020306143706*f[2])*dv)*vcut2+(((-75.89466384404115*f[5])-75.89466384404115*f[4]+67.8822509939086*f[0])*dv4+(151.7893276880823*f[5]+151.7893276880823*f[4]-135.7645019878172*f[0])*dv2)*vcut+(32.86335345030997*f[6]-37.94733192202057*f[4]-29.39387691339815*f[2]+33.9411254969543*f[0])*dv5)*wv+455.3679830642469*f[5]*vcut4+(156.7673435381235*f[2]-175.2712184016533*f[6])*dv*vcut3+((-75.89466384404115*f[5])-75.89466384404115*f[4]+67.8822509939086*f[0])*dv2*vcut2+((-21.90890230020666*f[6])-9.48683298050514*f[5]+18.97366596101028*f[4]+19.59591794226543*f[2]-16.97056274847715*f[0])*dv4))/dv5; 
  uhat[1] = 0.0; 
  uhat[2] = 0.0; 
  } else {
  uhat[0] = -(0.02083333333333333*(((394.3602414037198*f[6]*dv3-525.8136552049599*f[6]*dv)*wv3+((788.7204828074397*f[6]*dv3-1577.44096561488*f[6]*dv)*vcut-227.6839915321235*f[4]*dv4+227.6839915321235*f[4]*dv2)*wv2+((394.3602414037198*f[6]*dv3-1577.44096561488*f[6]*dv)*vcut2+(455.3679830642469*f[4]*dv2-227.6839915321235*f[4]*dv4)*vcut+((-98.59006035092993*f[6])-113.8419957660617*f[4])*dv5)*wv-525.8136552049599*f[6]*dv*vcut3+227.6839915321235*f[4]*dv2*vcut2+((-65.72670690061996*f[6])-56.92099788303084*f[4])*dv4)*zVal2+((788.7204828074397*f[7]-525.8136552049599*f[7]*dv2)*wv4+((3154.88193122976*f[7]-1577.44096561488*f[7]*dv2)*vcut+203.6467529817258*f[3]*dv3-271.5290039756345*f[3]*dv)*wv3+((4732.322896844638*f[7]-1577.44096561488*f[7]*dv2)*vcut2+(407.2935059634517*f[3]*dv3-814.5870119269034*f[3]*dv)*vcut+(131.4534138012399*f[7]-117.5755076535926*f[1])*dv4+(117.5755076535926*f[1]-131.4534138012399*f[7])*dv2)*wv2+((3154.88193122976*f[7]-525.8136552049599*f[7]*dv2)*vcut3+(203.6467529817258*f[3]*dv3-814.5870119269034*f[3]*dv)*vcut2+((131.4534138012399*f[7]-117.5755076535926*f[1])*dv4+(235.1510153071852*f[1]-262.9068276024799*f[7])*dv2)*vcut+((-50.91168824543144*f[3])-58.7877538267963*f[1])*dv5)*wv+788.7204828074397*f[7]*vcut4-271.5290039756345*f[3]*dv*vcut3+(117.5755076535926*f[1]-131.4534138012399*f[7])*dv2*vcut2+((-16.43167672515499*f[7])-33.9411254969543*f[3]-29.39387691339815*f[1])*dv4)*zVal+(455.3679830642469*f[5]-303.5786553761646*f[5]*dv2)*wv4+((1821.471932256988*f[5]-910.7359661284939*f[5]*dv2)*vcut+(117.5755076535926*f[2]-131.4534138012399*f[6])*dv3+(175.2712184016533*f[6]-156.7673435381235*f[2])*dv)*wv3+((2732.207898385482*f[5]-910.7359661284939*f[5]*dv2)*vcut2+((235.1510153071852*f[2]-262.9068276024799*f[6])*dv3+(525.8136552049599*f[6]-470.3020306143706*f[2])*dv)*vcut+(75.89466384404115*f[5]+75.89466384404115*f[4]-67.8822509939086*f[0])*dv4+((-75.89466384404115*f[5])-75.89466384404115*f[4]+67.8822509939086*f[0])*dv2)*wv2+((1821.471932256988*f[5]-303.5786553761646*f[5]*dv2)*vcut3+((117.5755076535926*f[2]-131.4534138012399*f[6])*dv3+(525.8136552049599*f[6]-470.3020306143706*f[2])*dv)*vcut2+((75.89466384404115*f[5]+75.89466384404115*f[4]-67.8822509939086*f[0])*dv4+((-151.7893276880823*f[5])-151.7893276880823*f[4]+135.7645019878172*f[0])*dv2)*vcut+(32.86335345030997*f[6]+37.94733192202057*f[4]-29.39387691339815*f[2]-33.9411254969543*f[0])*dv5)*wv+455.3679830642469*f[5]*vcut4+(175.2712184016533*f[6]-156.7673435381235*f[2])*dv*vcut3+((-75.89466384404115*f[5])-75.89466384404115*f[4]+67.8822509939086*f[0])*dv2*vcut2+(21.90890230020666*f[6]-9.48683298050514*f[5]+18.97366596101028*f[4]-19.59591794226543*f[2]-16.97056274847715*f[0])*dv4))/dv5; 
  uhat[1] = 0.0; 
  uhat[2] = 0.0; 
  }
  // calculate c = uhat/u 
  CartFieldBinOpDivide1xSer_P2(u, uhat, 1, 1, c); 
  // calculate fhat = c*f 
  CartFieldBinOpMultiply1x1vSer_P2(c, f, 1, 1, fhat); 
} 

double calcSheathDeltaPhi1xSer_P1(const double *phi, const double *phiWall, const double zVal) 
{ 
  return 1.224744871391589*phi[1]*zVal-0.7071067811865475*phiWall[0]+0.7071067811865475*phi[0]; 
}

void calcSheathPartialReflectionScaled1x2vSer_P1(const double wv, const double dv, const double zVal, const double vcut, const double *f, double *fhat) 
{ 
  double u[2]; 
  double uhat[2]; 
  double c[2]; 
  double zVal2 = zVal*zVal; 
  double wv2 = wv*wv; 
  double wv3 = wv2*wv; 
  double wv4 = wv3*wv; 
  double wv5 = wv4*wv; 
  double dv2 = dv*dv; 
  double dv3 = dv2*dv; 
  double dv4 = dv3*dv; 
  double dv5 = dv4*dv; 
  double vcut2 = vcut*vcut; 
  double vcut3 = vcut2*vcut; 
  double vcut4 = vcut3*vcut; 
  double vcut5 = vcut4*vcut; 
  u[0] = (0.3333333333333333*((10.39230484541326*f[1]*dv*wv+6.0*f[4])*zVal+6.0*f[0]*dv*wv+3.464101615137754*f[2]))/dv; 
  u[1] = 0.0; 
  if(zVal == 1) {
  uhat[0] = (0.1666666666666667*(((36.0*f[4]*dv2-48.0*f[4])*wv3+((144.0*f[4]-72.0*f[4]*dv2)*vcut-20.78460969082652*f[1]*dv3+20.78460969082652*f[1]*dv)*wv2+((36.0*f[4]*dv2-144.0*f[4])*vcut2+(20.78460969082652*f[1]*dv3-41.56921938165305*f[1]*dv)*vcut+(10.39230484541326*f[1]-9.0*f[4])*dv4)*wv+48.0*f[4]*vcut3+20.78460969082652*f[1]*dv*vcut2+(6.0*f[4]-5.196152422706631*f[1])*dv3)*zVal+(20.78460969082652*f[2]*dv2-27.71281292110204*f[2])*wv3+((83.1384387633061*f[2]-41.56921938165305*f[2]*dv2)*vcut-12.0*f[0]*dv3+12.0*f[0]*dv)*wv2+((20.78460969082652*f[2]*dv2-83.1384387633061*f[2])*vcut2+(12.0*f[0]*dv3-24.0*f[0]*dv)*vcut+(6.0*f[0]-5.196152422706631*f[2])*dv4)*wv+27.71281292110204*f[2]*vcut3+12.0*f[0]*dv*vcut2+(3.464101615137754*f[2]-3.0*f[0])*dv3))/dv4; 
  uhat[1] = 0.0; 
  } else {
  uhat[0] = -(0.1666666666666667*(((36.0*f[4]*dv2-48.0*f[4])*wv3+((72.0*f[4]*dv2-144.0*f[4])*vcut-20.78460969082652*f[1]*dv3+20.78460969082652*f[1]*dv)*wv2+((36.0*f[4]*dv2-144.0*f[4])*vcut2+(41.56921938165305*f[1]*dv-20.78460969082652*f[1]*dv3)*vcut+((-9.0*f[4])-10.39230484541326*f[1])*dv4)*wv-48.0*f[4]*vcut3+20.78460969082652*f[1]*dv*vcut2+((-6.0*f[4])-5.196152422706631*f[1])*dv3)*zVal+(20.78460969082652*f[2]*dv2-27.71281292110204*f[2])*wv3+((41.56921938165305*f[2]*dv2-83.1384387633061*f[2])*vcut-12.0*f[0]*dv3+12.0*f[0]*dv)*wv2+((20.78460969082652*f[2]*dv2-83.1384387633061*f[2])*vcut2+(24.0*f[0]*dv-12.0*f[0]*dv3)*vcut+((-5.196152422706631*f[2])-6.0*f[0])*dv4)*wv-27.71281292110204*f[2]*vcut3+12.0*f[0]*dv*vcut2+((-3.464101615137754*f[2])-3.0*f[0])*dv3))/dv4; 
  uhat[1] = 0.0; 
  }
  // calculate c = uhat/u 
  CartFieldBinOpDivide1xSer_P1(u, uhat, 1, 1, c); 
  // calculate fhat = c*f 
  CartFieldBinOpMultiply1x2vSer_P1(c, f, 1, 1, fhat); 
} 

double calcSheathDeltaPhi1xSer_P2(const double *phi, const double *phiWall, const double zVal) 
{ 
  double zVal2 = zVal*zVal; 
  return 2.371708245126284*phi[2]*(zVal2-0.3333333333333333)+1.224744871391589*phi[1]*zVal+0.7905694150420947*phiWall[2]-0.7071067811865475*phiWall[0]+0.7071067811865475*phi[0]; 
}

void calcSheathPartialReflectionScaled1x2vSer_P2(const double wv, const double dv, const double zVal, const double vcut, const double *f, double *fhat) 
{ 
  double u[3]; 
  double uhat[3]; 
  double c[3]; 
  double zVal2 = zVal*zVal; 
  double wv2 = wv*wv; 
  double wv3 = wv2*wv; 
  double wv4 = wv3*wv; 
  double wv5 = wv4*wv; 
  double dv2 = dv*dv; 
  double dv3 = dv2*dv; 
  double dv4 = dv3*dv; 
  double dv5 = dv4*dv; 
  double vcut2 = vcut*vcut; 
  double vcut3 = vcut2*vcut; 
  double vcut4 = vcut3*vcut; 
  double vcut5 = vcut4*vcut; 
  u[0] = (0.3333333333333333*((20.12461179749811*f[7]*dv*wv+11.61895003862225*f[11])*zVal2+(10.39230484541326*f[1]*dv*wv+6.0*f[4])*zVal+(6.0*f[0]-6.708203932499369*f[7])*dv*wv-3.872983346207417*f[11]+3.464101615137754*f[2]))/dv; 
  u[1] = 0.0; 
  u[2] = 0.0; 
  if(zVal == 1) {
  uhat[0] = (0.04166666666666666*(((278.854800926934*f[11]*dv3-371.8064012359121*f[11]*dv)*wv3+((1115.419203707736*f[11]*dv-557.7096018538681*f[11]*dv3)*vcut-160.9968943799849*f[7]*dv4+160.9968943799849*f[7]*dv2)*wv2+((278.854800926934*f[11]*dv3-1115.419203707736*f[11]*dv)*vcut2+(160.9968943799849*f[7]*dv4-321.9937887599697*f[7]*dv2)*vcut+(80.49844718999243*f[7]-69.71370023173351*f[11])*dv5)*wv+371.8064012359121*f[11]*dv*vcut3+160.9968943799849*f[7]*dv2*vcut2+(46.47580015448901*f[11]-40.24922359499622*f[7])*dv4)*zVal2+((557.7096018538681*f[12]-371.8064012359121*f[12]*dv2)*wv4+((1115.419203707736*f[12]*dv2-2230.838407415472*f[12])*vcut+144.0*f[4]*dv3-192.0*f[4]*dv)*wv3+((3346.257611123208*f[12]-1115.419203707736*f[12]*dv2)*vcut2+(576.0*f[4]*dv-288.0*f[4]*dv3)*vcut+(92.95160030897802*f[12]-83.1384387633061*f[1])*dv4+(83.1384387633061*f[1]-92.95160030897802*f[12])*dv2)*wv2+((371.8064012359121*f[12]*dv2-2230.838407415472*f[12])*vcut3+(144.0*f[4]*dv3-576.0*f[4]*dv)*vcut2+((83.1384387633061*f[1]-92.95160030897802*f[12])*dv4+(185.903200617956*f[12]-166.2768775266122*f[1])*dv2)*vcut+(41.56921938165305*f[1]-36.0*f[4])*dv5)*wv+557.7096018538681*f[12]*vcut4+192.0*f[4]*dv*vcut3+(83.1384387633061*f[1]-92.95160030897802*f[12])*dv2*vcut2+((-11.61895003862225*f[12])+24.0*f[4]-20.78460969082652*f[1])*dv4)*zVal+(321.9937887599697*f[8]-214.6625258399798*f[8]*dv2)*wv4+((643.9875775199395*f[8]*dv2-1287.975155039879*f[8])*vcut+(83.1384387633061*f[2]-92.95160030897802*f[11])*dv3+(123.9354670786373*f[11]-110.8512516844081*f[2])*dv)*wv3+((1931.962732559819*f[8]-643.9875775199395*f[8]*dv2)*vcut2+((185.903200617956*f[11]-166.2768775266122*f[2])*dv3+(332.5537550532244*f[2]-371.8064012359121*f[11])*dv)*vcut+(53.66563145999496*f[8]+53.66563145999496*f[7]-48.0*f[0])*dv4+((-53.66563145999496*f[8])-53.66563145999496*f[7]+48.0*f[0])*dv2)*wv2+((214.6625258399798*f[8]*dv2-1287.975155039879*f[8])*vcut3+((83.1384387633061*f[2]-92.95160030897802*f[11])*dv3+(371.8064012359121*f[11]-332.5537550532244*f[2])*dv)*vcut2+(((-53.66563145999496*f[8])-53.66563145999496*f[7]+48.0*f[0])*dv4+(107.3312629199899*f[8]+107.3312629199899*f[7]-96.0*f[0])*dv2)*vcut+(23.2379000772445*f[11]-26.83281572999748*f[7]-20.78460969082652*f[2]+24.0*f[0])*dv5)*wv+321.9937887599697*f[8]*vcut4+(110.8512516844081*f[2]-123.9354670786373*f[11])*dv*vcut3+((-53.66563145999496*f[8])-53.66563145999496*f[7]+48.0*f[0])*dv2*vcut2+((-15.49193338482967*f[11])-6.708203932499369*f[8]+13.41640786499874*f[7]+13.85640646055102*f[2]-12.0*f[0])*dv4))/dv5; 
  uhat[1] = 0.0; 
  uhat[2] = 0.0; 
  } else {
  uhat[0] = -(0.04166666666666666*(((278.854800926934*f[11]*dv3-371.8064012359121*f[11]*dv)*wv3+((557.7096018538681*f[11]*dv3-1115.419203707736*f[11]*dv)*vcut-160.9968943799849*f[7]*dv4+160.9968943799849*f[7]*dv2)*wv2+((278.854800926934*f[11]*dv3-1115.419203707736*f[11]*dv)*vcut2+(321.9937887599697*f[7]*dv2-160.9968943799849*f[7]*dv4)*vcut+((-69.71370023173351*f[11])-80.49844718999243*f[7])*dv5)*wv-371.8064012359121*f[11]*dv*vcut3+160.9968943799849*f[7]*dv2*vcut2+((-46.47580015448901*f[11])-40.24922359499622*f[7])*dv4)*zVal2+((557.7096018538681*f[12]-371.8064012359121*f[12]*dv2)*wv4+((2230.838407415472*f[12]-1115.419203707736*f[12]*dv2)*vcut+144.0*f[4]*dv3-192.0*f[4]*dv)*wv3+((3346.257611123208*f[12]-1115.419203707736*f[12]*dv2)*vcut2+(288.0*f[4]*dv3-576.0*f[4]*dv)*vcut+(92.95160030897802*f[12]-83.1384387633061*f[1])*dv4+(83.1384387633061*f[1]-92.95160030897802*f[12])*dv2)*wv2+((2230.838407415472*f[12]-371.8064012359121*f[12]*dv2)*vcut3+(144.0*f[4]*dv3-576.0*f[4]*dv)*vcut2+((92.95160030897802*f[12]-83.1384387633061*f[1])*dv4+(166.2768775266122*f[1]-185.903200617956*f[12])*dv2)*vcut+((-36.0*f[4])-41.56921938165305*f[1])*dv5)*wv+557.7096018538681*f[12]*vcut4-192.0*f[4]*dv*vcut3+(83.1384387633061*f[1]-92.95160030897802*f[12])*dv2*vcut2+((-11.61895003862225*f[12])-24.0*f[4]-20.78460969082652*f[1])*dv4)*zVal+(321.9937887599697*f[8]-214.6625258399798*f[8]*dv2)*wv4+((1287.975155039879*f[8]-643.9875775199395*f[8]*dv2)*vcut+(83.1384387633061*f[2]-92.95160030897802*f[11])*dv3+(123.9354670786373*f[11]-110.8512516844081*f[2])*dv)*wv3+((1931.962732559819*f[8]-643.9875775199395*f[8]*dv2)*vcut2+((166.2768775266122*f[2]-185.903200617956*f[11])*dv3+(371.8064012359121*f[11]-332.5537550532244*f[2])*dv)*vcut+(53.66563145999496*f[8]+53.66563145999496*f[7]-48.0*f[0])*dv4+((-53.66563145999496*f[8])-53.66563145999496*f[7]+48.0*f[0])*dv2)*wv2+((1287.975155039879*f[8]-214.6625258399798*f[8]*dv2)*vcut3+((83.1384387633061*f[2]-92.95160030897802*f[11])*dv3+(371.8064012359121*f[11]-332.5537550532244*f[2])*dv)*vcut2+((53.66563145999496*f[8]+53.66563145999496*f[7]-48.0*f[0])*dv4+((-107.3312629199899*f[8])-107.3312629199899*f[7]+96.0*f[0])*dv2)*vcut+(23.2379000772445*f[11]+26.83281572999748*f[7]-20.78460969082652*f[2]-24.0*f[0])*dv5)*wv+321.9937887599697*f[8]*vcut4+(123.9354670786373*f[11]-110.8512516844081*f[2])*dv*vcut3+((-53.66563145999496*f[8])-53.66563145999496*f[7]+48.0*f[0])*dv2*vcut2+(15.49193338482967*f[11]-6.708203932499369*f[8]+13.41640786499874*f[7]-13.85640646055102*f[2]-12.0*f[0])*dv4))/dv5; 
  uhat[1] = 0.0; 
  uhat[2] = 0.0; 
  }
  // calculate c = uhat/u 
  CartFieldBinOpDivide1xSer_P2(u, uhat, 1, 1, c); 
  // calculate fhat = c*f 
  CartFieldBinOpMultiply1x2vSer_P2(c, f, 1, 1, fhat); 
} 

double calcSheathDeltaPhi2xSer_P1(const double *phi, const double *phiWall, const double zVal) 
{ 
  return 0.8660254037844386*phi[2]*zVal-0.5*phiWall[0]+0.5*phi[0]; 
}

void calcSheathPartialReflectionScaled2x2vSer_P1(const double wv, const double dv, const double zVal, const double vcut, const double *f, double *fhat) 
{ 
  double u[4]; 
  double uhat[4]; 
  double c[4]; 
  double zVal2 = zVal*zVal; 
  double wv2 = wv*wv; 
  double wv3 = wv2*wv; 
  double wv4 = wv3*wv; 
  double wv5 = wv4*wv; 
  double dv2 = dv*dv; 
  double dv3 = dv2*dv; 
  double dv4 = dv3*dv; 
  double dv5 = dv4*dv; 
  double vcut2 = vcut*vcut; 
  double vcut3 = vcut2*vcut; 
  double vcut4 = vcut3*vcut; 
  double vcut5 = vcut4*vcut; 
  u[0] = (0.3333333333333333*((10.39230484541326*f[2]*dv*wv+6.0*f[7])*zVal+6.0*f[0]*dv*wv+3.464101615137754*f[3]))/dv; 
  u[1] = (0.3333333333333333*((10.39230484541326*f[5]*dv*wv+6.0*f[11])*zVal+6.0*f[1]*dv*wv+3.464101615137754*f[6]))/dv; 
  u[2] = 0.0; 
  u[3] = 0.0; 
  if(zVal == 1) {
  uhat[0] = (0.1666666666666667*(((36.0*f[7]*dv2-48.0*f[7])*wv3+((144.0*f[7]-72.0*f[7]*dv2)*vcut-20.78460969082652*f[2]*dv3+20.78460969082652*f[2]*dv)*wv2+((36.0*f[7]*dv2-144.0*f[7])*vcut2+(20.78460969082652*f[2]*dv3-41.56921938165305*f[2]*dv)*vcut+(10.39230484541326*f[2]-9.0*f[7])*dv4)*wv+48.0*f[7]*vcut3+20.78460969082652*f[2]*dv*vcut2+(6.0*f[7]-5.196152422706631*f[2])*dv3)*zVal+(20.78460969082652*f[3]*dv2-27.71281292110204*f[3])*wv3+((83.1384387633061*f[3]-41.56921938165305*f[3]*dv2)*vcut-12.0*f[0]*dv3+12.0*f[0]*dv)*wv2+((20.78460969082652*f[3]*dv2-83.1384387633061*f[3])*vcut2+(12.0*f[0]*dv3-24.0*f[0]*dv)*vcut+(6.0*f[0]-5.196152422706631*f[3])*dv4)*wv+27.71281292110204*f[3]*vcut3+12.0*f[0]*dv*vcut2+(3.464101615137754*f[3]-3.0*f[0])*dv3))/dv4; 
  uhat[1] = (0.1666666666666667*(((36.0*f[11]*dv2-48.0*f[11])*wv3+((144.0*f[11]-72.0*f[11]*dv2)*vcut-20.78460969082652*f[5]*dv3+20.78460969082652*f[5]*dv)*wv2+((36.0*f[11]*dv2-144.0*f[11])*vcut2+(20.78460969082652*f[5]*dv3-41.56921938165305*f[5]*dv)*vcut+(10.39230484541326*f[5]-9.0*f[11])*dv4)*wv+48.0*f[11]*vcut3+20.78460969082652*f[5]*dv*vcut2+(6.0*f[11]-5.196152422706631*f[5])*dv3)*zVal+(20.78460969082652*f[6]*dv2-27.71281292110204*f[6])*wv3+((83.1384387633061*f[6]-41.56921938165305*f[6]*dv2)*vcut-12.0*f[1]*dv3+12.0*f[1]*dv)*wv2+((20.78460969082652*f[6]*dv2-83.1384387633061*f[6])*vcut2+(12.0*f[1]*dv3-24.0*f[1]*dv)*vcut+(6.0*f[1]-5.196152422706631*f[6])*dv4)*wv+27.71281292110204*f[6]*vcut3+12.0*f[1]*dv*vcut2+(3.464101615137754*f[6]-3.0*f[1])*dv3))/dv4; 
  uhat[2] = 0.0; 
  uhat[3] = 0.0; 
  } else {
  uhat[0] = -(0.1666666666666667*(((36.0*f[7]*dv2-48.0*f[7])*wv3+((72.0*f[7]*dv2-144.0*f[7])*vcut-20.78460969082652*f[2]*dv3+20.78460969082652*f[2]*dv)*wv2+((36.0*f[7]*dv2-144.0*f[7])*vcut2+(41.56921938165305*f[2]*dv-20.78460969082652*f[2]*dv3)*vcut+((-9.0*f[7])-10.39230484541326*f[2])*dv4)*wv-48.0*f[7]*vcut3+20.78460969082652*f[2]*dv*vcut2+((-6.0*f[7])-5.196152422706631*f[2])*dv3)*zVal+(20.78460969082652*f[3]*dv2-27.71281292110204*f[3])*wv3+((41.56921938165305*f[3]*dv2-83.1384387633061*f[3])*vcut-12.0*f[0]*dv3+12.0*f[0]*dv)*wv2+((20.78460969082652*f[3]*dv2-83.1384387633061*f[3])*vcut2+(24.0*f[0]*dv-12.0*f[0]*dv3)*vcut+((-5.196152422706631*f[3])-6.0*f[0])*dv4)*wv-27.71281292110204*f[3]*vcut3+12.0*f[0]*dv*vcut2+((-3.464101615137754*f[3])-3.0*f[0])*dv3))/dv4; 
  uhat[1] = -(0.1666666666666667*(((36.0*f[11]*dv2-48.0*f[11])*wv3+((72.0*f[11]*dv2-144.0*f[11])*vcut-20.78460969082652*f[5]*dv3+20.78460969082652*f[5]*dv)*wv2+((36.0*f[11]*dv2-144.0*f[11])*vcut2+(41.56921938165305*f[5]*dv-20.78460969082652*f[5]*dv3)*vcut+((-9.0*f[11])-10.39230484541326*f[5])*dv4)*wv-48.0*f[11]*vcut3+20.78460969082652*f[5]*dv*vcut2+((-6.0*f[11])-5.196152422706631*f[5])*dv3)*zVal+(20.78460969082652*f[6]*dv2-27.71281292110204*f[6])*wv3+((41.56921938165305*f[6]*dv2-83.1384387633061*f[6])*vcut-12.0*f[1]*dv3+12.0*f[1]*dv)*wv2+((20.78460969082652*f[6]*dv2-83.1384387633061*f[6])*vcut2+(24.0*f[1]*dv-12.0*f[1]*dv3)*vcut+((-5.196152422706631*f[6])-6.0*f[1])*dv4)*wv-27.71281292110204*f[6]*vcut3+12.0*f[1]*dv*vcut2+((-3.464101615137754*f[6])-3.0*f[1])*dv3))/dv4; 
  uhat[2] = 0.0; 
  uhat[3] = 0.0; 
  }
  // calculate c = uhat/u 
  CartFieldBinOpDivide2xSer_P1(u, uhat, 1, 1, c); 
  // calculate fhat = c*f 
  CartFieldBinOpMultiply2x2vSer_P1(c, f, 1, 1, fhat); 
} 

double calcSheathDeltaPhi2xSer_P2(const double *phi, const double *phiWall, const double zVal) 
{ 
  double zVal2 = zVal*zVal; 
  return 1.677050983124842*phi[5]*(zVal2-0.3333333333333333)-0.9682458365518543*phi[6]*zVal+0.8660254037844386*phi[2]*zVal+0.5590169943749475*phiWall[5]+0.5590169943749475*phiWall[4]-0.5590169943749475*phi[4]-0.5*phiWall[0]+0.5*phi[0]; 
}

void calcSheathPartialReflectionScaled2x2vSer_P2(const double wv, const double dv, const double zVal, const double vcut, const double *f, double *fhat) 
{ 
  double u[8]; 
  double uhat[8]; 
  double c[8]; 
  double zVal2 = zVal*zVal; 
  double wv2 = wv*wv; 
  double wv3 = wv2*wv; 
  double wv4 = wv3*wv; 
  double wv5 = wv4*wv; 
  double dv2 = dv*dv; 
  double dv3 = dv2*dv; 
  double dv4 = dv3*dv; 
  double dv5 = dv4*dv; 
  double vcut2 = vcut*vcut; 
  double vcut3 = vcut2*vcut; 
  double vcut4 = vcut3*vcut; 
  double vcut5 = vcut4*vcut; 
  u[0] = (0.3333333333333333*((20.12461179749811*f[12]*dv*wv+11.61895003862225*f[22])*zVal2+(10.39230484541326*f[2]*dv*wv+6.0*f[7])*zVal+(6.0*f[0]-6.708203932499369*f[12])*dv*wv-3.872983346207417*f[22]+3.464101615137754*f[3]))/dv; 
  u[1] = (0.3333333333333333*((20.1246117974981*f[20]*dv*wv+11.61895003862225*f[33])*zVal2+(10.39230484541326*f[5]*dv*wv+6.0*f[15])*zVal+(6.0*f[1]-6.708203932499369*f[20])*dv*wv-3.872983346207417*f[33]+3.464101615137754*f[6]))/dv; 
  u[2] = 0.0; 
  u[3] = 0.0; 
  u[4] = (0.06666666666666667*((51.96152422706632*f[19]*dv*wv+30.0*f[32])*zVal+30.0*f[11]*dv*wv+17.32050807568877*f[21]))/dv; 
  u[5] = 0.0; 
  u[6] = 0.0; 
  u[7] = 0.0; 
  if(zVal == 1) {
  uhat[0] = (0.04166666666666666*(((278.854800926934*f[22]*dv3-371.8064012359121*f[22]*dv)*wv3+((1115.419203707736*f[22]*dv-557.7096018538681*f[22]*dv3)*vcut-160.9968943799849*f[12]*dv4+160.9968943799849*f[12]*dv2)*wv2+((278.854800926934*f[22]*dv3-1115.419203707736*f[22]*dv)*vcut2+(160.9968943799849*f[12]*dv4-321.9937887599697*f[12]*dv2)*vcut+(80.49844718999243*f[12]-69.71370023173351*f[22])*dv5)*wv+371.8064012359121*f[22]*dv*vcut3+160.9968943799849*f[12]*dv2*vcut2+(46.47580015448901*f[22]-40.24922359499622*f[12])*dv4)*zVal2+((557.7096018538681*f[24]-371.8064012359121*f[24]*dv2)*wv4+((1115.419203707736*f[24]*dv2-2230.838407415472*f[24])*vcut+144.0*f[7]*dv3-192.0*f[7]*dv)*wv3+((3346.257611123208*f[24]-1115.419203707736*f[24]*dv2)*vcut2+(576.0*f[7]*dv-288.0*f[7]*dv3)*vcut+(92.95160030897802*f[24]-83.1384387633061*f[2])*dv4+(83.1384387633061*f[2]-92.95160030897802*f[24])*dv2)*wv2+((371.8064012359121*f[24]*dv2-2230.838407415472*f[24])*vcut3+(144.0*f[7]*dv3-576.0*f[7]*dv)*vcut2+((83.1384387633061*f[2]-92.95160030897802*f[24])*dv4+(185.903200617956*f[24]-166.2768775266122*f[2])*dv2)*vcut+(41.56921938165305*f[2]-36.0*f[7])*dv5)*wv+557.7096018538681*f[24]*vcut4+192.0*f[7]*dv*vcut3+(83.1384387633061*f[2]-92.95160030897802*f[24])*dv2*vcut2+((-11.61895003862225*f[24])+24.0*f[7]-20.78460969082652*f[2])*dv4)*zVal+(321.9937887599697*f[13]-214.6625258399798*f[13]*dv2)*wv4+((643.9875775199395*f[13]*dv2-1287.975155039879*f[13])*vcut+(83.1384387633061*f[3]-92.95160030897802*f[22])*dv3+(123.9354670786373*f[22]-110.8512516844081*f[3])*dv)*wv3+((1931.962732559819*f[13]-643.9875775199395*f[13]*dv2)*vcut2+((185.903200617956*f[22]-166.2768775266122*f[3])*dv3+(332.5537550532244*f[3]-371.8064012359121*f[22])*dv)*vcut+(53.66563145999496*f[13]+53.66563145999496*f[12]-48.0*f[0])*dv4+((-53.66563145999496*f[13])-53.66563145999496*f[12]+48.0*f[0])*dv2)*wv2+((214.6625258399798*f[13]*dv2-1287.975155039879*f[13])*vcut3+((83.1384387633061*f[3]-92.95160030897802*f[22])*dv3+(371.8064012359121*f[22]-332.5537550532244*f[3])*dv)*vcut2+(((-53.66563145999496*f[13])-53.66563145999496*f[12]+48.0*f[0])*dv4+(107.3312629199899*f[13]+107.3312629199899*f[12]-96.0*f[0])*dv2)*vcut+(23.2379000772445*f[22]-26.83281572999748*f[12]-20.78460969082652*f[3]+24.0*f[0])*dv5)*wv+321.9937887599697*f[13]*vcut4+(110.8512516844081*f[3]-123.9354670786373*f[22])*dv*vcut3+((-53.66563145999496*f[13])-53.66563145999496*f[12]+48.0*f[0])*dv2*vcut2+((-15.49193338482967*f[22])-6.708203932499369*f[13]+13.41640786499874*f[12]+13.85640646055102*f[3]-12.0*f[0])*dv4))/dv5; 
  uhat[1] = (0.04166666666666666*(((278.8548009269339*f[33]*dv3-371.806401235912*f[33]*dv)*wv3+((1115.419203707736*f[33]*dv-557.7096018538679*f[33]*dv3)*vcut-160.9968943799848*f[20]*dv4+160.9968943799848*f[20]*dv2)*wv2+((278.8548009269339*f[33]*dv3-1115.419203707736*f[33]*dv)*vcut2+(160.9968943799848*f[20]*dv4-321.9937887599697*f[20]*dv2)*vcut+(80.49844718999242*f[20]-69.71370023173348*f[33])*dv5)*wv+371.806401235912*f[33]*dv*vcut3+160.9968943799848*f[20]*dv2*vcut2+(46.475800154489*f[33]-40.24922359499621*f[20])*dv4)*zVal2+((557.7096018538679*f[34]-371.806401235912*f[34]*dv2)*wv4+((1115.419203707736*f[34]*dv2-2230.838407415471*f[34])*vcut+144.0*f[15]*dv3-192.0*f[15]*dv)*wv3+((3346.257611123207*f[34]-1115.419203707736*f[34]*dv2)*vcut2+(576.0*f[15]*dv-288.0*f[15]*dv3)*vcut+(92.951600308978*f[34]-83.1384387633061*f[5])*dv4+(83.1384387633061*f[5]-92.951600308978*f[34])*dv2)*wv2+((371.806401235912*f[34]*dv2-2230.838407415471*f[34])*vcut3+(144.0*f[15]*dv3-576.0*f[15]*dv)*vcut2+((83.1384387633061*f[5]-92.951600308978*f[34])*dv4+(185.903200617956*f[34]-166.2768775266122*f[5])*dv2)*vcut+(41.56921938165305*f[5]-36.0*f[15])*dv5)*wv+557.7096018538679*f[34]*vcut4+192.0*f[15]*dv*vcut3+(83.1384387633061*f[5]-92.951600308978*f[34])*dv2*vcut2+((-11.61895003862225*f[34])+24.0*f[15]-20.78460969082652*f[5])*dv4)*zVal+(321.9937887599697*f[23]-214.6625258399798*f[23]*dv2)*wv4+((643.9875775199394*f[23]*dv2-1287.975155039879*f[23])*vcut+(83.1384387633061*f[6]-92.951600308978*f[33])*dv3+(123.9354670786373*f[33]-110.8512516844081*f[6])*dv)*wv3+((1931.962732559818*f[23]-643.9875775199394*f[23]*dv2)*vcut2+((185.903200617956*f[33]-166.2768775266122*f[6])*dv3+(332.5537550532244*f[6]-371.806401235912*f[33])*dv)*vcut+(53.66563145999495*f[23]+53.66563145999495*f[20]-48.0*f[1])*dv4+((-53.66563145999495*f[23])-53.66563145999495*f[20]+48.0*f[1])*dv2)*wv2+((214.6625258399798*f[23]*dv2-1287.975155039879*f[23])*vcut3+((83.1384387633061*f[6]-92.951600308978*f[33])*dv3+(371.806401235912*f[33]-332.5537550532244*f[6])*dv)*vcut2+(((-53.66563145999495*f[23])-53.66563145999495*f[20]+48.0*f[1])*dv4+(107.3312629199899*f[23]+107.3312629199899*f[20]-96.0*f[1])*dv2)*vcut+(23.2379000772445*f[33]-26.83281572999747*f[20]-20.78460969082652*f[6]+24.0*f[1])*dv5)*wv+321.9937887599697*f[23]*vcut4+(110.8512516844081*f[6]-123.9354670786373*f[33])*dv*vcut3+((-53.66563145999495*f[23])-53.66563145999495*f[20]+48.0*f[1])*dv2*vcut2+((-15.49193338482967*f[33])-6.708203932499369*f[23]+13.41640786499874*f[20]+13.85640646055102*f[6]-12.0*f[1])*dv4))/dv5; 
  uhat[2] = 0.0; 
  uhat[3] = 0.0; 
  uhat[4] = (0.03333333333333333*(((180.0*f[32]*dv2-240.0*f[32])*wv3+((720.0*f[32]-360.0*f[32]*dv2)*vcut-103.9230484541326*f[19]*dv3+103.9230484541326*f[19]*dv)*wv2+((180.0*f[32]*dv2-720.0*f[32])*vcut2+(103.9230484541326*f[19]*dv3-207.8460969082653*f[19]*dv)*vcut+(51.96152422706632*f[19]-45.0*f[32])*dv4)*wv+240.0*f[32]*vcut3+103.9230484541326*f[19]*dv*vcut2+(30.0*f[32]-25.98076211353316*f[19])*dv3)*zVal+(103.9230484541326*f[21]*dv2-138.5640646055102*f[21])*wv3+((415.6921938165306*f[21]-207.8460969082653*f[21]*dv2)*vcut-60.0*f[11]*dv3+60.0*f[11]*dv)*wv2+((103.9230484541326*f[21]*dv2-415.6921938165306*f[21])*vcut2+(60.0*f[11]*dv3-120.0*f[11]*dv)*vcut+(30.0*f[11]-25.98076211353316*f[21])*dv4)*wv+138.5640646055102*f[21]*vcut3+60.0*f[11]*dv*vcut2+(17.32050807568877*f[21]-15.0*f[11])*dv3))/dv4; 
  uhat[5] = 0.0; 
  uhat[6] = 0.0; 
  uhat[7] = 0.0; 
  } else {
  uhat[0] = -(0.04166666666666666*(((278.854800926934*f[22]*dv3-371.8064012359121*f[22]*dv)*wv3+((557.7096018538681*f[22]*dv3-1115.419203707736*f[22]*dv)*vcut-160.9968943799849*f[12]*dv4+160.9968943799849*f[12]*dv2)*wv2+((278.854800926934*f[22]*dv3-1115.419203707736*f[22]*dv)*vcut2+(321.9937887599697*f[12]*dv2-160.9968943799849*f[12]*dv4)*vcut+((-69.71370023173351*f[22])-80.49844718999243*f[12])*dv5)*wv-371.8064012359121*f[22]*dv*vcut3+160.9968943799849*f[12]*dv2*vcut2+((-46.47580015448901*f[22])-40.24922359499622*f[12])*dv4)*zVal2+((557.7096018538681*f[24]-371.8064012359121*f[24]*dv2)*wv4+((2230.838407415472*f[24]-1115.419203707736*f[24]*dv2)*vcut+144.0*f[7]*dv3-192.0*f[7]*dv)*wv3+((3346.257611123208*f[24]-1115.419203707736*f[24]*dv2)*vcut2+(288.0*f[7]*dv3-576.0*f[7]*dv)*vcut+(92.95160030897802*f[24]-83.1384387633061*f[2])*dv4+(83.1384387633061*f[2]-92.95160030897802*f[24])*dv2)*wv2+((2230.838407415472*f[24]-371.8064012359121*f[24]*dv2)*vcut3+(144.0*f[7]*dv3-576.0*f[7]*dv)*vcut2+((92.95160030897802*f[24]-83.1384387633061*f[2])*dv4+(166.2768775266122*f[2]-185.903200617956*f[24])*dv2)*vcut+((-36.0*f[7])-41.56921938165305*f[2])*dv5)*wv+557.7096018538681*f[24]*vcut4-192.0*f[7]*dv*vcut3+(83.1384387633061*f[2]-92.95160030897802*f[24])*dv2*vcut2+((-11.61895003862225*f[24])-24.0*f[7]-20.78460969082652*f[2])*dv4)*zVal+(321.9937887599697*f[13]-214.6625258399798*f[13]*dv2)*wv4+((1287.975155039879*f[13]-643.9875775199395*f[13]*dv2)*vcut+(83.1384387633061*f[3]-92.95160030897802*f[22])*dv3+(123.9354670786373*f[22]-110.8512516844081*f[3])*dv)*wv3+((1931.962732559819*f[13]-643.9875775199395*f[13]*dv2)*vcut2+((166.2768775266122*f[3]-185.903200617956*f[22])*dv3+(371.8064012359121*f[22]-332.5537550532244*f[3])*dv)*vcut+(53.66563145999496*f[13]+53.66563145999496*f[12]-48.0*f[0])*dv4+((-53.66563145999496*f[13])-53.66563145999496*f[12]+48.0*f[0])*dv2)*wv2+((1287.975155039879*f[13]-214.6625258399798*f[13]*dv2)*vcut3+((83.1384387633061*f[3]-92.95160030897802*f[22])*dv3+(371.8064012359121*f[22]-332.5537550532244*f[3])*dv)*vcut2+((53.66563145999496*f[13]+53.66563145999496*f[12]-48.0*f[0])*dv4+((-107.3312629199899*f[13])-107.3312629199899*f[12]+96.0*f[0])*dv2)*vcut+(23.2379000772445*f[22]+26.83281572999748*f[12]-20.78460969082652*f[3]-24.0*f[0])*dv5)*wv+321.9937887599697*f[13]*vcut4+(123.9354670786373*f[22]-110.8512516844081*f[3])*dv*vcut3+((-53.66563145999496*f[13])-53.66563145999496*f[12]+48.0*f[0])*dv2*vcut2+(15.49193338482967*f[22]-6.708203932499369*f[13]+13.41640786499874*f[12]-13.85640646055102*f[3]-12.0*f[0])*dv4))/dv5; 
  uhat[1] = -(0.04166666666666666*(((278.8548009269339*f[33]*dv3-371.806401235912*f[33]*dv)*wv3+((557.7096018538679*f[33]*dv3-1115.419203707736*f[33]*dv)*vcut-160.9968943799848*f[20]*dv4+160.9968943799848*f[20]*dv2)*wv2+((278.8548009269339*f[33]*dv3-1115.419203707736*f[33]*dv)*vcut2+(321.9937887599697*f[20]*dv2-160.9968943799848*f[20]*dv4)*vcut+((-69.71370023173348*f[33])-80.49844718999242*f[20])*dv5)*wv-371.806401235912*f[33]*dv*vcut3+160.9968943799848*f[20]*dv2*vcut2+((-46.475800154489*f[33])-40.24922359499621*f[20])*dv4)*zVal2+((557.7096018538679*f[34]-371.806401235912*f[34]*dv2)*wv4+((2230.838407415471*f[34]-1115.419203707736*f[34]*dv2)*vcut+144.0*f[15]*dv3-192.0*f[15]*dv)*wv3+((3346.257611123207*f[34]-1115.419203707736*f[34]*dv2)*vcut2+(288.0*f[15]*dv3-576.0*f[15]*dv)*vcut+(92.951600308978*f[34]-83.1384387633061*f[5])*dv4+(83.1384387633061*f[5]-92.951600308978*f[34])*dv2)*wv2+((2230.838407415471*f[34]-371.806401235912*f[34]*dv2)*vcut3+(144.0*f[15]*dv3-576.0*f[15]*dv)*vcut2+((92.951600308978*f[34]-83.1384387633061*f[5])*dv4+(166.2768775266122*f[5]-185.903200617956*f[34])*dv2)*vcut+((-36.0*f[15])-41.56921938165305*f[5])*dv5)*wv+557.7096018538679*f[34]*vcut4-192.0*f[15]*dv*vcut3+(83.1384387633061*f[5]-92.951600308978*f[34])*dv2*vcut2+((-11.61895003862225*f[34])-24.0*f[15]-20.78460969082652*f[5])*dv4)*zVal+(321.9937887599697*f[23]-214.6625258399798*f[23]*dv2)*wv4+((1287.975155039879*f[23]-643.9875775199394*f[23]*dv2)*vcut+(83.1384387633061*f[6]-92.951600308978*f[33])*dv3+(123.9354670786373*f[33]-110.8512516844081*f[6])*dv)*wv3+((1931.962732559818*f[23]-643.9875775199394*f[23]*dv2)*vcut2+((166.2768775266122*f[6]-185.903200617956*f[33])*dv3+(371.806401235912*f[33]-332.5537550532244*f[6])*dv)*vcut+(53.66563145999495*f[23]+53.66563145999495*f[20]-48.0*f[1])*dv4+((-53.66563145999495*f[23])-53.66563145999495*f[20]+48.0*f[1])*dv2)*wv2+((1287.975155039879*f[23]-214.6625258399798*f[23]*dv2)*vcut3+((83.1384387633061*f[6]-92.951600308978*f[33])*dv3+(371.806401235912*f[33]-332.5537550532244*f[6])*dv)*vcut2+((53.66563145999495*f[23]+53.66563145999495*f[20]-48.0*f[1])*dv4+((-107.3312629199899*f[23])-107.3312629199899*f[20]+96.0*f[1])*dv2)*vcut+(23.2379000772445*f[33]+26.83281572999747*f[20]-20.78460969082652*f[6]-24.0*f[1])*dv5)*wv+321.9937887599697*f[23]*vcut4+(123.9354670786373*f[33]-110.8512516844081*f[6])*dv*vcut3+((-53.66563145999495*f[23])-53.66563145999495*f[20]+48.0*f[1])*dv2*vcut2+(15.49193338482967*f[33]-6.708203932499369*f[23]+13.41640786499874*f[20]-13.85640646055102*f[6]-12.0*f[1])*dv4))/dv5; 
  uhat[2] = 0.0; 
  uhat[3] = 0.0; 
  uhat[4] = -(0.03333333333333333*(((180.0*f[32]*dv2-240.0*f[32])*wv3+((360.0*f[32]*dv2-720.0*f[32])*vcut-103.9230484541326*f[19]*dv3+103.9230484541326*f[19]*dv)*wv2+((180.0*f[32]*dv2-720.0*f[32])*vcut2+(207.8460969082653*f[19]*dv-103.9230484541326*f[19]*dv3)*vcut+((-45.0*f[32])-51.96152422706632*f[19])*dv4)*wv-240.0*f[32]*vcut3+103.9230484541326*f[19]*dv*vcut2+((-30.0*f[32])-25.98076211353316*f[19])*dv3)*zVal+(103.9230484541326*f[21]*dv2-138.5640646055102*f[21])*wv3+((207.8460969082653*f[21]*dv2-415.6921938165306*f[21])*vcut-60.0*f[11]*dv3+60.0*f[11]*dv)*wv2+((103.9230484541326*f[21]*dv2-415.6921938165306*f[21])*vcut2+(120.0*f[11]*dv-60.0*f[11]*dv3)*vcut+((-25.98076211353316*f[21])-30.0*f[11])*dv4)*wv-138.5640646055102*f[21]*vcut3+60.0*f[11]*dv*vcut2+((-17.32050807568877*f[21])-15.0*f[11])*dv3))/dv4; 
  uhat[5] = 0.0; 
  uhat[6] = 0.0; 
  uhat[7] = 0.0; 
  }
  // calculate c = uhat/u 
  CartFieldBinOpDivide2xSer_P2(u, uhat, 1, 1, c); 
  // calculate fhat = c*f 
  CartFieldBinOpMultiply2x2vSer_P2(c, f, 1, 1, fhat); 
} 

double calcSheathDeltaPhi3xSer_P1(const double *phi, const double *phiWall, const double zVal) 
{ 
  return 0.6123724356957944*phi[3]*zVal-0.3535533905932737*phiWall[0]+0.3535533905932737*phi[0]; 
}

void calcSheathPartialReflectionScaled3x2vSer_P1(const double wv, const double dv, const double zVal, const double vcut, const double *f, double *fhat) 
{ 
  double u[8]; 
  double uhat[8]; 
  double c[8]; 
  double zVal2 = zVal*zVal; 
  double wv2 = wv*wv; 
  double wv3 = wv2*wv; 
  double wv4 = wv3*wv; 
  double wv5 = wv4*wv; 
  double dv2 = dv*dv; 
  double dv3 = dv2*dv; 
  double dv4 = dv3*dv; 
  double dv5 = dv4*dv; 
  double vcut2 = vcut*vcut; 
  double vcut3 = vcut2*vcut; 
  double vcut4 = vcut3*vcut; 
  double vcut5 = vcut4*vcut; 
  u[0] = (0.3333333333333333*((10.39230484541326*f[3]*dv*wv+6.0*f[11])*zVal+6.0*f[0]*dv*wv+3.464101615137754*f[4]))/dv; 
  u[1] = (0.3333333333333333*((10.39230484541326*f[7]*dv*wv+6.0*f[18])*zVal+6.0*f[1]*dv*wv+3.464101615137754*f[9]))/dv; 
  u[2] = (0.3333333333333333*((10.39230484541326*f[8]*dv*wv+6.0*f[19])*zVal+6.0*f[2]*dv*wv+3.464101615137754*f[10]))/dv; 
  u[3] = 0.0; 
  u[4] = (0.3333333333333333*((10.39230484541326*f[16]*dv*wv+6.0*f[26])*zVal+6.0*f[6]*dv*wv+3.464101615137754*f[17]))/dv; 
  u[5] = 0.0; 
  u[6] = 0.0; 
  u[7] = 0.0; 
  if(zVal == 1) {
  uhat[0] = (0.1666666666666667*(((36.0*f[11]*dv2-48.0*f[11])*wv3+((144.0*f[11]-72.0*f[11]*dv2)*vcut-20.78460969082652*f[3]*dv3+20.78460969082652*f[3]*dv)*wv2+((36.0*f[11]*dv2-144.0*f[11])*vcut2+(20.78460969082652*f[3]*dv3-41.56921938165305*f[3]*dv)*vcut+(10.39230484541326*f[3]-9.0*f[11])*dv4)*wv+48.0*f[11]*vcut3+20.78460969082652*f[3]*dv*vcut2+(6.0*f[11]-5.196152422706631*f[3])*dv3)*zVal+(20.78460969082652*f[4]*dv2-27.71281292110204*f[4])*wv3+((83.1384387633061*f[4]-41.56921938165305*f[4]*dv2)*vcut-12.0*f[0]*dv3+12.0*f[0]*dv)*wv2+((20.78460969082652*f[4]*dv2-83.1384387633061*f[4])*vcut2+(12.0*f[0]*dv3-24.0*f[0]*dv)*vcut+(6.0*f[0]-5.196152422706631*f[4])*dv4)*wv+27.71281292110204*f[4]*vcut3+12.0*f[0]*dv*vcut2+(3.464101615137754*f[4]-3.0*f[0])*dv3))/dv4; 
  uhat[1] = (0.1666666666666667*(((36.0*f[18]*dv2-48.0*f[18])*wv3+((144.0*f[18]-72.0*f[18]*dv2)*vcut-20.78460969082652*f[7]*dv3+20.78460969082652*f[7]*dv)*wv2+((36.0*f[18]*dv2-144.0*f[18])*vcut2+(20.78460969082652*f[7]*dv3-41.56921938165305*f[7]*dv)*vcut+(10.39230484541326*f[7]-9.0*f[18])*dv4)*wv+48.0*f[18]*vcut3+20.78460969082652*f[7]*dv*vcut2+(6.0*f[18]-5.196152422706631*f[7])*dv3)*zVal+(20.78460969082652*f[9]*dv2-27.71281292110204*f[9])*wv3+((83.1384387633061*f[9]-41.56921938165305*f[9]*dv2)*vcut-12.0*f[1]*dv3+12.0*f[1]*dv)*wv2+((20.78460969082652*f[9]*dv2-83.1384387633061*f[9])*vcut2+(12.0*f[1]*dv3-24.0*f[1]*dv)*vcut+(6.0*f[1]-5.196152422706631*f[9])*dv4)*wv+27.71281292110204*f[9]*vcut3+12.0*f[1]*dv*vcut2+(3.464101615137754*f[9]-3.0*f[1])*dv3))/dv4; 
  uhat[2] = (0.1666666666666667*(((36.0*f[19]*dv2-48.0*f[19])*wv3+((144.0*f[19]-72.0*f[19]*dv2)*vcut-20.78460969082652*f[8]*dv3+20.78460969082652*f[8]*dv)*wv2+((36.0*f[19]*dv2-144.0*f[19])*vcut2+(20.78460969082652*f[8]*dv3-41.56921938165305*f[8]*dv)*vcut+(10.39230484541326*f[8]-9.0*f[19])*dv4)*wv+48.0*f[19]*vcut3+20.78460969082652*f[8]*dv*vcut2+(6.0*f[19]-5.196152422706631*f[8])*dv3)*zVal+(20.78460969082652*f[10]*dv2-27.71281292110204*f[10])*wv3+((83.1384387633061*f[10]-41.56921938165305*f[10]*dv2)*vcut-12.0*f[2]*dv3+12.0*f[2]*dv)*wv2+((20.78460969082652*f[10]*dv2-83.1384387633061*f[10])*vcut2+(12.0*f[2]*dv3-24.0*f[2]*dv)*vcut+(6.0*f[2]-5.196152422706631*f[10])*dv4)*wv+27.71281292110204*f[10]*vcut3+12.0*f[2]*dv*vcut2+(3.464101615137754*f[10]-3.0*f[2])*dv3))/dv4; 
  uhat[3] = 0.0; 
  uhat[4] = (0.1666666666666667*(((36.0*f[26]*dv2-48.0*f[26])*wv3+((144.0*f[26]-72.0*f[26]*dv2)*vcut-20.78460969082652*f[16]*dv3+20.78460969082652*f[16]*dv)*wv2+((36.0*f[26]*dv2-144.0*f[26])*vcut2+(20.78460969082652*f[16]*dv3-41.56921938165305*f[16]*dv)*vcut+(10.39230484541326*f[16]-9.0*f[26])*dv4)*wv+48.0*f[26]*vcut3+20.78460969082652*f[16]*dv*vcut2+(6.0*f[26]-5.196152422706631*f[16])*dv3)*zVal+(20.78460969082652*f[17]*dv2-27.71281292110204*f[17])*wv3+((83.1384387633061*f[17]-41.56921938165305*f[17]*dv2)*vcut-12.0*f[6]*dv3+12.0*f[6]*dv)*wv2+((20.78460969082652*f[17]*dv2-83.1384387633061*f[17])*vcut2+(12.0*f[6]*dv3-24.0*f[6]*dv)*vcut+(6.0*f[6]-5.196152422706631*f[17])*dv4)*wv+27.71281292110204*f[17]*vcut3+12.0*f[6]*dv*vcut2+(3.464101615137754*f[17]-3.0*f[6])*dv3))/dv4; 
  uhat[5] = 0.0; 
  uhat[6] = 0.0; 
  uhat[7] = 0.0; 
  } else {
  uhat[0] = -(0.1666666666666667*(((36.0*f[11]*dv2-48.0*f[11])*wv3+((72.0*f[11]*dv2-144.0*f[11])*vcut-20.78460969082652*f[3]*dv3+20.78460969082652*f[3]*dv)*wv2+((36.0*f[11]*dv2-144.0*f[11])*vcut2+(41.56921938165305*f[3]*dv-20.78460969082652*f[3]*dv3)*vcut+((-9.0*f[11])-10.39230484541326*f[3])*dv4)*wv-48.0*f[11]*vcut3+20.78460969082652*f[3]*dv*vcut2+((-6.0*f[11])-5.196152422706631*f[3])*dv3)*zVal+(20.78460969082652*f[4]*dv2-27.71281292110204*f[4])*wv3+((41.56921938165305*f[4]*dv2-83.1384387633061*f[4])*vcut-12.0*f[0]*dv3+12.0*f[0]*dv)*wv2+((20.78460969082652*f[4]*dv2-83.1384387633061*f[4])*vcut2+(24.0*f[0]*dv-12.0*f[0]*dv3)*vcut+((-5.196152422706631*f[4])-6.0*f[0])*dv4)*wv-27.71281292110204*f[4]*vcut3+12.0*f[0]*dv*vcut2+((-3.464101615137754*f[4])-3.0*f[0])*dv3))/dv4; 
  uhat[1] = -(0.1666666666666667*(((36.0*f[18]*dv2-48.0*f[18])*wv3+((72.0*f[18]*dv2-144.0*f[18])*vcut-20.78460969082652*f[7]*dv3+20.78460969082652*f[7]*dv)*wv2+((36.0*f[18]*dv2-144.0*f[18])*vcut2+(41.56921938165305*f[7]*dv-20.78460969082652*f[7]*dv3)*vcut+((-9.0*f[18])-10.39230484541326*f[7])*dv4)*wv-48.0*f[18]*vcut3+20.78460969082652*f[7]*dv*vcut2+((-6.0*f[18])-5.196152422706631*f[7])*dv3)*zVal+(20.78460969082652*f[9]*dv2-27.71281292110204*f[9])*wv3+((41.56921938165305*f[9]*dv2-83.1384387633061*f[9])*vcut-12.0*f[1]*dv3+12.0*f[1]*dv)*wv2+((20.78460969082652*f[9]*dv2-83.1384387633061*f[9])*vcut2+(24.0*f[1]*dv-12.0*f[1]*dv3)*vcut+((-5.196152422706631*f[9])-6.0*f[1])*dv4)*wv-27.71281292110204*f[9]*vcut3+12.0*f[1]*dv*vcut2+((-3.464101615137754*f[9])-3.0*f[1])*dv3))/dv4; 
  uhat[2] = -(0.1666666666666667*(((36.0*f[19]*dv2-48.0*f[19])*wv3+((72.0*f[19]*dv2-144.0*f[19])*vcut-20.78460969082652*f[8]*dv3+20.78460969082652*f[8]*dv)*wv2+((36.0*f[19]*dv2-144.0*f[19])*vcut2+(41.56921938165305*f[8]*dv-20.78460969082652*f[8]*dv3)*vcut+((-9.0*f[19])-10.39230484541326*f[8])*dv4)*wv-48.0*f[19]*vcut3+20.78460969082652*f[8]*dv*vcut2+((-6.0*f[19])-5.196152422706631*f[8])*dv3)*zVal+(20.78460969082652*f[10]*dv2-27.71281292110204*f[10])*wv3+((41.56921938165305*f[10]*dv2-83.1384387633061*f[10])*vcut-12.0*f[2]*dv3+12.0*f[2]*dv)*wv2+((20.78460969082652*f[10]*dv2-83.1384387633061*f[10])*vcut2+(24.0*f[2]*dv-12.0*f[2]*dv3)*vcut+((-5.196152422706631*f[10])-6.0*f[2])*dv4)*wv-27.71281292110204*f[10]*vcut3+12.0*f[2]*dv*vcut2+((-3.464101615137754*f[10])-3.0*f[2])*dv3))/dv4; 
  uhat[3] = 0.0; 
  uhat[4] = -(0.1666666666666667*(((36.0*f[26]*dv2-48.0*f[26])*wv3+((72.0*f[26]*dv2-144.0*f[26])*vcut-20.78460969082652*f[16]*dv3+20.78460969082652*f[16]*dv)*wv2+((36.0*f[26]*dv2-144.0*f[26])*vcut2+(41.56921938165305*f[16]*dv-20.78460969082652*f[16]*dv3)*vcut+((-9.0*f[26])-10.39230484541326*f[16])*dv4)*wv-48.0*f[26]*vcut3+20.78460969082652*f[16]*dv*vcut2+((-6.0*f[26])-5.196152422706631*f[16])*dv3)*zVal+(20.78460969082652*f[17]*dv2-27.71281292110204*f[17])*wv3+((41.56921938165305*f[17]*dv2-83.1384387633061*f[17])*vcut-12.0*f[6]*dv3+12.0*f[6]*dv)*wv2+((20.78460969082652*f[17]*dv2-83.1384387633061*f[17])*vcut2+(24.0*f[6]*dv-12.0*f[6]*dv3)*vcut+((-5.196152422706631*f[17])-6.0*f[6])*dv4)*wv-27.71281292110204*f[17]*vcut3+12.0*f[6]*dv*vcut2+((-3.464101615137754*f[17])-3.0*f[6])*dv3))/dv4; 
  uhat[5] = 0.0; 
  uhat[6] = 0.0; 
  uhat[7] = 0.0; 
  }
  // calculate c = uhat/u 
  CartFieldBinOpDivide3xSer_P1(u, uhat, 1, 1, c); 
  // calculate fhat = c*f 
  CartFieldBinOpMultiply3x2vSer_P1(c, f, 1, 1, fhat); 
} 

double calcSheathDeltaPhi3xSer_P2(const double *phi, const double *phiWall, const double zVal) 
{ 
  double zVal2 = zVal*zVal; 
  return 1.185854122563142*phi[9]*(zVal2-0.3333333333333333)-0.6846531968814574*phi[14]*zVal-0.6846531968814574*phi[13]*zVal+0.6123724356957944*phi[3]*zVal+0.3952847075210473*phiWall[9]+0.3952847075210473*phiWall[8]-0.3952847075210473*phi[8]+0.3952847075210473*phiWall[7]-0.3952847075210473*phi[7]-0.3535533905932737*phiWall[0]+0.3535533905932737*phi[0]; 
}

void calcSheathPartialReflectionScaled3x2vSer_P2(const double wv, const double dv, const double zVal, const double vcut, const double *f, double *fhat) 
{ 
  double u[20]; 
  double uhat[20]; 
  double c[20]; 
  double zVal2 = zVal*zVal; 
  double wv2 = wv*wv; 
  double wv3 = wv2*wv; 
  double wv4 = wv3*wv; 
  double wv5 = wv4*wv; 
  double dv2 = dv*dv; 
  double dv3 = dv2*dv; 
  double dv4 = dv3*dv; 
  double dv5 = dv4*dv; 
  double vcut2 = vcut*vcut; 
  double vcut3 = vcut2*vcut; 
  double vcut4 = vcut3*vcut; 
  double vcut5 = vcut4*vcut; 
  u[0] = (0.3333333333333333*((20.12461179749811*f[18]*dv*wv+11.61895003862225*f[39])*zVal2+(10.39230484541326*f[3]*dv*wv+6.0*f[11])*zVal+(6.0*f[0]-6.708203932499369*f[18])*dv*wv-3.872983346207417*f[39]+3.464101615137754*f[4]))/dv; 
  u[1] = (0.3333333333333333*((20.1246117974981*f[35]*dv*wv+11.61895003862225*f[63])*zVal2+(10.39230484541326*f[7]*dv*wv+6.0*f[23])*zVal+(6.0*f[1]-6.708203932499369*f[35])*dv*wv-3.872983346207417*f[63]+3.464101615137754*f[9]))/dv; 
  u[2] = (0.3333333333333333*((20.1246117974981*f[36]*dv*wv+11.61895003862225*f[64])*zVal2+(10.39230484541326*f[8]*dv*wv+6.0*f[24])*zVal+(6.0*f[2]-6.708203932499369*f[36])*dv*wv-3.872983346207417*f[64]+3.464101615137754*f[10]))/dv; 
  u[3] = 0.0; 
  u[4] = (0.3333333333333333*((20.12461179749811*f[58]*dv*wv+11.61895003862225*f[89])*zVal2+(10.39230484541326*f[21]*dv*wv+6.0*f[51])*zVal+(6.0*f[6]-6.708203932499369*f[58])*dv*wv-3.872983346207417*f[89]+3.464101615137754*f[22]))/dv; 
  u[5] = 0.0; 
  u[6] = 0.0; 
  u[7] = (0.06666666666666667*((51.96152422706632*f[33]*dv*wv+30.0*f[61])*zVal+30.0*f[16]*dv*wv+17.32050807568877*f[37]))/dv; 
  u[8] = (0.06666666666666667*((51.96152422706632*f[34]*dv*wv+30.0*f[62])*zVal+30.0*f[17]*dv*wv+17.32050807568877*f[38]))/dv; 
  u[9] = 0.0; 
  u[10] = 0.0; 
  u[11] = (0.06666666666666667*((51.96152422706632*f[56]*dv*wv+30.0*f[87])*zVal+30.0*f[31]*dv*wv+17.32050807568877*f[59]))/dv; 
  u[12] = (0.06666666666666667*((51.96152422706632*f[57]*dv*wv+30.0*f[88])*zVal+30.0*f[32]*dv*wv+17.32050807568877*f[60]))/dv; 
  u[13] = 0.0; 
  u[14] = 0.0; 
  u[15] = 0.0; 
  u[16] = 0.0; 
  u[17] = 0.0; 
  u[18] = 0.0; 
  u[19] = 0.0; 
  if(zVal == 1) {
  uhat[0] = (0.04166666666666666*(((278.854800926934*f[39]*dv3-371.8064012359121*f[39]*dv)*wv3+((1115.419203707736*f[39]*dv-557.7096018538681*f[39]*dv3)*vcut-160.9968943799849*f[18]*dv4+160.9968943799849*f[18]*dv2)*wv2+((278.854800926934*f[39]*dv3-1115.419203707736*f[39]*dv)*vcut2+(160.9968943799849*f[18]*dv4-321.9937887599697*f[18]*dv2)*vcut+(80.49844718999243*f[18]-69.71370023173351*f[39])*dv5)*wv+371.8064012359121*f[39]*dv*vcut3+160.9968943799849*f[18]*dv2*vcut2+(46.47580015448901*f[39]-40.24922359499622*f[18])*dv4)*zVal2+((557.7096018538681*f[42]-371.8064012359121*f[42]*dv2)*wv4+((1115.419203707736*f[42]*dv2-2230.838407415472*f[42])*vcut+144.0*f[11]*dv3-192.0*f[11]*dv)*wv3+((3346.257611123208*f[42]-1115.419203707736*f[42]*dv2)*vcut2+(576.0*f[11]*dv-288.0*f[11]*dv3)*vcut+(92.95160030897802*f[42]-83.1384387633061*f[3])*dv4+(83.1384387633061*f[3]-92.95160030897802*f[42])*dv2)*wv2+((371.8064012359121*f[42]*dv2-2230.838407415472*f[42])*vcut3+(144.0*f[11]*dv3-576.0*f[11]*dv)*vcut2+((83.1384387633061*f[3]-92.95160030897802*f[42])*dv4+(185.903200617956*f[42]-166.2768775266122*f[3])*dv2)*vcut+(41.56921938165305*f[3]-36.0*f[11])*dv5)*wv+557.7096018538681*f[42]*vcut4+192.0*f[11]*dv*vcut3+(83.1384387633061*f[3]-92.95160030897802*f[42])*dv2*vcut2+((-11.61895003862225*f[42])+24.0*f[11]-20.78460969082652*f[3])*dv4)*zVal+(321.9937887599697*f[19]-214.6625258399798*f[19]*dv2)*wv4+((643.9875775199395*f[19]*dv2-1287.975155039879*f[19])*vcut+(83.1384387633061*f[4]-92.95160030897802*f[39])*dv3+(123.9354670786373*f[39]-110.8512516844081*f[4])*dv)*wv3+((1931.962732559819*f[19]-643.9875775199395*f[19]*dv2)*vcut2+((185.903200617956*f[39]-166.2768775266122*f[4])*dv3+(332.5537550532244*f[4]-371.8064012359121*f[39])*dv)*vcut+(53.66563145999496*f[19]+53.66563145999496*f[18]-48.0*f[0])*dv4+((-53.66563145999496*f[19])-53.66563145999496*f[18]+48.0*f[0])*dv2)*wv2+((214.6625258399798*f[19]*dv2-1287.975155039879*f[19])*vcut3+((83.1384387633061*f[4]-92.95160030897802*f[39])*dv3+(371.8064012359121*f[39]-332.5537550532244*f[4])*dv)*vcut2+(((-53.66563145999496*f[19])-53.66563145999496*f[18]+48.0*f[0])*dv4+(107.3312629199899*f[19]+107.3312629199899*f[18]-96.0*f[0])*dv2)*vcut+(23.2379000772445*f[39]-26.83281572999748*f[18]-20.78460969082652*f[4]+24.0*f[0])*dv5)*wv+321.9937887599697*f[19]*vcut4+(110.8512516844081*f[4]-123.9354670786373*f[39])*dv*vcut3+((-53.66563145999496*f[19])-53.66563145999496*f[18]+48.0*f[0])*dv2*vcut2+((-15.49193338482967*f[39])-6.708203932499369*f[19]+13.41640786499874*f[18]+13.85640646055102*f[4]-12.0*f[0])*dv4))/dv5; 
  uhat[1] = (0.04166666666666666*(((278.8548009269339*f[63]*dv3-371.806401235912*f[63]*dv)*wv3+((1115.419203707736*f[63]*dv-557.7096018538679*f[63]*dv3)*vcut-160.9968943799848*f[35]*dv4+160.9968943799848*f[35]*dv2)*wv2+((278.8548009269339*f[63]*dv3-1115.419203707736*f[63]*dv)*vcut2+(160.9968943799848*f[35]*dv4-321.9937887599697*f[35]*dv2)*vcut+(80.49844718999242*f[35]-69.71370023173348*f[63])*dv5)*wv+371.806401235912*f[63]*dv*vcut3+160.9968943799848*f[35]*dv2*vcut2+(46.475800154489*f[63]-40.24922359499621*f[35])*dv4)*zVal2+((557.7096018538679*f[66]-371.806401235912*f[66]*dv2)*wv4+((1115.419203707736*f[66]*dv2-2230.838407415471*f[66])*vcut+144.0*f[23]*dv3-192.0*f[23]*dv)*wv3+((3346.257611123207*f[66]-1115.419203707736*f[66]*dv2)*vcut2+(576.0*f[23]*dv-288.0*f[23]*dv3)*vcut+(92.951600308978*f[66]-83.1384387633061*f[7])*dv4+(83.1384387633061*f[7]-92.951600308978*f[66])*dv2)*wv2+((371.806401235912*f[66]*dv2-2230.838407415471*f[66])*vcut3+(144.0*f[23]*dv3-576.0*f[23]*dv)*vcut2+((83.1384387633061*f[7]-92.951600308978*f[66])*dv4+(185.903200617956*f[66]-166.2768775266122*f[7])*dv2)*vcut+(41.56921938165305*f[7]-36.0*f[23])*dv5)*wv+557.7096018538679*f[66]*vcut4+192.0*f[23]*dv*vcut3+(83.1384387633061*f[7]-92.951600308978*f[66])*dv2*vcut2+((-11.61895003862225*f[66])+24.0*f[23]-20.78460969082652*f[7])*dv4)*zVal+(321.9937887599697*f[40]-214.6625258399798*f[40]*dv2)*wv4+((643.9875775199394*f[40]*dv2-1287.975155039879*f[40])*vcut+(83.1384387633061*f[9]-92.951600308978*f[63])*dv3+(123.9354670786373*f[63]-110.8512516844081*f[9])*dv)*wv3+((1931.962732559818*f[40]-643.9875775199394*f[40]*dv2)*vcut2+((185.903200617956*f[63]-166.2768775266122*f[9])*dv3+(332.5537550532244*f[9]-371.806401235912*f[63])*dv)*vcut+(53.66563145999495*f[40]+53.66563145999495*f[35]-48.0*f[1])*dv4+((-53.66563145999495*f[40])-53.66563145999495*f[35]+48.0*f[1])*dv2)*wv2+((214.6625258399798*f[40]*dv2-1287.975155039879*f[40])*vcut3+((83.1384387633061*f[9]-92.951600308978*f[63])*dv3+(371.806401235912*f[63]-332.5537550532244*f[9])*dv)*vcut2+(((-53.66563145999495*f[40])-53.66563145999495*f[35]+48.0*f[1])*dv4+(107.3312629199899*f[40]+107.3312629199899*f[35]-96.0*f[1])*dv2)*vcut+(23.2379000772445*f[63]-26.83281572999747*f[35]-20.78460969082652*f[9]+24.0*f[1])*dv5)*wv+321.9937887599697*f[40]*vcut4+(110.8512516844081*f[9]-123.9354670786373*f[63])*dv*vcut3+((-53.66563145999495*f[40])-53.66563145999495*f[35]+48.0*f[1])*dv2*vcut2+((-15.49193338482967*f[63])-6.708203932499369*f[40]+13.41640786499874*f[35]+13.85640646055102*f[9]-12.0*f[1])*dv4))/dv5; 
  uhat[2] = (0.04166666666666666*(((278.8548009269339*f[64]*dv3-371.806401235912*f[64]*dv)*wv3+((1115.419203707736*f[64]*dv-557.7096018538679*f[64]*dv3)*vcut-160.9968943799848*f[36]*dv4+160.9968943799848*f[36]*dv2)*wv2+((278.8548009269339*f[64]*dv3-1115.419203707736*f[64]*dv)*vcut2+(160.9968943799848*f[36]*dv4-321.9937887599697*f[36]*dv2)*vcut+(80.49844718999242*f[36]-69.71370023173348*f[64])*dv5)*wv+371.806401235912*f[64]*dv*vcut3+160.9968943799848*f[36]*dv2*vcut2+(46.475800154489*f[64]-40.24922359499621*f[36])*dv4)*zVal2+((557.7096018538679*f[67]-371.806401235912*f[67]*dv2)*wv4+((1115.419203707736*f[67]*dv2-2230.838407415471*f[67])*vcut+144.0*f[24]*dv3-192.0*f[24]*dv)*wv3+((3346.257611123207*f[67]-1115.419203707736*f[67]*dv2)*vcut2+(576.0*f[24]*dv-288.0*f[24]*dv3)*vcut+(92.951600308978*f[67]-83.1384387633061*f[8])*dv4+(83.1384387633061*f[8]-92.951600308978*f[67])*dv2)*wv2+((371.806401235912*f[67]*dv2-2230.838407415471*f[67])*vcut3+(144.0*f[24]*dv3-576.0*f[24]*dv)*vcut2+((83.1384387633061*f[8]-92.951600308978*f[67])*dv4+(185.903200617956*f[67]-166.2768775266122*f[8])*dv2)*vcut+(41.56921938165305*f[8]-36.0*f[24])*dv5)*wv+557.7096018538679*f[67]*vcut4+192.0*f[24]*dv*vcut3+(83.1384387633061*f[8]-92.951600308978*f[67])*dv2*vcut2+((-11.61895003862225*f[67])+24.0*f[24]-20.78460969082652*f[8])*dv4)*zVal+(321.9937887599697*f[41]-214.6625258399798*f[41]*dv2)*wv4+((643.9875775199394*f[41]*dv2-1287.975155039879*f[41])*vcut+(83.1384387633061*f[10]-92.951600308978*f[64])*dv3+(123.9354670786373*f[64]-110.8512516844081*f[10])*dv)*wv3+((1931.962732559818*f[41]-643.9875775199394*f[41]*dv2)*vcut2+((185.903200617956*f[64]-166.2768775266122*f[10])*dv3+(332.5537550532244*f[10]-371.806401235912*f[64])*dv)*vcut+(53.66563145999495*f[41]+53.66563145999495*f[36]-48.0*f[2])*dv4+((-53.66563145999495*f[41])-53.66563145999495*f[36]+48.0*f[2])*dv2)*wv2+((214.6625258399798*f[41]*dv2-1287.975155039879*f[41])*vcut3+((83.1384387633061*f[10]-92.951600308978*f[64])*dv3+(371.806401235912*f[64]-332.5537550532244*f[10])*dv)*vcut2+(((-53.66563145999495*f[41])-53.66563145999495*f[36]+48.0*f[2])*dv4+(107.3312629199899*f[41]+107.3312629199899*f[36]-96.0*f[2])*dv2)*vcut+(23.2379000772445*f[64]-26.83281572999747*f[36]-20.78460969082652*f[10]+24.0*f[2])*dv5)*wv+321.9937887599697*f[41]*vcut4+(110.8512516844081*f[10]-123.9354670786373*f[64])*dv*vcut3+((-53.66563145999495*f[41])-53.66563145999495*f[36]+48.0*f[2])*dv2*vcut2+((-15.49193338482967*f[64])-6.708203932499369*f[41]+13.41640786499874*f[36]+13.85640646055102*f[10]-12.0*f[2])*dv4))/dv5; 
  uhat[3] = 0.0; 
  uhat[4] = (0.04166666666666666*(((278.854800926934*f[89]*dv3-371.8064012359121*f[89]*dv)*wv3+((1115.419203707736*f[89]*dv-557.7096018538681*f[89]*dv3)*vcut-160.9968943799849*f[58]*dv4+160.9968943799849*f[58]*dv2)*wv2+((278.854800926934*f[89]*dv3-1115.419203707736*f[89]*dv)*vcut2+(160.9968943799849*f[58]*dv4-321.9937887599697*f[58]*dv2)*vcut+(80.49844718999243*f[58]-69.71370023173351*f[89])*dv5)*wv+371.8064012359121*f[89]*dv*vcut3+160.9968943799849*f[58]*dv2*vcut2+(46.47580015448901*f[89]-40.24922359499622*f[58])*dv4)*zVal2+((557.7096018538681*f[90]-371.8064012359121*f[90]*dv2)*wv4+((1115.419203707736*f[90]*dv2-2230.838407415472*f[90])*vcut+144.0*f[51]*dv3-192.0*f[51]*dv)*wv3+((3346.257611123208*f[90]-1115.419203707736*f[90]*dv2)*vcut2+(576.0*f[51]*dv-288.0*f[51]*dv3)*vcut+(92.95160030897802*f[90]-83.1384387633061*f[21])*dv4+(83.1384387633061*f[21]-92.95160030897802*f[90])*dv2)*wv2+((371.8064012359121*f[90]*dv2-2230.838407415472*f[90])*vcut3+(144.0*f[51]*dv3-576.0*f[51]*dv)*vcut2+((83.1384387633061*f[21]-92.95160030897802*f[90])*dv4+(185.903200617956*f[90]-166.2768775266122*f[21])*dv2)*vcut+(41.56921938165305*f[21]-36.0*f[51])*dv5)*wv+557.7096018538681*f[90]*vcut4+192.0*f[51]*dv*vcut3+(83.1384387633061*f[21]-92.95160030897802*f[90])*dv2*vcut2+((-11.61895003862225*f[90])+24.0*f[51]-20.78460969082652*f[21])*dv4)*zVal+(321.9937887599697*f[65]-214.6625258399798*f[65]*dv2)*wv4+((643.9875775199395*f[65]*dv2-1287.975155039879*f[65])*vcut+(83.1384387633061*f[22]-92.95160030897802*f[89])*dv3+(123.9354670786373*f[89]-110.8512516844081*f[22])*dv)*wv3+((1931.962732559819*f[65]-643.9875775199395*f[65]*dv2)*vcut2+((185.903200617956*f[89]-166.2768775266122*f[22])*dv3+(332.5537550532244*f[22]-371.8064012359121*f[89])*dv)*vcut+(53.66563145999496*f[65]+53.66563145999496*f[58]-48.0*f[6])*dv4+((-53.66563145999496*f[65])-53.66563145999496*f[58]+48.0*f[6])*dv2)*wv2+((214.6625258399798*f[65]*dv2-1287.975155039879*f[65])*vcut3+((83.1384387633061*f[22]-92.95160030897802*f[89])*dv3+(371.8064012359121*f[89]-332.5537550532244*f[22])*dv)*vcut2+(((-53.66563145999496*f[65])-53.66563145999496*f[58]+48.0*f[6])*dv4+(107.3312629199899*f[65]+107.3312629199899*f[58]-96.0*f[6])*dv2)*vcut+(23.2379000772445*f[89]-26.83281572999748*f[58]-20.78460969082652*f[22]+24.0*f[6])*dv5)*wv+321.9937887599697*f[65]*vcut4+(110.8512516844081*f[22]-123.9354670786373*f[89])*dv*vcut3+((-53.66563145999496*f[65])-53.66563145999496*f[58]+48.0*f[6])*dv2*vcut2+((-15.49193338482967*f[89])-6.708203932499369*f[65]+13.41640786499874*f[58]+13.85640646055102*f[22]-12.0*f[6])*dv4))/dv5; 
  uhat[5] = 0.0; 
  uhat[6] = 0.0; 
  uhat[7] = (0.03333333333333333*(((180.0*f[61]*dv2-240.0*f[61])*wv3+((720.0*f[61]-360.0*f[61]*dv2)*vcut-103.9230484541326*f[33]*dv3+103.9230484541326*f[33]*dv)*wv2+((180.0*f[61]*dv2-720.0*f[61])*vcut2+(103.9230484541326*f[33]*dv3-207.8460969082653*f[33]*dv)*vcut+(51.96152422706632*f[33]-45.0*f[61])*dv4)*wv+240.0*f[61]*vcut3+103.9230484541326*f[33]*dv*vcut2+(30.0*f[61]-25.98076211353316*f[33])*dv3)*zVal+(103.9230484541326*f[37]*dv2-138.5640646055102*f[37])*wv3+((415.6921938165306*f[37]-207.8460969082653*f[37]*dv2)*vcut-60.0*f[16]*dv3+60.0*f[16]*dv)*wv2+((103.9230484541326*f[37]*dv2-415.6921938165306*f[37])*vcut2+(60.0*f[16]*dv3-120.0*f[16]*dv)*vcut+(30.0*f[16]-25.98076211353316*f[37])*dv4)*wv+138.5640646055102*f[37]*vcut3+60.0*f[16]*dv*vcut2+(17.32050807568877*f[37]-15.0*f[16])*dv3))/dv4; 
  uhat[8] = (0.03333333333333333*(((180.0*f[62]*dv2-240.0*f[62])*wv3+((720.0*f[62]-360.0*f[62]*dv2)*vcut-103.9230484541326*f[34]*dv3+103.9230484541326*f[34]*dv)*wv2+((180.0*f[62]*dv2-720.0*f[62])*vcut2+(103.9230484541326*f[34]*dv3-207.8460969082653*f[34]*dv)*vcut+(51.96152422706632*f[34]-45.0*f[62])*dv4)*wv+240.0*f[62]*vcut3+103.9230484541326*f[34]*dv*vcut2+(30.0*f[62]-25.98076211353316*f[34])*dv3)*zVal+(103.9230484541326*f[38]*dv2-138.5640646055102*f[38])*wv3+((415.6921938165306*f[38]-207.8460969082653*f[38]*dv2)*vcut-60.0*f[17]*dv3+60.0*f[17]*dv)*wv2+((103.9230484541326*f[38]*dv2-415.6921938165306*f[38])*vcut2+(60.0*f[17]*dv3-120.0*f[17]*dv)*vcut+(30.0*f[17]-25.98076211353316*f[38])*dv4)*wv+138.5640646055102*f[38]*vcut3+60.0*f[17]*dv*vcut2+(17.32050807568877*f[38]-15.0*f[17])*dv3))/dv4; 
  uhat[9] = 0.0; 
  uhat[10] = 0.0; 
  uhat[11] = (0.03333333333333333*(((180.0*f[87]*dv2-240.0*f[87])*wv3+((720.0*f[87]-360.0*f[87]*dv2)*vcut-103.9230484541326*f[56]*dv3+103.9230484541326*f[56]*dv)*wv2+((180.0*f[87]*dv2-720.0*f[87])*vcut2+(103.9230484541326*f[56]*dv3-207.8460969082653*f[56]*dv)*vcut+(51.96152422706632*f[56]-45.0*f[87])*dv4)*wv+240.0*f[87]*vcut3+103.9230484541326*f[56]*dv*vcut2+(30.0*f[87]-25.98076211353316*f[56])*dv3)*zVal+(103.9230484541326*f[59]*dv2-138.5640646055102*f[59])*wv3+((415.6921938165306*f[59]-207.8460969082653*f[59]*dv2)*vcut-60.0*f[31]*dv3+60.0*f[31]*dv)*wv2+((103.9230484541326*f[59]*dv2-415.6921938165306*f[59])*vcut2+(60.0*f[31]*dv3-120.0*f[31]*dv)*vcut+(30.0*f[31]-25.98076211353316*f[59])*dv4)*wv+138.5640646055102*f[59]*vcut3+60.0*f[31]*dv*vcut2+(17.32050807568877*f[59]-15.0*f[31])*dv3))/dv4; 
  uhat[12] = (0.03333333333333333*(((180.0*f[88]*dv2-240.0*f[88])*wv3+((720.0*f[88]-360.0*f[88]*dv2)*vcut-103.9230484541326*f[57]*dv3+103.9230484541326*f[57]*dv)*wv2+((180.0*f[88]*dv2-720.0*f[88])*vcut2+(103.9230484541326*f[57]*dv3-207.8460969082653*f[57]*dv)*vcut+(51.96152422706632*f[57]-45.0*f[88])*dv4)*wv+240.0*f[88]*vcut3+103.9230484541326*f[57]*dv*vcut2+(30.0*f[88]-25.98076211353316*f[57])*dv3)*zVal+(103.9230484541326*f[60]*dv2-138.5640646055102*f[60])*wv3+((415.6921938165306*f[60]-207.8460969082653*f[60]*dv2)*vcut-60.0*f[32]*dv3+60.0*f[32]*dv)*wv2+((103.9230484541326*f[60]*dv2-415.6921938165306*f[60])*vcut2+(60.0*f[32]*dv3-120.0*f[32]*dv)*vcut+(30.0*f[32]-25.98076211353316*f[60])*dv4)*wv+138.5640646055102*f[60]*vcut3+60.0*f[32]*dv*vcut2+(17.32050807568877*f[60]-15.0*f[32])*dv3))/dv4; 
  uhat[13] = 0.0; 
  uhat[14] = 0.0; 
  uhat[15] = 0.0; 
  uhat[16] = 0.0; 
  uhat[17] = 0.0; 
  uhat[18] = 0.0; 
  uhat[19] = 0.0; 
  } else {
  uhat[0] = -(0.04166666666666666*(((278.854800926934*f[39]*dv3-371.8064012359121*f[39]*dv)*wv3+((557.7096018538681*f[39]*dv3-1115.419203707736*f[39]*dv)*vcut-160.9968943799849*f[18]*dv4+160.9968943799849*f[18]*dv2)*wv2+((278.854800926934*f[39]*dv3-1115.419203707736*f[39]*dv)*vcut2+(321.9937887599697*f[18]*dv2-160.9968943799849*f[18]*dv4)*vcut+((-69.71370023173351*f[39])-80.49844718999243*f[18])*dv5)*wv-371.8064012359121*f[39]*dv*vcut3+160.9968943799849*f[18]*dv2*vcut2+((-46.47580015448901*f[39])-40.24922359499622*f[18])*dv4)*zVal2+((557.7096018538681*f[42]-371.8064012359121*f[42]*dv2)*wv4+((2230.838407415472*f[42]-1115.419203707736*f[42]*dv2)*vcut+144.0*f[11]*dv3-192.0*f[11]*dv)*wv3+((3346.257611123208*f[42]-1115.419203707736*f[42]*dv2)*vcut2+(288.0*f[11]*dv3-576.0*f[11]*dv)*vcut+(92.95160030897802*f[42]-83.1384387633061*f[3])*dv4+(83.1384387633061*f[3]-92.95160030897802*f[42])*dv2)*wv2+((2230.838407415472*f[42]-371.8064012359121*f[42]*dv2)*vcut3+(144.0*f[11]*dv3-576.0*f[11]*dv)*vcut2+((92.95160030897802*f[42]-83.1384387633061*f[3])*dv4+(166.2768775266122*f[3]-185.903200617956*f[42])*dv2)*vcut+((-36.0*f[11])-41.56921938165305*f[3])*dv5)*wv+557.7096018538681*f[42]*vcut4-192.0*f[11]*dv*vcut3+(83.1384387633061*f[3]-92.95160030897802*f[42])*dv2*vcut2+((-11.61895003862225*f[42])-24.0*f[11]-20.78460969082652*f[3])*dv4)*zVal+(321.9937887599697*f[19]-214.6625258399798*f[19]*dv2)*wv4+((1287.975155039879*f[19]-643.9875775199395*f[19]*dv2)*vcut+(83.1384387633061*f[4]-92.95160030897802*f[39])*dv3+(123.9354670786373*f[39]-110.8512516844081*f[4])*dv)*wv3+((1931.962732559819*f[19]-643.9875775199395*f[19]*dv2)*vcut2+((166.2768775266122*f[4]-185.903200617956*f[39])*dv3+(371.8064012359121*f[39]-332.5537550532244*f[4])*dv)*vcut+(53.66563145999496*f[19]+53.66563145999496*f[18]-48.0*f[0])*dv4+((-53.66563145999496*f[19])-53.66563145999496*f[18]+48.0*f[0])*dv2)*wv2+((1287.975155039879*f[19]-214.6625258399798*f[19]*dv2)*vcut3+((83.1384387633061*f[4]-92.95160030897802*f[39])*dv3+(371.8064012359121*f[39]-332.5537550532244*f[4])*dv)*vcut2+((53.66563145999496*f[19]+53.66563145999496*f[18]-48.0*f[0])*dv4+((-107.3312629199899*f[19])-107.3312629199899*f[18]+96.0*f[0])*dv2)*vcut+(23.2379000772445*f[39]+26.83281572999748*f[18]-20.78460969082652*f[4]-24.0*f[0])*dv5)*wv+321.9937887599697*f[19]*vcut4+(123.9354670786373*f[39]-110.8512516844081*f[4])*dv*vcut3+((-53.66563145999496*f[19])-53.66563145999496*f[18]+48.0*f[0])*dv2*vcut2+(15.49193338482967*f[39]-6.708203932499369*f[19]+13.41640786499874*f[18]-13.85640646055102*f[4]-12.0*f[0])*dv4))/dv5; 
  uhat[1] = -(0.04166666666666666*(((278.8548009269339*f[63]*dv3-371.806401235912*f[63]*dv)*wv3+((557.7096018538679*f[63]*dv3-1115.419203707736*f[63]*dv)*vcut-160.9968943799848*f[35]*dv4+160.9968943799848*f[35]*dv2)*wv2+((278.8548009269339*f[63]*dv3-1115.419203707736*f[63]*dv)*vcut2+(321.9937887599697*f[35]*dv2-160.9968943799848*f[35]*dv4)*vcut+((-69.71370023173348*f[63])-80.49844718999242*f[35])*dv5)*wv-371.806401235912*f[63]*dv*vcut3+160.9968943799848*f[35]*dv2*vcut2+((-46.475800154489*f[63])-40.24922359499621*f[35])*dv4)*zVal2+((557.7096018538679*f[66]-371.806401235912*f[66]*dv2)*wv4+((2230.838407415471*f[66]-1115.419203707736*f[66]*dv2)*vcut+144.0*f[23]*dv3-192.0*f[23]*dv)*wv3+((3346.257611123207*f[66]-1115.419203707736*f[66]*dv2)*vcut2+(288.0*f[23]*dv3-576.0*f[23]*dv)*vcut+(92.951600308978*f[66]-83.1384387633061*f[7])*dv4+(83.1384387633061*f[7]-92.951600308978*f[66])*dv2)*wv2+((2230.838407415471*f[66]-371.806401235912*f[66]*dv2)*vcut3+(144.0*f[23]*dv3-576.0*f[23]*dv)*vcut2+((92.951600308978*f[66]-83.1384387633061*f[7])*dv4+(166.2768775266122*f[7]-185.903200617956*f[66])*dv2)*vcut+((-36.0*f[23])-41.56921938165305*f[7])*dv5)*wv+557.7096018538679*f[66]*vcut4-192.0*f[23]*dv*vcut3+(83.1384387633061*f[7]-92.951600308978*f[66])*dv2*vcut2+((-11.61895003862225*f[66])-24.0*f[23]-20.78460969082652*f[7])*dv4)*zVal+(321.9937887599697*f[40]-214.6625258399798*f[40]*dv2)*wv4+((1287.975155039879*f[40]-643.9875775199394*f[40]*dv2)*vcut+(83.1384387633061*f[9]-92.951600308978*f[63])*dv3+(123.9354670786373*f[63]-110.8512516844081*f[9])*dv)*wv3+((1931.962732559818*f[40]-643.9875775199394*f[40]*dv2)*vcut2+((166.2768775266122*f[9]-185.903200617956*f[63])*dv3+(371.806401235912*f[63]-332.5537550532244*f[9])*dv)*vcut+(53.66563145999495*f[40]+53.66563145999495*f[35]-48.0*f[1])*dv4+((-53.66563145999495*f[40])-53.66563145999495*f[35]+48.0*f[1])*dv2)*wv2+((1287.975155039879*f[40]-214.6625258399798*f[40]*dv2)*vcut3+((83.1384387633061*f[9]-92.951600308978*f[63])*dv3+(371.806401235912*f[63]-332.5537550532244*f[9])*dv)*vcut2+((53.66563145999495*f[40]+53.66563145999495*f[35]-48.0*f[1])*dv4+((-107.3312629199899*f[40])-107.3312629199899*f[35]+96.0*f[1])*dv2)*vcut+(23.2379000772445*f[63]+26.83281572999747*f[35]-20.78460969082652*f[9]-24.0*f[1])*dv5)*wv+321.9937887599697*f[40]*vcut4+(123.9354670786373*f[63]-110.8512516844081*f[9])*dv*vcut3+((-53.66563145999495*f[40])-53.66563145999495*f[35]+48.0*f[1])*dv2*vcut2+(15.49193338482967*f[63]-6.708203932499369*f[40]+13.41640786499874*f[35]-13.85640646055102*f[9]-12.0*f[1])*dv4))/dv5; 
  uhat[2] = -(0.04166666666666666*(((278.8548009269339*f[64]*dv3-371.806401235912*f[64]*dv)*wv3+((557.7096018538679*f[64]*dv3-1115.419203707736*f[64]*dv)*vcut-160.9968943799848*f[36]*dv4+160.9968943799848*f[36]*dv2)*wv2+((278.8548009269339*f[64]*dv3-1115.419203707736*f[64]*dv)*vcut2+(321.9937887599697*f[36]*dv2-160.9968943799848*f[36]*dv4)*vcut+((-69.71370023173348*f[64])-80.49844718999242*f[36])*dv5)*wv-371.806401235912*f[64]*dv*vcut3+160.9968943799848*f[36]*dv2*vcut2+((-46.475800154489*f[64])-40.24922359499621*f[36])*dv4)*zVal2+((557.7096018538679*f[67]-371.806401235912*f[67]*dv2)*wv4+((2230.838407415471*f[67]-1115.419203707736*f[67]*dv2)*vcut+144.0*f[24]*dv3-192.0*f[24]*dv)*wv3+((3346.257611123207*f[67]-1115.419203707736*f[67]*dv2)*vcut2+(288.0*f[24]*dv3-576.0*f[24]*dv)*vcut+(92.951600308978*f[67]-83.1384387633061*f[8])*dv4+(83.1384387633061*f[8]-92.951600308978*f[67])*dv2)*wv2+((2230.838407415471*f[67]-371.806401235912*f[67]*dv2)*vcut3+(144.0*f[24]*dv3-576.0*f[24]*dv)*vcut2+((92.951600308978*f[67]-83.1384387633061*f[8])*dv4+(166.2768775266122*f[8]-185.903200617956*f[67])*dv2)*vcut+((-36.0*f[24])-41.56921938165305*f[8])*dv5)*wv+557.7096018538679*f[67]*vcut4-192.0*f[24]*dv*vcut3+(83.1384387633061*f[8]-92.951600308978*f[67])*dv2*vcut2+((-11.61895003862225*f[67])-24.0*f[24]-20.78460969082652*f[8])*dv4)*zVal+(321.9937887599697*f[41]-214.6625258399798*f[41]*dv2)*wv4+((1287.975155039879*f[41]-643.9875775199394*f[41]*dv2)*vcut+(83.1384387633061*f[10]-92.951600308978*f[64])*dv3+(123.9354670786373*f[64]-110.8512516844081*f[10])*dv)*wv3+((1931.962732559818*f[41]-643.9875775199394*f[41]*dv2)*vcut2+((166.2768775266122*f[10]-185.903200617956*f[64])*dv3+(371.806401235912*f[64]-332.5537550532244*f[10])*dv)*vcut+(53.66563145999495*f[41]+53.66563145999495*f[36]-48.0*f[2])*dv4+((-53.66563145999495*f[41])-53.66563145999495*f[36]+48.0*f[2])*dv2)*wv2+((1287.975155039879*f[41]-214.6625258399798*f[41]*dv2)*vcut3+((83.1384387633061*f[10]-92.951600308978*f[64])*dv3+(371.806401235912*f[64]-332.5537550532244*f[10])*dv)*vcut2+((53.66563145999495*f[41]+53.66563145999495*f[36]-48.0*f[2])*dv4+((-107.3312629199899*f[41])-107.3312629199899*f[36]+96.0*f[2])*dv2)*vcut+(23.2379000772445*f[64]+26.83281572999747*f[36]-20.78460969082652*f[10]-24.0*f[2])*dv5)*wv+321.9937887599697*f[41]*vcut4+(123.9354670786373*f[64]-110.8512516844081*f[10])*dv*vcut3+((-53.66563145999495*f[41])-53.66563145999495*f[36]+48.0*f[2])*dv2*vcut2+(15.49193338482967*f[64]-6.708203932499369*f[41]+13.41640786499874*f[36]-13.85640646055102*f[10]-12.0*f[2])*dv4))/dv5; 
  uhat[3] = 0.0; 
  uhat[4] = -(0.04166666666666666*(((278.854800926934*f[89]*dv3-371.8064012359121*f[89]*dv)*wv3+((557.7096018538681*f[89]*dv3-1115.419203707736*f[89]*dv)*vcut-160.9968943799849*f[58]*dv4+160.9968943799849*f[58]*dv2)*wv2+((278.854800926934*f[89]*dv3-1115.419203707736*f[89]*dv)*vcut2+(321.9937887599697*f[58]*dv2-160.9968943799849*f[58]*dv4)*vcut+((-69.71370023173351*f[89])-80.49844718999243*f[58])*dv5)*wv-371.8064012359121*f[89]*dv*vcut3+160.9968943799849*f[58]*dv2*vcut2+((-46.47580015448901*f[89])-40.24922359499622*f[58])*dv4)*zVal2+((557.7096018538681*f[90]-371.8064012359121*f[90]*dv2)*wv4+((2230.838407415472*f[90]-1115.419203707736*f[90]*dv2)*vcut+144.0*f[51]*dv3-192.0*f[51]*dv)*wv3+((3346.257611123208*f[90]-1115.419203707736*f[90]*dv2)*vcut2+(288.0*f[51]*dv3-576.0*f[51]*dv)*vcut+(92.95160030897802*f[90]-83.1384387633061*f[21])*dv4+(83.1384387633061*f[21]-92.95160030897802*f[90])*dv2)*wv2+((2230.838407415472*f[90]-371.8064012359121*f[90]*dv2)*vcut3+(144.0*f[51]*dv3-576.0*f[51]*dv)*vcut2+((92.95160030897802*f[90]-83.1384387633061*f[21])*dv4+(166.2768775266122*f[21]-185.903200617956*f[90])*dv2)*vcut+((-36.0*f[51])-41.56921938165305*f[21])*dv5)*wv+557.7096018538681*f[90]*vcut4-192.0*f[51]*dv*vcut3+(83.1384387633061*f[21]-92.95160030897802*f[90])*dv2*vcut2+((-11.61895003862225*f[90])-24.0*f[51]-20.78460969082652*f[21])*dv4)*zVal+(321.9937887599697*f[65]-214.6625258399798*f[65]*dv2)*wv4+((1287.975155039879*f[65]-643.9875775199395*f[65]*dv2)*vcut+(83.1384387633061*f[22]-92.95160030897802*f[89])*dv3+(123.9354670786373*f[89]-110.8512516844081*f[22])*dv)*wv3+((1931.962732559819*f[65]-643.9875775199395*f[65]*dv2)*vcut2+((166.2768775266122*f[22]-185.903200617956*f[89])*dv3+(371.8064012359121*f[89]-332.5537550532244*f[22])*dv)*vcut+(53.66563145999496*f[65]+53.66563145999496*f[58]-48.0*f[6])*dv4+((-53.66563145999496*f[65])-53.66563145999496*f[58]+48.0*f[6])*dv2)*wv2+((1287.975155039879*f[65]-214.6625258399798*f[65]*dv2)*vcut3+((83.1384387633061*f[22]-92.95160030897802*f[89])*dv3+(371.8064012359121*f[89]-332.5537550532244*f[22])*dv)*vcut2+((53.66563145999496*f[65]+53.66563145999496*f[58]-48.0*f[6])*dv4+((-107.3312629199899*f[65])-107.3312629199899*f[58]+96.0*f[6])*dv2)*vcut+(23.2379000772445*f[89]+26.83281572999748*f[58]-20.78460969082652*f[22]-24.0*f[6])*dv5)*wv+321.9937887599697*f[65]*vcut4+(123.9354670786373*f[89]-110.8512516844081*f[22])*dv*vcut3+((-53.66563145999496*f[65])-53.66563145999496*f[58]+48.0*f[6])*dv2*vcut2+(15.49193338482967*f[89]-6.708203932499369*f[65]+13.41640786499874*f[58]-13.85640646055102*f[22]-12.0*f[6])*dv4))/dv5; 
  uhat[5] = 0.0; 
  uhat[6] = 0.0; 
  uhat[7] = -(0.03333333333333333*(((180.0*f[61]*dv2-240.0*f[61])*wv3+((360.0*f[61]*dv2-720.0*f[61])*vcut-103.9230484541326*f[33]*dv3+103.9230484541326*f[33]*dv)*wv2+((180.0*f[61]*dv2-720.0*f[61])*vcut2+(207.8460969082653*f[33]*dv-103.9230484541326*f[33]*dv3)*vcut+((-45.0*f[61])-51.96152422706632*f[33])*dv4)*wv-240.0*f[61]*vcut3+103.9230484541326*f[33]*dv*vcut2+((-30.0*f[61])-25.98076211353316*f[33])*dv3)*zVal+(103.9230484541326*f[37]*dv2-138.5640646055102*f[37])*wv3+((207.8460969082653*f[37]*dv2-415.6921938165306*f[37])*vcut-60.0*f[16]*dv3+60.0*f[16]*dv)*wv2+((103.9230484541326*f[37]*dv2-415.6921938165306*f[37])*vcut2+(120.0*f[16]*dv-60.0*f[16]*dv3)*vcut+((-25.98076211353316*f[37])-30.0*f[16])*dv4)*wv-138.5640646055102*f[37]*vcut3+60.0*f[16]*dv*vcut2+((-17.32050807568877*f[37])-15.0*f[16])*dv3))/dv4; 
  uhat[8] = -(0.03333333333333333*(((180.0*f[62]*dv2-240.0*f[62])*wv3+((360.0*f[62]*dv2-720.0*f[62])*vcut-103.9230484541326*f[34]*dv3+103.9230484541326*f[34]*dv)*wv2+((180.0*f[62]*dv2-720.0*f[62])*vcut2+(207.8460969082653*f[34]*dv-103.9230484541326*f[34]*dv3)*vcut+((-45.0*f[62])-51.96152422706632*f[34])*dv4)*wv-240.0*f[62]*vcut3+103.9230484541326*f[34]*dv*vcut2+((-30.0*f[62])-25.98076211353316*f[34])*dv3)*zVal+(103.9230484541326*f[38]*dv2-138.5640646055102*f[38])*wv3+((207.8460969082653*f[38]*dv2-415.6921938165306*f[38])*vcut-60.0*f[17]*dv3+60.0*f[17]*dv)*wv2+((103.9230484541326*f[38]*dv2-415.6921938165306*f[38])*vcut2+(120.0*f[17]*dv-60.0*f[17]*dv3)*vcut+((-25.98076211353316*f[38])-30.0*f[17])*dv4)*wv-138.5640646055102*f[38]*vcut3+60.0*f[17]*dv*vcut2+((-17.32050807568877*f[38])-15.0*f[17])*dv3))/dv4; 
  uhat[9] = 0.0; 
  uhat[10] = 0.0; 
  uhat[11] = -(0.03333333333333333*(((180.0*f[87]*dv2-240.0*f[87])*wv3+((360.0*f[87]*dv2-720.0*f[87])*vcut-103.9230484541326*f[56]*dv3+103.9230484541326*f[56]*dv)*wv2+((180.0*f[87]*dv2-720.0*f[87])*vcut2+(207.8460969082653*f[56]*dv-103.9230484541326*f[56]*dv3)*vcut+((-45.0*f[87])-51.96152422706632*f[56])*dv4)*wv-240.0*f[87]*vcut3+103.9230484541326*f[56]*dv*vcut2+((-30.0*f[87])-25.98076211353316*f[56])*dv3)*zVal+(103.9230484541326*f[59]*dv2-138.5640646055102*f[59])*wv3+((207.8460969082653*f[59]*dv2-415.6921938165306*f[59])*vcut-60.0*f[31]*dv3+60.0*f[31]*dv)*wv2+((103.9230484541326*f[59]*dv2-415.6921938165306*f[59])*vcut2+(120.0*f[31]*dv-60.0*f[31]*dv3)*vcut+((-25.98076211353316*f[59])-30.0*f[31])*dv4)*wv-138.5640646055102*f[59]*vcut3+60.0*f[31]*dv*vcut2+((-17.32050807568877*f[59])-15.0*f[31])*dv3))/dv4; 
  uhat[12] = -(0.03333333333333333*(((180.0*f[88]*dv2-240.0*f[88])*wv3+((360.0*f[88]*dv2-720.0*f[88])*vcut-103.9230484541326*f[57]*dv3+103.9230484541326*f[57]*dv)*wv2+((180.0*f[88]*dv2-720.0*f[88])*vcut2+(207.8460969082653*f[57]*dv-103.9230484541326*f[57]*dv3)*vcut+((-45.0*f[88])-51.96152422706632*f[57])*dv4)*wv-240.0*f[88]*vcut3+103.9230484541326*f[57]*dv*vcut2+((-30.0*f[88])-25.98076211353316*f[57])*dv3)*zVal+(103.9230484541326*f[60]*dv2-138.5640646055102*f[60])*wv3+((207.8460969082653*f[60]*dv2-415.6921938165306*f[60])*vcut-60.0*f[32]*dv3+60.0*f[32]*dv)*wv2+((103.9230484541326*f[60]*dv2-415.6921938165306*f[60])*vcut2+(120.0*f[32]*dv-60.0*f[32]*dv3)*vcut+((-25.98076211353316*f[60])-30.0*f[32])*dv4)*wv-138.5640646055102*f[60]*vcut3+60.0*f[32]*dv*vcut2+((-17.32050807568877*f[60])-15.0*f[32])*dv3))/dv4; 
  uhat[13] = 0.0; 
  uhat[14] = 0.0; 
  uhat[15] = 0.0; 
  uhat[16] = 0.0; 
  uhat[17] = 0.0; 
  uhat[18] = 0.0; 
  uhat[19] = 0.0; 
  }
  // calculate c = uhat/u 
  CartFieldBinOpDivide3xSer_P2(u, uhat, 1, 1, c); 
  // calculate fhat = c*f 
  CartFieldBinOpMultiply3x2vSer_P2(c, f, 1, 1, fhat); 
} 

