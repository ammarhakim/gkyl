#include <GyrokineticModDecl.h> 
double EmGyrokineticSurf2x2vSer_X_P2_Bvars_0(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = (0.04166666666666666*(dfac_v2*(6.0*BdriftX[0]*m_*wv2+q_*(3.0*(3.872983346207417*BmagInv[0]*dfac_y*(Apar[6]*wv-1.0*Phi[6])+(BdriftX[0]*(2.23606797749979*Apar[4]+Apar[0])-3.0*BmagInv[0]*Apar[3]*dfac_y)*wv+3.0*BmagInv[0]*Phi[3]*dfac_y)+5.196152422706631*((BmagInv[0]*Apar[2]*dfac_y-1.0*BdriftX[0]*Apar[1])*wv-1.0*BmagInv[0]*Phi[2]*dfac_y)))+2.0*BdriftX[0]*m_))/(dfac_v2*q_); 

  double alpha[20]; 
  alpha[0] = (0.2357022603955158*(dfac_v2*(6.0*BdriftX[0]*m_*wv2+q_*(1.732050807568877*((3.0*BmagInv[0]*Apar[2]*dfac_y-3.0*BdriftX[0]*Apar[1])*wv-3.0*BmagInv[0]*Phi[2]*dfac_y)+3.872983346207417*BmagInv[0]*dfac_y*(3.0*Apar[6]*wv-3.0*Phi[6])+(BdriftX[0]*(6.708203932499369*Apar[4]+3.0*Apar[0])-9.0*BmagInv[0]*Apar[3]*dfac_y)*wv+9.0*BmagInv[0]*Phi[3]*dfac_y))+2.0*BdriftX[0]*m_))/(dfac_v2*q_); 
  alpha[1] = -0.2357022603955158*(6.708203932499369*((3.0*BmagInv[0]*Apar[7]*dfac_y-1.0*BdriftX[0]*Apar[6])*wv-3.0*BmagInv[0]*Phi[7]*dfac_y)+3.872983346207417*BmagInv[0]*dfac_y*(3.0*Phi[5]-3.0*Apar[5]*wv)+BdriftX[0]*(5.196152422706631*Apar[3]-3.0*Apar[2])*wv); 
  alpha[2] = (0.2357022603955158*(1.732050807568877*(4.0*BdriftX[0]*m_*wv+(Apar[0]*BdriftX[0]-3.0*BmagInv[0]*Apar[3]*dfac_y)*q_)+(BmagInv[0]*(6.708203932499369*Apar[6]+3.0*Apar[2])*dfac_y+BdriftX[0]*(3.872983346207417*Apar[4]-3.0*Apar[1]))*q_))/(dfac_v*q_); 
  alpha[4] = -(0.2357022603955158*(3.872983346207417*(3.0*BmagInv[0]*Apar[7]*dfac_y-1.0*BdriftX[0]*Apar[6])-6.708203932499369*BmagInv[0]*Apar[5]*dfac_y+BdriftX[0]*(3.0*Apar[3]-1.732050807568877*Apar[2])))/dfac_v; 
  alpha[7] = -0.1414213562373095*BdriftX[0]*(8.660254037844387*Apar[7]-5.0*Apar[5])*wv; 
  alpha[8] = (0.421637021355784*BdriftX[0]*m_)/(dfac_v2*q_); 
  alpha[11] = (0.04714045207910316*BdriftX[0]*(8.660254037844387*Apar[5]-15.0*Apar[7]))/dfac_v; 
  double alphaUp[20]; 
  alphaUp[0] = (0.2357022603955158*(dfac_v2*(6.0*BdriftX[0]*m_*wv2+q_*(1.732050807568877*((3.0*BmagInv[0]*Apar[2]*dfac_y-3.0*BdriftX[0]*Apar[1])*wv-3.0*BmagInv[0]*Phi[2]*dfac_y)+3.872983346207417*BmagInv[0]*dfac_y*(3.0*Apar[6]*wv-3.0*Phi[6])+(BdriftX[0]*(6.708203932499369*Apar[4]+3.0*Apar[0])-9.0*BmagInv[0]*Apar[3]*dfac_y)*wv+9.0*BmagInv[0]*Phi[3]*dfac_y))+2.0*BdriftX[0]*m_))/(dfac_v2*q_); 
  alphaUp[1] = -0.2357022603955158*(6.708203932499369*((3.0*BmagInv[0]*Apar[7]*dfac_y-1.0*BdriftX[0]*Apar[6])*wv-3.0*BmagInv[0]*Phi[7]*dfac_y)+3.872983346207417*BmagInv[0]*dfac_y*(3.0*Phi[5]-3.0*Apar[5]*wv)+BdriftX[0]*(5.196152422706631*Apar[3]-3.0*Apar[2])*wv); 
  alphaUp[2] = (0.2357022603955158*(1.732050807568877*(4.0*BdriftX[0]*m_*wv+(Apar[0]*BdriftX[0]-3.0*BmagInv[0]*Apar[3]*dfac_y)*q_)+(BmagInv[0]*(6.708203932499369*Apar[6]+3.0*Apar[2])*dfac_y+BdriftX[0]*(3.872983346207417*Apar[4]-3.0*Apar[1]))*q_))/(dfac_v*q_); 
  alphaUp[4] = -(0.2357022603955158*(3.872983346207417*(3.0*BmagInv[0]*Apar[7]*dfac_y-1.0*BdriftX[0]*Apar[6])-6.708203932499369*BmagInv[0]*Apar[5]*dfac_y+BdriftX[0]*(3.0*Apar[3]-1.732050807568877*Apar[2])))/dfac_v; 
  alphaUp[7] = -0.1414213562373095*BdriftX[0]*(8.660254037844387*Apar[7]-5.0*Apar[5])*wv; 
  alphaUp[8] = (0.421637021355784*BdriftX[0]*m_)/(dfac_v2*q_); 
  alphaUp[11] = (0.04714045207910316*BdriftX[0]*(8.660254037844387*Apar[5]-15.0*Apar[7]))/dfac_v; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[11]+fl[11])+1.732050807568877*(fl[1]-1.0*fr[1])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[19]+fl[19])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[2]+fl[2])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[21]+fl[21])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[25]+fl[25])+3.0*(fl[8]-1.0*fr[8]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[32]+fl[32])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[7]+fl[7]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[35]+fl[35])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[9]+fl[9]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[37]+fl[37])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*(fr[20]-1.0*fl[20])-5.0*(fr[12]+fl[12])); 
  favg[8] = -0.1414213562373095*(8.660254037844387*(fr[23]-1.0*fl[23])-5.0*(fr[13]+fl[13])); 
  favg[9] = -0.1414213562373095*(8.660254037844387*(fr[28]-1.0*fl[28])-5.0*(fr[14]+fl[14])); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[44]+fl[44])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[18]+fl[18])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*(fr[33]-1.0*fl[33])-5.0*(fr[22]+fl[22])); 
  favg[12] = -0.1414213562373095*(8.660254037844387*(fr[34]-1.0*fl[34])-5.0*(fr[24]+fl[24])); 
  favg[13] = -0.1414213562373095*(8.660254037844387*(fr[36]-1.0*fl[36])-5.0*(fr[26]+fl[26])); 
  favg[14] = -0.1414213562373095*(8.660254037844387*(fr[39]-1.0*fl[39])-5.0*(fr[27]+fl[27])); 
  favg[15] = -0.1414213562373095*(8.660254037844387*(fr[41]-1.0*fl[41])-5.0*(fr[29]+fl[29])); 
  favg[16] = -0.1414213562373095*(8.660254037844387*(fr[42]-1.0*fl[42])-5.0*(fr[30]+fl[30])); 
  favg[17] = -0.1414213562373095*(8.660254037844387*(fr[45]-1.0*fl[45])-5.0*(fr[38]+fl[38])); 
  favg[18] = -0.1414213562373095*(8.660254037844387*(fr[46]-1.0*fl[46])-5.0*(fr[40]+fl[40])); 
  favg[19] = -0.1414213562373095*(8.660254037844387*(fr[47]-1.0*fl[47])-5.0*(fr[43]+fl[43])); 

//
// //
  Ghat[0] = -0.125*(1.414213562373095*((2.0*fr[0]-2.0*fl[0])*amax-1.0*(alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0]))+(3.16227766016838*(2.0*fr[11]-2.0*fl[11])-4.898979485566357*(fr[1]+fl[1]))*amax); 
  Ghat[1] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[19]-10.0*fr[19])*amax+2.0*(alpha[4]*favg[11]+favg[4]*alpha[11]))+5.477225575051662*alpha[8]*favg[12])+1.414213562373095*((30.0*fl[2]-30.0*fr[2])*amax+15.0*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1]))+73.48469228349535*(fr[5]+fl[5])*amax+18.97366596101028*(alpha[1]*favg[7]+favg[1]*alpha[7])); 
  Ghat[2] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[21]-10.0*fr[21])*amax+2.0*alpha[4]*favg[12])+5.477225575051662*(alpha[7]*favg[11]+favg[7]*alpha[11]))+1.414213562373095*((30.0*fl[3]-30.0*fr[3])*amax+15.0*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2]))+73.48469228349535*(fr[6]+fl[6])*amax+18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])); 
  Ghat[3] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*(10.0*fl[25]-10.0*fr[25])*amax+5.477225575051662*(alpha[11]*favg[17]+alpha[8]*favg[14]+alpha[7]*favg[13]))+1.414213562373095*((30.0*fl[4]-30.0*fr[4])*amax+15.0*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3]))+73.48469228349535*(fr[8]+fl[8])*amax); 
  Ghat[4] = 0.008333333333333333*(3.16227766016838*((30.0*fl[32]-30.0*fr[32])*amax+6.0*(alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7]))+1.414213562373095*((30.0*fl[7]-30.0*fr[7])*amax+12.0*alpha[11]*favg[12]+15.0*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2]))+73.48469228349535*(fr[15]+fl[15])*amax+18.97366596101028*(alpha[2]*favg[12]+alpha[1]*favg[11]+favg[1]*alpha[11])); 
  Ghat[5] = 0.008333333333333333*(3.16227766016838*((30.0*fl[35]-30.0*fr[35])*amax+6.0*(alpha[4]*favg[17]+favg[5]*alpha[7]))+1.414213562373095*((30.0*fl[9]-30.0*fr[9])*amax+15.0*(alpha[8]*favg[18]+alpha[2]*favg[10]+alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3]))+73.48469228349535*(fr[16]+fl[16])*amax+18.97366596101028*(alpha[1]*favg[13]+favg[10]*alpha[11])); 
  Ghat[6] = 0.008333333333333333*(3.16227766016838*((30.0*fl[37]-30.0*fr[37])*amax+6.0*(alpha[4]*favg[18]+favg[6]*alpha[8]))+1.414213562373095*((30.0*fl[10]-30.0*fr[10])*amax+15.0*(alpha[7]*favg[17]+alpha[11]*favg[13]+alpha[1]*favg[10]+alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3]))+73.48469228349535*(fr[17]+fl[17])*amax+18.97366596101028*alpha[2]*favg[14]); 
  Ghat[7] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[20]+fl[20])*amax+17.14642819948225*(alpha[2]*favg[11]+favg[2]*alpha[11]))+1.414213562373095*((210.0*fl[12]-210.0*fr[12])*amax+105.0*(alpha[0]*favg[7]+favg[0]*alpha[7]))+3.16227766016838*(30.0*(alpha[11]*favg[11]+alpha[7]*favg[7])+42.0*(alpha[4]*favg[4]+alpha[1]*favg[1]))); 
  Ghat[8] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[23]+fl[23])*amax+17.14642819948224*alpha[1]*favg[12])+1.414213562373095*((210.0*fl[13]-210.0*fr[13])*amax+105.0*(alpha[0]*favg[8]+favg[0]*alpha[8]))+3.16227766016838*(42.0*alpha[11]*favg[11]+30.0*alpha[8]*favg[8]+42.0*(alpha[4]*favg[4]+alpha[2]*favg[2]))); 
  Ghat[9] = 0.01863389981249824*(3.872983346207417*(8.485281374238571*(fr[28]+fl[28])*amax+2.449489742783178*(alpha[2]*favg[16]+alpha[1]*favg[15]))+3.16227766016838*((6.0*fl[14]-6.0*fr[14])*amax+3.0*(alpha[4]*favg[19]+alpha[0]*favg[9]))); 
  Ghat[10] = 0.001666666666666667*(3.872983346207417*(2.449489742783178*((50.0*fl[44]-50.0*fr[44])*amax+10.0*(alpha[4]*(favg[14]+favg[13])+favg[5]*alpha[11]))+21.90890230020665*alpha[11]*favg[18])+1.414213562373095*((150.0*fl[18]-150.0*fr[18])*amax+75.0*(alpha[0]*favg[10]+alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4]))+367.4234614174767*(fr[31]+fl[31])*amax+94.86832980505139*(alpha[2]*favg[18]+alpha[1]*favg[17]+(alpha[8]+alpha[7])*favg[10])); 
  Ghat[11] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[33]+fl[33])*amax+17.14642819948225*(alpha[2]*favg[7]+favg[2]*alpha[7]))+34.2928563989645*(alpha[1]*favg[4]+favg[1]*alpha[4]))+1.414213562373095*((210.0*fl[22]-210.0*fr[22])*amax+84.0*alpha[4]*favg[12]+105.0*(alpha[0]*favg[11]+favg[0]*alpha[11]))+3.16227766016838*((42.0*alpha[8]+30.0*alpha[7])*favg[11]+(42.0*favg[8]+30.0*favg[7])*alpha[11])); 
  Ghat[12] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[34]+fl[34])*amax+17.14642819948225*(alpha[1]*favg[8]+favg[1]*alpha[8]))+34.2928563989645*(alpha[2]*favg[4]+favg[2]*alpha[4]))+1.414213562373095*((210.0*fl[24]-210.0*fr[24])*amax+105.0*alpha[0]*favg[12]+84.0*(alpha[4]*favg[11]+favg[4]*alpha[11]))+3.16227766016838*(30.0*alpha[8]+42.0*alpha[7])*favg[12]); 
  Ghat[13] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[36]+fl[36])*amax+17.14642819948225*(alpha[2]*favg[17]+favg[3]*alpha[7]))+34.2928563989645*(alpha[4]*favg[10]+alpha[1]*favg[5]))+1.414213562373095*((210.0*fl[26]-210.0*fr[26])*amax+105.0*(alpha[0]*favg[13]+favg[6]*alpha[11]))+94.86832980505139*(alpha[11]*favg[17]+alpha[7]*favg[13])); 
  Ghat[14] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[39]+fl[39])*amax+17.14642819948225*(alpha[1]*favg[18]+favg[3]*alpha[8]))+34.2928563989645*(alpha[4]*favg[10]+alpha[2]*favg[6]))+1.414213562373095*((210.0*fl[27]-210.0*fr[27])*amax+105.0*alpha[0]*favg[14])+3.16227766016838*(42.0*alpha[11]*favg[17]+30.0*alpha[8]*favg[14])); 
  Ghat[15] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[29]-10.0*fr[29])*amax+5.0*(alpha[4]*favg[16]+alpha[0]*favg[15]))+6.324555320336759*(alpha[11]*favg[19]+alpha[7]*favg[15]))+2.23606797749979*(42.42640687119285*(fr[41]+fl[41])*amax+12.24744871391589*(alpha[2]*favg[19]+alpha[1]*favg[9]))); 
  Ghat[16] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[30]-10.0*fr[30])*amax+5.0*(alpha[0]*favg[16]+alpha[4]*favg[15]))+6.324555320336761*alpha[8]*favg[16])+2.23606797749979*(42.42640687119285*(fr[42]+fl[42])*amax+12.24744871391589*(alpha[1]*favg[19]+alpha[2]*favg[9]))); 
  Ghat[17] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[45]+fl[45])*amax+17.14642819948225*(alpha[2]*favg[13]+favg[3]*alpha[11]))+1.414213562373095*((210.0*fl[38]-210.0*fr[38])*amax+84.0*alpha[4]*favg[18]+105.0*(alpha[0]*favg[17]+favg[6]*alpha[7]))+3.16227766016838*((42.0*alpha[8]+30.0*alpha[7])*favg[17]+alpha[11]*(42.0*favg[14]+30.0*favg[13])+42.0*(alpha[1]*favg[10]+alpha[4]*favg[5]))); 
  Ghat[18] = 2.380952380952381e-4*(8.660254037844387*(296.98484809835*(fr[46]+fl[46])*amax+2.449489742783178*(35.0*alpha[1]*favg[14]+28.0*favg[10]*alpha[11]))+1.414213562373095*((1050.0*fl[40]-1050.0*fr[40])*amax+525.0*alpha[0]*favg[18]+420.0*alpha[4]*favg[17]+525.0*favg[5]*alpha[8])+3.16227766016838*((150.0*alpha[8]+210.0*alpha[7])*favg[18]+210.0*(alpha[2]*favg[10]+alpha[4]*favg[6]))); 
  Ghat[19] = 0.01863389981249824*(3.872983346207417*(8.485281374238571*(fr[47]+fl[47])*amax+2.449489742783178*(alpha[1]*favg[16]+alpha[2]*favg[15]))+3.16227766016838*((6.0*fl[43]-6.0*fr[43])*amax+3.0*(alpha[0]*favg[19]+alpha[4]*favg[9]))+8.485281374238571*((alpha[8]+alpha[7])*favg[19]+alpha[11]*favg[15])); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_x; 
  incr[1] = -1.224744871391589*Ghat[0]*dfac_x; 
  incr[2] = 0.7071067811865475*Ghat[1]*dfac_x; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_x; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_x; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_x; 
  incr[6] = -1.224744871391589*Ghat[2]*dfac_x; 
  incr[7] = 0.7071067811865475*Ghat[4]*dfac_x; 
  incr[8] = -1.224744871391589*Ghat[3]*dfac_x; 
  incr[9] = 0.7071067811865475*Ghat[5]*dfac_x; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_x; 
  incr[11] = 1.58113883008419*Ghat[0]*dfac_x; 
  incr[12] = 0.7071067811865475*Ghat[7]*dfac_x; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_x; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_x; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_x; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_x; 
  incr[17] = -1.224744871391589*Ghat[6]*dfac_x; 
  incr[18] = 0.7071067811865475*Ghat[10]*dfac_x; 
  incr[19] = 1.58113883008419*Ghat[1]*dfac_x; 
  incr[20] = -1.224744871391589*Ghat[7]*dfac_x; 
  incr[21] = 1.58113883008419*Ghat[2]*dfac_x; 
  incr[22] = 0.7071067811865475*Ghat[11]*dfac_x; 
  incr[23] = -1.224744871391589*Ghat[8]*dfac_x; 
  incr[24] = 0.7071067811865475*Ghat[12]*dfac_x; 
  incr[25] = 1.58113883008419*Ghat[3]*dfac_x; 
  incr[26] = 0.7071067811865475*Ghat[13]*dfac_x; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_x; 
  incr[28] = -1.224744871391589*Ghat[9]*dfac_x; 
  incr[29] = 0.7071067811865475*Ghat[15]*dfac_x; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_x; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_x; 
  incr[32] = 1.58113883008419*Ghat[4]*dfac_x; 
  incr[33] = -1.224744871391589*Ghat[11]*dfac_x; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_x; 
  incr[35] = 1.58113883008419*Ghat[5]*dfac_x; 
  incr[36] = -1.224744871391589*Ghat[13]*dfac_x; 
  incr[37] = 1.58113883008419*Ghat[6]*dfac_x; 
  incr[38] = 0.7071067811865475*Ghat[17]*dfac_x; 
  incr[39] = -1.224744871391589*Ghat[14]*dfac_x; 
  incr[40] = 0.7071067811865475*Ghat[18]*dfac_x; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_x; 
  incr[42] = -1.224744871391589*Ghat[16]*dfac_x; 
  incr[43] = 0.7071067811865475*Ghat[19]*dfac_x; 
  incr[44] = 1.58113883008419*Ghat[10]*dfac_x; 
  incr[45] = -1.224744871391589*Ghat[17]*dfac_x; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_x; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_x; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += -1.0*incr[7]; 
  outl[8] += incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += -1.0*incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += -1.0*incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += -1.0*incr[43]; 
  outl[44] += -1.0*incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Y_P2_Bvars_0(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = (0.04166666666666666*(dfac_v2*(6.0*BdriftY[0]*m_*wv2+q_*(3.0*((-3.872983346207417*BmagInv[0]*dfac_x*(Apar[7]*wv-1.0*Phi[7]))+(3.0*BmagInv[0]*Apar[3]*dfac_x+BdriftY[0]*(2.23606797749979*Apar[5]+Apar[0]))*wv-3.0*BmagInv[0]*Phi[3]*dfac_x)-5.196152422706631*((BmagInv[0]*Apar[1]*dfac_x+BdriftY[0]*Apar[2])*wv-1.0*BmagInv[0]*Phi[1]*dfac_x)))+2.0*BdriftY[0]*m_))/(dfac_v2*q_); 

  double alpha[20]; 
  alpha[0] = -(0.2357022603955158*(dfac_v2*(q_*(1.732050807568877*(3.0*(BmagInv[0]*Apar[1]*dfac_x+BdriftY[0]*Apar[2])*wv-3.0*BmagInv[0]*Phi[1]*dfac_x)+3.872983346207417*BmagInv[0]*dfac_x*(3.0*Apar[7]*wv-3.0*Phi[7])+(BdriftY[0]*((-6.708203932499369*Apar[5])-3.0*Apar[0])-9.0*BmagInv[0]*Apar[3]*dfac_x)*wv+9.0*BmagInv[0]*Phi[3]*dfac_x)-6.0*BdriftY[0]*m_*wv2)-2.0*BdriftY[0]*m_))/(dfac_v2*q_); 
  alpha[1] = 0.2357022603955158*(6.708203932499369*((3.0*BmagInv[0]*Apar[6]*dfac_x+BdriftY[0]*Apar[7])*wv-3.0*BmagInv[0]*Phi[6]*dfac_x)+3.872983346207417*BmagInv[0]*dfac_x*(3.0*Phi[4]-3.0*Apar[4]*wv)+BdriftY[0]*(3.0*Apar[1]-5.196152422706631*Apar[3])*wv); 
  alpha[2] = -(0.2357022603955158*(1.732050807568877*(((-3.0*BmagInv[0]*Apar[3]*dfac_x)-1.0*Apar[0]*BdriftY[0])*q_-4.0*BdriftY[0]*m_*wv)+(3.0*(BmagInv[0]*Apar[1]*dfac_x+BdriftY[0]*Apar[2])+6.708203932499369*BmagInv[0]*Apar[7]*dfac_x-3.872983346207417*BdriftY[0]*Apar[5])*q_))/(dfac_v*q_); 
  alpha[4] = (0.2357022603955158*(3.872983346207417*(3.0*BmagInv[0]*Apar[6]*dfac_x+BdriftY[0]*Apar[7])-6.708203932499369*BmagInv[0]*Apar[4]*dfac_x+BdriftY[0]*(1.732050807568877*Apar[1]-3.0*Apar[3])))/dfac_v; 
  alpha[7] = -0.1414213562373095*BdriftY[0]*(8.660254037844387*Apar[6]-5.0*Apar[4])*wv; 
  alpha[8] = (0.421637021355784*BdriftY[0]*m_)/(dfac_v2*q_); 
  alpha[11] = (0.04714045207910316*BdriftY[0]*(8.660254037844387*Apar[4]-15.0*Apar[6]))/dfac_v; 
  double alphaUp[20]; 
  alphaUp[0] = -(0.2357022603955158*(dfac_v2*(q_*(1.732050807568877*(3.0*(BmagInv[0]*Apar[1]*dfac_x+BdriftY[0]*Apar[2])*wv-3.0*BmagInv[0]*Phi[1]*dfac_x)+3.872983346207417*BmagInv[0]*dfac_x*(3.0*Apar[7]*wv-3.0*Phi[7])+(BdriftY[0]*((-6.708203932499369*Apar[5])-3.0*Apar[0])-9.0*BmagInv[0]*Apar[3]*dfac_x)*wv+9.0*BmagInv[0]*Phi[3]*dfac_x)-6.0*BdriftY[0]*m_*wv2)-2.0*BdriftY[0]*m_))/(dfac_v2*q_); 
  alphaUp[1] = 0.2357022603955158*(6.708203932499369*((3.0*BmagInv[0]*Apar[6]*dfac_x+BdriftY[0]*Apar[7])*wv-3.0*BmagInv[0]*Phi[6]*dfac_x)+3.872983346207417*BmagInv[0]*dfac_x*(3.0*Phi[4]-3.0*Apar[4]*wv)+BdriftY[0]*(3.0*Apar[1]-5.196152422706631*Apar[3])*wv); 
  alphaUp[2] = -(0.2357022603955158*(1.732050807568877*(((-3.0*BmagInv[0]*Apar[3]*dfac_x)-1.0*Apar[0]*BdriftY[0])*q_-4.0*BdriftY[0]*m_*wv)+(3.0*(BmagInv[0]*Apar[1]*dfac_x+BdriftY[0]*Apar[2])+6.708203932499369*BmagInv[0]*Apar[7]*dfac_x-3.872983346207417*BdriftY[0]*Apar[5])*q_))/(dfac_v*q_); 
  alphaUp[4] = (0.2357022603955158*(3.872983346207417*(3.0*BmagInv[0]*Apar[6]*dfac_x+BdriftY[0]*Apar[7])-6.708203932499369*BmagInv[0]*Apar[4]*dfac_x+BdriftY[0]*(1.732050807568877*Apar[1]-3.0*Apar[3])))/dfac_v; 
  alphaUp[7] = -0.1414213562373095*BdriftY[0]*(8.660254037844387*Apar[6]-5.0*Apar[4])*wv; 
  alphaUp[8] = (0.421637021355784*BdriftY[0]*m_)/(dfac_v2*q_); 
  alphaUp[11] = (0.04714045207910316*BdriftY[0]*(8.660254037844387*Apar[4]-15.0*Apar[6]))/dfac_v; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[12]+fl[12])+1.732050807568877*(fl[2]-1.0*fr[2])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[20]+fl[20])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[22]+fl[22])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[26]+fl[26])+3.0*(fl[9]-1.0*fr[9]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[33]+fl[33])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[6]+fl[6]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[36]+fl[36])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[38]+fl[38])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*(fr[19]-1.0*fl[19])-5.0*(fr[11]+fl[11])); 
  favg[8] = -0.1414213562373095*(8.660254037844387*(fr[24]-1.0*fl[24])-5.0*(fr[13]+fl[13])); 
  favg[9] = -0.1414213562373095*(8.660254037844387*(fr[29]-1.0*fl[29])-5.0*(fr[14]+fl[14])); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[45]+fl[45])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[17]+fl[17])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*(fr[32]-1.0*fl[32])-5.0*(fr[21]+fl[21])); 
  favg[12] = -0.1414213562373095*(8.660254037844387*(fr[34]-1.0*fl[34])-5.0*(fr[23]+fl[23])); 
  favg[13] = -0.1414213562373095*(8.660254037844387*(fr[35]-1.0*fl[35])-5.0*(fr[25]+fl[25])); 
  favg[14] = -0.1414213562373095*(8.660254037844387*(fr[40]-1.0*fl[40])-5.0*(fr[27]+fl[27])); 
  favg[15] = -0.1414213562373095*(8.660254037844387*(fr[41]-1.0*fl[41])-5.0*(fr[28]+fl[28])); 
  favg[16] = -0.1414213562373095*(8.660254037844387*(fr[43]-1.0*fl[43])-5.0*(fr[30]+fl[30])); 
  favg[17] = -0.1414213562373095*(8.660254037844387*(fr[44]-1.0*fl[44])-5.0*(fr[37]+fl[37])); 
  favg[18] = -0.1414213562373095*(8.660254037844387*(fr[46]-1.0*fl[46])-5.0*(fr[39]+fl[39])); 
  favg[19] = -0.1414213562373095*(8.660254037844387*(fr[47]-1.0*fl[47])-5.0*(fr[42]+fl[42])); 

//
// //
  Ghat[0] = -0.125*(1.414213562373095*((2.0*fr[0]-2.0*fl[0])*amax-1.0*(alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0]))+(3.16227766016838*(2.0*fr[12]-2.0*fl[12])-4.898979485566357*(fr[2]+fl[2]))*amax); 
  Ghat[1] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[20]-10.0*fr[20])*amax+2.0*(alpha[4]*favg[11]+favg[4]*alpha[11]))+5.477225575051662*alpha[8]*favg[12])+1.414213562373095*((30.0*fl[1]-30.0*fr[1])*amax+15.0*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1]))+73.48469228349535*(fr[5]+fl[5])*amax+18.97366596101028*(alpha[1]*favg[7]+favg[1]*alpha[7])); 
  Ghat[2] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[22]-10.0*fr[22])*amax+2.0*alpha[4]*favg[12])+5.477225575051662*(alpha[7]*favg[11]+favg[7]*alpha[11]))+1.414213562373095*((30.0*fl[3]-30.0*fr[3])*amax+15.0*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2]))+73.48469228349535*(fr[7]+fl[7])*amax+18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])); 
  Ghat[3] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*(10.0*fl[26]-10.0*fr[26])*amax+5.477225575051662*(alpha[11]*favg[17]+alpha[8]*favg[14]+alpha[7]*favg[13]))+1.414213562373095*((30.0*fl[4]-30.0*fr[4])*amax+15.0*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3]))+73.48469228349535*(fr[9]+fl[9])*amax); 
  Ghat[4] = 0.008333333333333333*(3.16227766016838*((30.0*fl[33]-30.0*fr[33])*amax+6.0*(alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7]))+1.414213562373095*((30.0*fl[6]-30.0*fr[6])*amax+12.0*alpha[11]*favg[12]+15.0*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2]))+73.48469228349535*(fr[15]+fl[15])*amax+18.97366596101028*(alpha[2]*favg[12]+alpha[1]*favg[11]+favg[1]*alpha[11])); 
  Ghat[5] = 0.008333333333333333*(3.16227766016838*((30.0*fl[36]-30.0*fr[36])*amax+6.0*(alpha[4]*favg[17]+favg[5]*alpha[7]))+1.414213562373095*((30.0*fl[8]-30.0*fr[8])*amax+15.0*(alpha[8]*favg[18]+alpha[2]*favg[10]+alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3]))+73.48469228349535*(fr[16]+fl[16])*amax+18.97366596101028*(alpha[1]*favg[13]+favg[10]*alpha[11])); 
  Ghat[6] = 0.008333333333333333*(3.16227766016838*((30.0*fl[38]-30.0*fr[38])*amax+6.0*(alpha[4]*favg[18]+favg[6]*alpha[8]))+1.414213562373095*((30.0*fl[10]-30.0*fr[10])*amax+15.0*(alpha[7]*favg[17]+alpha[11]*favg[13]+alpha[1]*favg[10]+alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3]))+73.48469228349535*(fr[18]+fl[18])*amax+18.97366596101028*alpha[2]*favg[14]); 
  Ghat[7] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[19]+fl[19])*amax+17.14642819948225*(alpha[2]*favg[11]+favg[2]*alpha[11]))+1.414213562373095*((210.0*fl[11]-210.0*fr[11])*amax+105.0*(alpha[0]*favg[7]+favg[0]*alpha[7]))+3.16227766016838*(30.0*(alpha[11]*favg[11]+alpha[7]*favg[7])+42.0*(alpha[4]*favg[4]+alpha[1]*favg[1]))); 
  Ghat[8] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[24]+fl[24])*amax+17.14642819948224*alpha[1]*favg[12])+1.414213562373095*((210.0*fl[13]-210.0*fr[13])*amax+105.0*(alpha[0]*favg[8]+favg[0]*alpha[8]))+3.16227766016838*(42.0*alpha[11]*favg[11]+30.0*alpha[8]*favg[8]+42.0*(alpha[4]*favg[4]+alpha[2]*favg[2]))); 
  Ghat[9] = 0.01863389981249824*(3.872983346207417*(8.485281374238571*(fr[29]+fl[29])*amax+2.449489742783178*(alpha[2]*favg[16]+alpha[1]*favg[15]))+3.16227766016838*((6.0*fl[14]-6.0*fr[14])*amax+3.0*(alpha[4]*favg[19]+alpha[0]*favg[9]))); 
  Ghat[10] = 0.001666666666666667*(3.872983346207417*(2.449489742783178*((50.0*fl[45]-50.0*fr[45])*amax+10.0*(alpha[4]*(favg[14]+favg[13])+favg[5]*alpha[11]))+21.90890230020665*alpha[11]*favg[18])+1.414213562373095*((150.0*fl[17]-150.0*fr[17])*amax+75.0*(alpha[0]*favg[10]+alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4]))+367.4234614174767*(fr[31]+fl[31])*amax+94.86832980505139*(alpha[2]*favg[18]+alpha[1]*favg[17]+(alpha[8]+alpha[7])*favg[10])); 
  Ghat[11] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[32]+fl[32])*amax+17.14642819948225*(alpha[2]*favg[7]+favg[2]*alpha[7]))+34.2928563989645*(alpha[1]*favg[4]+favg[1]*alpha[4]))+1.414213562373095*((210.0*fl[21]-210.0*fr[21])*amax+84.0*alpha[4]*favg[12]+105.0*(alpha[0]*favg[11]+favg[0]*alpha[11]))+3.16227766016838*((42.0*alpha[8]+30.0*alpha[7])*favg[11]+(42.0*favg[8]+30.0*favg[7])*alpha[11])); 
  Ghat[12] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[34]+fl[34])*amax+17.14642819948225*(alpha[1]*favg[8]+favg[1]*alpha[8]))+34.2928563989645*(alpha[2]*favg[4]+favg[2]*alpha[4]))+1.414213562373095*((210.0*fl[23]-210.0*fr[23])*amax+105.0*alpha[0]*favg[12]+84.0*(alpha[4]*favg[11]+favg[4]*alpha[11]))+3.16227766016838*(30.0*alpha[8]+42.0*alpha[7])*favg[12]); 
  Ghat[13] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[35]+fl[35])*amax+17.14642819948225*(alpha[2]*favg[17]+favg[3]*alpha[7]))+34.2928563989645*(alpha[4]*favg[10]+alpha[1]*favg[5]))+1.414213562373095*((210.0*fl[25]-210.0*fr[25])*amax+105.0*(alpha[0]*favg[13]+favg[6]*alpha[11]))+94.86832980505139*(alpha[11]*favg[17]+alpha[7]*favg[13])); 
  Ghat[14] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[40]+fl[40])*amax+17.14642819948225*(alpha[1]*favg[18]+favg[3]*alpha[8]))+34.2928563989645*(alpha[4]*favg[10]+alpha[2]*favg[6]))+1.414213562373095*((210.0*fl[27]-210.0*fr[27])*amax+105.0*alpha[0]*favg[14])+3.16227766016838*(42.0*alpha[11]*favg[17]+30.0*alpha[8]*favg[14])); 
  Ghat[15] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[28]-10.0*fr[28])*amax+5.0*(alpha[4]*favg[16]+alpha[0]*favg[15]))+6.324555320336759*(alpha[11]*favg[19]+alpha[7]*favg[15]))+2.23606797749979*(42.42640687119285*(fr[41]+fl[41])*amax+12.24744871391589*(alpha[2]*favg[19]+alpha[1]*favg[9]))); 
  Ghat[16] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[30]-10.0*fr[30])*amax+5.0*(alpha[0]*favg[16]+alpha[4]*favg[15]))+6.324555320336761*alpha[8]*favg[16])+2.23606797749979*(42.42640687119285*(fr[43]+fl[43])*amax+12.24744871391589*(alpha[1]*favg[19]+alpha[2]*favg[9]))); 
  Ghat[17] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[44]+fl[44])*amax+17.14642819948225*(alpha[2]*favg[13]+favg[3]*alpha[11]))+1.414213562373095*((210.0*fl[37]-210.0*fr[37])*amax+84.0*alpha[4]*favg[18]+105.0*(alpha[0]*favg[17]+favg[6]*alpha[7]))+3.16227766016838*((42.0*alpha[8]+30.0*alpha[7])*favg[17]+alpha[11]*(42.0*favg[14]+30.0*favg[13])+42.0*(alpha[1]*favg[10]+alpha[4]*favg[5]))); 
  Ghat[18] = 2.380952380952381e-4*(8.660254037844387*(296.98484809835*(fr[46]+fl[46])*amax+2.449489742783178*(35.0*alpha[1]*favg[14]+28.0*favg[10]*alpha[11]))+1.414213562373095*((1050.0*fl[39]-1050.0*fr[39])*amax+525.0*alpha[0]*favg[18]+420.0*alpha[4]*favg[17]+525.0*favg[5]*alpha[8])+3.16227766016838*((150.0*alpha[8]+210.0*alpha[7])*favg[18]+210.0*(alpha[2]*favg[10]+alpha[4]*favg[6]))); 
  Ghat[19] = 0.01863389981249824*(3.872983346207417*(8.485281374238571*(fr[47]+fl[47])*amax+2.449489742783178*(alpha[1]*favg[16]+alpha[2]*favg[15]))+3.16227766016838*((6.0*fl[42]-6.0*fr[42])*amax+3.0*(alpha[0]*favg[19]+alpha[4]*favg[9]))+8.485281374238571*((alpha[8]+alpha[7])*favg[19]+alpha[11]*favg[15])); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_y; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_y; 
  incr[2] = -1.224744871391589*Ghat[0]*dfac_y; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_y; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_y; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_y; 
  incr[6] = 0.7071067811865475*Ghat[4]*dfac_y; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_y; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_y; 
  incr[9] = -1.224744871391589*Ghat[3]*dfac_y; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_y; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_y; 
  incr[12] = 1.58113883008419*Ghat[0]*dfac_y; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_y; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_y; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_y; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_y; 
  incr[17] = 0.7071067811865475*Ghat[10]*dfac_y; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_y; 
  incr[19] = -1.224744871391589*Ghat[7]*dfac_y; 
  incr[20] = 1.58113883008419*Ghat[1]*dfac_y; 
  incr[21] = 0.7071067811865475*Ghat[11]*dfac_y; 
  incr[22] = 1.58113883008419*Ghat[2]*dfac_y; 
  incr[23] = 0.7071067811865475*Ghat[12]*dfac_y; 
  incr[24] = -1.224744871391589*Ghat[8]*dfac_y; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_y; 
  incr[26] = 1.58113883008419*Ghat[3]*dfac_y; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_y; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_y; 
  incr[29] = -1.224744871391589*Ghat[9]*dfac_y; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_y; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_y; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_y; 
  incr[33] = 1.58113883008419*Ghat[4]*dfac_y; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_y; 
  incr[35] = -1.224744871391589*Ghat[13]*dfac_y; 
  incr[36] = 1.58113883008419*Ghat[5]*dfac_y; 
  incr[37] = 0.7071067811865475*Ghat[17]*dfac_y; 
  incr[38] = 1.58113883008419*Ghat[6]*dfac_y; 
  incr[39] = 0.7071067811865475*Ghat[18]*dfac_y; 
  incr[40] = -1.224744871391589*Ghat[14]*dfac_y; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_y; 
  incr[42] = 0.7071067811865475*Ghat[19]*dfac_y; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_y; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_y; 
  incr[45] = 1.58113883008419*Ghat[10]*dfac_y; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_y; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_y; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += -1.0*incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += -1.0*incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += -1.0*incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += -1.0*incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += -1.0*incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Vpar_P2_Bvars_0(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = -(0.0125*(8.660254037844386*(dfac_v*(2.0*(BdriftY[0]*Phi[2]*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_*wv+(BdriftY[0]*(Apar[1]*Phi[3]+Apar[0]*Phi[2])*dfac_y+BdriftX[0]*(Apar[2]*Phi[3]+Apar[0]*Phi[1])*dfac_x)*q_)-2.0*(BdriftY[0]*Phi[2]*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_)+dfac_v*(3.872983346207417*(5.0*Apar[3]*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)+2.23606797749979*(BdriftY[0]*Apar[4]*Phi[6]*dfac_y+BdriftX[0]*Apar[5]*Phi[7]*dfac_x))+11.18033988749895*(1.732050807568877*(BdriftY[0]*Apar[2]*Phi[5]*dfac_y+BdriftX[0]*Apar[1]*Phi[4]*dfac_x)-3.0*BmagInv[0]*(Apar[3]*Phi[5]-1.0*(Phi[3]*Apar[5]+Apar[3]*Phi[4])+Phi[3]*Apar[4])*dfac_x*dfac_y)+5.0*(4.0*dApardt[0]-3.0*BmagInv[0]*(5.0*(Apar[6]*Phi[7]-1.0*Phi[6]*Apar[7])+Apar[1]*Phi[2]-1.0*Phi[1]*Apar[2])*dfac_x*dfac_y))*q_))/(dfac_v*m_); 

  double alpha[20]; 
  alpha[0] = -(0.07071067811865474*(1.732050807568877*(dfac_v*(10.0*(BdriftY[0]*Phi[2]*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_*wv+5.0*(BdriftY[0]*(Apar[1]*Phi[3]+Apar[0]*Phi[2])*dfac_y+BdriftX[0]*(Apar[2]*Phi[3]+Apar[0]*Phi[1])*dfac_x)*q_)-10.0*(BdriftY[0]*Phi[2]*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_)+dfac_v*(3.872983346207417*(5.0*Apar[3]*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)+2.23606797749979*(BdriftY[0]*Apar[4]*Phi[6]*dfac_y+BdriftX[0]*Apar[5]*Phi[7]*dfac_x))+2.23606797749979*(8.660254037844386*(BdriftY[0]*Apar[2]*Phi[5]*dfac_y+BdriftX[0]*Apar[1]*Phi[4]*dfac_x)+BmagInv[0]*((-15.0*Apar[3]*Phi[5])+15.0*(Phi[3]*Apar[5]+Apar[3]*Phi[4])-15.0*Phi[3]*Apar[4])*dfac_x*dfac_y)+BmagInv[0]*((-75.0*Apar[6]*Phi[7])+75.0*Phi[6]*Apar[7]-15.0*Apar[1]*Phi[2]+15.0*Phi[1]*Apar[2])*dfac_x*dfac_y+20.0*dApardt[0])*q_))/(dfac_v*m_); 
  alpha[1] = -(0.07071067811865474*(2.23606797749979*(1.732050807568877*(dfac_v*(10.0*BdriftX[0]*Phi[4]*dfac_x*m_*wv+(BdriftY[0]*(5.0*Apar[3]*Phi[5]+2.0*Phi[3]*Apar[4])*dfac_y+5.0*Apar[0]*BdriftX[0]*Phi[4]*dfac_x)*q_)-10.0*BdriftX[0]*Phi[4]*dfac_x*m_)+BmagInv[0]*(15.0*Apar[2]*Phi[4]-15.0*Phi[2]*Apar[4])*dfac_v*dfac_x*dfac_y*q_)+1.732050807568877*(dfac_v*(10.0*BdriftY[0]*Phi[3]*dfac_y*m_*wv+(BdriftY[0]*(10.0*Apar[6]*Phi[7]+5.0*(Apar[0]*Phi[3]+Apar[1]*Phi[2]))*dfac_y+BdriftX[0]*(5.0*Apar[7]*Phi[7]+10.0*(Apar[6]*Phi[6]+Apar[4]*Phi[4])+5.0*(Apar[3]*Phi[3]+Apar[1]*Phi[1]))*dfac_x)*q_)-10.0*BdriftY[0]*Phi[3]*dfac_y*m_)+dfac_v*(3.872983346207417*((BmagInv[0]*(1.732050807568877*(5.0*Phi[3]*Apar[7]-5.0*Apar[3]*Phi[7])+3.872983346207417*((5.0*Apar[5]-2.0*Apar[4])*Phi[6]+(2.0*Phi[4]-5.0*Phi[5])*Apar[6]))*dfac_x+BdriftY[0]*(5.0*Apar[2]*Phi[7]+2.0*Apar[1]*Phi[6]))*dfac_y+5.0*BdriftX[0]*Apar[2]*Phi[6]*dfac_x)+BmagInv[0]*(15.0*Phi[1]*Apar[3]-15.0*Apar[1]*Phi[3])*dfac_x*dfac_y+20.0*dApardt[1])*q_))/(dfac_v*m_); 
  alpha[2] = -(0.07071067811865474*(2.23606797749979*(1.732050807568877*(dfac_v*(10.0*BdriftY[0]*Phi[5]*dfac_y*m_*wv+(5.0*Apar[0]*BdriftY[0]*Phi[5]*dfac_y+BdriftX[0]*(2.0*Phi[3]*Apar[5]+5.0*Apar[3]*Phi[4])*dfac_x)*q_)-10.0*BdriftY[0]*Phi[5]*dfac_y*m_)+BmagInv[0]*(15.0*Phi[1]*Apar[5]-15.0*Apar[1]*Phi[5])*dfac_v*dfac_x*dfac_y*q_)+1.732050807568877*(dfac_v*(10.0*BdriftX[0]*Phi[3]*dfac_x*m_*wv+(BdriftY[0]*(10.0*Apar[7]*Phi[7]+5.0*Apar[6]*Phi[6]+10.0*Apar[5]*Phi[5]+5.0*(Apar[3]*Phi[3]+Apar[2]*Phi[2]))*dfac_y+BdriftX[0]*(10.0*Phi[6]*Apar[7]+5.0*(Apar[0]*Phi[3]+Phi[1]*Apar[2]))*dfac_x)*q_)-10.0*BdriftX[0]*Phi[3]*dfac_x*m_)+dfac_v*(3.872983346207417*((BmagInv[0]*(3.872983346207417*((2.0*Apar[5]-5.0*Apar[4])*Phi[7]+(5.0*Phi[4]-2.0*Phi[5])*Apar[7])+1.732050807568877*(5.0*Apar[3]*Phi[6]-5.0*Phi[3]*Apar[6]))*dfac_x+5.0*BdriftY[0]*Apar[1]*Phi[7])*dfac_y+BdriftX[0]*(2.0*Apar[2]*Phi[7]+5.0*Apar[1]*Phi[6])*dfac_x)+BmagInv[0]*(15.0*Apar[2]*Phi[3]-15.0*Phi[2]*Apar[3])*dfac_x*dfac_y+20.0*dApardt[2])*q_))/(dfac_v*m_); 
  alpha[4] = -(0.07071067811865474*(3.872983346207417*(dfac_v*(10.0*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)*m_*wv+(4.47213595499958*(BdriftY[0]*((Apar[5]+Apar[4])*Phi[7]+Phi[5]*Apar[7])*dfac_y+BdriftX[0]*((Apar[5]+Apar[4])*Phi[6]+Phi[4]*Apar[6])*dfac_x)+(1.732050807568877*BmagInv[0]*((-5.0*Apar[1]*Phi[7])+5.0*(Phi[1]*Apar[7]+Apar[2]*Phi[6])-5.0*Phi[2]*Apar[6])*dfac_x+BdriftY[0]*(5.0*Apar[0]*Phi[7]+2.0*(Apar[3]*Phi[6]+Phi[3]*Apar[6])))*dfac_y+BdriftX[0]*(2.0*(Apar[3]*Phi[7]+Phi[3]*Apar[7])+5.0*Apar[0]*Phi[6])*dfac_x)*q_)-10.0*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)*m_)+dfac_v*(19.36491673103708*(BdriftY[0]*Apar[1]*Phi[5]*dfac_y+BdriftX[0]*Apar[2]*Phi[4]*dfac_x)+8.660254037844386*(BdriftY[0]*(Apar[2]*Phi[3]+Phi[2]*Apar[3])*dfac_y+BdriftX[0]*(Apar[1]*Phi[3]+Phi[1]*Apar[3])*dfac_x)+BmagInv[0]*(75.0*Phi[4]*Apar[5]-75.0*Apar[4]*Phi[5])*dfac_x*dfac_y+20.0*dApardt[3])*q_))/(dfac_v*m_); 
  alpha[7] = (0.01010152544552211*(3.872983346207417*(2.23606797749979*(dfac_v*((BdriftY[0]*((-14.0*Apar[3]*Phi[7])-7.0*Apar[0]*Phi[6])*dfac_y+BdriftX[0]*((-14.0*Apar[3]*Phi[6])-7.0*Phi[3]*Apar[6])*dfac_x)*q_-14.0*BdriftY[0]*Phi[6]*dfac_y*m_*wv)+dfac_y*(1.732050807568877*BmagInv[0]*(7.0*Apar[1]*Phi[6]-7.0*Phi[1]*Apar[6])*dfac_v*dfac_x*q_+14.0*BdriftY[0]*Phi[6]*m_))+BdriftY[0]*((-10.0*Apar[4]*Phi[6])-35.0*Phi[5]*Apar[6])*dfac_v*dfac_y*q_)+dfac_v*(1.732050807568877*(BdriftX[0]*((-70.0*Apar[1]*Phi[4])-35.0*Phi[1]*Apar[4])*dfac_x-35.0*BdriftY[0]*Phi[2]*Apar[4]*dfac_y)+(2.23606797749979*(BmagInv[0]*(210.0*Apar[6]*Phi[7]-210.0*Phi[6]*Apar[7])*dfac_x-24.24871130596428*BdriftY[0]*Apar[1]*Phi[3])+BmagInv[0]*(210.0*Phi[3]*Apar[4]-210.0*Apar[3]*Phi[4])*dfac_x)*dfac_y-140.0*dApardt[4])*q_))/(dfac_v*m_); 
  alpha[8] = -(0.01010152544552211*(3.872983346207417*(2.23606797749979*(dfac_v*(14.0*BdriftX[0]*Phi[7]*dfac_x*m_*wv+(BdriftY[0]*(14.0*Apar[3]*Phi[7]+7.0*Phi[3]*Apar[7])*dfac_y+BdriftX[0]*(7.0*Apar[0]*Phi[7]+14.0*Apar[3]*Phi[6])*dfac_x)*q_)+dfac_x*(1.732050807568877*BmagInv[0]*(7.0*Apar[2]*Phi[7]-7.0*Phi[2]*Apar[7])*dfac_v*dfac_y*q_-14.0*BdriftX[0]*Phi[7]*m_))+BdriftX[0]*(10.0*Apar[5]*Phi[7]+35.0*Phi[4]*Apar[7])*dfac_v*dfac_x*q_)+dfac_v*(2.23606797749979*dfac_x*(BmagInv[0]*(210.0*Phi[6]*Apar[7]-210.0*Apar[6]*Phi[7])*dfac_y+24.24871130596428*BdriftX[0]*Apar[2]*Phi[3])+1.732050807568877*(BdriftY[0]*(70.0*Apar[2]*Phi[5]+35.0*Phi[2]*Apar[5])*dfac_y+35.0*BdriftX[0]*Phi[1]*Apar[5]*dfac_x)+BmagInv[0]*(210.0*Phi[3]*Apar[5]-210.0*Apar[3]*Phi[5])*dfac_x*dfac_y+140.0*dApardt[5])*q_))/(dfac_v*m_); 
  alpha[11] = -(0.01010152544552211*(3.872983346207417*(BdriftY[0]*(28.0*Apar[7]*Phi[7]+10.0*Apar[6]*Phi[6]+35.0*Apar[4]*Phi[5]+14.0*Apar[3]*Phi[3])*dfac_y+BdriftX[0]*(14.0*Apar[6]*Phi[7]+28.0*Phi[6]*Apar[7]+2.23606797749979*(14.0*Apar[3]*Phi[4]+7.0*Phi[3]*Apar[4]))*dfac_x)+1.732050807568877*(BdriftY[0]*(70.0*Apar[1]*Phi[7]+35.0*(Apar[2]*Phi[6]+Phi[2]*Apar[6]))*dfac_y+BdriftX[0]*(70.0*Apar[1]*Phi[6]+35.0*Phi[1]*Apar[6])*dfac_x)+BmagInv[0]*(2.23606797749979*(210.0*Phi[4]*Apar[7]-210.0*Apar[4]*Phi[7])+105.0*Apar[3]*Phi[6]-105.0*Phi[3]*Apar[6])*dfac_x*dfac_y+140.0*dApardt[6])*q_)/m_; 
  alpha[12] = -(0.01010152544552211*(3.872983346207417*(BdriftY[0]*(28.0*Apar[6]*Phi[7]+14.0*Phi[6]*Apar[7]+2.23606797749979*(14.0*Apar[3]*Phi[5]+7.0*Phi[3]*Apar[5]))*dfac_y+BdriftX[0]*(10.0*Apar[7]*Phi[7]+28.0*Apar[6]*Phi[6]+35.0*Phi[4]*Apar[5]+14.0*Apar[3]*Phi[3])*dfac_x)+1.732050807568877*(BdriftY[0]*(70.0*Apar[2]*Phi[7]+35.0*Phi[2]*Apar[7])*dfac_y+BdriftX[0]*(35.0*(Apar[1]*Phi[7]+Phi[1]*Apar[7])+70.0*Apar[2]*Phi[6])*dfac_x)+BmagInv[0]*((-105.0*Apar[3]*Phi[7])+105.0*Phi[3]*Apar[7]+2.23606797749979*(210.0*Apar[5]*Phi[6]-210.0*Phi[5]*Apar[6]))*dfac_x*dfac_y+140.0*dApardt[7])*q_)/m_; 
  double alphaUp[20]; 
  alphaUp[0] = -(0.07071067811865474*(1.732050807568877*(dfac_v*(10.0*(BdriftY[0]*Phi[2]*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_*wv+5.0*(BdriftY[0]*(Apar[1]*Phi[3]+Apar[0]*Phi[2])*dfac_y+BdriftX[0]*(Apar[2]*Phi[3]+Apar[0]*Phi[1])*dfac_x)*q_)-10.0*(BdriftY[0]*Phi[2]*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_)+dfac_v*(3.872983346207417*(5.0*Apar[3]*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)+2.23606797749979*(BdriftY[0]*Apar[4]*Phi[6]*dfac_y+BdriftX[0]*Apar[5]*Phi[7]*dfac_x))+2.23606797749979*(8.660254037844386*(BdriftY[0]*Apar[2]*Phi[5]*dfac_y+BdriftX[0]*Apar[1]*Phi[4]*dfac_x)+BmagInv[0]*((-15.0*Apar[3]*Phi[5])+15.0*(Phi[3]*Apar[5]+Apar[3]*Phi[4])-15.0*Phi[3]*Apar[4])*dfac_x*dfac_y)+BmagInv[0]*((-75.0*Apar[6]*Phi[7])+75.0*Phi[6]*Apar[7]-15.0*Apar[1]*Phi[2]+15.0*Phi[1]*Apar[2])*dfac_x*dfac_y+20.0*dApardt[0])*q_))/(dfac_v*m_); 
  alphaUp[1] = -(0.07071067811865474*(2.23606797749979*(1.732050807568877*(dfac_v*(10.0*BdriftX[0]*Phi[4]*dfac_x*m_*wv+(BdriftY[0]*(5.0*Apar[3]*Phi[5]+2.0*Phi[3]*Apar[4])*dfac_y+5.0*Apar[0]*BdriftX[0]*Phi[4]*dfac_x)*q_)-10.0*BdriftX[0]*Phi[4]*dfac_x*m_)+BmagInv[0]*(15.0*Apar[2]*Phi[4]-15.0*Phi[2]*Apar[4])*dfac_v*dfac_x*dfac_y*q_)+1.732050807568877*(dfac_v*(10.0*BdriftY[0]*Phi[3]*dfac_y*m_*wv+(BdriftY[0]*(10.0*Apar[6]*Phi[7]+5.0*(Apar[0]*Phi[3]+Apar[1]*Phi[2]))*dfac_y+BdriftX[0]*(5.0*Apar[7]*Phi[7]+10.0*(Apar[6]*Phi[6]+Apar[4]*Phi[4])+5.0*(Apar[3]*Phi[3]+Apar[1]*Phi[1]))*dfac_x)*q_)-10.0*BdriftY[0]*Phi[3]*dfac_y*m_)+dfac_v*(3.872983346207417*((BmagInv[0]*(1.732050807568877*(5.0*Phi[3]*Apar[7]-5.0*Apar[3]*Phi[7])+3.872983346207417*((5.0*Apar[5]-2.0*Apar[4])*Phi[6]+(2.0*Phi[4]-5.0*Phi[5])*Apar[6]))*dfac_x+BdriftY[0]*(5.0*Apar[2]*Phi[7]+2.0*Apar[1]*Phi[6]))*dfac_y+5.0*BdriftX[0]*Apar[2]*Phi[6]*dfac_x)+BmagInv[0]*(15.0*Phi[1]*Apar[3]-15.0*Apar[1]*Phi[3])*dfac_x*dfac_y+20.0*dApardt[1])*q_))/(dfac_v*m_); 
  alphaUp[2] = -(0.07071067811865474*(2.23606797749979*(1.732050807568877*(dfac_v*(10.0*BdriftY[0]*Phi[5]*dfac_y*m_*wv+(5.0*Apar[0]*BdriftY[0]*Phi[5]*dfac_y+BdriftX[0]*(2.0*Phi[3]*Apar[5]+5.0*Apar[3]*Phi[4])*dfac_x)*q_)-10.0*BdriftY[0]*Phi[5]*dfac_y*m_)+BmagInv[0]*(15.0*Phi[1]*Apar[5]-15.0*Apar[1]*Phi[5])*dfac_v*dfac_x*dfac_y*q_)+1.732050807568877*(dfac_v*(10.0*BdriftX[0]*Phi[3]*dfac_x*m_*wv+(BdriftY[0]*(10.0*Apar[7]*Phi[7]+5.0*Apar[6]*Phi[6]+10.0*Apar[5]*Phi[5]+5.0*(Apar[3]*Phi[3]+Apar[2]*Phi[2]))*dfac_y+BdriftX[0]*(10.0*Phi[6]*Apar[7]+5.0*(Apar[0]*Phi[3]+Phi[1]*Apar[2]))*dfac_x)*q_)-10.0*BdriftX[0]*Phi[3]*dfac_x*m_)+dfac_v*(3.872983346207417*((BmagInv[0]*(3.872983346207417*((2.0*Apar[5]-5.0*Apar[4])*Phi[7]+(5.0*Phi[4]-2.0*Phi[5])*Apar[7])+1.732050807568877*(5.0*Apar[3]*Phi[6]-5.0*Phi[3]*Apar[6]))*dfac_x+5.0*BdriftY[0]*Apar[1]*Phi[7])*dfac_y+BdriftX[0]*(2.0*Apar[2]*Phi[7]+5.0*Apar[1]*Phi[6])*dfac_x)+BmagInv[0]*(15.0*Apar[2]*Phi[3]-15.0*Phi[2]*Apar[3])*dfac_x*dfac_y+20.0*dApardt[2])*q_))/(dfac_v*m_); 
  alphaUp[4] = -(0.07071067811865474*(3.872983346207417*(dfac_v*(10.0*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)*m_*wv+(4.47213595499958*(BdriftY[0]*((Apar[5]+Apar[4])*Phi[7]+Phi[5]*Apar[7])*dfac_y+BdriftX[0]*((Apar[5]+Apar[4])*Phi[6]+Phi[4]*Apar[6])*dfac_x)+(1.732050807568877*BmagInv[0]*((-5.0*Apar[1]*Phi[7])+5.0*(Phi[1]*Apar[7]+Apar[2]*Phi[6])-5.0*Phi[2]*Apar[6])*dfac_x+BdriftY[0]*(5.0*Apar[0]*Phi[7]+2.0*(Apar[3]*Phi[6]+Phi[3]*Apar[6])))*dfac_y+BdriftX[0]*(2.0*(Apar[3]*Phi[7]+Phi[3]*Apar[7])+5.0*Apar[0]*Phi[6])*dfac_x)*q_)-10.0*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)*m_)+dfac_v*(19.36491673103708*(BdriftY[0]*Apar[1]*Phi[5]*dfac_y+BdriftX[0]*Apar[2]*Phi[4]*dfac_x)+8.660254037844386*(BdriftY[0]*(Apar[2]*Phi[3]+Phi[2]*Apar[3])*dfac_y+BdriftX[0]*(Apar[1]*Phi[3]+Phi[1]*Apar[3])*dfac_x)+BmagInv[0]*(75.0*Phi[4]*Apar[5]-75.0*Apar[4]*Phi[5])*dfac_x*dfac_y+20.0*dApardt[3])*q_))/(dfac_v*m_); 
  alphaUp[7] = (0.01010152544552211*(3.872983346207417*(2.23606797749979*(dfac_v*((BdriftY[0]*((-14.0*Apar[3]*Phi[7])-7.0*Apar[0]*Phi[6])*dfac_y+BdriftX[0]*((-14.0*Apar[3]*Phi[6])-7.0*Phi[3]*Apar[6])*dfac_x)*q_-14.0*BdriftY[0]*Phi[6]*dfac_y*m_*wv)+dfac_y*(1.732050807568877*BmagInv[0]*(7.0*Apar[1]*Phi[6]-7.0*Phi[1]*Apar[6])*dfac_v*dfac_x*q_+14.0*BdriftY[0]*Phi[6]*m_))+BdriftY[0]*((-10.0*Apar[4]*Phi[6])-35.0*Phi[5]*Apar[6])*dfac_v*dfac_y*q_)+dfac_v*(1.732050807568877*(BdriftX[0]*((-70.0*Apar[1]*Phi[4])-35.0*Phi[1]*Apar[4])*dfac_x-35.0*BdriftY[0]*Phi[2]*Apar[4]*dfac_y)+(2.23606797749979*(BmagInv[0]*(210.0*Apar[6]*Phi[7]-210.0*Phi[6]*Apar[7])*dfac_x-24.24871130596428*BdriftY[0]*Apar[1]*Phi[3])+BmagInv[0]*(210.0*Phi[3]*Apar[4]-210.0*Apar[3]*Phi[4])*dfac_x)*dfac_y-140.0*dApardt[4])*q_))/(dfac_v*m_); 
  alphaUp[8] = -(0.01010152544552211*(3.872983346207417*(2.23606797749979*(dfac_v*(14.0*BdriftX[0]*Phi[7]*dfac_x*m_*wv+(BdriftY[0]*(14.0*Apar[3]*Phi[7]+7.0*Phi[3]*Apar[7])*dfac_y+BdriftX[0]*(7.0*Apar[0]*Phi[7]+14.0*Apar[3]*Phi[6])*dfac_x)*q_)+dfac_x*(1.732050807568877*BmagInv[0]*(7.0*Apar[2]*Phi[7]-7.0*Phi[2]*Apar[7])*dfac_v*dfac_y*q_-14.0*BdriftX[0]*Phi[7]*m_))+BdriftX[0]*(10.0*Apar[5]*Phi[7]+35.0*Phi[4]*Apar[7])*dfac_v*dfac_x*q_)+dfac_v*(2.23606797749979*dfac_x*(BmagInv[0]*(210.0*Phi[6]*Apar[7]-210.0*Apar[6]*Phi[7])*dfac_y+24.24871130596428*BdriftX[0]*Apar[2]*Phi[3])+1.732050807568877*(BdriftY[0]*(70.0*Apar[2]*Phi[5]+35.0*Phi[2]*Apar[5])*dfac_y+35.0*BdriftX[0]*Phi[1]*Apar[5]*dfac_x)+BmagInv[0]*(210.0*Phi[3]*Apar[5]-210.0*Apar[3]*Phi[5])*dfac_x*dfac_y+140.0*dApardt[5])*q_))/(dfac_v*m_); 
  alphaUp[11] = -(0.01010152544552211*(3.872983346207417*(BdriftY[0]*(28.0*Apar[7]*Phi[7]+10.0*Apar[6]*Phi[6]+35.0*Apar[4]*Phi[5]+14.0*Apar[3]*Phi[3])*dfac_y+BdriftX[0]*(14.0*Apar[6]*Phi[7]+28.0*Phi[6]*Apar[7]+2.23606797749979*(14.0*Apar[3]*Phi[4]+7.0*Phi[3]*Apar[4]))*dfac_x)+1.732050807568877*(BdriftY[0]*(70.0*Apar[1]*Phi[7]+35.0*(Apar[2]*Phi[6]+Phi[2]*Apar[6]))*dfac_y+BdriftX[0]*(70.0*Apar[1]*Phi[6]+35.0*Phi[1]*Apar[6])*dfac_x)+BmagInv[0]*(2.23606797749979*(210.0*Phi[4]*Apar[7]-210.0*Apar[4]*Phi[7])+105.0*Apar[3]*Phi[6]-105.0*Phi[3]*Apar[6])*dfac_x*dfac_y+140.0*dApardt[6])*q_)/m_; 
  alphaUp[12] = -(0.01010152544552211*(3.872983346207417*(BdriftY[0]*(28.0*Apar[6]*Phi[7]+14.0*Phi[6]*Apar[7]+2.23606797749979*(14.0*Apar[3]*Phi[5]+7.0*Phi[3]*Apar[5]))*dfac_y+BdriftX[0]*(10.0*Apar[7]*Phi[7]+28.0*Apar[6]*Phi[6]+35.0*Phi[4]*Apar[5]+14.0*Apar[3]*Phi[3])*dfac_x)+1.732050807568877*(BdriftY[0]*(70.0*Apar[2]*Phi[7]+35.0*Phi[2]*Apar[7])*dfac_y+BdriftX[0]*(35.0*(Apar[1]*Phi[7]+Phi[1]*Apar[7])+70.0*Apar[2]*Phi[6])*dfac_x)+BmagInv[0]*((-105.0*Apar[3]*Phi[7])+105.0*Phi[3]*Apar[7]+2.23606797749979*(210.0*Apar[5]*Phi[6]-210.0*Phi[5]*Apar[6]))*dfac_x*dfac_y+140.0*dApardt[7])*q_)/m_; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[13]+fl[13])+1.732050807568877*(fl[3]-1.0*fr[3])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[23]+fl[23])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[24]+fl[24])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[2]+fl[2])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[27]+fl[27])+3.0*(fl[10]-1.0*fr[10]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[34]+fl[34])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[5]+fl[5]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[39]+fl[39])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[40]+fl[40])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[9]+fl[9]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*(fr[21]-1.0*fl[21])-5.0*(fr[11]+fl[11])); 
  favg[8] = -0.1414213562373095*(8.660254037844387*(fr[22]-1.0*fl[22])-5.0*(fr[12]+fl[12])); 
  favg[9] = -0.1414213562373095*(8.660254037844387*(fr[30]-1.0*fl[30])-5.0*(fr[14]+fl[14])); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[46]+fl[46])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[16]+fl[16])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*(fr[32]-1.0*fl[32])-5.0*(fr[19]+fl[19])); 
  favg[12] = -0.1414213562373095*(8.660254037844387*(fr[33]-1.0*fl[33])-5.0*(fr[20]+fl[20])); 
  favg[13] = -0.1414213562373095*(8.660254037844387*(fr[37]-1.0*fl[37])-5.0*(fr[25]+fl[25])); 
  favg[14] = -0.1414213562373095*(8.660254037844387*(fr[38]-1.0*fl[38])-5.0*(fr[26]+fl[26])); 
  favg[15] = -0.1414213562373095*(8.660254037844387*(fr[42]-1.0*fl[42])-5.0*(fr[28]+fl[28])); 
  favg[16] = -0.1414213562373095*(8.660254037844387*(fr[43]-1.0*fl[43])-5.0*(fr[29]+fl[29])); 
  favg[17] = -0.1414213562373095*(8.660254037844387*(fr[44]-1.0*fl[44])-5.0*(fr[35]+fl[35])); 
  favg[18] = -0.1414213562373095*(8.660254037844387*(fr[45]-1.0*fl[45])-5.0*(fr[36]+fl[36])); 
  favg[19] = -0.1414213562373095*(8.660254037844387*(fr[47]-1.0*fl[47])-5.0*(fr[41]+fl[41])); 

//
// //
  Ghat[0] = -0.125*(1.414213562373095*((2.0*fr[0]-2.0*fl[0])*amax-1.0*(alpha[12]*favg[12]+alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0]))+(3.16227766016838*(2.0*fr[13]-2.0*fl[13])-4.898979485566357*(fr[3]+fl[3]))*amax); 
  Ghat[1] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[23]-10.0*fr[23])*amax+2.0*(alpha[4]*favg[11]+favg[4]*alpha[11]))+5.477225575051662*(alpha[8]*favg[12]+favg[8]*alpha[12]))+1.414213562373095*((30.0*fl[1]-30.0*fr[1])*amax+15.0*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1]))+73.48469228349535*(fr[6]+fl[6])*amax+18.97366596101028*(alpha[1]*favg[7]+favg[1]*alpha[7])); 
  Ghat[2] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[24]-10.0*fr[24])*amax+2.0*(alpha[4]*favg[12]+favg[4]*alpha[12]))+5.477225575051662*(alpha[7]*favg[11]+favg[7]*alpha[11]))+1.414213562373095*((30.0*fl[2]-30.0*fr[2])*amax+15.0*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2]))+73.48469228349535*(fr[7]+fl[7])*amax+18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])); 
  Ghat[3] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*(10.0*fl[27]-10.0*fr[27])*amax+5.477225575051662*(alpha[12]*favg[18]+alpha[11]*favg[17]+alpha[8]*favg[14]+alpha[7]*favg[13]))+1.414213562373095*((30.0*fl[4]-30.0*fr[4])*amax+15.0*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3]))+73.48469228349535*(fr[10]+fl[10])*amax); 
  Ghat[4] = 0.008333333333333333*(3.16227766016838*((30.0*fl[34]-30.0*fr[34])*amax+6.0*(alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7]))+1.414213562373095*((30.0*fl[5]-30.0*fr[5])*amax+12.0*(alpha[11]*favg[12]+favg[11]*alpha[12])+15.0*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2]))+73.48469228349535*(fr[15]+fl[15])*amax+18.97366596101028*(alpha[2]*favg[12]+favg[2]*alpha[12]+alpha[1]*favg[11]+favg[1]*alpha[11])); 
  Ghat[5] = 0.008333333333333333*(3.16227766016838*((30.0*fl[39]-30.0*fr[39])*amax+6.0*(alpha[4]*favg[17]+favg[5]*alpha[7]))+1.414213562373095*((30.0*fl[8]-30.0*fr[8])*amax+15.0*(alpha[8]*favg[18]+alpha[12]*favg[14]+alpha[2]*favg[10]+alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3]))+73.48469228349535*(fr[17]+fl[17])*amax+18.97366596101028*(alpha[1]*favg[13]+favg[10]*alpha[11])); 
  Ghat[6] = 0.008333333333333333*(3.16227766016838*((30.0*fl[40]-30.0*fr[40])*amax+6.0*(alpha[4]*favg[18]+favg[6]*alpha[8]))+1.414213562373095*((30.0*fl[9]-30.0*fr[9])*amax+15.0*(alpha[7]*favg[17]+alpha[11]*favg[13]+alpha[1]*favg[10]+alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3]))+73.48469228349535*(fr[18]+fl[18])*amax+18.97366596101028*(alpha[2]*favg[14]+favg[10]*alpha[12])); 
  Ghat[7] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[21]+fl[21])*amax+17.14642819948225*(alpha[2]*favg[11]+favg[2]*alpha[11]))+1.414213562373095*((210.0*fl[11]-210.0*fr[11])*amax+105.0*(alpha[0]*favg[7]+favg[0]*alpha[7]))+3.16227766016838*(42.0*alpha[12]*favg[12]+30.0*(alpha[11]*favg[11]+alpha[7]*favg[7])+42.0*(alpha[4]*favg[4]+alpha[1]*favg[1]))); 
  Ghat[8] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[22]+fl[22])*amax+17.14642819948225*(alpha[1]*favg[12]+favg[1]*alpha[12]))+1.414213562373095*((210.0*fl[12]-210.0*fr[12])*amax+105.0*(alpha[0]*favg[8]+favg[0]*alpha[8]))+3.16227766016838*(30.0*alpha[12]*favg[12]+42.0*alpha[11]*favg[11]+30.0*alpha[8]*favg[8]+42.0*(alpha[4]*favg[4]+alpha[2]*favg[2]))); 
  Ghat[9] = 0.01863389981249824*(3.872983346207417*(8.485281374238571*(fr[30]+fl[30])*amax+2.449489742783178*(alpha[2]*favg[16]+alpha[1]*favg[15]))+3.16227766016838*((6.0*fl[14]-6.0*fr[14])*amax+3.0*(alpha[4]*favg[19]+alpha[0]*favg[9]))); 
  Ghat[10] = 0.001666666666666667*(3.872983346207417*(2.449489742783178*((50.0*fl[46]-50.0*fr[46])*amax+10.0*(alpha[4]*(favg[14]+favg[13])+favg[6]*alpha[12]+favg[5]*alpha[11]))+21.90890230020665*(alpha[11]*favg[18]+alpha[12]*favg[17]))+1.414213562373095*((150.0*fl[16]-150.0*fr[16])*amax+75.0*(alpha[0]*favg[10]+alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4]))+367.4234614174767*(fr[31]+fl[31])*amax+94.86832980505139*(alpha[2]*favg[18]+alpha[1]*favg[17]+(alpha[8]+alpha[7])*favg[10])); 
  Ghat[11] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[32]+fl[32])*amax+17.14642819948225*(alpha[2]*favg[7]+favg[2]*alpha[7]))+34.2928563989645*(alpha[1]*favg[4]+favg[1]*alpha[4]))+1.414213562373095*((210.0*fl[19]-210.0*fr[19])*amax+84.0*(alpha[4]*favg[12]+favg[4]*alpha[12])+105.0*(alpha[0]*favg[11]+favg[0]*alpha[11]))+3.16227766016838*((42.0*alpha[8]+30.0*alpha[7])*favg[11]+(42.0*favg[8]+30.0*favg[7])*alpha[11])); 
  Ghat[12] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[33]+fl[33])*amax+17.14642819948225*(alpha[1]*favg[8]+favg[1]*alpha[8]))+34.2928563989645*(alpha[2]*favg[4]+favg[2]*alpha[4]))+1.414213562373095*((210.0*fl[20]-210.0*fr[20])*amax+105.0*(alpha[0]*favg[12]+favg[0]*alpha[12])+84.0*(alpha[4]*favg[11]+favg[4]*alpha[11]))+3.16227766016838*((30.0*alpha[8]+42.0*alpha[7])*favg[12]+(30.0*favg[8]+42.0*favg[7])*alpha[12])); 
  Ghat[13] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[37]+fl[37])*amax+17.14642819948225*(alpha[2]*favg[17]+favg[3]*alpha[7]))+34.2928563989645*(alpha[4]*favg[10]+alpha[1]*favg[5]))+1.414213562373095*((210.0*fl[25]-210.0*fr[25])*amax+105.0*(alpha[0]*favg[13]+favg[6]*alpha[11]))+3.16227766016838*(42.0*alpha[12]*favg[18]+30.0*(alpha[11]*favg[17]+alpha[7]*favg[13]))); 
  Ghat[14] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[38]+fl[38])*amax+17.14642819948225*(alpha[1]*favg[18]+favg[3]*alpha[8]))+34.2928563989645*(alpha[4]*favg[10]+alpha[2]*favg[6]))+1.414213562373095*((210.0*fl[26]-210.0*fr[26])*amax+105.0*(alpha[0]*favg[14]+favg[5]*alpha[12]))+3.16227766016838*(30.0*alpha[12]*favg[18]+42.0*alpha[11]*favg[17]+30.0*alpha[8]*favg[14])); 
  Ghat[15] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[28]-10.0*fr[28])*amax+5.0*(alpha[4]*favg[16]+alpha[0]*favg[15]))+6.324555320336759*(alpha[11]*favg[19]+alpha[7]*favg[15]))+2.23606797749979*(42.42640687119285*(fr[42]+fl[42])*amax+12.24744871391589*(alpha[2]*favg[19]+alpha[1]*favg[9]))); 
  Ghat[16] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[29]-10.0*fr[29])*amax+5.0*(alpha[0]*favg[16]+alpha[4]*favg[15]))+6.324555320336759*(alpha[12]*favg[19]+alpha[8]*favg[16]))+2.23606797749979*(42.42640687119285*(fr[43]+fl[43])*amax+12.24744871391589*(alpha[1]*favg[19]+alpha[2]*favg[9]))); 
  Ghat[17] = 2.380952380952381e-4*(8.660254037844387*(296.98484809835*(fr[44]+fl[44])*amax+2.449489742783178*(35.0*alpha[2]*favg[13]+28.0*favg[10]*alpha[12]+35.0*favg[3]*alpha[11]))+1.414213562373095*((1050.0*fl[35]-1050.0*fr[35])*amax+420.0*alpha[4]*favg[18]+525.0*(alpha[0]*favg[17]+favg[6]*alpha[7]))+3.16227766016838*((210.0*alpha[8]+150.0*alpha[7])*favg[17]+alpha[11]*(210.0*favg[14]+150.0*favg[13])+210.0*(alpha[1]*favg[10]+alpha[4]*favg[5]))); 
  Ghat[18] = 2.380952380952381e-4*(8.660254037844387*(296.98484809835*(fr[45]+fl[45])*amax+2.449489742783178*(35.0*(alpha[1]*favg[14]+favg[3]*alpha[12])+28.0*favg[10]*alpha[11]))+1.414213562373095*((1050.0*fl[36]-1050.0*fr[36])*amax+525.0*alpha[0]*favg[18]+420.0*alpha[4]*favg[17]+525.0*favg[5]*alpha[8])+3.16227766016838*((150.0*alpha[8]+210.0*alpha[7])*favg[18]+150.0*alpha[12]*favg[14]+210.0*(alpha[12]*favg[13]+alpha[2]*favg[10]+alpha[4]*favg[6]))); 
  Ghat[19] = 0.01863389981249824*(3.872983346207417*(8.485281374238571*(fr[47]+fl[47])*amax+2.449489742783178*(alpha[1]*favg[16]+alpha[2]*favg[15]))+3.16227766016838*((6.0*fl[41]-6.0*fr[41])*amax+3.0*(alpha[0]*favg[19]+alpha[4]*favg[9]))+8.485281374238571*((alpha[8]+alpha[7])*favg[19]+alpha[12]*favg[16]+alpha[11]*favg[15])); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_v; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_v; 
  incr[2] = 0.7071067811865475*Ghat[2]*dfac_v; 
  incr[3] = -1.224744871391589*Ghat[0]*dfac_v; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_v; 
  incr[5] = 0.7071067811865475*Ghat[4]*dfac_v; 
  incr[6] = -1.224744871391589*Ghat[1]*dfac_v; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_v; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_v; 
  incr[9] = 0.7071067811865475*Ghat[6]*dfac_v; 
  incr[10] = -1.224744871391589*Ghat[3]*dfac_v; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_v; 
  incr[12] = 0.7071067811865475*Ghat[8]*dfac_v; 
  incr[13] = 1.58113883008419*Ghat[0]*dfac_v; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_v; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_v; 
  incr[16] = 0.7071067811865475*Ghat[10]*dfac_v; 
  incr[17] = -1.224744871391589*Ghat[5]*dfac_v; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_v; 
  incr[19] = 0.7071067811865475*Ghat[11]*dfac_v; 
  incr[20] = 0.7071067811865475*Ghat[12]*dfac_v; 
  incr[21] = -1.224744871391589*Ghat[7]*dfac_v; 
  incr[22] = -1.224744871391589*Ghat[8]*dfac_v; 
  incr[23] = 1.58113883008419*Ghat[1]*dfac_v; 
  incr[24] = 1.58113883008419*Ghat[2]*dfac_v; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_v; 
  incr[26] = 0.7071067811865475*Ghat[14]*dfac_v; 
  incr[27] = 1.58113883008419*Ghat[3]*dfac_v; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_v; 
  incr[29] = 0.7071067811865475*Ghat[16]*dfac_v; 
  incr[30] = -1.224744871391589*Ghat[9]*dfac_v; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_v; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_v; 
  incr[33] = -1.224744871391589*Ghat[12]*dfac_v; 
  incr[34] = 1.58113883008419*Ghat[4]*dfac_v; 
  incr[35] = 0.7071067811865475*Ghat[17]*dfac_v; 
  incr[36] = 0.7071067811865475*Ghat[18]*dfac_v; 
  incr[37] = -1.224744871391589*Ghat[13]*dfac_v; 
  incr[38] = -1.224744871391589*Ghat[14]*dfac_v; 
  incr[39] = 1.58113883008419*Ghat[5]*dfac_v; 
  incr[40] = 1.58113883008419*Ghat[6]*dfac_v; 
  incr[41] = 0.7071067811865475*Ghat[19]*dfac_v; 
  incr[42] = -1.224744871391589*Ghat[15]*dfac_v; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_v; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_v; 
  incr[45] = -1.224744871391589*Ghat[18]*dfac_v; 
  incr[46] = 1.58113883008419*Ghat[10]*dfac_v; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_v; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += -1.0*incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += -1.0*incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += incr[21]; 
  outl[22] += incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += -1.0*incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += incr[37]; 
  outl[38] += incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += -1.0*incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += -1.0*incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_X_P2_Bvars_1(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = (0.04166666666666666*(2.23606797749979*(dfac_v2*(6.0*BdriftX[4]*m_*wv2+q_*(3.0*(((-3.0*Apar[3]*BmagInv[4]*dfac_y)+Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*wv+3.0*Phi[3]*BmagInv[4]*dfac_y)+5.196152422706631*((Apar[2]*BmagInv[4]*dfac_y-1.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*wv-1.0*Phi[2]*BmagInv[4]*dfac_y)))+2.0*BdriftX[4]*m_)-1.732050807568877*(3.0*dfac_v2*(2.0*BdriftX[1]*m_*wv2+q_*((3.0*BmagInv[1]*Phi[3]+BmagInv[0]*Phi[2])*dfac_y-1.0*((3.0*BmagInv[1]*Apar[3]+BmagInv[0]*Apar[2])*dfac_y-1.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*wv))+2.0*BdriftX[1]*m_)+dfac_v2*(6.0*BdriftX[0]*m_*wv2+q_*(3.872983346207417*dfac_y*(6.708203932499369*BmagInv[4]*(Apar[6]*wv-1.0*Phi[6])+3.0*BmagInv[0]*(Apar[6]*wv-1.0*Phi[6])+5.196152422706631*BmagInv[1]*(Phi[6]-1.0*Apar[6]*wv))+3.0*(((-3.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*dfac_y)+5.0*Apar[4]*BdriftX[4]+3.0*Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])*wv+3.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*dfac_y)))+2.0*BdriftX[0]*m_))/(dfac_v2*q_); 

  double alpha[20]; 
  alpha[0] = (0.2357022603955158*(2.23606797749979*(dfac_v2*(6.0*BdriftX[4]*m_*wv2+q_*(1.732050807568877*((3.0*Apar[2]*BmagInv[4]*dfac_y-3.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*wv-3.0*Phi[2]*BmagInv[4]*dfac_y)+(3.0*(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])-9.0*Apar[3]*BmagInv[4]*dfac_y)*wv+9.0*Phi[3]*BmagInv[4]*dfac_y))+2.0*BdriftX[4]*m_)+1.732050807568877*(dfac_v2*(q_*(((9.0*BmagInv[1]*Apar[3]+3.0*BmagInv[0]*Apar[2])*dfac_y-3.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*wv+((-9.0*BmagInv[1]*Phi[3])-3.0*BmagInv[0]*Phi[2])*dfac_y)-6.0*BdriftX[1]*m_*wv2)-2.0*BdriftX[1]*m_)+dfac_v2*(6.0*BdriftX[0]*m_*wv2+q_*(3.872983346207417*dfac_y*(2.23606797749979*BmagInv[4]*(3.0*Apar[6]*wv-3.0*Phi[6])+1.732050807568877*BmagInv[1]*(3.0*Phi[6]-3.0*Apar[6]*wv)+BmagInv[0]*(3.0*Apar[6]*wv-3.0*Phi[6]))+((-9.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*dfac_y)+15.0*Apar[4]*BdriftX[4]+9.0*Apar[1]*BdriftX[1]+3.0*Apar[0]*BdriftX[0])*wv+9.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*dfac_y))+2.0*BdriftX[0]*m_))/(dfac_v2*q_); 
  alpha[1] = -0.2357022603955158*(3.872983346207417*(3.872983346207417*((3.0*BmagInv[4]*Apar[7]*dfac_y-1.0*BdriftX[4]*Apar[6])*wv-3.0*BmagInv[4]*Phi[7]*dfac_y)+1.732050807568877*((3.0*BmagInv[0]*Apar[7]*dfac_y-1.0*BdriftX[0]*Apar[6])*wv-3.0*BmagInv[0]*Phi[7]*dfac_y)+(3.0*BdriftX[1]*Apar[6]-9.0*BmagInv[1]*Apar[7]*dfac_y)*wv+9.0*BmagInv[1]*Phi[7]*dfac_y)+2.23606797749979*(1.732050807568877*((3.0*Apar[3]*BdriftX[4]-3.0*BmagInv[0]*Apar[5]*dfac_y)*wv+3.0*BmagInv[0]*Phi[5]*dfac_y)+(9.0*BmagInv[1]*Apar[5]*dfac_y-3.0*Apar[2]*BdriftX[4])*wv-9.0*BmagInv[1]*Phi[5]*dfac_y)+1.732050807568877*((3.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])-15.0*BmagInv[4]*Apar[5]*dfac_y)*wv+15.0*BmagInv[4]*Phi[5]*dfac_y)+((-9.0*BdriftX[1]*Apar[3])-3.0*BdriftX[0]*Apar[2])*wv); 
  alpha[2] = (0.2357022603955158*(2.23606797749979*(1.732050807568877*(4.0*BdriftX[4]*m_*wv+((-3.0*Apar[3]*BmagInv[4]*dfac_y)+Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*q_)+(3.0*Apar[2]*BmagInv[4]*dfac_y-3.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*q_)+1.732050807568877*(4.0*BdriftX[0]*m_*wv+((-3.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*dfac_y)+5.0*Apar[4]*BdriftX[4]+3.0*Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])*q_)-12.0*BdriftX[1]*m_*wv+((3.872983346207417*(3.872983346207417*BmagInv[4]-3.0*BmagInv[1]+1.732050807568877*BmagInv[0])*Apar[6]+9.0*BmagInv[1]*Apar[3]+3.0*BmagInv[0]*Apar[2])*dfac_y-3.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*q_))/(dfac_v*q_); 
  alpha[4] = -(0.2357022603955158*(3.872983346207417*(2.23606797749979*(3.0*BmagInv[4]*Apar[7]*dfac_y-1.0*BdriftX[4]*Apar[6])+1.732050807568877*(BdriftX[1]*Apar[6]-3.0*BmagInv[1]*Apar[7]*dfac_y)+3.0*BmagInv[0]*Apar[7]*dfac_y-1.0*BdriftX[0]*Apar[6])+2.23606797749979*(1.732050807568877*(3.0*BmagInv[1]*Apar[5]*dfac_y-1.0*Apar[2]*BdriftX[4])-3.0*BmagInv[0]*Apar[5]*dfac_y+3.0*Apar[3]*BdriftX[4])-15.0*BmagInv[4]*Apar[5]*dfac_y+1.732050807568877*((-3.0*BdriftX[1]*Apar[3])-1.0*BdriftX[0]*Apar[2])+3.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])))/dfac_v; 
  alpha[7] = 0.1414213562373095*(3.872983346207417*(2.23606797749979*(1.732050807568877*BdriftX[1]-1.0*BdriftX[0])-5.0*BdriftX[4])*Apar[7]+(11.18033988749895*BdriftX[4]-8.660254037844386*BdriftX[1]+5.0*BdriftX[0])*Apar[5])*wv; 
  alpha[8] = -(0.04714045207910316*(2.23606797749979*(6.928203230275509*BdriftX[1]-4.0*BdriftX[0])-20.0*BdriftX[4])*m_)/(dfac_v2*q_); 
  alpha[11] = -(0.04714045207910316*((33.54101966249685*BdriftX[4]-25.98076211353316*BdriftX[1]+15.0*BdriftX[0])*Apar[7]+3.872983346207417*(2.23606797749979*(1.732050807568877*BdriftX[1]-1.0*BdriftX[0])-5.0*BdriftX[4])*Apar[5]))/dfac_v; 
  double alphaUp[20]; 
  alphaUp[0] = (0.2357022603955158*(2.23606797749979*(dfac_v2*(6.0*BdriftX[4]*m_*wv2+q_*(1.732050807568877*((3.0*Apar[2]*BmagInv[4]*dfac_y-3.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*wv-3.0*Phi[2]*BmagInv[4]*dfac_y)+(3.0*(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])-9.0*Apar[3]*BmagInv[4]*dfac_y)*wv+9.0*Phi[3]*BmagInv[4]*dfac_y))+2.0*BdriftX[4]*m_)+1.732050807568877*(dfac_v2*(q_*(((9.0*BmagInv[1]*Apar[3]+3.0*BmagInv[0]*Apar[2])*dfac_y-3.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*wv+((-9.0*BmagInv[1]*Phi[3])-3.0*BmagInv[0]*Phi[2])*dfac_y)-6.0*BdriftX[1]*m_*wv2)-2.0*BdriftX[1]*m_)+dfac_v2*(6.0*BdriftX[0]*m_*wv2+q_*(3.872983346207417*dfac_y*(2.23606797749979*BmagInv[4]*(3.0*Apar[6]*wv-3.0*Phi[6])+1.732050807568877*BmagInv[1]*(3.0*Phi[6]-3.0*Apar[6]*wv)+BmagInv[0]*(3.0*Apar[6]*wv-3.0*Phi[6]))+((-9.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*dfac_y)+15.0*Apar[4]*BdriftX[4]+9.0*Apar[1]*BdriftX[1]+3.0*Apar[0]*BdriftX[0])*wv+9.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*dfac_y))+2.0*BdriftX[0]*m_))/(dfac_v2*q_); 
  alphaUp[1] = -0.2357022603955158*(3.872983346207417*(3.872983346207417*((3.0*BmagInv[4]*Apar[7]*dfac_y-1.0*BdriftX[4]*Apar[6])*wv-3.0*BmagInv[4]*Phi[7]*dfac_y)+1.732050807568877*((3.0*BmagInv[0]*Apar[7]*dfac_y-1.0*BdriftX[0]*Apar[6])*wv-3.0*BmagInv[0]*Phi[7]*dfac_y)+(3.0*BdriftX[1]*Apar[6]-9.0*BmagInv[1]*Apar[7]*dfac_y)*wv+9.0*BmagInv[1]*Phi[7]*dfac_y)+2.23606797749979*(1.732050807568877*((3.0*Apar[3]*BdriftX[4]-3.0*BmagInv[0]*Apar[5]*dfac_y)*wv+3.0*BmagInv[0]*Phi[5]*dfac_y)+(9.0*BmagInv[1]*Apar[5]*dfac_y-3.0*Apar[2]*BdriftX[4])*wv-9.0*BmagInv[1]*Phi[5]*dfac_y)+1.732050807568877*((3.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])-15.0*BmagInv[4]*Apar[5]*dfac_y)*wv+15.0*BmagInv[4]*Phi[5]*dfac_y)+((-9.0*BdriftX[1]*Apar[3])-3.0*BdriftX[0]*Apar[2])*wv); 
  alphaUp[2] = (0.2357022603955158*(2.23606797749979*(1.732050807568877*(4.0*BdriftX[4]*m_*wv+((-3.0*Apar[3]*BmagInv[4]*dfac_y)+Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*q_)+(3.0*Apar[2]*BmagInv[4]*dfac_y-3.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*q_)+1.732050807568877*(4.0*BdriftX[0]*m_*wv+((-3.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*dfac_y)+5.0*Apar[4]*BdriftX[4]+3.0*Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])*q_)-12.0*BdriftX[1]*m_*wv+((3.872983346207417*(3.872983346207417*BmagInv[4]-3.0*BmagInv[1]+1.732050807568877*BmagInv[0])*Apar[6]+9.0*BmagInv[1]*Apar[3]+3.0*BmagInv[0]*Apar[2])*dfac_y-3.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*q_))/(dfac_v*q_); 
  alphaUp[4] = -(0.2357022603955158*(3.872983346207417*(2.23606797749979*(3.0*BmagInv[4]*Apar[7]*dfac_y-1.0*BdriftX[4]*Apar[6])+1.732050807568877*(BdriftX[1]*Apar[6]-3.0*BmagInv[1]*Apar[7]*dfac_y)+3.0*BmagInv[0]*Apar[7]*dfac_y-1.0*BdriftX[0]*Apar[6])+2.23606797749979*(1.732050807568877*(3.0*BmagInv[1]*Apar[5]*dfac_y-1.0*Apar[2]*BdriftX[4])-3.0*BmagInv[0]*Apar[5]*dfac_y+3.0*Apar[3]*BdriftX[4])-15.0*BmagInv[4]*Apar[5]*dfac_y+1.732050807568877*((-3.0*BdriftX[1]*Apar[3])-1.0*BdriftX[0]*Apar[2])+3.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])))/dfac_v; 
  alphaUp[7] = 0.1414213562373095*(3.872983346207417*(2.23606797749979*(1.732050807568877*BdriftX[1]-1.0*BdriftX[0])-5.0*BdriftX[4])*Apar[7]+(11.18033988749895*BdriftX[4]-8.660254037844386*BdriftX[1]+5.0*BdriftX[0])*Apar[5])*wv; 
  alphaUp[8] = -(0.04714045207910316*(2.23606797749979*(6.928203230275509*BdriftX[1]-4.0*BdriftX[0])-20.0*BdriftX[4])*m_)/(dfac_v2*q_); 
  alphaUp[11] = -(0.04714045207910316*((33.54101966249685*BdriftX[4]-25.98076211353316*BdriftX[1]+15.0*BdriftX[0])*Apar[7]+3.872983346207417*(2.23606797749979*(1.732050807568877*BdriftX[1]-1.0*BdriftX[0])-5.0*BdriftX[4])*Apar[5]))/dfac_v; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[11]+fl[11])+1.732050807568877*(fl[1]-1.0*fr[1])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[19]+fl[19])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[2]+fl[2])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[21]+fl[21])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[25]+fl[25])+3.0*(fl[8]-1.0*fr[8]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[32]+fl[32])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[7]+fl[7]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[35]+fl[35])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[9]+fl[9]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[37]+fl[37])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*(fr[20]-1.0*fl[20])-5.0*(fr[12]+fl[12])); 
  favg[8] = -0.1414213562373095*(8.660254037844387*(fr[23]-1.0*fl[23])-5.0*(fr[13]+fl[13])); 
  favg[9] = -0.1414213562373095*(8.660254037844387*(fr[28]-1.0*fl[28])-5.0*(fr[14]+fl[14])); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[44]+fl[44])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[18]+fl[18])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*(fr[33]-1.0*fl[33])-5.0*(fr[22]+fl[22])); 
  favg[12] = -0.1414213562373095*(8.660254037844387*(fr[34]-1.0*fl[34])-5.0*(fr[24]+fl[24])); 
  favg[13] = -0.1414213562373095*(8.660254037844387*(fr[36]-1.0*fl[36])-5.0*(fr[26]+fl[26])); 
  favg[14] = -0.1414213562373095*(8.660254037844387*(fr[39]-1.0*fl[39])-5.0*(fr[27]+fl[27])); 
  favg[15] = -0.1414213562373095*(8.660254037844387*(fr[41]-1.0*fl[41])-5.0*(fr[29]+fl[29])); 
  favg[16] = -0.1414213562373095*(8.660254037844387*(fr[42]-1.0*fl[42])-5.0*(fr[30]+fl[30])); 
  favg[17] = -0.1414213562373095*(8.660254037844387*(fr[45]-1.0*fl[45])-5.0*(fr[38]+fl[38])); 
  favg[18] = -0.1414213562373095*(8.660254037844387*(fr[46]-1.0*fl[46])-5.0*(fr[40]+fl[40])); 
  favg[19] = -0.1414213562373095*(8.660254037844387*(fr[47]-1.0*fl[47])-5.0*(fr[43]+fl[43])); 

//
// //
  Ghat[0] = -0.125*(1.414213562373095*((2.0*fr[0]-2.0*fl[0])*amax-1.0*(alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0]))+(3.16227766016838*(2.0*fr[11]-2.0*fl[11])-4.898979485566357*(fr[1]+fl[1]))*amax); 
  Ghat[1] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[19]-10.0*fr[19])*amax+2.0*(alpha[4]*favg[11]+favg[4]*alpha[11]))+5.477225575051662*alpha[8]*favg[12])+1.414213562373095*((30.0*fl[2]-30.0*fr[2])*amax+15.0*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1]))+73.48469228349535*(fr[5]+fl[5])*amax+18.97366596101028*(alpha[1]*favg[7]+favg[1]*alpha[7])); 
  Ghat[2] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[21]-10.0*fr[21])*amax+2.0*alpha[4]*favg[12])+5.477225575051662*(alpha[7]*favg[11]+favg[7]*alpha[11]))+1.414213562373095*((30.0*fl[3]-30.0*fr[3])*amax+15.0*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2]))+73.48469228349535*(fr[6]+fl[6])*amax+18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])); 
  Ghat[3] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*(10.0*fl[25]-10.0*fr[25])*amax+5.477225575051662*(alpha[11]*favg[17]+alpha[8]*favg[14]+alpha[7]*favg[13]))+1.414213562373095*((30.0*fl[4]-30.0*fr[4])*amax+15.0*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3]))+73.48469228349535*(fr[8]+fl[8])*amax); 
  Ghat[4] = 0.008333333333333333*(3.16227766016838*((30.0*fl[32]-30.0*fr[32])*amax+6.0*(alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7]))+1.414213562373095*((30.0*fl[7]-30.0*fr[7])*amax+12.0*alpha[11]*favg[12]+15.0*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2]))+73.48469228349535*(fr[15]+fl[15])*amax+18.97366596101028*(alpha[2]*favg[12]+alpha[1]*favg[11]+favg[1]*alpha[11])); 
  Ghat[5] = 0.008333333333333333*(3.16227766016838*((30.0*fl[35]-30.0*fr[35])*amax+6.0*(alpha[4]*favg[17]+favg[5]*alpha[7]))+1.414213562373095*((30.0*fl[9]-30.0*fr[9])*amax+15.0*(alpha[8]*favg[18]+alpha[2]*favg[10]+alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3]))+73.48469228349535*(fr[16]+fl[16])*amax+18.97366596101028*(alpha[1]*favg[13]+favg[10]*alpha[11])); 
  Ghat[6] = 0.008333333333333333*(3.16227766016838*((30.0*fl[37]-30.0*fr[37])*amax+6.0*(alpha[4]*favg[18]+favg[6]*alpha[8]))+1.414213562373095*((30.0*fl[10]-30.0*fr[10])*amax+15.0*(alpha[7]*favg[17]+alpha[11]*favg[13]+alpha[1]*favg[10]+alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3]))+73.48469228349535*(fr[17]+fl[17])*amax+18.97366596101028*alpha[2]*favg[14]); 
  Ghat[7] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[20]+fl[20])*amax+17.14642819948225*(alpha[2]*favg[11]+favg[2]*alpha[11]))+1.414213562373095*((210.0*fl[12]-210.0*fr[12])*amax+105.0*(alpha[0]*favg[7]+favg[0]*alpha[7]))+3.16227766016838*(30.0*(alpha[11]*favg[11]+alpha[7]*favg[7])+42.0*(alpha[4]*favg[4]+alpha[1]*favg[1]))); 
  Ghat[8] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[23]+fl[23])*amax+17.14642819948224*alpha[1]*favg[12])+1.414213562373095*((210.0*fl[13]-210.0*fr[13])*amax+105.0*(alpha[0]*favg[8]+favg[0]*alpha[8]))+3.16227766016838*(42.0*alpha[11]*favg[11]+30.0*alpha[8]*favg[8]+42.0*(alpha[4]*favg[4]+alpha[2]*favg[2]))); 
  Ghat[9] = 0.01863389981249824*(3.872983346207417*(8.485281374238571*(fr[28]+fl[28])*amax+2.449489742783178*(alpha[2]*favg[16]+alpha[1]*favg[15]))+3.16227766016838*((6.0*fl[14]-6.0*fr[14])*amax+3.0*(alpha[4]*favg[19]+alpha[0]*favg[9]))); 
  Ghat[10] = 0.001666666666666667*(3.872983346207417*(2.449489742783178*((50.0*fl[44]-50.0*fr[44])*amax+10.0*(alpha[4]*(favg[14]+favg[13])+favg[5]*alpha[11]))+21.90890230020665*alpha[11]*favg[18])+1.414213562373095*((150.0*fl[18]-150.0*fr[18])*amax+75.0*(alpha[0]*favg[10]+alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4]))+367.4234614174767*(fr[31]+fl[31])*amax+94.86832980505139*(alpha[2]*favg[18]+alpha[1]*favg[17]+(alpha[8]+alpha[7])*favg[10])); 
  Ghat[11] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[33]+fl[33])*amax+17.14642819948225*(alpha[2]*favg[7]+favg[2]*alpha[7]))+34.2928563989645*(alpha[1]*favg[4]+favg[1]*alpha[4]))+1.414213562373095*((210.0*fl[22]-210.0*fr[22])*amax+84.0*alpha[4]*favg[12]+105.0*(alpha[0]*favg[11]+favg[0]*alpha[11]))+3.16227766016838*((42.0*alpha[8]+30.0*alpha[7])*favg[11]+(42.0*favg[8]+30.0*favg[7])*alpha[11])); 
  Ghat[12] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[34]+fl[34])*amax+17.14642819948225*(alpha[1]*favg[8]+favg[1]*alpha[8]))+34.2928563989645*(alpha[2]*favg[4]+favg[2]*alpha[4]))+1.414213562373095*((210.0*fl[24]-210.0*fr[24])*amax+105.0*alpha[0]*favg[12]+84.0*(alpha[4]*favg[11]+favg[4]*alpha[11]))+3.16227766016838*(30.0*alpha[8]+42.0*alpha[7])*favg[12]); 
  Ghat[13] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[36]+fl[36])*amax+17.14642819948225*(alpha[2]*favg[17]+favg[3]*alpha[7]))+34.2928563989645*(alpha[4]*favg[10]+alpha[1]*favg[5]))+1.414213562373095*((210.0*fl[26]-210.0*fr[26])*amax+105.0*(alpha[0]*favg[13]+favg[6]*alpha[11]))+94.86832980505139*(alpha[11]*favg[17]+alpha[7]*favg[13])); 
  Ghat[14] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[39]+fl[39])*amax+17.14642819948225*(alpha[1]*favg[18]+favg[3]*alpha[8]))+34.2928563989645*(alpha[4]*favg[10]+alpha[2]*favg[6]))+1.414213562373095*((210.0*fl[27]-210.0*fr[27])*amax+105.0*alpha[0]*favg[14])+3.16227766016838*(42.0*alpha[11]*favg[17]+30.0*alpha[8]*favg[14])); 
  Ghat[15] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[29]-10.0*fr[29])*amax+5.0*(alpha[4]*favg[16]+alpha[0]*favg[15]))+6.324555320336759*(alpha[11]*favg[19]+alpha[7]*favg[15]))+2.23606797749979*(42.42640687119285*(fr[41]+fl[41])*amax+12.24744871391589*(alpha[2]*favg[19]+alpha[1]*favg[9]))); 
  Ghat[16] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[30]-10.0*fr[30])*amax+5.0*(alpha[0]*favg[16]+alpha[4]*favg[15]))+6.324555320336761*alpha[8]*favg[16])+2.23606797749979*(42.42640687119285*(fr[42]+fl[42])*amax+12.24744871391589*(alpha[1]*favg[19]+alpha[2]*favg[9]))); 
  Ghat[17] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[45]+fl[45])*amax+17.14642819948225*(alpha[2]*favg[13]+favg[3]*alpha[11]))+1.414213562373095*((210.0*fl[38]-210.0*fr[38])*amax+84.0*alpha[4]*favg[18]+105.0*(alpha[0]*favg[17]+favg[6]*alpha[7]))+3.16227766016838*((42.0*alpha[8]+30.0*alpha[7])*favg[17]+alpha[11]*(42.0*favg[14]+30.0*favg[13])+42.0*(alpha[1]*favg[10]+alpha[4]*favg[5]))); 
  Ghat[18] = 2.380952380952381e-4*(8.660254037844387*(296.98484809835*(fr[46]+fl[46])*amax+2.449489742783178*(35.0*alpha[1]*favg[14]+28.0*favg[10]*alpha[11]))+1.414213562373095*((1050.0*fl[40]-1050.0*fr[40])*amax+525.0*alpha[0]*favg[18]+420.0*alpha[4]*favg[17]+525.0*favg[5]*alpha[8])+3.16227766016838*((150.0*alpha[8]+210.0*alpha[7])*favg[18]+210.0*(alpha[2]*favg[10]+alpha[4]*favg[6]))); 
  Ghat[19] = 0.01863389981249824*(3.872983346207417*(8.485281374238571*(fr[47]+fl[47])*amax+2.449489742783178*(alpha[1]*favg[16]+alpha[2]*favg[15]))+3.16227766016838*((6.0*fl[43]-6.0*fr[43])*amax+3.0*(alpha[0]*favg[19]+alpha[4]*favg[9]))+8.485281374238571*((alpha[8]+alpha[7])*favg[19]+alpha[11]*favg[15])); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_x; 
  incr[1] = -1.224744871391589*Ghat[0]*dfac_x; 
  incr[2] = 0.7071067811865475*Ghat[1]*dfac_x; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_x; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_x; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_x; 
  incr[6] = -1.224744871391589*Ghat[2]*dfac_x; 
  incr[7] = 0.7071067811865475*Ghat[4]*dfac_x; 
  incr[8] = -1.224744871391589*Ghat[3]*dfac_x; 
  incr[9] = 0.7071067811865475*Ghat[5]*dfac_x; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_x; 
  incr[11] = 1.58113883008419*Ghat[0]*dfac_x; 
  incr[12] = 0.7071067811865475*Ghat[7]*dfac_x; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_x; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_x; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_x; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_x; 
  incr[17] = -1.224744871391589*Ghat[6]*dfac_x; 
  incr[18] = 0.7071067811865475*Ghat[10]*dfac_x; 
  incr[19] = 1.58113883008419*Ghat[1]*dfac_x; 
  incr[20] = -1.224744871391589*Ghat[7]*dfac_x; 
  incr[21] = 1.58113883008419*Ghat[2]*dfac_x; 
  incr[22] = 0.7071067811865475*Ghat[11]*dfac_x; 
  incr[23] = -1.224744871391589*Ghat[8]*dfac_x; 
  incr[24] = 0.7071067811865475*Ghat[12]*dfac_x; 
  incr[25] = 1.58113883008419*Ghat[3]*dfac_x; 
  incr[26] = 0.7071067811865475*Ghat[13]*dfac_x; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_x; 
  incr[28] = -1.224744871391589*Ghat[9]*dfac_x; 
  incr[29] = 0.7071067811865475*Ghat[15]*dfac_x; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_x; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_x; 
  incr[32] = 1.58113883008419*Ghat[4]*dfac_x; 
  incr[33] = -1.224744871391589*Ghat[11]*dfac_x; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_x; 
  incr[35] = 1.58113883008419*Ghat[5]*dfac_x; 
  incr[36] = -1.224744871391589*Ghat[13]*dfac_x; 
  incr[37] = 1.58113883008419*Ghat[6]*dfac_x; 
  incr[38] = 0.7071067811865475*Ghat[17]*dfac_x; 
  incr[39] = -1.224744871391589*Ghat[14]*dfac_x; 
  incr[40] = 0.7071067811865475*Ghat[18]*dfac_x; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_x; 
  incr[42] = -1.224744871391589*Ghat[16]*dfac_x; 
  incr[43] = 0.7071067811865475*Ghat[19]*dfac_x; 
  incr[44] = 1.58113883008419*Ghat[10]*dfac_x; 
  incr[45] = -1.224744871391589*Ghat[17]*dfac_x; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_x; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_x; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += -1.0*incr[7]; 
  outl[8] += incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += -1.0*incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += -1.0*incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += -1.0*incr[43]; 
  outl[44] += -1.0*incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Y_P2_Bvars_1(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = (0.008333333333333333*(dfac_v2*(30.0*BdriftY[0]*m_*wv2-11.18033988749895*(5.196152422706631*BmagInv[1]*dfac_x*(Apar[4]*q_*wv-1.0*(Bmag[4]*wm+Phi[4]*q_))-3.0*BdriftY[0]*Apar[5]*q_*wv)-3.872983346207417*q_*(3.0*((5.0*BmagInv[0]*Apar[7]*dfac_x+2.23606797749979*BdriftY[4]*Apar[6])*wv-5.0*BmagInv[0]*Phi[7]*dfac_x)+8.660254037844386*(3.0*BmagInv[1]*Phi[6]*dfac_x-1.0*(3.0*BmagInv[1]*Apar[6]*dfac_x+BdriftY[1]*Apar[7])*wv)))+5.0*(dfac_v2*(3.0*q_*((3.0*BmagInv[0]*Apar[3]*dfac_x+Apar[4]*BdriftY[4]+Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0])*wv-3.0*BmagInv[0]*Phi[3]*dfac_x)-5.196152422706631*((BmagInv[0]*Apar[1]*dfac_x+BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])*q_*wv-1.0*BmagInv[0]*dfac_x*(Bmag[1]*wm+Phi[1]*q_)))+2.0*BdriftY[0]*m_)))/(dfac_v2*q_); 

  double alpha[20]; 
  alpha[0] = -(0.04714045207910316*(dfac_v2*((-30.0*BdriftY[0]*m_*wv2)+2.23606797749979*(1.732050807568877*BmagInv[1]*dfac_x*(15.0*Apar[4]*q_*wv-15.0*(Bmag[4]*wm+Phi[4]*q_))-15.0*BdriftY[0]*Apar[5]*q_*wv)+3.872983346207417*q_*(1.732050807568877*(((-15.0*BmagInv[1]*Apar[6]*dfac_x)-5.0*BdriftY[1]*Apar[7])*wv+15.0*BmagInv[1]*Phi[6]*dfac_x)+(15.0*BmagInv[0]*Apar[7]*dfac_x+6.708203932499369*BdriftY[4]*Apar[6])*wv-15.0*BmagInv[0]*Phi[7]*dfac_x)+1.732050807568877*(15.0*(BmagInv[0]*Apar[1]*dfac_x+BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])*q_*wv-15.0*BmagInv[0]*dfac_x*(Bmag[1]*wm+Phi[1]*q_))+q_*(((-45.0*BmagInv[0]*Apar[3]*dfac_x)-15.0*(Apar[4]*BdriftY[4]+Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0]))*wv+45.0*BmagInv[0]*Phi[3]*dfac_x))-10.0*BdriftY[0]*m_))/(dfac_v2*q_); 
  alpha[1] = (0.04714045207910316*(dfac_v2*(30.0*BdriftY[1]*m_*wv2+2.23606797749979*(1.732050807568877*(((-15.0*BmagInv[0]*Apar[4]*dfac_x)-6.0*Apar[3]*BdriftY[4])*q_*wv+15.0*BmagInv[0]*dfac_x*(Bmag[4]*wm+Phi[4]*q_))+(15.0*BdriftY[1]*Apar[5]+6.0*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4]))*q_*wv)+3.872983346207417*q_*(3.872983346207417*((6.0*BmagInv[4]*Apar[6]*dfac_x+2.0*BdriftY[4]*Apar[7])*wv-6.0*BmagInv[4]*Phi[6]*dfac_x)+1.732050807568877*((15.0*BmagInv[0]*Apar[6]*dfac_x+5.0*BdriftY[0]*Apar[7])*wv-15.0*BmagInv[0]*Phi[6]*dfac_x)+((-15.0*BmagInv[1]*Apar[7]*dfac_x)-6.0*BdriftY[1]*Apar[6])*wv+15.0*BmagInv[1]*Phi[7]*dfac_x)+1.732050807568877*((((-30.0*Apar[4]*BmagInv[4])-15.0*Apar[1]*BmagInv[1])*dfac_x-15.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*q_*wv+dfac_x*((30.0*Bmag[4]*BmagInv[4]+15.0*Bmag[1]*BmagInv[1])*wm+(30.0*BmagInv[4]*Phi[4]+15.0*BmagInv[1]*Phi[1])*q_))+q_*((45.0*BmagInv[1]*Apar[3]*dfac_x+15.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1]))*wv-45.0*BmagInv[1]*Phi[3]*dfac_x))+10.0*BdriftY[1]*m_))/(dfac_v2*q_); 
  alpha[2] = -(0.02721655269759087*((3.872983346207417*(1.732050807568877*((-15.0*BmagInv[1]*Apar[6]*dfac_x)-5.0*BdriftY[1]*Apar[7])+15.0*BmagInv[0]*Apar[7]*dfac_x+6.708203932499369*BdriftY[4]*Apar[6])+2.23606797749979*(25.98076211353316*BmagInv[1]*Apar[4]*dfac_x-15.0*BdriftY[0]*Apar[5])+25.98076211353316*(BmagInv[0]*Apar[1]*dfac_x+BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])-45.0*BmagInv[0]*Apar[3]*dfac_x-15.0*(Apar[4]*BdriftY[4]+Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0]))*q_-60.0*BdriftY[0]*m_*wv))/(dfac_v*q_); 
  alpha[3] = (0.7071067811865475*(2.23606797749979*BmagInv[1]*Bmag[4]+BmagInv[0]*Bmag[1])*dfac_x)/(dfac_m*q_); 
  alpha[4] = (0.04714045207910316*(1.732050807568877*(20.0*BdriftY[1]*m_*wv+(15.0*BmagInv[1]*Apar[3]*dfac_x+5.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1]))*q_)+(3.872983346207417*(1.732050807568877*((-5.0*BmagInv[1]*Apar[7]*dfac_x)-2.0*BdriftY[1]*Apar[6])+2.23606797749979*(6.0*BmagInv[4]*Apar[6]*dfac_x+2.0*BdriftY[4]*Apar[7])+15.0*BmagInv[0]*Apar[6]*dfac_x+5.0*BdriftY[0]*Apar[7])+2.23606797749979*((-15.0*BmagInv[0]*Apar[4]*dfac_x)+1.732050807568877*(5.0*BdriftY[1]*Apar[5]+2.0*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4]))-6.0*Apar[3]*BdriftY[4])+((-30.0*Apar[4]*BmagInv[4])-15.0*Apar[1]*BmagInv[1])*dfac_x-15.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*q_))/(dfac_v*q_); 
  alpha[5] = (0.7071067811865475*(Bmag[4]*(2.0*BmagInv[4]+2.23606797749979*BmagInv[0])+Bmag[1]*BmagInv[1])*dfac_x)/(dfac_m*q_); 
  alpha[7] = (0.006734350297014738*(dfac_v2*(210.0*BdriftY[4]*m_*wv2+3.872983346207417*q_*(2.23606797749979*(1.732050807568877*((42.0*BmagInv[1]*Apar[6]*dfac_x+14.0*BdriftY[1]*Apar[7])*wv-42.0*BmagInv[1]*Phi[6]*dfac_x)-21.0*BdriftY[0]*Apar[6]*wv)+((-105.0*BmagInv[4]*Apar[7]*dfac_x)-30.0*BdriftY[4]*Apar[6])*wv+105.0*BmagInv[4]*Phi[7]*dfac_x)+1.732050807568877*((((-105.0*Apar[1]*BmagInv[4])-210.0*BmagInv[1]*Apar[4])*dfac_x-105.0*Apar[2]*BdriftY[4])*q_*wv+dfac_x*((105.0*Bmag[1]*BmagInv[4]+210.0*BmagInv[1]*Bmag[4])*wm+(210.0*BmagInv[1]*Phi[4]+105.0*Phi[1]*BmagInv[4])*q_))+q_*((315.0*Apar[3]*BmagInv[4]*dfac_x+2.23606797749979*(BdriftY[4]*(105.0*Apar[5]+30.0*Apar[4])+BdriftY[1]*(42.0*Apar[1]-72.74613391789283*Apar[3]))+105.0*(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4]))*wv-315.0*Phi[3]*BmagInv[4]*dfac_x))+70.0*BdriftY[4]*m_))/(dfac_v2*q_); 
  alpha[8] = (0.421637021355784*BdriftY[0]*m_)/(dfac_v2*q_); 
  alpha[11] = -(0.00869400884928835*(2.23606797749979*((1.732050807568877*((21.0*Apar[1]*BmagInv[4]+42.0*BmagInv[1]*Apar[4])*dfac_x+21.0*Apar[2]*BdriftY[4])-63.0*Apar[3]*BmagInv[4]*dfac_x-21.0*(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4]))*q_-84.0*BdriftY[4]*m_*wv)+(3.872983346207417*(2.23606797749979*(21.0*BmagInv[4]*Apar[7]*dfac_x+6.0*BdriftY[4]*Apar[6])+1.732050807568877*((-42.0*BmagInv[1]*Apar[6]*dfac_x)-14.0*BdriftY[1]*Apar[7])+21.0*BdriftY[0]*Apar[6])+BdriftY[4]*((-105.0*Apar[5])-30.0*Apar[4])+BdriftY[1]*(72.74613391789283*Apar[3]-42.0*Apar[1]))*q_))/(dfac_v*q_); 
  alpha[12] = (0.4216370213557841*BdriftY[1]*m_)/(dfac_v2*q_); 
  alpha[13] = (0.7071067811865475*(Bmag[1]*BmagInv[4]+2.0*BmagInv[1]*Bmag[4])*dfac_x)/(dfac_m*q_); 
  double alphaUp[20]; 
  alphaUp[0] = -(0.04714045207910316*(dfac_v2*((-30.0*BdriftY[0]*m_*wv2)+2.23606797749979*(1.732050807568877*BmagInv[1]*dfac_x*(15.0*Apar[4]*q_*wv-15.0*(Bmag[4]*wm+Phi[4]*q_))-15.0*BdriftY[0]*Apar[5]*q_*wv)+3.872983346207417*q_*(1.732050807568877*(((-15.0*BmagInv[1]*Apar[6]*dfac_x)-5.0*BdriftY[1]*Apar[7])*wv+15.0*BmagInv[1]*Phi[6]*dfac_x)+(15.0*BmagInv[0]*Apar[7]*dfac_x+6.708203932499369*BdriftY[4]*Apar[6])*wv-15.0*BmagInv[0]*Phi[7]*dfac_x)+1.732050807568877*(15.0*(BmagInv[0]*Apar[1]*dfac_x+BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])*q_*wv-15.0*BmagInv[0]*dfac_x*(Bmag[1]*wm+Phi[1]*q_))+q_*(((-45.0*BmagInv[0]*Apar[3]*dfac_x)-15.0*(Apar[4]*BdriftY[4]+Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0]))*wv+45.0*BmagInv[0]*Phi[3]*dfac_x))-10.0*BdriftY[0]*m_))/(dfac_v2*q_); 
  alphaUp[1] = (0.04714045207910316*(dfac_v2*(30.0*BdriftY[1]*m_*wv2+2.23606797749979*(1.732050807568877*(((-15.0*BmagInv[0]*Apar[4]*dfac_x)-6.0*Apar[3]*BdriftY[4])*q_*wv+15.0*BmagInv[0]*dfac_x*(Bmag[4]*wm+Phi[4]*q_))+(15.0*BdriftY[1]*Apar[5]+6.0*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4]))*q_*wv)+3.872983346207417*q_*(3.872983346207417*((6.0*BmagInv[4]*Apar[6]*dfac_x+2.0*BdriftY[4]*Apar[7])*wv-6.0*BmagInv[4]*Phi[6]*dfac_x)+1.732050807568877*((15.0*BmagInv[0]*Apar[6]*dfac_x+5.0*BdriftY[0]*Apar[7])*wv-15.0*BmagInv[0]*Phi[6]*dfac_x)+((-15.0*BmagInv[1]*Apar[7]*dfac_x)-6.0*BdriftY[1]*Apar[6])*wv+15.0*BmagInv[1]*Phi[7]*dfac_x)+1.732050807568877*((((-30.0*Apar[4]*BmagInv[4])-15.0*Apar[1]*BmagInv[1])*dfac_x-15.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*q_*wv+dfac_x*((30.0*Bmag[4]*BmagInv[4]+15.0*Bmag[1]*BmagInv[1])*wm+(30.0*BmagInv[4]*Phi[4]+15.0*BmagInv[1]*Phi[1])*q_))+q_*((45.0*BmagInv[1]*Apar[3]*dfac_x+15.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1]))*wv-45.0*BmagInv[1]*Phi[3]*dfac_x))+10.0*BdriftY[1]*m_))/(dfac_v2*q_); 
  alphaUp[2] = -(0.02721655269759087*((3.872983346207417*(1.732050807568877*((-15.0*BmagInv[1]*Apar[6]*dfac_x)-5.0*BdriftY[1]*Apar[7])+15.0*BmagInv[0]*Apar[7]*dfac_x+6.708203932499369*BdriftY[4]*Apar[6])+2.23606797749979*(25.98076211353316*BmagInv[1]*Apar[4]*dfac_x-15.0*BdriftY[0]*Apar[5])+25.98076211353316*(BmagInv[0]*Apar[1]*dfac_x+BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])-45.0*BmagInv[0]*Apar[3]*dfac_x-15.0*(Apar[4]*BdriftY[4]+Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0]))*q_-60.0*BdriftY[0]*m_*wv))/(dfac_v*q_); 
  alphaUp[3] = (0.7071067811865475*(2.23606797749979*BmagInv[1]*Bmag[4]+BmagInv[0]*Bmag[1])*dfac_x)/(dfac_m*q_); 
  alphaUp[4] = (0.04714045207910316*(1.732050807568877*(20.0*BdriftY[1]*m_*wv+(15.0*BmagInv[1]*Apar[3]*dfac_x+5.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1]))*q_)+(3.872983346207417*(1.732050807568877*((-5.0*BmagInv[1]*Apar[7]*dfac_x)-2.0*BdriftY[1]*Apar[6])+2.23606797749979*(6.0*BmagInv[4]*Apar[6]*dfac_x+2.0*BdriftY[4]*Apar[7])+15.0*BmagInv[0]*Apar[6]*dfac_x+5.0*BdriftY[0]*Apar[7])+2.23606797749979*((-15.0*BmagInv[0]*Apar[4]*dfac_x)+1.732050807568877*(5.0*BdriftY[1]*Apar[5]+2.0*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4]))-6.0*Apar[3]*BdriftY[4])+((-30.0*Apar[4]*BmagInv[4])-15.0*Apar[1]*BmagInv[1])*dfac_x-15.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*q_))/(dfac_v*q_); 
  alphaUp[5] = (0.7071067811865475*(Bmag[4]*(2.0*BmagInv[4]+2.23606797749979*BmagInv[0])+Bmag[1]*BmagInv[1])*dfac_x)/(dfac_m*q_); 
  alphaUp[7] = (0.006734350297014738*(dfac_v2*(210.0*BdriftY[4]*m_*wv2+3.872983346207417*q_*(2.23606797749979*(1.732050807568877*((42.0*BmagInv[1]*Apar[6]*dfac_x+14.0*BdriftY[1]*Apar[7])*wv-42.0*BmagInv[1]*Phi[6]*dfac_x)-21.0*BdriftY[0]*Apar[6]*wv)+((-105.0*BmagInv[4]*Apar[7]*dfac_x)-30.0*BdriftY[4]*Apar[6])*wv+105.0*BmagInv[4]*Phi[7]*dfac_x)+1.732050807568877*((((-105.0*Apar[1]*BmagInv[4])-210.0*BmagInv[1]*Apar[4])*dfac_x-105.0*Apar[2]*BdriftY[4])*q_*wv+dfac_x*((105.0*Bmag[1]*BmagInv[4]+210.0*BmagInv[1]*Bmag[4])*wm+(210.0*BmagInv[1]*Phi[4]+105.0*Phi[1]*BmagInv[4])*q_))+q_*((315.0*Apar[3]*BmagInv[4]*dfac_x+2.23606797749979*(BdriftY[4]*(105.0*Apar[5]+30.0*Apar[4])+BdriftY[1]*(42.0*Apar[1]-72.74613391789283*Apar[3]))+105.0*(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4]))*wv-315.0*Phi[3]*BmagInv[4]*dfac_x))+70.0*BdriftY[4]*m_))/(dfac_v2*q_); 
  alphaUp[8] = (0.421637021355784*BdriftY[0]*m_)/(dfac_v2*q_); 
  alphaUp[11] = -(0.00869400884928835*(2.23606797749979*((1.732050807568877*((21.0*Apar[1]*BmagInv[4]+42.0*BmagInv[1]*Apar[4])*dfac_x+21.0*Apar[2]*BdriftY[4])-63.0*Apar[3]*BmagInv[4]*dfac_x-21.0*(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4]))*q_-84.0*BdriftY[4]*m_*wv)+(3.872983346207417*(2.23606797749979*(21.0*BmagInv[4]*Apar[7]*dfac_x+6.0*BdriftY[4]*Apar[6])+1.732050807568877*((-42.0*BmagInv[1]*Apar[6]*dfac_x)-14.0*BdriftY[1]*Apar[7])+21.0*BdriftY[0]*Apar[6])+BdriftY[4]*((-105.0*Apar[5])-30.0*Apar[4])+BdriftY[1]*(72.74613391789283*Apar[3]-42.0*Apar[1]))*q_))/(dfac_v*q_); 
  alphaUp[12] = (0.4216370213557841*BdriftY[1]*m_)/(dfac_v2*q_); 
  alphaUp[13] = (0.7071067811865475*(Bmag[1]*BmagInv[4]+2.0*BmagInv[1]*Bmag[4])*dfac_x)/(dfac_m*q_); 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[12]+fl[12])+1.732050807568877*(fl[2]-1.0*fr[2])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[20]+fl[20])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[22]+fl[22])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[26]+fl[26])+3.0*(fl[9]-1.0*fr[9]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[33]+fl[33])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[6]+fl[6]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[36]+fl[36])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[38]+fl[38])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*(fr[19]-1.0*fl[19])-5.0*(fr[11]+fl[11])); 
  favg[8] = -0.1414213562373095*(8.660254037844387*(fr[24]-1.0*fl[24])-5.0*(fr[13]+fl[13])); 
  favg[9] = -0.1414213562373095*(8.660254037844387*(fr[29]-1.0*fl[29])-5.0*(fr[14]+fl[14])); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[45]+fl[45])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[17]+fl[17])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*(fr[32]-1.0*fl[32])-5.0*(fr[21]+fl[21])); 
  favg[12] = -0.1414213562373095*(8.660254037844387*(fr[34]-1.0*fl[34])-5.0*(fr[23]+fl[23])); 
  favg[13] = -0.1414213562373095*(8.660254037844387*(fr[35]-1.0*fl[35])-5.0*(fr[25]+fl[25])); 
  favg[14] = -0.1414213562373095*(8.660254037844387*(fr[40]-1.0*fl[40])-5.0*(fr[27]+fl[27])); 
  favg[15] = -0.1414213562373095*(8.660254037844387*(fr[41]-1.0*fl[41])-5.0*(fr[28]+fl[28])); 
  favg[16] = -0.1414213562373095*(8.660254037844387*(fr[43]-1.0*fl[43])-5.0*(fr[30]+fl[30])); 
  favg[17] = -0.1414213562373095*(8.660254037844387*(fr[44]-1.0*fl[44])-5.0*(fr[37]+fl[37])); 
  favg[18] = -0.1414213562373095*(8.660254037844387*(fr[46]-1.0*fl[46])-5.0*(fr[39]+fl[39])); 
  favg[19] = -0.1414213562373095*(8.660254037844387*(fr[47]-1.0*fl[47])-5.0*(fr[42]+fl[42])); 

//
// //
  Ghat[0] = -0.125*(1.414213562373095*((2.0*fr[0]-2.0*fl[0])*amax-1.0*(alpha[13]*favg[13]+alpha[12]*favg[12]+alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[3]*favg[3]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0]))+(3.16227766016838*(2.0*fr[12]-2.0*fl[12])-4.898979485566357*(fr[2]+fl[2]))*amax); 
  Ghat[1] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[20]-10.0*fr[20])*amax+2.0*(alpha[5]*favg[13]+favg[5]*alpha[13]+alpha[4]*favg[11]+favg[4]*alpha[11]))+5.477225575051662*(alpha[8]*favg[12]+favg[8]*alpha[12]))+1.414213562373095*((30.0*fl[1]-30.0*fr[1])*amax+15.0*(alpha[3]*favg[5]+favg[3]*alpha[5]+alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1]))+73.48469228349535*(fr[5]+fl[5])*amax+18.97366596101028*(alpha[1]*favg[7]+favg[1]*alpha[7])); 
  Ghat[2] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[22]-10.0*fr[22])*amax+2.0*(alpha[4]*favg[12]+favg[4]*alpha[12]))+5.477225575051662*(alpha[13]*favg[17]+alpha[7]*favg[11]+favg[7]*alpha[11]))+1.414213562373095*((30.0*fl[3]-30.0*fr[3])*amax+15.0*(alpha[5]*favg[10]+alpha[3]*favg[6]+alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2]))+73.48469228349535*(fr[7]+fl[7])*amax+18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])); 
  Ghat[3] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[26]-10.0*fr[26])*amax+2.0*alpha[5]*favg[15])+5.477225575051662*(alpha[12]*favg[18]+alpha[11]*favg[17]+alpha[8]*favg[14]+alpha[7]*favg[13]+favg[7]*alpha[13]))+1.414213562373095*((30.0*fl[4]-30.0*fr[4])*amax+15.0*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+favg[1]*alpha[5]+alpha[0]*favg[3]+favg[0]*alpha[3]))+73.48469228349535*(fr[9]+fl[9])*amax+18.97366596101028*alpha[3]*favg[9]); 
  Ghat[4] = 0.008333333333333333*(3.16227766016838*((30.0*fl[33]-30.0*fr[33])*amax+6.0*(alpha[5]*favg[17]+alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7]))+1.414213562373095*((30.0*fl[6]-30.0*fr[6])*amax+12.0*(alpha[11]*favg[12]+favg[11]*alpha[12])+15.0*(alpha[3]*favg[10]+alpha[5]*favg[6]+alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2]))+73.48469228349535*(fr[15]+fl[15])*amax+18.97366596101028*(favg[10]*alpha[13]+alpha[2]*favg[12]+favg[2]*alpha[12]+alpha[1]*favg[11]+favg[1]*alpha[11])); 
  Ghat[5] = 0.008333333333333333*(3.16227766016838*((30.0*fl[36]-30.0*fr[36])*amax+6.0*(alpha[4]*favg[17]+alpha[5]*(favg[9]+favg[7])+favg[5]*alpha[7]))+1.414213562373095*((30.0*fl[8]-30.0*fr[8])*amax+15.0*alpha[8]*favg[18]+12.0*alpha[13]*favg[15]+15.0*(alpha[12]*favg[14]+alpha[2]*favg[10]+alpha[4]*favg[6]+alpha[0]*favg[5]+favg[0]*alpha[5]+alpha[1]*favg[3]+favg[1]*alpha[3]))+73.48469228349535*(fr[16]+fl[16])*amax+18.97366596101028*(alpha[3]*favg[15]+alpha[1]*favg[13]+favg[1]*alpha[13]+favg[10]*alpha[11])); 
  Ghat[6] = 0.008333333333333333*(3.16227766016838*((30.0*fl[38]-30.0*fr[38])*amax+6.0*(alpha[5]*favg[19]+alpha[4]*favg[18]+favg[6]*alpha[8]))+1.414213562373095*((30.0*fl[10]-30.0*fr[10])*amax+15.0*(alpha[7]*favg[17]+alpha[11]*favg[13]+favg[11]*alpha[13]+alpha[1]*favg[10]+alpha[0]*favg[6]+alpha[4]*favg[5]+favg[4]*alpha[5]+alpha[2]*favg[3]+favg[2]*alpha[3]))+73.48469228349535*(fr[18]+fl[18])*amax+18.97366596101028*(alpha[3]*favg[16]+alpha[2]*favg[14]+favg[10]*alpha[12])); 
  Ghat[7] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[19]+fl[19])*amax+17.14642819948225*(alpha[3]*favg[13]+favg[3]*alpha[13]+alpha[2]*favg[11]+favg[2]*alpha[11]))+1.414213562373095*((210.0*fl[11]-210.0*fr[11])*amax+105.0*(alpha[0]*favg[7]+favg[0]*alpha[7]))+3.16227766016838*(30.0*alpha[13]*favg[13]+42.0*alpha[12]*favg[12]+30.0*(alpha[11]*favg[11]+alpha[7]*favg[7])+42.0*(alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[1]*favg[1]))); 
  Ghat[8] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[24]+fl[24])*amax+17.14642819948225*(alpha[3]*favg[14]+alpha[1]*favg[12]+favg[1]*alpha[12]))+1.414213562373095*((210.0*fl[13]-210.0*fr[13])*amax+105.0*(alpha[5]*favg[18]+alpha[0]*favg[8]+favg[0]*alpha[8]))+3.16227766016838*(30.0*alpha[12]*favg[12]+42.0*alpha[11]*favg[11]+30.0*alpha[8]*favg[8]+42.0*(alpha[4]*favg[4]+alpha[2]*favg[2]))); 
  Ghat[9] = 0.01863389981249824*(3.872983346207417*(8.485281374238571*(fr[29]+fl[29])*amax+2.449489742783178*(alpha[2]*favg[16]+alpha[1]*favg[15]))+3.16227766016838*((6.0*fl[14]-6.0*fr[14])*amax+3.0*(alpha[4]*favg[19]+alpha[0]*favg[9]))+8.485281374238571*(alpha[13]*favg[13]+alpha[5]*favg[5]+alpha[3]*favg[3])); 
  Ghat[10] = 0.002886751345948129*(3.872983346207417*(1.414213562373095*((50.0*fl[45]-50.0*fr[45])*amax+10.0*(alpha[5]*favg[16]+alpha[4]*(favg[14]+favg[13])+favg[4]*alpha[13]+favg[6]*alpha[12]+alpha[5]*favg[11]+favg[5]*alpha[11]))+12.64911064067352*(alpha[13]*favg[19]+alpha[11]*favg[18]+alpha[12]*favg[17]))+2.449489742783178*((50.0*fl[17]-50.0*fr[17])*amax+25.0*(alpha[0]*favg[10]+alpha[1]*favg[6]+alpha[2]*favg[5]+favg[2]*alpha[5]+alpha[3]*favg[4]+favg[3]*alpha[4]))+212.1320343559643*(fr[31]+fl[31])*amax+54.77225575051662*(alpha[3]*favg[19]+alpha[2]*favg[18]+alpha[1]*favg[17]+(alpha[8]+alpha[7])*favg[10])); 
  Ghat[11] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[32]+fl[32])*amax+17.14642819948225*(alpha[3]*favg[17]+alpha[2]*favg[7]+favg[2]*alpha[7]))+34.2928563989645*(alpha[5]*favg[10]+alpha[1]*favg[4]+favg[1]*alpha[4]))+1.414213562373095*((210.0*fl[21]-210.0*fr[21])*amax+105.0*favg[6]*alpha[13]+84.0*(alpha[4]*favg[12]+favg[4]*alpha[12])+105.0*(alpha[0]*favg[11]+favg[0]*alpha[11]))+3.16227766016838*(30.0*alpha[13]*favg[17]+(42.0*alpha[8]+30.0*alpha[7])*favg[11]+(42.0*favg[8]+30.0*favg[7])*alpha[11])); 
  Ghat[12] = 9.221388919541468e-4*(3.872983346207417*(1.414213562373095*((70.0*fl[23]-70.0*fr[23])*amax+35.0*(alpha[5]*favg[14]+alpha[0]*favg[12]+favg[0]*alpha[12])+28.0*(alpha[4]*favg[11]+favg[4]*alpha[11]))+3.16227766016838*(14.0*alpha[13]*favg[18]+(10.0*alpha[8]+14.0*alpha[7])*favg[12]+(10.0*favg[8]+14.0*favg[7])*alpha[12]))+2.23606797749979*(296.98484809835*(fr[34]+fl[34])*amax+85.73214099741124*(alpha[3]*favg[18]+alpha[1]*favg[8]+favg[1]*alpha[8]))+171.4642819948225*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[35]+fl[35])*amax+17.14642819948225*(alpha[2]*favg[17]+alpha[3]*favg[7]+favg[3]*alpha[7]))+34.2928563989645*(alpha[4]*favg[10]+alpha[1]*favg[5]+favg[1]*alpha[5]))+1.414213562373095*((210.0*fl[25]-210.0*fr[25])*amax+84.0*alpha[5]*favg[15]+105.0*(alpha[0]*favg[13]+favg[0]*alpha[13]+favg[6]*alpha[11]))+3.16227766016838*(42.0*alpha[12]*favg[18]+30.0*(alpha[11]*favg[17]+alpha[7]*favg[13])+(42.0*favg[9]+30.0*favg[7])*alpha[13])); 
  Ghat[14] = 0.001190476190476191*(3.872983346207417*(2.23606797749979*(59.39696961967*(fr[40]+fl[40])*amax+17.14642819948225*(alpha[1]*favg[18]+alpha[3]*favg[8]+favg[3]*alpha[8]))+34.2928563989645*(alpha[4]*favg[10]+alpha[2]*favg[6]))+1.414213562373095*((210.0*fl[27]-210.0*fr[27])*amax+105.0*(alpha[0]*favg[14]+alpha[5]*favg[12]+favg[5]*alpha[12]))+3.16227766016838*(30.0*alpha[12]*favg[18]+42.0*alpha[11]*favg[17]+30.0*alpha[8]*favg[14])); 
  Ghat[15] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[28]-10.0*fr[28])*amax+5.0*(alpha[4]*favg[16]+alpha[0]*favg[15])+4.0*(alpha[5]*favg[13]+favg[5]*alpha[13]))+6.324555320336759*(alpha[11]*favg[19]+alpha[7]*favg[15]))+2.23606797749979*(42.42640687119285*(fr[41]+fl[41])*amax+12.24744871391589*(alpha[2]*favg[19]+alpha[1]*favg[9]))+24.49489742783178*(alpha[3]*favg[5]+favg[3]*alpha[5])); 
  Ghat[16] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[30]-10.0*fr[30])*amax+5.0*(alpha[0]*favg[16]+alpha[4]*favg[15]))+6.324555320336759*(alpha[12]*favg[19]+alpha[13]*favg[17]+alpha[8]*favg[16]))+2.23606797749979*(42.42640687119285*(fr[43]+fl[43])*amax+12.24744871391589*(alpha[1]*favg[19]+alpha[2]*favg[9]))+24.49489742783178*(alpha[5]*favg[10]+alpha[3]*favg[6])); 
  Ghat[17] = 2.380952380952381e-4*(8.660254037844387*(296.98484809835*(fr[44]+fl[44])*amax+2.449489742783178*(35.0*(alpha[2]*favg[13]+favg[2]*alpha[13])+28.0*favg[10]*alpha[12]+35.0*(alpha[3]*favg[11]+favg[3]*alpha[11])))+1.414213562373095*((1050.0*fl[37]-1050.0*fr[37])*amax+420.0*(alpha[5]*favg[19]+alpha[4]*favg[18])+525.0*(alpha[0]*favg[17]+favg[6]*alpha[7]))+3.16227766016838*((210.0*alpha[8]+150.0*alpha[7])*favg[17]+210.0*(alpha[13]*favg[16]+alpha[11]*favg[14])+150.0*(alpha[11]*favg[13]+favg[11]*alpha[13])+210.0*(alpha[1]*favg[10]+alpha[4]*favg[5]+favg[4]*alpha[5]))); 
  Ghat[18] = 2.380952380952381e-4*(8.660254037844387*(296.98484809835*(fr[46]+fl[46])*amax+2.449489742783178*(35.0*(alpha[1]*favg[14]+alpha[3]*favg[12]+favg[3]*alpha[12])+28.0*favg[10]*alpha[11]))+1.414213562373095*((1050.0*fl[39]-1050.0*fr[39])*amax+525.0*alpha[0]*favg[18]+420.0*alpha[4]*favg[17]+525.0*(alpha[5]*favg[8]+favg[5]*alpha[8]))+3.16227766016838*((150.0*alpha[8]+210.0*alpha[7])*favg[18]+150.0*alpha[12]*favg[14]+210.0*(alpha[12]*favg[13]+favg[12]*alpha[13]+alpha[2]*favg[10]+alpha[4]*favg[6]))); 
  Ghat[19] = 0.001666666666666667*(8.660254037844387*(42.42640687119285*(fr[47]+fl[47])*amax+2.449489742783178*(5.0*(alpha[1]*favg[16]+alpha[2]*favg[15])+4.0*favg[10]*alpha[13]))+1.414213562373095*((150.0*fl[42]-150.0*fr[42])*amax+75.0*alpha[0]*favg[19]+60.0*alpha[5]*favg[17]+75.0*alpha[4]*favg[9])+94.86832980505139*((alpha[8]+alpha[7])*favg[19]+alpha[12]*favg[16]+alpha[11]*favg[15]+alpha[3]*favg[10]+alpha[5]*favg[6])); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_y; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_y; 
  incr[2] = -1.224744871391589*Ghat[0]*dfac_y; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_y; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_y; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_y; 
  incr[6] = 0.7071067811865475*Ghat[4]*dfac_y; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_y; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_y; 
  incr[9] = -1.224744871391589*Ghat[3]*dfac_y; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_y; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_y; 
  incr[12] = 1.58113883008419*Ghat[0]*dfac_y; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_y; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_y; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_y; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_y; 
  incr[17] = 0.7071067811865475*Ghat[10]*dfac_y; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_y; 
  incr[19] = -1.224744871391589*Ghat[7]*dfac_y; 
  incr[20] = 1.58113883008419*Ghat[1]*dfac_y; 
  incr[21] = 0.7071067811865475*Ghat[11]*dfac_y; 
  incr[22] = 1.58113883008419*Ghat[2]*dfac_y; 
  incr[23] = 0.7071067811865475*Ghat[12]*dfac_y; 
  incr[24] = -1.224744871391589*Ghat[8]*dfac_y; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_y; 
  incr[26] = 1.58113883008419*Ghat[3]*dfac_y; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_y; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_y; 
  incr[29] = -1.224744871391589*Ghat[9]*dfac_y; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_y; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_y; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_y; 
  incr[33] = 1.58113883008419*Ghat[4]*dfac_y; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_y; 
  incr[35] = -1.224744871391589*Ghat[13]*dfac_y; 
  incr[36] = 1.58113883008419*Ghat[5]*dfac_y; 
  incr[37] = 0.7071067811865475*Ghat[17]*dfac_y; 
  incr[38] = 1.58113883008419*Ghat[6]*dfac_y; 
  incr[39] = 0.7071067811865475*Ghat[18]*dfac_y; 
  incr[40] = -1.224744871391589*Ghat[14]*dfac_y; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_y; 
  incr[42] = 0.7071067811865475*Ghat[19]*dfac_y; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_y; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_y; 
  incr[45] = 1.58113883008419*Ghat[10]*dfac_y; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_y; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_y; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += -1.0*incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += -1.0*incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += -1.0*incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += -1.0*incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += -1.0*incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Vpar_P2_Bvars_1(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = -(0.001785714285714286*(3.872983346207417*q_*(15.65247584249853*(dfac_v*(dfac_y*(2.0*BdriftY[4]*Phi[6]*m_*wv+1.732050807568877*dfac_x*((Bmag[1]*BmagInv[4]+2.0*BmagInv[1]*Bmag[4])*Apar[6]*wm+((5.0*BmagInv[1]*Apar[5]-1.0*(Apar[1]*BmagInv[4]+2.0*BmagInv[1]*Apar[4]))*Phi[6]-1.0*(5.0*BmagInv[1]*Phi[5]-1.0*(2.0*BmagInv[1]*Phi[4]+Phi[1]*BmagInv[4]))*Apar[6])*q_))+((2.0*Apar[3]*BdriftY[4]*Phi[7]+(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4])*Phi[6])*dfac_y+(BdriftX[0]*Apar[5]*Phi[7]+BdriftX[4]*(2.0*Apar[3]*Phi[6]+Phi[3]*Apar[6]))*dfac_x)*q_)-2.0*BdriftY[4]*Phi[6]*dfac_y*m_)+dfac_v*((35.0*(1.732050807568877*BmagInv[1]*(Phi[3]*Apar[7]-1.0*Apar[3]*Phi[7])*dfac_x+(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[7])+2.0*(5.0*Apar[4]*BdriftY[4]+7.0*Apar[1]*BdriftY[1])*Phi[6]+35.0*BdriftY[4]*Phi[5]*Apar[6])*dfac_y+35.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[6]*dfac_x)*q_)+15.65247584249853*(1.732050807568877*(5.0*dfac_x*(2.0*BdriftX[1]*dfac_v*m_*(Bmag[4]*wm+Phi[4]*q_)*wv+Bmag[4]*((Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*dfac_v*q_-2.0*BdriftX[1]*m_)*wm)+q_*(dfac_v*((5.0*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])*Phi[5]+2.0*Phi[3]*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4]))*dfac_y+5.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[4]*dfac_x)*q_-10.0*BdriftX[1]*Phi[4]*dfac_x*m_))+15.0*dfac_v*dfac_x*dfac_y*q_*((BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]*wm-1.0*(2.0*BmagInv[4]*(Apar[6]*Phi[7]-1.0*Phi[6]*Apar[7])+BmagInv[0]*Apar[3]*Phi[5]-1.0*(BmagInv[0]*Phi[3]*Apar[5]+(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Phi[4])+(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[4])*q_))+35.0*(1.732050807568877*(2.0*dfac_v*m_*(BdriftX[0]*Bmag[1]*dfac_x*wm+((BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2])*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*q_)*wv+dfac_x*((2.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Bmag[4]+Bmag[1]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0]))*dfac_v*q_-2.0*BdriftX[0]*Bmag[1]*m_)*wm+q_*(dfac_v*((2.0*BdriftY[1]*Apar[6]*Phi[7]+Phi[2]*Apar[4]*BdriftY[4]+(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[3]+(Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0])*Phi[2])*dfac_y+(BdriftX[1]*Apar[7]*Phi[7]+2.0*(BdriftX[1]*Apar[6]*Phi[6]+(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Phi[4])+Phi[1]*Apar[4]*BdriftX[4]+(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[3]+(Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])*Phi[1])*dfac_x)*q_-2.0*((BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2])*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_))+dfac_v*q_*(3.0*(2.0*Apar[3]*Bmag[4]*BmagInv[4]+Bmag[1]*(BmagInv[1]*Apar[3]+BmagInv[0]*Apar[2]))*dfac_x*dfac_y*wm+(4.0*dApardt[0]-3.0*(5.0*BmagInv[0]*(Apar[6]*Phi[7]-1.0*Phi[6]*Apar[7])+2.0*BmagInv[4]*(Phi[3]*Apar[4]-1.0*Apar[3]*Phi[4])+BmagInv[1]*(Apar[1]*Phi[3]-1.0*Phi[1]*Apar[3])+BmagInv[0]*(Apar[1]*Phi[2]-1.0*Phi[1]*Apar[2]))*dfac_x*dfac_y)*q_))))/(dfac_v*m_*q_); 

  double alpha[20]; 
  alpha[0] = -(0.01010152544552211*(2.23606797749979*(1.732050807568877*(dfac_x*(70.0*BdriftX[1]*dfac_v*m_*(Bmag[4]*wm+Phi[4]*q_)*wv+Bmag[4]*(35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*dfac_v*q_-70.0*BdriftX[1]*m_)*wm-70.0*BdriftX[1]*Phi[4]*m_*q_)+dfac_v*((35.0*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])*Phi[5]+14.0*Phi[3]*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4]))*dfac_y+35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[4]*dfac_x)*q2)+dfac_v*dfac_x*dfac_y*(105.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]*q_*wm+(BmagInv[4]*(210.0*Phi[6]*Apar[7]-210.0*Apar[6]*Phi[7])-105.0*BmagInv[0]*Apar[3]*Phi[5]+105.0*(BmagInv[0]*Phi[3]*Apar[5]+(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Phi[4])-105.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[4])*q2))+3.872983346207417*(2.23606797749979*(dfac_y*(dfac_v*(14.0*BdriftY[4]*Phi[6]*m_*q_*wv+1.732050807568877*dfac_x*((7.0*Bmag[1]*BmagInv[4]+14.0*BmagInv[1]*Bmag[4])*Apar[6]*q_*wm+((35.0*BmagInv[1]*Apar[5]-7.0*Apar[1]*BmagInv[4]-14.0*BmagInv[1]*Apar[4])*Phi[6]+(BmagInv[1]*(14.0*Phi[4]-35.0*Phi[5])+7.0*Phi[1]*BmagInv[4])*Apar[6])*q2))-14.0*BdriftY[4]*Phi[6]*m_*q_)+dfac_v*((14.0*Apar[3]*BdriftY[4]*Phi[7]+7.0*(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4])*Phi[6])*dfac_y+(7.0*BdriftX[0]*Apar[5]*Phi[7]+BdriftX[4]*(14.0*Apar[3]*Phi[6]+7.0*Phi[3]*Apar[6]))*dfac_x)*q2)+dfac_v*((1.732050807568877*BmagInv[1]*(35.0*Phi[3]*Apar[7]-35.0*Apar[3]*Phi[7])*dfac_x+35.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[7]+(10.0*Apar[4]*BdriftY[4]+14.0*Apar[1]*BdriftY[1])*Phi[6]+35.0*BdriftY[4]*Phi[5]*Apar[6])*dfac_y+35.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[6]*dfac_x)*q2)+1.732050807568877*(70.0*dfac_v*m_*(BdriftX[0]*Bmag[1]*dfac_x*wm+((BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2])*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*q_)*wv+dfac_x*((70.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Bmag[4]+35.0*Bmag[1]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0]))*dfac_v*q_-70.0*BdriftX[0]*Bmag[1]*m_)*wm-70.0*((BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2])*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_*q_+dfac_v*((70.0*BdriftY[1]*Apar[6]*Phi[7]+35.0*(Phi[2]*Apar[4]*BdriftY[4]+(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[3]+(Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0])*Phi[2]))*dfac_y+(35.0*BdriftX[1]*Apar[7]*Phi[7]+70.0*(BdriftX[1]*Apar[6]*Phi[6]+(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Phi[4])+35.0*(Phi[1]*Apar[4]*BdriftX[4]+(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[3]+(Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])*Phi[1]))*dfac_x)*q2)+dfac_v*((210.0*Apar[3]*Bmag[4]*BmagInv[4]+105.0*Bmag[1]*(BmagInv[1]*Apar[3]+BmagInv[0]*Apar[2]))*dfac_x*dfac_y*q_*wm+((BmagInv[0]*(525.0*Phi[6]*Apar[7]-525.0*Apar[6]*Phi[7])+BmagInv[4]*(210.0*Apar[3]*Phi[4]-210.0*Phi[3]*Apar[4])+BmagInv[1]*(105.0*Phi[1]*Apar[3]-105.0*Apar[1]*Phi[3])+BmagInv[0]*(105.0*Phi[1]*Apar[2]-105.0*Apar[1]*Phi[2]))*dfac_x*dfac_y+140.0*dApardt[0])*q2)))/(dfac_v*m_*q_); 
  alpha[1] = -(0.01010152544552211*(2.23606797749979*(1.732050807568877*(dfac_v*m_*(70.0*BdriftX[0]*Bmag[4]*dfac_x*wm+(28.0*Phi[3]*BdriftY[4]*dfac_y+70.0*BdriftX[0]*Phi[4]*dfac_x)*q_)*wv+dfac_x*(((55.0*Apar[4]*BdriftX[4]+63.0*Apar[1]*BdriftX[1]+35.0*Apar[0]*BdriftX[0])*Bmag[4]+14.0*Bmag[1]*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*dfac_v*q_-70.0*BdriftX[0]*Bmag[4]*m_)*wm+((-28.0*Phi[3]*BdriftY[4]*dfac_y)-70.0*BdriftX[0]*Phi[4]*dfac_x)*m_*q_+dfac_v*((55.0*BdriftY[4]*Apar[6]*Phi[7]+35.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[5]+14.0*((Apar[0]*Phi[3]+Apar[1]*Phi[2])*BdriftY[4]+(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*Apar[4]))*dfac_y+(BdriftX[4]*(14.0*Apar[7]*Phi[7]+55.0*Apar[6]*Phi[6])+(55.0*Apar[4]*BdriftX[4]+63.0*Apar[1]*BdriftX[1]+35.0*Apar[0]*BdriftX[0])*Phi[4]+14.0*((Apar[3]*Phi[3]+Apar[1]*Phi[1])*BdriftX[4]+BdriftX[1]*Phi[1]*Apar[4]))*dfac_x)*q2)+dfac_v*dfac_x*dfac_y*((42.0*Bmag[1]*Apar[3]*BmagInv[4]+(189.0*BmagInv[1]*Apar[3]+105.0*BmagInv[0]*Apar[2])*Bmag[4])*q_*wm+(BmagInv[1]*(105.0*Phi[3]*Apar[5]-105.0*Apar[3]*Phi[5])+(189.0*BmagInv[1]*Apar[3]+105.0*BmagInv[0]*Apar[2])*Phi[4]+(42.0*Phi[1]*Apar[3]-42.0*Apar[1]*Phi[3])*BmagInv[4]+((-189.0*BmagInv[1]*Phi[3])-105.0*BmagInv[0]*Phi[2])*Apar[4])*q2))+1.732050807568877*(dfac_v*m_*((140.0*BdriftX[4]*Bmag[4]+70.0*BdriftX[1]*Bmag[1])*dfac_x*wm+(70.0*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*dfac_y+(140.0*BdriftX[4]*Phi[4]+70.0*BdriftX[1]*Phi[1])*dfac_x)*q_)*wv+dfac_x*((70.0*(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*Bmag[4]+35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Bmag[1])*dfac_v*q_+((-140.0*BdriftX[4]*Bmag[4])-70.0*BdriftX[1]*Bmag[1])*m_)*wm+(((-140.0*BdriftX[4]*Phi[4])-70.0*BdriftX[1]*Phi[1])*dfac_x-70.0*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*dfac_y)*m_*q_+dfac_v*((70.0*(BdriftY[0]*Apar[6]*Phi[7]+Apar[3]*BdriftY[4]*Phi[5])+Phi[3]*(55.0*Apar[4]*BdriftY[4]+63.0*Apar[1]*BdriftY[1]+35.0*Apar[0]*BdriftY[0])+35.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[2])*dfac_y+(35.0*BdriftX[0]*Apar[7]*Phi[7]+70.0*(BdriftX[0]*Apar[6]*Phi[6]+(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*Phi[4])+35.0*((BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[3]+(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[1]))*dfac_x)*q2)+3.872983346207417*(dfac_v*(28.0*BdriftY[1]*Phi[6]*dfac_y*m_*q_*wv+2.23606797749979*(1.732050807568877*dfac_x*dfac_y*(14.0*BmagInv[0]*Bmag[4]*Apar[6]*q_*wm+(BmagInv[4]*(14.0*Phi[3]*Apar[7]-14.0*Apar[3]*Phi[7])+BmagInv[0]*((35.0*Apar[5]-14.0*Apar[4])*Phi[6]+(14.0*Phi[4]-35.0*Phi[5])*Apar[6]))*q2)+((14.0*Apar[2]*BdriftY[4]*Phi[7]+11.0*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4])*Phi[6]+14.0*BdriftY[1]*Phi[5]*Apar[6])*dfac_y+(7.0*BdriftX[1]*Apar[5]*Phi[7]+14.0*Apar[2]*BdriftX[4]*Phi[6])*dfac_x)*q2))+dfac_y*(1.732050807568877*dfac_v*dfac_x*((55.0*Bmag[4]*BmagInv[4]+14.0*Bmag[1]*BmagInv[1])*Apar[6]*q_*wm+(BmagInv[0]*(35.0*Phi[3]*Apar[7]-35.0*Apar[3]*Phi[7])+(BmagInv[4]*(70.0*Apar[5]-55.0*Apar[4])-14.0*Apar[1]*BmagInv[1])*Phi[6]+(BmagInv[4]*(55.0*Phi[4]-70.0*Phi[5])+14.0*BmagInv[1]*Phi[1])*Apar[6])*q2)-28.0*BdriftY[1]*Phi[6]*m_*q_)+dfac_v*(((63.0*BdriftY[1]*Apar[3]+35.0*BdriftY[0]*Apar[2])*Phi[7]+14.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[6])*dfac_y+((63.0*BdriftX[1]*Apar[3]+35.0*BdriftX[0]*Apar[2])*Phi[6]+14.0*BdriftX[1]*Phi[3]*Apar[6])*dfac_x)*q2)+dfac_v*((210.0*Apar[2]*Bmag[4]*BmagInv[4]+105.0*Bmag[1]*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*dfac_x*dfac_y*q_*wm+((BmagInv[1]*(945.0*Phi[6]*Apar[7]-945.0*Apar[6]*Phi[7])+BmagInv[4]*(210.0*Apar[2]*Phi[4]-210.0*Phi[2]*Apar[4])+BmagInv[0]*(105.0*Phi[1]*Apar[3]-105.0*Apar[1]*Phi[3])+BmagInv[1]*(105.0*Phi[1]*Apar[2]-105.0*Apar[1]*Phi[2]))*dfac_x*dfac_y+140.0*dApardt[1])*q2)))/(dfac_v*m_*q_); 
  alpha[2] = -(0.01010152544552211*(2.23606797749979*(1.732050807568877*(dfac_v*(70.0*BdriftY[0]*Phi[5]*dfac_y*m_*wv+35.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Bmag[4]*dfac_x*wm+((BdriftY[4]*(28.0*Apar[7]*Phi[7]+10.0*Apar[6]*Phi[6])+35.0*(Apar[4]*BdriftY[4]+Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0])*Phi[5]+14.0*Apar[3]*Phi[3]*BdriftY[4])*dfac_y+(BdriftX[4]*(14.0*Apar[6]*Phi[7]+28.0*Phi[6]*Apar[7])+14.0*BdriftX[0]*Phi[3]*Apar[5]+35.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[4])*dfac_x)*q_)-70.0*BdriftY[0]*Phi[5]*dfac_y*m_)+BmagInv[0]*dfac_v*dfac_x*dfac_y*(105.0*Bmag[1]*Apar[5]*wm+(105.0*Phi[1]*Apar[5]-105.0*Apar[1]*Phi[5])*q_))+3.872983346207417*(dfac_v*(70.0*(BdriftY[1]*Phi[7]*dfac_y+BdriftX[1]*Phi[6]*dfac_x)*m_*wv+2.23606797749979*(dfac_x*(1.732050807568877*dfac_y*(35.0*BmagInv[0]*Bmag[4]*Apar[7]*wm+(BmagInv[0]*((14.0*Apar[5]-35.0*Apar[4])*Phi[7]+(35.0*Phi[4]-14.0*Phi[5])*Apar[7])+BmagInv[4]*(7.0*Apar[3]*Phi[6]-7.0*Phi[3]*Apar[6]))*q_)+(14.0*BdriftX[1]*Bmag[4]+7.0*Bmag[1]*BdriftX[4])*Apar[6]*wm)+((14.0*((BdriftY[1]*Apar[5]+Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4])*Phi[7]+BdriftY[1]*Phi[5]*Apar[7])+7.0*BdriftY[4]*(Apar[2]*Phi[6]+Phi[2]*Apar[6]))*dfac_y+(14.0*(BdriftX[1]*Apar[5]+Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Phi[6]+(14.0*BdriftX[1]*Phi[4]+7.0*Phi[1]*BdriftX[4])*Apar[6])*dfac_x)*q_)+1.732050807568877*dfac_x*dfac_y*((70.0*Bmag[4]*BmagInv[4]+35.0*Bmag[1]*BmagInv[1])*Apar[7]*wm+(((-70.0*Apar[4]*BmagInv[4])-35.0*Apar[1]*BmagInv[1])*Phi[7]+(70.0*BmagInv[4]*Phi[4]+35.0*BmagInv[1]*Phi[1])*Apar[7]+35.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Phi[6]-35.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[6])*q_)+((35.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[7]+14.0*BdriftY[1]*(Apar[3]*Phi[6]+Phi[3]*Apar[6]))*dfac_y+(14.0*((BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[7]+BdriftX[1]*Phi[3]*Apar[7])+35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[6])*dfac_x)*q_)-70.0*(BdriftY[1]*Phi[7]*dfac_y+BdriftX[1]*Phi[6]*dfac_x)*m_)+1.732050807568877*(dfac_v*(dfac_x*(70.0*BdriftX[0]*Phi[3]*m_*wv+(70.0*Apar[3]*BdriftX[4]*Bmag[4]+35.0*Bmag[1]*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2]))*wm)+((BdriftY[0]*(70.0*Apar[7]*Phi[7]+35.0*Apar[6]*Phi[6]+70.0*Apar[5]*Phi[5])+35.0*((BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[3]+Phi[2]*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])))*dfac_y+(70.0*(BdriftX[0]*Phi[6]*Apar[7]+Apar[3]*BdriftX[4]*Phi[4])+35.0*(Phi[3]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])+Phi[1]*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])))*dfac_x)*q_)-70.0*BdriftX[0]*Phi[3]*dfac_x*m_)+dfac_v*(525.0*BmagInv[1]*Bmag[4]*Apar[5]*dfac_x*dfac_y*wm+((BmagInv[1]*(525.0*Phi[4]*Apar[5]-525.0*Apar[4]*Phi[5])+BmagInv[0]*(105.0*Apar[2]*Phi[3]-105.0*Phi[2]*Apar[3]))*dfac_x*dfac_y+140.0*dApardt[2])*q_)))/(dfac_v*m_); 
  alpha[3] = -(0.07071067811865474*dfac_x*(2.23606797749979*Bmag[4]*(dfac_v*(10.0*BdriftX[1]*m_*wv+(8.660254037844386*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*dfac_y+5.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*q_)-10.0*BdriftX[1]*m_)+dfac_v*(10.0*BdriftX[0]*Bmag[1]*m_*wv+((8.660254037844387*(Bmag[1]*BmagInv[4]+2.0*BmagInv[1]*Bmag[4])*Apar[6]+1.732050807568877*(10.0*Apar[3]*Bmag[4]*BmagInv[4]+5.0*Bmag[1]*(BmagInv[1]*Apar[3]+BmagInv[0]*Apar[2])))*dfac_y+10.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Bmag[4]+5.0*Bmag[1]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0]))*q_)-10.0*BdriftX[0]*Bmag[1]*m_))/(dfac_m*dfac_v*m_*q_); 
  alpha[4] = -(0.002020305089104421*(3.872983346207417*(2.23606797749979*(dfac_v*(140.0*(BdriftY[4]*Phi[7]*dfac_y+BdriftX[4]*Phi[6]*dfac_x)*m_*wv+dfac_x*(1.732050807568877*dfac_y*((70.0*Bmag[1]*BmagInv[4]+315.0*BmagInv[1]*Bmag[4])*Apar[7]*wm+((70.0*BmagInv[1]*Apar[5]-70.0*Apar[1]*BmagInv[4]-315.0*BmagInv[1]*Apar[4])*Phi[7]+(BmagInv[1]*(315.0*Phi[4]-70.0*Phi[5])+70.0*Phi[1]*BmagInv[4])*Apar[7]+BmagInv[4]*(70.0*Apar[2]*Phi[6]-70.0*Phi[2]*Apar[6]))*q_)+70.0*BdriftX[0]*Bmag[4]*Apar[6]*wm)+((70.0*((BdriftY[0]*Apar[5]+Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4])*Phi[7]+BdriftY[0]*Phi[5]*Apar[7])+55.0*BdriftY[4]*(Apar[3]*Phi[6]+Phi[3]*Apar[6]))*dfac_y+(28.0*BdriftX[4]*(Apar[3]*Phi[7]+Phi[3]*Apar[7])+70.0*((BdriftX[0]*Apar[5]+Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*Phi[6]+BdriftX[0]*Phi[4]*Apar[6]))*dfac_x)*q_)-140.0*(BdriftY[4]*Phi[7]*dfac_y+BdriftX[4]*Phi[6]*dfac_x)*m_)+dfac_v*(350.0*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)*m_*wv+dfac_x*(1.732050807568877*dfac_y*(175.0*BmagInv[0]*Bmag[1]*Apar[7]*wm+(BmagInv[0]*(175.0*Phi[1]*Apar[7]-175.0*Apar[1]*Phi[7])+(245.0*BmagInv[1]*Apar[3]+175.0*BmagInv[0]*Apar[2])*Phi[6]+((-245.0*BmagInv[1]*Phi[3])-175.0*BmagInv[0]*Phi[2])*Apar[6])*q_)+(275.0*BdriftX[4]*Bmag[4]+70.0*BdriftX[1]*Bmag[1])*Apar[6]*wm)+(((BdriftY[4]*(140.0*Apar[5]+275.0*Apar[4])+315.0*Apar[1]*BdriftY[1]+175.0*Apar[0]*BdriftY[0])*Phi[7]+140.0*BdriftY[4]*Phi[5]*Apar[7]+70.0*((BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[6]+(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*Apar[6]))*dfac_y+(70.0*((BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[7]+BdriftX[0]*Phi[3]*Apar[7])+(BdriftX[4]*(140.0*Apar[5]+275.0*Apar[4])+315.0*Apar[1]*BdriftX[1]+175.0*Apar[0]*BdriftX[0])*Phi[6]+(275.0*BdriftX[4]*Phi[4]+70.0*BdriftX[1]*Phi[1])*Apar[6])*dfac_x)*q_)-350.0*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)*m_)+2.23606797749979*(1.732050807568877*(dfac_v*(350.0*BdriftY[1]*Phi[5]*dfac_y*m_*wv+((315.0*BdriftX[1]*Apar[3]+175.0*BdriftX[0]*Apar[2])*Bmag[4]+70.0*Bmag[1]*Apar[3]*BdriftX[4])*dfac_x*wm+((175.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[5]+70.0*(Apar[2]*Phi[3]+Phi[2]*Apar[3])*BdriftY[4])*dfac_y+(70.0*BdriftX[1]*Phi[3]*Apar[5]+(315.0*BdriftX[1]*Apar[3]+175.0*BdriftX[0]*Apar[2])*Phi[4]+70.0*((Apar[1]*Phi[3]+Phi[1]*Apar[3])*BdriftX[4]+BdriftX[1]*Phi[3]*Apar[4]))*dfac_x)*q_)-350.0*BdriftY[1]*Phi[5]*dfac_y*m_)+dfac_v*dfac_x*dfac_y*((1050.0*Bmag[4]*BmagInv[4]+525.0*Bmag[1]*BmagInv[1])*Apar[5]*wm+(((-1050.0*Apar[4]*BmagInv[4])-525.0*Apar[1]*BmagInv[1])*Phi[5]+(1050.0*BmagInv[4]*Phi[4]+525.0*BmagInv[1]*Phi[1])*Apar[5])*q_))+1.732050807568877*(dfac_v*(dfac_x*(350.0*BdriftX[1]*Phi[3]*m_*wv+(350.0*Apar[2]*BdriftX[4]*Bmag[4]+175.0*Bmag[1]*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*wm)+((BdriftY[1]*(630.0*Apar[7]*Phi[7]+275.0*Apar[6]*Phi[6])+350.0*(BdriftY[1]*Apar[5]+Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4])*Phi[5]+(315.0*BdriftY[1]*Apar[3]+175.0*BdriftY[0]*Apar[2])*Phi[3]+175.0*Phi[2]*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*dfac_y+(BdriftX[1]*(140.0*Apar[6]*Phi[7]+630.0*Phi[6]*Apar[7])+350.0*Apar[2]*BdriftX[4]*Phi[4]+175.0*((Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[3]+Phi[1]*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])))*dfac_x)*q_)-350.0*BdriftX[1]*Phi[3]*dfac_x*m_)+dfac_v*(2625.0*BmagInv[0]*Bmag[4]*Apar[5]*dfac_x*dfac_y*wm+((BmagInv[0]*(2625.0*Phi[4]*Apar[5]-2625.0*Apar[4]*Phi[5])+BmagInv[1]*(525.0*Apar[2]*Phi[3]-525.0*Phi[2]*Apar[3]))*dfac_x*dfac_y+700.0*dApardt[3])*q_)))/(dfac_v*m_); 
  alpha[5] = -(0.01010152544552211*dfac_x*(2.23606797749979*(dfac_v*(70.0*BdriftX[0]*Bmag[4]*m_*wv+(1.732050807568877*(14.0*Bmag[1]*Apar[3]*BmagInv[4]+(63.0*BmagInv[1]*Apar[3]+35.0*BmagInv[0]*Apar[2])*Bmag[4])*dfac_y+(55.0*Apar[4]*BdriftX[4]+63.0*Apar[1]*BdriftX[1]+35.0*Apar[0]*BdriftX[0])*Bmag[4]+14.0*Bmag[1]*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*q_)-70.0*BdriftX[0]*Bmag[4]*m_)+dfac_v*((140.0*BdriftX[4]*Bmag[4]+70.0*BdriftX[1]*Bmag[1])*m_*wv+((3.872983346207417*(Bmag[4]*(55.0*BmagInv[4]+31.30495168499706*BmagInv[0])+14.0*Bmag[1]*BmagInv[1])*Apar[6]+1.732050807568877*(70.0*Apar[2]*Bmag[4]*BmagInv[4]+35.0*Bmag[1]*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])))*dfac_y+70.0*(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*Bmag[4]+35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Bmag[1])*q_)+((-140.0*BdriftX[4]*Bmag[4])-70.0*BdriftX[1]*Bmag[1])*m_))/(dfac_m*dfac_v*m_*q_); 
  alpha[6] = -(0.02357022603955158*dfac_x*(3.872983346207417*(2.23606797749979*(15.0*BmagInv[0]*Bmag[4]*Apar[7]*dfac_y+1.732050807568877*(2.0*BdriftX[1]*Bmag[4]+Bmag[1]*BdriftX[4])*Apar[6])+(30.0*Bmag[4]*BmagInv[4]+15.0*Bmag[1]*BmagInv[1])*Apar[7]*dfac_y)+2.23606797749979*(25.98076211353316*BmagInv[0]*Bmag[1]*Apar[5]*dfac_y+15.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Bmag[4])+Bmag[4]*(129.9038105676658*BmagInv[1]*Apar[5]*dfac_y+30.0*Apar[3]*BdriftX[4])+15.0*Bmag[1]*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])))/(dfac_m*m_); 
  alpha[7] = -(0.01010152544552211*(3.872983346207417*(2.23606797749979*(dfac_y*(dfac_v*(14.0*BdriftY[0]*Phi[6]*m_*q_*wv+1.732050807568877*dfac_x*(7.0*BmagInv[0]*Bmag[1]*Apar[6]*q_*wm+(BmagInv[1]*(14.0*Phi[3]*Apar[7]-14.0*Apar[3]*Phi[7])+BmagInv[0]*(7.0*Phi[1]*Apar[6]-7.0*Apar[1]*Phi[6]))*q2))-14.0*BdriftY[0]*Phi[6]*m_*q_)+dfac_v*((14.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[7]+(15.0*Apar[4]*BdriftY[4]+11.0*Apar[1]*BdriftY[1]+7.0*Apar[0]*BdriftY[0])*Phi[6]+10.0*BdriftY[4]*Phi[5]*Apar[6])*dfac_y+(7.0*BdriftX[4]*Apar[5]*Phi[7]+14.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[6]+7.0*BdriftX[0]*Phi[3]*Apar[6])*dfac_x)*q2)+dfac_y*(dfac_v*(20.0*BdriftY[4]*Phi[6]*m_*q_*wv+1.732050807568877*dfac_x*((10.0*Bmag[1]*BmagInv[4]+55.0*BmagInv[1]*Bmag[4])*Apar[6]*q_*wm+((70.0*BmagInv[1]*Apar[5]-10.0*Apar[1]*BmagInv[4]-55.0*BmagInv[1]*Apar[4])*Phi[6]+(BmagInv[1]*(55.0*Phi[4]-70.0*Phi[5])+10.0*Phi[1]*BmagInv[4])*Apar[6])*q2))-20.0*BdriftY[4]*Phi[6]*m_*q_)+dfac_v*((55.0*Apar[3]*BdriftY[4]*Phi[7]+10.0*(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4])*Phi[6]+35.0*BdriftY[0]*Phi[5]*Apar[6])*dfac_y+BdriftX[4]*(55.0*Apar[3]*Phi[6]+10.0*Phi[3]*Apar[6])*dfac_x)*q2)+2.23606797749979*(1.732050807568877*(q_*(dfac_v*(28.0*BdriftY[1]*Phi[3]*dfac_y*m_*wv+(55.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Bmag[4]+Bmag[1]*(10.0*Apar[4]*BdriftX[4]+14.0*Apar[1]*BdriftX[1]))*dfac_x*wm)-28.0*BdriftY[1]*Phi[3]*dfac_y*m_)+dfac_v*((55.0*BdriftY[1]*Apar[6]*Phi[7]+BdriftY[4]*(35.0*Apar[2]*Phi[5]+10.0*Phi[2]*Apar[4])+14.0*((Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[3]+Apar[1]*BdriftY[1]*Phi[2]))*dfac_y+(14.0*BdriftX[1]*Apar[7]*Phi[7]+55.0*(BdriftX[1]*Apar[6]*Phi[6]+(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Phi[4])+10.0*Phi[1]*Apar[4]*BdriftX[4]+14.0*BdriftX[1]*(Apar[3]*Phi[3]+Apar[1]*Phi[1]))*dfac_x)*q2)+dfac_v*dfac_x*dfac_y*(Apar[3]*(165.0*Bmag[4]*BmagInv[4]+42.0*Bmag[1]*BmagInv[1])*q_*wm+(BmagInv[0]*(210.0*Phi[6]*Apar[7]-210.0*Apar[6]*Phi[7])+BmagInv[4]*((-105.0*Apar[3]*Phi[5])+105.0*Phi[3]*Apar[5]+165.0*Apar[3]*Phi[4]-165.0*Phi[3]*Apar[4])+BmagInv[1]*(42.0*Phi[1]*Apar[3]-42.0*Apar[1]*Phi[3]))*q2))+1.732050807568877*(dfac_v*m_*((140.0*BdriftX[1]*Bmag[4]+70.0*Bmag[1]*BdriftX[4])*dfac_x*wm+(70.0*Phi[2]*BdriftY[4]*dfac_y+(140.0*BdriftX[1]*Phi[4]+70.0*Phi[1]*BdriftX[4])*dfac_x)*q_)*wv+dfac_x*((70.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Bmag[4]+35.0*Bmag[1]*(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4]))*dfac_v*q_+((-140.0*BdriftX[1]*Bmag[4])-70.0*Bmag[1]*BdriftX[4])*m_)*wm+(((-140.0*BdriftX[1]*Phi[4])-70.0*Phi[1]*BdriftX[4])*dfac_x-70.0*Phi[2]*BdriftY[4]*dfac_y)*m_*q_+dfac_v*((70.0*BdriftY[1]*Apar[3]*Phi[5]+(55.0*Apar[1]*Phi[3]+35.0*Apar[0]*Phi[2])*BdriftY[4]+(55.0*BdriftY[1]*Phi[3]+35.0*BdriftY[0]*Phi[2])*Apar[4])*dfac_y+(70.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[4]+35.0*((Apar[2]*Phi[3]+Apar[0]*Phi[1])*BdriftX[4]+BdriftX[0]*Phi[1]*Apar[4]))*dfac_x)*q2)+dfac_v*((105.0*Bmag[1]*Apar[2]*BmagInv[4]+210.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4])*dfac_x*dfac_y*q_*wm+((BmagInv[4]*(825.0*Phi[6]*Apar[7]-825.0*Apar[6]*Phi[7])+210.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Phi[4]+(105.0*Phi[1]*Apar[2]-105.0*Apar[1]*Phi[2])*BmagInv[4]-210.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[4])*dfac_x*dfac_y+140.0*dApardt[4])*q2)))/(dfac_v*m_*q_); 
  alpha[8] = (0.01010152544552211*(3.872983346207417*(2.23606797749979*(dfac_v*(dfac_x*(((-14.0*BdriftX[4]*Bmag[4])-7.0*BdriftX[1]*Bmag[1])*Apar[7]*wm-14.0*BdriftX[0]*Phi[7]*m_*wv)+(((-14.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[7])-7.0*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*Apar[7]+BdriftY[4]*((-7.0*Apar[5]*Phi[6])-14.0*Phi[5]*Apar[6]))*dfac_y+((-7.0*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])*Phi[7])+((-14.0*BdriftX[4]*Phi[4])-7.0*BdriftX[1]*Phi[1])*Apar[7]-14.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[6])*dfac_x)*q_)+dfac_x*(1.732050807568877*((7.0*BmagInv[1]*Apar[3]-7.0*BmagInv[0]*Apar[2])*Phi[7]+(7.0*BmagInv[0]*Phi[2]-7.0*BmagInv[1]*Phi[3])*Apar[7])*dfac_v*dfac_y*q_+14.0*BdriftX[0]*Phi[7]*m_))+dfac_v*(((1.732050807568877*BmagInv[1]*(70.0*Phi[5]*Apar[6]-70.0*Apar[5]*Phi[6])*dfac_x+BdriftY[4]*((-28.0*Apar[3]*Phi[7])-14.0*Phi[3]*Apar[7]))*dfac_y+(BdriftX[0]*((-10.0*Apar[5]*Phi[7])-35.0*Phi[4]*Apar[7])+BdriftX[4]*((-28.0*Apar[3]*Phi[6])-14.0*Phi[3]*Apar[6]))*dfac_x)*q_-35.0*BdriftX[0]*Bmag[4]*Apar[7]*dfac_x*wm))+dfac_v*(2.23606797749979*(1.732050807568877*((BdriftY[1]*((-28.0*Apar[6]*Phi[7])-14.0*Phi[6]*Apar[7])*dfac_y+(BdriftX[1]*((-10.0*Apar[7]*Phi[7])-28.0*Apar[6]*Phi[6]-35.0*Phi[4]*Apar[5])-14.0*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[3])*dfac_x)*q_-35.0*BdriftX[1]*Bmag[4]*Apar[5]*dfac_x*wm)+BmagInv[0]*(210.0*Apar[6]*Phi[7]-210.0*Phi[6]*Apar[7])*dfac_x*dfac_y*q_)+1.732050807568877*((((-70.0*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])*Phi[5])-35.0*(BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2])*Apar[5])*dfac_y-35.0*BdriftX[0]*Phi[1]*Apar[5]*dfac_x)*q_-35.0*BdriftX[0]*Bmag[1]*Apar[5]*dfac_x*wm)+((BmagInv[4]*(315.0*Apar[6]*Phi[7]-315.0*Phi[6]*Apar[7])+BmagInv[0]*(210.0*Apar[3]*Phi[5]-210.0*Phi[3]*Apar[5]))*dfac_x*dfac_y-140.0*dApardt[5])*q_)))/(dfac_v*m_); 
  alpha[10] = -(0.003367175148507369*dfac_x*(3.872983346207417*(2.23606797749979*((42.0*Bmag[1]*BmagInv[4]+189.0*BmagInv[1]*Bmag[4])*Apar[7]*dfac_y+24.24871130596428*BdriftX[0]*Bmag[4]*Apar[6])+105.0*BmagInv[0]*Bmag[1]*Apar[7]*dfac_y+1.732050807568877*(55.0*BdriftX[4]*Bmag[4]+14.0*BdriftX[1]*Bmag[1])*Apar[6])+2.23606797749979*(1.732050807568877*(210.0*Bmag[4]*BmagInv[4]+105.0*Bmag[1]*BmagInv[1])*Apar[5]*dfac_y+(189.0*BdriftX[1]*Apar[3]+105.0*BdriftX[0]*Apar[2])*Bmag[4]+42.0*Bmag[1]*Apar[3]*BdriftX[4])+Bmag[4]*(909.3266739736605*BmagInv[0]*Apar[5]*dfac_y+210.0*Apar[2]*BdriftX[4])+105.0*Bmag[1]*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])))/(dfac_m*m_); 
  alpha[11] = -(0.01010152544552211*(3.872983346207417*(2.23606797749979*(dfac_v*(dfac_x*(14.0*Phi[3]*BdriftX[4]*m_*wv+(14.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Bmag[4]+7.0*Bmag[1]*Apar[2]*BdriftX[4])*wm)+((BdriftY[4]*(22.0*Apar[7]*Phi[7]+15.0*Apar[6]*Phi[6])+(BdriftY[4]*(14.0*Apar[5]+10.0*Apar[4])+14.0*Apar[1]*BdriftY[1])*Phi[5]+(11.0*Apar[3]*Phi[3]+7.0*Apar[2]*Phi[2])*BdriftY[4])*dfac_y+(BdriftX[4]*(4.0*Apar[6]*Phi[7]+22.0*Phi[6]*Apar[7])+14.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[4]+7.0*((Apar[0]*Phi[3]+Phi[1]*Apar[2])*BdriftX[4]+BdriftX[0]*Phi[3]*Apar[4]))*dfac_x)*q_)+dfac_x*(1.732050807568877*(7.0*Apar[2]*Phi[3]-7.0*Phi[2]*Apar[3])*BmagInv[4]*dfac_v*dfac_y*q_-14.0*Phi[3]*BdriftX[4]*m_))+dfac_v*(70.0*BdriftY[4]*Phi[5]*dfac_y*m_*wv+dfac_x*(1.732050807568877*dfac_y*((35.0*Bmag[1]*BmagInv[4]+70.0*BmagInv[1]*Bmag[4])*Apar[5]*wm+(((-35.0*Apar[1]*BmagInv[4])-70.0*BmagInv[1]*Apar[4])*Phi[5]+(70.0*BmagInv[1]*Phi[4]+35.0*Phi[1]*BmagInv[4])*Apar[5])*q_)+Apar[3]*(55.0*BdriftX[4]*Bmag[4]+14.0*BdriftX[1]*Bmag[1])*wm)+((BdriftY[0]*(28.0*Apar[7]*Phi[7]+10.0*Apar[6]*Phi[6])+35.0*(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4])*Phi[5]+14.0*((BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[3]+BdriftY[1]*Phi[2]*Apar[3]))*dfac_y+(BdriftX[0]*(14.0*Apar[6]*Phi[7]+28.0*Phi[6]*Apar[7])+BdriftX[4]*(14.0*Phi[3]*Apar[5]+55.0*Apar[3]*Phi[4]+10.0*Phi[3]*Apar[4])+14.0*BdriftX[1]*(Apar[1]*Phi[3]+Phi[1]*Apar[3]))*dfac_x)*q_)-70.0*BdriftY[4]*Phi[5]*dfac_y*m_)+1.732050807568877*(dfac_v*(140.0*(BdriftY[1]*Phi[7]*dfac_y+BdriftX[1]*Phi[6]*dfac_x)*m_*wv+35.0*BdriftX[0]*Bmag[1]*Apar[6]*dfac_x*wm+((70.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[7]+(55.0*BdriftY[1]*Apar[3]+35.0*BdriftY[0]*Apar[2])*Phi[6]+(55.0*BdriftY[1]*Phi[3]+35.0*BdriftY[0]*Phi[2])*Apar[6])*dfac_y+(28.0*BdriftX[1]*(Apar[3]*Phi[7]+Phi[3]*Apar[7])+70.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[6]+35.0*BdriftX[0]*Phi[1]*Apar[6])*dfac_x)*q_)-140.0*(BdriftY[1]*Phi[7]*dfac_y+BdriftX[1]*Phi[6]*dfac_x)*m_)+dfac_v*(2.23606797749979*(1.732050807568877*((55.0*BdriftX[1]*Bmag[4]+10.0*Bmag[1]*BdriftX[4])*Apar[6]*dfac_x*wm+(((28.0*BdriftY[1]*Apar[5]+55.0*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4]))*Phi[7]+28.0*BdriftY[1]*Phi[5]*Apar[7]+10.0*BdriftY[4]*(Apar[2]*Phi[6]+Phi[2]*Apar[6]))*dfac_y+(14.0*Apar[2]*BdriftX[4]*Phi[7]+(28.0*BdriftX[1]*Apar[5]+55.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*Phi[6]+(55.0*BdriftX[1]*Phi[4]+10.0*Phi[1]*BdriftX[4])*Apar[6])*dfac_x)*q_)+dfac_x*dfac_y*(210.0*BmagInv[0]*Bmag[4]*Apar[7]*wm+(BmagInv[0]*(210.0*Phi[4]*Apar[7]-210.0*Apar[4]*Phi[7])+BmagInv[4]*(135.0*Apar[3]*Phi[6]-135.0*Phi[3]*Apar[6]))*q_))+(825.0*Bmag[4]*BmagInv[4]+210.0*Bmag[1]*BmagInv[1])*Apar[7]*dfac_x*dfac_y*wm+(((BmagInv[4]*(210.0*Apar[5]-825.0*Apar[4])-210.0*Apar[1]*BmagInv[1])*Phi[7]+(BmagInv[4]*(825.0*Phi[4]-210.0*Phi[5])+210.0*BmagInv[1]*Phi[1])*Apar[7]+(105.0*BmagInv[0]*Apar[3]+210.0*BmagInv[1]*Apar[2])*Phi[6]+((-105.0*BmagInv[0]*Phi[3])-210.0*BmagInv[1]*Phi[2])*Apar[6])*dfac_x*dfac_y+140.0*dApardt[6])*q_)))/(dfac_v*m_); 
  alpha[12] = (0.002020305089104421*(1.732050807568877*(dfac_v*(dfac_x*((-350.0*BdriftX[1]*Phi[7]*m_*wv)-175.0*BdriftX[0]*Bmag[1]*Apar[7]*wm)+((((-630.0*BdriftY[1]*Apar[3])-350.0*BdriftY[0]*Apar[2])*Phi[7]+((-315.0*BdriftY[1]*Phi[3])-175.0*BdriftY[0]*Phi[2])*Apar[7])*dfac_y+((-175.0*((Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[7]+BdriftX[0]*Phi[1]*Apar[7]))+((-630.0*BdriftX[1]*Apar[3])-350.0*BdriftX[0]*Apar[2])*Phi[6]-140.0*BdriftX[1]*Phi[3]*Apar[6])*dfac_x)*q_)+350.0*BdriftX[1]*Phi[7]*dfac_x*m_)+dfac_v*(2.23606797749979*(1.732050807568877*(((-315.0*BdriftX[1]*Bmag[4])-70.0*Bmag[1]*BdriftX[4])*Apar[7]*dfac_x*wm+((BdriftY[4]*((-140.0*Apar[2]*Phi[7])-70.0*Phi[2]*Apar[7])+BdriftY[1]*((-70.0*Apar[5]*Phi[6])-140.0*Phi[5]*Apar[6]))*dfac_y+(((-50.0*BdriftX[1]*Apar[5])-70.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*Phi[7]+((-315.0*BdriftX[1]*Phi[4])-70.0*Phi[1]*BdriftX[4])*Apar[7]-140.0*Apar[2]*BdriftX[4]*Phi[6])*dfac_x)*q_)+(BmagInv[4]*(210.0*Apar[3]*Phi[7]-210.0*Phi[3]*Apar[7])+BmagInv[0]*(1050.0*Phi[5]*Apar[6]-1050.0*Apar[5]*Phi[6]))*dfac_x*dfac_y*q_)+3.872983346207417*(2.23606797749979*(((-70.0*BdriftX[4]*Bmag[4])-35.0*BdriftX[1]*Bmag[1])*Apar[5]*dfac_x*wm+((1.732050807568877*BmagInv[1]*(70.0*Apar[3]*Phi[5]-70.0*Phi[3]*Apar[5])*dfac_x+BdriftY[4]*((-110.0*Apar[6]*Phi[7])-55.0*Phi[6]*Apar[7])-70.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[5]-35.0*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*Apar[5])*dfac_y+(BdriftX[4]*((-20.0*Apar[7]*Phi[7])-110.0*Apar[6]*Phi[6])+((-70.0*BdriftX[4]*Phi[4])-35.0*BdriftX[1]*Phi[1])*Apar[5]-28.0*Apar[3]*Phi[3]*BdriftX[4])*dfac_x)*q_)-175.0*BdriftX[0]*Bmag[4]*Apar[5]*dfac_x*wm+((1.732050807568877*BmagInv[1]*(560.0*Apar[6]*Phi[7]-560.0*Phi[6]*Apar[7])*dfac_x+BdriftY[0]*((-140.0*Apar[6]*Phi[7])-70.0*Phi[6]*Apar[7])+BdriftY[4]*((-140.0*Apar[3]*Phi[5])-70.0*Phi[3]*Apar[5]))*dfac_y+(BdriftX[0]*((-50.0*Apar[7]*Phi[7])-140.0*Apar[6]*Phi[6]-175.0*Phi[4]*Apar[5])-70.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[3])*dfac_x)*q_)+(((525.0*BmagInv[0]*Apar[3]-525.0*BmagInv[1]*Apar[2])*Phi[7]+(525.0*BmagInv[1]*Phi[2]-525.0*BmagInv[0]*Phi[3])*Apar[7]+BmagInv[4]*(2100.0*Phi[5]*Apar[6]-2100.0*Apar[5]*Phi[6]))*dfac_x*dfac_y-700.0*dApardt[7])*q_)))/(dfac_v*m_); 
  alpha[13] = -(0.003367175148507369*dfac_x*(3.872983346207417*(2.23606797749979*(1.732050807568877*(dfac_v*((28.0*BdriftX[1]*Bmag[4]+14.0*Bmag[1]*BdriftX[4])*m_*wv+(14.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Bmag[4]+7.0*Bmag[1]*(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4]))*q_)+((-28.0*BdriftX[1]*Bmag[4])-14.0*Bmag[1]*BdriftX[4])*m_)+(21.0*Bmag[1]*Apar[2]*BmagInv[4]+42.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4])*dfac_v*dfac_y*q_)+dfac_v*(Apar[3]*(165.0*Bmag[4]*BmagInv[4]+42.0*Bmag[1]*BmagInv[1])*dfac_y+1.732050807568877*(55.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Bmag[4]+Bmag[1]*(10.0*Apar[4]*BdriftX[4]+14.0*Apar[1]*BdriftX[1])))*q_)+(3.872983346207417*(30.0*Bmag[1]*BmagInv[4]+165.0*BmagInv[1]*Bmag[4])+181.8653347947321*BmagInv[0]*Bmag[1])*Apar[6]*dfac_v*dfac_y*q_))/(dfac_m*dfac_v*m_*q_); 
  alpha[14] = -(0.02357022603955158*(((30.0*BdriftX[4]+33.54101966249685*BdriftX[0])*Bmag[4]+15.0*BdriftX[1]*Bmag[1])*Apar[7]+3.872983346207417*(8.660254037844386*BdriftX[1]*Bmag[4]+3.872983346207417*BdriftX[0]*Bmag[1])*Apar[5])*dfac_x)/(dfac_m*m_); 
  alpha[17] = -(0.003367175148507369*dfac_x*(3.872983346207417*(2.23606797749979*((165.0*Bmag[4]*BmagInv[4]+42.0*Bmag[1]*BmagInv[1])*Apar[7]*dfac_y+12.12435565298214*BdriftX[0]*Bmag[1]*Apar[6])+210.0*BmagInv[0]*Bmag[4]*Apar[7]*dfac_y+1.732050807568877*(55.0*BdriftX[1]*Bmag[4]+10.0*Bmag[1]*BdriftX[4])*Apar[6])+2.23606797749979*(1.732050807568877*(105.0*Bmag[1]*BmagInv[4]+210.0*BmagInv[1]*Bmag[4])*Apar[5]*dfac_y+Apar[3]*(165.0*BdriftX[4]*Bmag[4]+42.0*BdriftX[1]*Bmag[1]))+210.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Bmag[4]+105.0*Bmag[1]*Apar[2]*BdriftX[4]))/(dfac_m*m_); 
  alpha[18] = -(0.02357022603955158*(3.872983346207417*(1.732050807568877*(9.0*BdriftX[1]*Bmag[4]+2.0*Bmag[1]*BdriftX[4])+3.872983346207417*BdriftX[0]*Bmag[1])*Apar[7]+((30.0*BdriftX[4]+33.54101966249685*BdriftX[0])*Bmag[4]+15.0*BdriftX[1]*Bmag[1])*Apar[5])*dfac_x)/(dfac_m*m_); 
  double alphaUp[20]; 
  alphaUp[0] = -(0.01010152544552211*(2.23606797749979*(1.732050807568877*(dfac_x*(70.0*BdriftX[1]*dfac_v*m_*(Bmag[4]*wm+Phi[4]*q_)*wv+Bmag[4]*(35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*dfac_v*q_-70.0*BdriftX[1]*m_)*wm-70.0*BdriftX[1]*Phi[4]*m_*q_)+dfac_v*((35.0*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])*Phi[5]+14.0*Phi[3]*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4]))*dfac_y+35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[4]*dfac_x)*q2)+dfac_v*dfac_x*dfac_y*(105.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]*q_*wm+(BmagInv[4]*(210.0*Phi[6]*Apar[7]-210.0*Apar[6]*Phi[7])-105.0*BmagInv[0]*Apar[3]*Phi[5]+105.0*(BmagInv[0]*Phi[3]*Apar[5]+(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Phi[4])-105.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[4])*q2))+3.872983346207417*(2.23606797749979*(dfac_y*(dfac_v*(14.0*BdriftY[4]*Phi[6]*m_*q_*wv+1.732050807568877*dfac_x*((7.0*Bmag[1]*BmagInv[4]+14.0*BmagInv[1]*Bmag[4])*Apar[6]*q_*wm+((35.0*BmagInv[1]*Apar[5]-7.0*Apar[1]*BmagInv[4]-14.0*BmagInv[1]*Apar[4])*Phi[6]+(BmagInv[1]*(14.0*Phi[4]-35.0*Phi[5])+7.0*Phi[1]*BmagInv[4])*Apar[6])*q2))-14.0*BdriftY[4]*Phi[6]*m_*q_)+dfac_v*((14.0*Apar[3]*BdriftY[4]*Phi[7]+7.0*(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4])*Phi[6])*dfac_y+(7.0*BdriftX[0]*Apar[5]*Phi[7]+BdriftX[4]*(14.0*Apar[3]*Phi[6]+7.0*Phi[3]*Apar[6]))*dfac_x)*q2)+dfac_v*((1.732050807568877*BmagInv[1]*(35.0*Phi[3]*Apar[7]-35.0*Apar[3]*Phi[7])*dfac_x+35.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[7]+(10.0*Apar[4]*BdriftY[4]+14.0*Apar[1]*BdriftY[1])*Phi[6]+35.0*BdriftY[4]*Phi[5]*Apar[6])*dfac_y+35.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[6]*dfac_x)*q2)+1.732050807568877*(70.0*dfac_v*m_*(BdriftX[0]*Bmag[1]*dfac_x*wm+((BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2])*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*q_)*wv+dfac_x*((70.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Bmag[4]+35.0*Bmag[1]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0]))*dfac_v*q_-70.0*BdriftX[0]*Bmag[1]*m_)*wm-70.0*((BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2])*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_*q_+dfac_v*((70.0*BdriftY[1]*Apar[6]*Phi[7]+35.0*(Phi[2]*Apar[4]*BdriftY[4]+(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[3]+(Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0])*Phi[2]))*dfac_y+(35.0*BdriftX[1]*Apar[7]*Phi[7]+70.0*(BdriftX[1]*Apar[6]*Phi[6]+(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Phi[4])+35.0*(Phi[1]*Apar[4]*BdriftX[4]+(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[3]+(Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])*Phi[1]))*dfac_x)*q2)+dfac_v*((210.0*Apar[3]*Bmag[4]*BmagInv[4]+105.0*Bmag[1]*(BmagInv[1]*Apar[3]+BmagInv[0]*Apar[2]))*dfac_x*dfac_y*q_*wm+((BmagInv[0]*(525.0*Phi[6]*Apar[7]-525.0*Apar[6]*Phi[7])+BmagInv[4]*(210.0*Apar[3]*Phi[4]-210.0*Phi[3]*Apar[4])+BmagInv[1]*(105.0*Phi[1]*Apar[3]-105.0*Apar[1]*Phi[3])+BmagInv[0]*(105.0*Phi[1]*Apar[2]-105.0*Apar[1]*Phi[2]))*dfac_x*dfac_y+140.0*dApardt[0])*q2)))/(dfac_v*m_*q_); 
  alphaUp[1] = -(0.01010152544552211*(2.23606797749979*(1.732050807568877*(dfac_v*m_*(70.0*BdriftX[0]*Bmag[4]*dfac_x*wm+(28.0*Phi[3]*BdriftY[4]*dfac_y+70.0*BdriftX[0]*Phi[4]*dfac_x)*q_)*wv+dfac_x*(((55.0*Apar[4]*BdriftX[4]+63.0*Apar[1]*BdriftX[1]+35.0*Apar[0]*BdriftX[0])*Bmag[4]+14.0*Bmag[1]*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*dfac_v*q_-70.0*BdriftX[0]*Bmag[4]*m_)*wm+((-28.0*Phi[3]*BdriftY[4]*dfac_y)-70.0*BdriftX[0]*Phi[4]*dfac_x)*m_*q_+dfac_v*((55.0*BdriftY[4]*Apar[6]*Phi[7]+35.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[5]+14.0*((Apar[0]*Phi[3]+Apar[1]*Phi[2])*BdriftY[4]+(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*Apar[4]))*dfac_y+(BdriftX[4]*(14.0*Apar[7]*Phi[7]+55.0*Apar[6]*Phi[6])+(55.0*Apar[4]*BdriftX[4]+63.0*Apar[1]*BdriftX[1]+35.0*Apar[0]*BdriftX[0])*Phi[4]+14.0*((Apar[3]*Phi[3]+Apar[1]*Phi[1])*BdriftX[4]+BdriftX[1]*Phi[1]*Apar[4]))*dfac_x)*q2)+dfac_v*dfac_x*dfac_y*((42.0*Bmag[1]*Apar[3]*BmagInv[4]+(189.0*BmagInv[1]*Apar[3]+105.0*BmagInv[0]*Apar[2])*Bmag[4])*q_*wm+(BmagInv[1]*(105.0*Phi[3]*Apar[5]-105.0*Apar[3]*Phi[5])+(189.0*BmagInv[1]*Apar[3]+105.0*BmagInv[0]*Apar[2])*Phi[4]+(42.0*Phi[1]*Apar[3]-42.0*Apar[1]*Phi[3])*BmagInv[4]+((-189.0*BmagInv[1]*Phi[3])-105.0*BmagInv[0]*Phi[2])*Apar[4])*q2))+1.732050807568877*(dfac_v*m_*((140.0*BdriftX[4]*Bmag[4]+70.0*BdriftX[1]*Bmag[1])*dfac_x*wm+(70.0*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*dfac_y+(140.0*BdriftX[4]*Phi[4]+70.0*BdriftX[1]*Phi[1])*dfac_x)*q_)*wv+dfac_x*((70.0*(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*Bmag[4]+35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Bmag[1])*dfac_v*q_+((-140.0*BdriftX[4]*Bmag[4])-70.0*BdriftX[1]*Bmag[1])*m_)*wm+(((-140.0*BdriftX[4]*Phi[4])-70.0*BdriftX[1]*Phi[1])*dfac_x-70.0*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*dfac_y)*m_*q_+dfac_v*((70.0*(BdriftY[0]*Apar[6]*Phi[7]+Apar[3]*BdriftY[4]*Phi[5])+Phi[3]*(55.0*Apar[4]*BdriftY[4]+63.0*Apar[1]*BdriftY[1]+35.0*Apar[0]*BdriftY[0])+35.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[2])*dfac_y+(35.0*BdriftX[0]*Apar[7]*Phi[7]+70.0*(BdriftX[0]*Apar[6]*Phi[6]+(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*Phi[4])+35.0*((BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[3]+(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[1]))*dfac_x)*q2)+3.872983346207417*(dfac_v*(28.0*BdriftY[1]*Phi[6]*dfac_y*m_*q_*wv+2.23606797749979*(1.732050807568877*dfac_x*dfac_y*(14.0*BmagInv[0]*Bmag[4]*Apar[6]*q_*wm+(BmagInv[4]*(14.0*Phi[3]*Apar[7]-14.0*Apar[3]*Phi[7])+BmagInv[0]*((35.0*Apar[5]-14.0*Apar[4])*Phi[6]+(14.0*Phi[4]-35.0*Phi[5])*Apar[6]))*q2)+((14.0*Apar[2]*BdriftY[4]*Phi[7]+11.0*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4])*Phi[6]+14.0*BdriftY[1]*Phi[5]*Apar[6])*dfac_y+(7.0*BdriftX[1]*Apar[5]*Phi[7]+14.0*Apar[2]*BdriftX[4]*Phi[6])*dfac_x)*q2))+dfac_y*(1.732050807568877*dfac_v*dfac_x*((55.0*Bmag[4]*BmagInv[4]+14.0*Bmag[1]*BmagInv[1])*Apar[6]*q_*wm+(BmagInv[0]*(35.0*Phi[3]*Apar[7]-35.0*Apar[3]*Phi[7])+(BmagInv[4]*(70.0*Apar[5]-55.0*Apar[4])-14.0*Apar[1]*BmagInv[1])*Phi[6]+(BmagInv[4]*(55.0*Phi[4]-70.0*Phi[5])+14.0*BmagInv[1]*Phi[1])*Apar[6])*q2)-28.0*BdriftY[1]*Phi[6]*m_*q_)+dfac_v*(((63.0*BdriftY[1]*Apar[3]+35.0*BdriftY[0]*Apar[2])*Phi[7]+14.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[6])*dfac_y+((63.0*BdriftX[1]*Apar[3]+35.0*BdriftX[0]*Apar[2])*Phi[6]+14.0*BdriftX[1]*Phi[3]*Apar[6])*dfac_x)*q2)+dfac_v*((210.0*Apar[2]*Bmag[4]*BmagInv[4]+105.0*Bmag[1]*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*dfac_x*dfac_y*q_*wm+((BmagInv[1]*(945.0*Phi[6]*Apar[7]-945.0*Apar[6]*Phi[7])+BmagInv[4]*(210.0*Apar[2]*Phi[4]-210.0*Phi[2]*Apar[4])+BmagInv[0]*(105.0*Phi[1]*Apar[3]-105.0*Apar[1]*Phi[3])+BmagInv[1]*(105.0*Phi[1]*Apar[2]-105.0*Apar[1]*Phi[2]))*dfac_x*dfac_y+140.0*dApardt[1])*q2)))/(dfac_v*m_*q_); 
  alphaUp[2] = -(0.01010152544552211*(2.23606797749979*(1.732050807568877*(dfac_v*(70.0*BdriftY[0]*Phi[5]*dfac_y*m_*wv+35.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Bmag[4]*dfac_x*wm+((BdriftY[4]*(28.0*Apar[7]*Phi[7]+10.0*Apar[6]*Phi[6])+35.0*(Apar[4]*BdriftY[4]+Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0])*Phi[5]+14.0*Apar[3]*Phi[3]*BdriftY[4])*dfac_y+(BdriftX[4]*(14.0*Apar[6]*Phi[7]+28.0*Phi[6]*Apar[7])+14.0*BdriftX[0]*Phi[3]*Apar[5]+35.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[4])*dfac_x)*q_)-70.0*BdriftY[0]*Phi[5]*dfac_y*m_)+BmagInv[0]*dfac_v*dfac_x*dfac_y*(105.0*Bmag[1]*Apar[5]*wm+(105.0*Phi[1]*Apar[5]-105.0*Apar[1]*Phi[5])*q_))+3.872983346207417*(dfac_v*(70.0*(BdriftY[1]*Phi[7]*dfac_y+BdriftX[1]*Phi[6]*dfac_x)*m_*wv+2.23606797749979*(dfac_x*(1.732050807568877*dfac_y*(35.0*BmagInv[0]*Bmag[4]*Apar[7]*wm+(BmagInv[0]*((14.0*Apar[5]-35.0*Apar[4])*Phi[7]+(35.0*Phi[4]-14.0*Phi[5])*Apar[7])+BmagInv[4]*(7.0*Apar[3]*Phi[6]-7.0*Phi[3]*Apar[6]))*q_)+(14.0*BdriftX[1]*Bmag[4]+7.0*Bmag[1]*BdriftX[4])*Apar[6]*wm)+((14.0*((BdriftY[1]*Apar[5]+Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4])*Phi[7]+BdriftY[1]*Phi[5]*Apar[7])+7.0*BdriftY[4]*(Apar[2]*Phi[6]+Phi[2]*Apar[6]))*dfac_y+(14.0*(BdriftX[1]*Apar[5]+Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Phi[6]+(14.0*BdriftX[1]*Phi[4]+7.0*Phi[1]*BdriftX[4])*Apar[6])*dfac_x)*q_)+1.732050807568877*dfac_x*dfac_y*((70.0*Bmag[4]*BmagInv[4]+35.0*Bmag[1]*BmagInv[1])*Apar[7]*wm+(((-70.0*Apar[4]*BmagInv[4])-35.0*Apar[1]*BmagInv[1])*Phi[7]+(70.0*BmagInv[4]*Phi[4]+35.0*BmagInv[1]*Phi[1])*Apar[7]+35.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Phi[6]-35.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[6])*q_)+((35.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[7]+14.0*BdriftY[1]*(Apar[3]*Phi[6]+Phi[3]*Apar[6]))*dfac_y+(14.0*((BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[7]+BdriftX[1]*Phi[3]*Apar[7])+35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[6])*dfac_x)*q_)-70.0*(BdriftY[1]*Phi[7]*dfac_y+BdriftX[1]*Phi[6]*dfac_x)*m_)+1.732050807568877*(dfac_v*(dfac_x*(70.0*BdriftX[0]*Phi[3]*m_*wv+(70.0*Apar[3]*BdriftX[4]*Bmag[4]+35.0*Bmag[1]*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2]))*wm)+((BdriftY[0]*(70.0*Apar[7]*Phi[7]+35.0*Apar[6]*Phi[6]+70.0*Apar[5]*Phi[5])+35.0*((BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[3]+Phi[2]*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])))*dfac_y+(70.0*(BdriftX[0]*Phi[6]*Apar[7]+Apar[3]*BdriftX[4]*Phi[4])+35.0*(Phi[3]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])+Phi[1]*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])))*dfac_x)*q_)-70.0*BdriftX[0]*Phi[3]*dfac_x*m_)+dfac_v*(525.0*BmagInv[1]*Bmag[4]*Apar[5]*dfac_x*dfac_y*wm+((BmagInv[1]*(525.0*Phi[4]*Apar[5]-525.0*Apar[4]*Phi[5])+BmagInv[0]*(105.0*Apar[2]*Phi[3]-105.0*Phi[2]*Apar[3]))*dfac_x*dfac_y+140.0*dApardt[2])*q_)))/(dfac_v*m_); 
  alphaUp[3] = -(0.07071067811865474*dfac_x*(2.23606797749979*Bmag[4]*(dfac_v*(10.0*BdriftX[1]*m_*wv+(8.660254037844386*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*dfac_y+5.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*q_)-10.0*BdriftX[1]*m_)+dfac_v*(10.0*BdriftX[0]*Bmag[1]*m_*wv+((8.660254037844387*(Bmag[1]*BmagInv[4]+2.0*BmagInv[1]*Bmag[4])*Apar[6]+1.732050807568877*(10.0*Apar[3]*Bmag[4]*BmagInv[4]+5.0*Bmag[1]*(BmagInv[1]*Apar[3]+BmagInv[0]*Apar[2])))*dfac_y+10.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Bmag[4]+5.0*Bmag[1]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0]))*q_)-10.0*BdriftX[0]*Bmag[1]*m_))/(dfac_m*dfac_v*m_*q_); 
  alphaUp[4] = -(0.002020305089104421*(3.872983346207417*(2.23606797749979*(dfac_v*(140.0*(BdriftY[4]*Phi[7]*dfac_y+BdriftX[4]*Phi[6]*dfac_x)*m_*wv+dfac_x*(1.732050807568877*dfac_y*((70.0*Bmag[1]*BmagInv[4]+315.0*BmagInv[1]*Bmag[4])*Apar[7]*wm+((70.0*BmagInv[1]*Apar[5]-70.0*Apar[1]*BmagInv[4]-315.0*BmagInv[1]*Apar[4])*Phi[7]+(BmagInv[1]*(315.0*Phi[4]-70.0*Phi[5])+70.0*Phi[1]*BmagInv[4])*Apar[7]+BmagInv[4]*(70.0*Apar[2]*Phi[6]-70.0*Phi[2]*Apar[6]))*q_)+70.0*BdriftX[0]*Bmag[4]*Apar[6]*wm)+((70.0*((BdriftY[0]*Apar[5]+Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4])*Phi[7]+BdriftY[0]*Phi[5]*Apar[7])+55.0*BdriftY[4]*(Apar[3]*Phi[6]+Phi[3]*Apar[6]))*dfac_y+(28.0*BdriftX[4]*(Apar[3]*Phi[7]+Phi[3]*Apar[7])+70.0*((BdriftX[0]*Apar[5]+Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*Phi[6]+BdriftX[0]*Phi[4]*Apar[6]))*dfac_x)*q_)-140.0*(BdriftY[4]*Phi[7]*dfac_y+BdriftX[4]*Phi[6]*dfac_x)*m_)+dfac_v*(350.0*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)*m_*wv+dfac_x*(1.732050807568877*dfac_y*(175.0*BmagInv[0]*Bmag[1]*Apar[7]*wm+(BmagInv[0]*(175.0*Phi[1]*Apar[7]-175.0*Apar[1]*Phi[7])+(245.0*BmagInv[1]*Apar[3]+175.0*BmagInv[0]*Apar[2])*Phi[6]+((-245.0*BmagInv[1]*Phi[3])-175.0*BmagInv[0]*Phi[2])*Apar[6])*q_)+(275.0*BdriftX[4]*Bmag[4]+70.0*BdriftX[1]*Bmag[1])*Apar[6]*wm)+(((BdriftY[4]*(140.0*Apar[5]+275.0*Apar[4])+315.0*Apar[1]*BdriftY[1]+175.0*Apar[0]*BdriftY[0])*Phi[7]+140.0*BdriftY[4]*Phi[5]*Apar[7]+70.0*((BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[6]+(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*Apar[6]))*dfac_y+(70.0*((BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[7]+BdriftX[0]*Phi[3]*Apar[7])+(BdriftX[4]*(140.0*Apar[5]+275.0*Apar[4])+315.0*Apar[1]*BdriftX[1]+175.0*Apar[0]*BdriftX[0])*Phi[6]+(275.0*BdriftX[4]*Phi[4]+70.0*BdriftX[1]*Phi[1])*Apar[6])*dfac_x)*q_)-350.0*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)*m_)+2.23606797749979*(1.732050807568877*(dfac_v*(350.0*BdriftY[1]*Phi[5]*dfac_y*m_*wv+((315.0*BdriftX[1]*Apar[3]+175.0*BdriftX[0]*Apar[2])*Bmag[4]+70.0*Bmag[1]*Apar[3]*BdriftX[4])*dfac_x*wm+((175.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[5]+70.0*(Apar[2]*Phi[3]+Phi[2]*Apar[3])*BdriftY[4])*dfac_y+(70.0*BdriftX[1]*Phi[3]*Apar[5]+(315.0*BdriftX[1]*Apar[3]+175.0*BdriftX[0]*Apar[2])*Phi[4]+70.0*((Apar[1]*Phi[3]+Phi[1]*Apar[3])*BdriftX[4]+BdriftX[1]*Phi[3]*Apar[4]))*dfac_x)*q_)-350.0*BdriftY[1]*Phi[5]*dfac_y*m_)+dfac_v*dfac_x*dfac_y*((1050.0*Bmag[4]*BmagInv[4]+525.0*Bmag[1]*BmagInv[1])*Apar[5]*wm+(((-1050.0*Apar[4]*BmagInv[4])-525.0*Apar[1]*BmagInv[1])*Phi[5]+(1050.0*BmagInv[4]*Phi[4]+525.0*BmagInv[1]*Phi[1])*Apar[5])*q_))+1.732050807568877*(dfac_v*(dfac_x*(350.0*BdriftX[1]*Phi[3]*m_*wv+(350.0*Apar[2]*BdriftX[4]*Bmag[4]+175.0*Bmag[1]*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*wm)+((BdriftY[1]*(630.0*Apar[7]*Phi[7]+275.0*Apar[6]*Phi[6])+350.0*(BdriftY[1]*Apar[5]+Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4])*Phi[5]+(315.0*BdriftY[1]*Apar[3]+175.0*BdriftY[0]*Apar[2])*Phi[3]+175.0*Phi[2]*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*dfac_y+(BdriftX[1]*(140.0*Apar[6]*Phi[7]+630.0*Phi[6]*Apar[7])+350.0*Apar[2]*BdriftX[4]*Phi[4]+175.0*((Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[3]+Phi[1]*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])))*dfac_x)*q_)-350.0*BdriftX[1]*Phi[3]*dfac_x*m_)+dfac_v*(2625.0*BmagInv[0]*Bmag[4]*Apar[5]*dfac_x*dfac_y*wm+((BmagInv[0]*(2625.0*Phi[4]*Apar[5]-2625.0*Apar[4]*Phi[5])+BmagInv[1]*(525.0*Apar[2]*Phi[3]-525.0*Phi[2]*Apar[3]))*dfac_x*dfac_y+700.0*dApardt[3])*q_)))/(dfac_v*m_); 
  alphaUp[5] = -(0.01010152544552211*dfac_x*(2.23606797749979*(dfac_v*(70.0*BdriftX[0]*Bmag[4]*m_*wv+(1.732050807568877*(14.0*Bmag[1]*Apar[3]*BmagInv[4]+(63.0*BmagInv[1]*Apar[3]+35.0*BmagInv[0]*Apar[2])*Bmag[4])*dfac_y+(55.0*Apar[4]*BdriftX[4]+63.0*Apar[1]*BdriftX[1]+35.0*Apar[0]*BdriftX[0])*Bmag[4]+14.0*Bmag[1]*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*q_)-70.0*BdriftX[0]*Bmag[4]*m_)+dfac_v*((140.0*BdriftX[4]*Bmag[4]+70.0*BdriftX[1]*Bmag[1])*m_*wv+((3.872983346207417*(Bmag[4]*(55.0*BmagInv[4]+31.30495168499706*BmagInv[0])+14.0*Bmag[1]*BmagInv[1])*Apar[6]+1.732050807568877*(70.0*Apar[2]*Bmag[4]*BmagInv[4]+35.0*Bmag[1]*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])))*dfac_y+70.0*(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4])*Bmag[4]+35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Bmag[1])*q_)+((-140.0*BdriftX[4]*Bmag[4])-70.0*BdriftX[1]*Bmag[1])*m_))/(dfac_m*dfac_v*m_*q_); 
  alphaUp[6] = -(0.02357022603955158*dfac_x*(3.872983346207417*(2.23606797749979*(15.0*BmagInv[0]*Bmag[4]*Apar[7]*dfac_y+1.732050807568877*(2.0*BdriftX[1]*Bmag[4]+Bmag[1]*BdriftX[4])*Apar[6])+(30.0*Bmag[4]*BmagInv[4]+15.0*Bmag[1]*BmagInv[1])*Apar[7]*dfac_y)+2.23606797749979*(25.98076211353316*BmagInv[0]*Bmag[1]*Apar[5]*dfac_y+15.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Bmag[4])+Bmag[4]*(129.9038105676658*BmagInv[1]*Apar[5]*dfac_y+30.0*Apar[3]*BdriftX[4])+15.0*Bmag[1]*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])))/(dfac_m*m_); 
  alphaUp[7] = -(0.01010152544552211*(3.872983346207417*(2.23606797749979*(dfac_y*(dfac_v*(14.0*BdriftY[0]*Phi[6]*m_*q_*wv+1.732050807568877*dfac_x*(7.0*BmagInv[0]*Bmag[1]*Apar[6]*q_*wm+(BmagInv[1]*(14.0*Phi[3]*Apar[7]-14.0*Apar[3]*Phi[7])+BmagInv[0]*(7.0*Phi[1]*Apar[6]-7.0*Apar[1]*Phi[6]))*q2))-14.0*BdriftY[0]*Phi[6]*m_*q_)+dfac_v*((14.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[7]+(15.0*Apar[4]*BdriftY[4]+11.0*Apar[1]*BdriftY[1]+7.0*Apar[0]*BdriftY[0])*Phi[6]+10.0*BdriftY[4]*Phi[5]*Apar[6])*dfac_y+(7.0*BdriftX[4]*Apar[5]*Phi[7]+14.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[6]+7.0*BdriftX[0]*Phi[3]*Apar[6])*dfac_x)*q2)+dfac_y*(dfac_v*(20.0*BdriftY[4]*Phi[6]*m_*q_*wv+1.732050807568877*dfac_x*((10.0*Bmag[1]*BmagInv[4]+55.0*BmagInv[1]*Bmag[4])*Apar[6]*q_*wm+((70.0*BmagInv[1]*Apar[5]-10.0*Apar[1]*BmagInv[4]-55.0*BmagInv[1]*Apar[4])*Phi[6]+(BmagInv[1]*(55.0*Phi[4]-70.0*Phi[5])+10.0*Phi[1]*BmagInv[4])*Apar[6])*q2))-20.0*BdriftY[4]*Phi[6]*m_*q_)+dfac_v*((55.0*Apar[3]*BdriftY[4]*Phi[7]+10.0*(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4])*Phi[6]+35.0*BdriftY[0]*Phi[5]*Apar[6])*dfac_y+BdriftX[4]*(55.0*Apar[3]*Phi[6]+10.0*Phi[3]*Apar[6])*dfac_x)*q2)+2.23606797749979*(1.732050807568877*(q_*(dfac_v*(28.0*BdriftY[1]*Phi[3]*dfac_y*m_*wv+(55.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Bmag[4]+Bmag[1]*(10.0*Apar[4]*BdriftX[4]+14.0*Apar[1]*BdriftX[1]))*dfac_x*wm)-28.0*BdriftY[1]*Phi[3]*dfac_y*m_)+dfac_v*((55.0*BdriftY[1]*Apar[6]*Phi[7]+BdriftY[4]*(35.0*Apar[2]*Phi[5]+10.0*Phi[2]*Apar[4])+14.0*((Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[3]+Apar[1]*BdriftY[1]*Phi[2]))*dfac_y+(14.0*BdriftX[1]*Apar[7]*Phi[7]+55.0*(BdriftX[1]*Apar[6]*Phi[6]+(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Phi[4])+10.0*Phi[1]*Apar[4]*BdriftX[4]+14.0*BdriftX[1]*(Apar[3]*Phi[3]+Apar[1]*Phi[1]))*dfac_x)*q2)+dfac_v*dfac_x*dfac_y*(Apar[3]*(165.0*Bmag[4]*BmagInv[4]+42.0*Bmag[1]*BmagInv[1])*q_*wm+(BmagInv[0]*(210.0*Phi[6]*Apar[7]-210.0*Apar[6]*Phi[7])+BmagInv[4]*((-105.0*Apar[3]*Phi[5])+105.0*Phi[3]*Apar[5]+165.0*Apar[3]*Phi[4]-165.0*Phi[3]*Apar[4])+BmagInv[1]*(42.0*Phi[1]*Apar[3]-42.0*Apar[1]*Phi[3]))*q2))+1.732050807568877*(dfac_v*m_*((140.0*BdriftX[1]*Bmag[4]+70.0*Bmag[1]*BdriftX[4])*dfac_x*wm+(70.0*Phi[2]*BdriftY[4]*dfac_y+(140.0*BdriftX[1]*Phi[4]+70.0*Phi[1]*BdriftX[4])*dfac_x)*q_)*wv+dfac_x*((70.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Bmag[4]+35.0*Bmag[1]*(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4]))*dfac_v*q_+((-140.0*BdriftX[1]*Bmag[4])-70.0*Bmag[1]*BdriftX[4])*m_)*wm+(((-140.0*BdriftX[1]*Phi[4])-70.0*Phi[1]*BdriftX[4])*dfac_x-70.0*Phi[2]*BdriftY[4]*dfac_y)*m_*q_+dfac_v*((70.0*BdriftY[1]*Apar[3]*Phi[5]+(55.0*Apar[1]*Phi[3]+35.0*Apar[0]*Phi[2])*BdriftY[4]+(55.0*BdriftY[1]*Phi[3]+35.0*BdriftY[0]*Phi[2])*Apar[4])*dfac_y+(70.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[4]+35.0*((Apar[2]*Phi[3]+Apar[0]*Phi[1])*BdriftX[4]+BdriftX[0]*Phi[1]*Apar[4]))*dfac_x)*q2)+dfac_v*((105.0*Bmag[1]*Apar[2]*BmagInv[4]+210.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4])*dfac_x*dfac_y*q_*wm+((BmagInv[4]*(825.0*Phi[6]*Apar[7]-825.0*Apar[6]*Phi[7])+210.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Phi[4]+(105.0*Phi[1]*Apar[2]-105.0*Apar[1]*Phi[2])*BmagInv[4]-210.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[4])*dfac_x*dfac_y+140.0*dApardt[4])*q2)))/(dfac_v*m_*q_); 
  alphaUp[8] = (0.01010152544552211*(3.872983346207417*(2.23606797749979*(dfac_v*(dfac_x*(((-14.0*BdriftX[4]*Bmag[4])-7.0*BdriftX[1]*Bmag[1])*Apar[7]*wm-14.0*BdriftX[0]*Phi[7]*m_*wv)+(((-14.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[7])-7.0*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*Apar[7]+BdriftY[4]*((-7.0*Apar[5]*Phi[6])-14.0*Phi[5]*Apar[6]))*dfac_y+((-7.0*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])*Phi[7])+((-14.0*BdriftX[4]*Phi[4])-7.0*BdriftX[1]*Phi[1])*Apar[7]-14.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[6])*dfac_x)*q_)+dfac_x*(1.732050807568877*((7.0*BmagInv[1]*Apar[3]-7.0*BmagInv[0]*Apar[2])*Phi[7]+(7.0*BmagInv[0]*Phi[2]-7.0*BmagInv[1]*Phi[3])*Apar[7])*dfac_v*dfac_y*q_+14.0*BdriftX[0]*Phi[7]*m_))+dfac_v*(((1.732050807568877*BmagInv[1]*(70.0*Phi[5]*Apar[6]-70.0*Apar[5]*Phi[6])*dfac_x+BdriftY[4]*((-28.0*Apar[3]*Phi[7])-14.0*Phi[3]*Apar[7]))*dfac_y+(BdriftX[0]*((-10.0*Apar[5]*Phi[7])-35.0*Phi[4]*Apar[7])+BdriftX[4]*((-28.0*Apar[3]*Phi[6])-14.0*Phi[3]*Apar[6]))*dfac_x)*q_-35.0*BdriftX[0]*Bmag[4]*Apar[7]*dfac_x*wm))+dfac_v*(2.23606797749979*(1.732050807568877*((BdriftY[1]*((-28.0*Apar[6]*Phi[7])-14.0*Phi[6]*Apar[7])*dfac_y+(BdriftX[1]*((-10.0*Apar[7]*Phi[7])-28.0*Apar[6]*Phi[6]-35.0*Phi[4]*Apar[5])-14.0*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[3])*dfac_x)*q_-35.0*BdriftX[1]*Bmag[4]*Apar[5]*dfac_x*wm)+BmagInv[0]*(210.0*Apar[6]*Phi[7]-210.0*Phi[6]*Apar[7])*dfac_x*dfac_y*q_)+1.732050807568877*((((-70.0*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])*Phi[5])-35.0*(BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2])*Apar[5])*dfac_y-35.0*BdriftX[0]*Phi[1]*Apar[5]*dfac_x)*q_-35.0*BdriftX[0]*Bmag[1]*Apar[5]*dfac_x*wm)+((BmagInv[4]*(315.0*Apar[6]*Phi[7]-315.0*Phi[6]*Apar[7])+BmagInv[0]*(210.0*Apar[3]*Phi[5]-210.0*Phi[3]*Apar[5]))*dfac_x*dfac_y-140.0*dApardt[5])*q_)))/(dfac_v*m_); 
  alphaUp[10] = -(0.003367175148507369*dfac_x*(3.872983346207417*(2.23606797749979*((42.0*Bmag[1]*BmagInv[4]+189.0*BmagInv[1]*Bmag[4])*Apar[7]*dfac_y+24.24871130596428*BdriftX[0]*Bmag[4]*Apar[6])+105.0*BmagInv[0]*Bmag[1]*Apar[7]*dfac_y+1.732050807568877*(55.0*BdriftX[4]*Bmag[4]+14.0*BdriftX[1]*Bmag[1])*Apar[6])+2.23606797749979*(1.732050807568877*(210.0*Bmag[4]*BmagInv[4]+105.0*Bmag[1]*BmagInv[1])*Apar[5]*dfac_y+(189.0*BdriftX[1]*Apar[3]+105.0*BdriftX[0]*Apar[2])*Bmag[4]+42.0*Bmag[1]*Apar[3]*BdriftX[4])+Bmag[4]*(909.3266739736605*BmagInv[0]*Apar[5]*dfac_y+210.0*Apar[2]*BdriftX[4])+105.0*Bmag[1]*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])))/(dfac_m*m_); 
  alphaUp[11] = -(0.01010152544552211*(3.872983346207417*(2.23606797749979*(dfac_v*(dfac_x*(14.0*Phi[3]*BdriftX[4]*m_*wv+(14.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Bmag[4]+7.0*Bmag[1]*Apar[2]*BdriftX[4])*wm)+((BdriftY[4]*(22.0*Apar[7]*Phi[7]+15.0*Apar[6]*Phi[6])+(BdriftY[4]*(14.0*Apar[5]+10.0*Apar[4])+14.0*Apar[1]*BdriftY[1])*Phi[5]+(11.0*Apar[3]*Phi[3]+7.0*Apar[2]*Phi[2])*BdriftY[4])*dfac_y+(BdriftX[4]*(4.0*Apar[6]*Phi[7]+22.0*Phi[6]*Apar[7])+14.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[4]+7.0*((Apar[0]*Phi[3]+Phi[1]*Apar[2])*BdriftX[4]+BdriftX[0]*Phi[3]*Apar[4]))*dfac_x)*q_)+dfac_x*(1.732050807568877*(7.0*Apar[2]*Phi[3]-7.0*Phi[2]*Apar[3])*BmagInv[4]*dfac_v*dfac_y*q_-14.0*Phi[3]*BdriftX[4]*m_))+dfac_v*(70.0*BdriftY[4]*Phi[5]*dfac_y*m_*wv+dfac_x*(1.732050807568877*dfac_y*((35.0*Bmag[1]*BmagInv[4]+70.0*BmagInv[1]*Bmag[4])*Apar[5]*wm+(((-35.0*Apar[1]*BmagInv[4])-70.0*BmagInv[1]*Apar[4])*Phi[5]+(70.0*BmagInv[1]*Phi[4]+35.0*Phi[1]*BmagInv[4])*Apar[5])*q_)+Apar[3]*(55.0*BdriftX[4]*Bmag[4]+14.0*BdriftX[1]*Bmag[1])*wm)+((BdriftY[0]*(28.0*Apar[7]*Phi[7]+10.0*Apar[6]*Phi[6])+35.0*(Apar[0]*BdriftY[4]+BdriftY[0]*Apar[4])*Phi[5]+14.0*((BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[3]+BdriftY[1]*Phi[2]*Apar[3]))*dfac_y+(BdriftX[0]*(14.0*Apar[6]*Phi[7]+28.0*Phi[6]*Apar[7])+BdriftX[4]*(14.0*Phi[3]*Apar[5]+55.0*Apar[3]*Phi[4]+10.0*Phi[3]*Apar[4])+14.0*BdriftX[1]*(Apar[1]*Phi[3]+Phi[1]*Apar[3]))*dfac_x)*q_)-70.0*BdriftY[4]*Phi[5]*dfac_y*m_)+1.732050807568877*(dfac_v*(140.0*(BdriftY[1]*Phi[7]*dfac_y+BdriftX[1]*Phi[6]*dfac_x)*m_*wv+35.0*BdriftX[0]*Bmag[1]*Apar[6]*dfac_x*wm+((70.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[7]+(55.0*BdriftY[1]*Apar[3]+35.0*BdriftY[0]*Apar[2])*Phi[6]+(55.0*BdriftY[1]*Phi[3]+35.0*BdriftY[0]*Phi[2])*Apar[6])*dfac_y+(28.0*BdriftX[1]*(Apar[3]*Phi[7]+Phi[3]*Apar[7])+70.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[6]+35.0*BdriftX[0]*Phi[1]*Apar[6])*dfac_x)*q_)-140.0*(BdriftY[1]*Phi[7]*dfac_y+BdriftX[1]*Phi[6]*dfac_x)*m_)+dfac_v*(2.23606797749979*(1.732050807568877*((55.0*BdriftX[1]*Bmag[4]+10.0*Bmag[1]*BdriftX[4])*Apar[6]*dfac_x*wm+(((28.0*BdriftY[1]*Apar[5]+55.0*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4]))*Phi[7]+28.0*BdriftY[1]*Phi[5]*Apar[7]+10.0*BdriftY[4]*(Apar[2]*Phi[6]+Phi[2]*Apar[6]))*dfac_y+(14.0*Apar[2]*BdriftX[4]*Phi[7]+(28.0*BdriftX[1]*Apar[5]+55.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*Phi[6]+(55.0*BdriftX[1]*Phi[4]+10.0*Phi[1]*BdriftX[4])*Apar[6])*dfac_x)*q_)+dfac_x*dfac_y*(210.0*BmagInv[0]*Bmag[4]*Apar[7]*wm+(BmagInv[0]*(210.0*Phi[4]*Apar[7]-210.0*Apar[4]*Phi[7])+BmagInv[4]*(135.0*Apar[3]*Phi[6]-135.0*Phi[3]*Apar[6]))*q_))+(825.0*Bmag[4]*BmagInv[4]+210.0*Bmag[1]*BmagInv[1])*Apar[7]*dfac_x*dfac_y*wm+(((BmagInv[4]*(210.0*Apar[5]-825.0*Apar[4])-210.0*Apar[1]*BmagInv[1])*Phi[7]+(BmagInv[4]*(825.0*Phi[4]-210.0*Phi[5])+210.0*BmagInv[1]*Phi[1])*Apar[7]+(105.0*BmagInv[0]*Apar[3]+210.0*BmagInv[1]*Apar[2])*Phi[6]+((-105.0*BmagInv[0]*Phi[3])-210.0*BmagInv[1]*Phi[2])*Apar[6])*dfac_x*dfac_y+140.0*dApardt[6])*q_)))/(dfac_v*m_); 
  alphaUp[12] = (0.002020305089104421*(1.732050807568877*(dfac_v*(dfac_x*((-350.0*BdriftX[1]*Phi[7]*m_*wv)-175.0*BdriftX[0]*Bmag[1]*Apar[7]*wm)+((((-630.0*BdriftY[1]*Apar[3])-350.0*BdriftY[0]*Apar[2])*Phi[7]+((-315.0*BdriftY[1]*Phi[3])-175.0*BdriftY[0]*Phi[2])*Apar[7])*dfac_y+((-175.0*((Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[7]+BdriftX[0]*Phi[1]*Apar[7]))+((-630.0*BdriftX[1]*Apar[3])-350.0*BdriftX[0]*Apar[2])*Phi[6]-140.0*BdriftX[1]*Phi[3]*Apar[6])*dfac_x)*q_)+350.0*BdriftX[1]*Phi[7]*dfac_x*m_)+dfac_v*(2.23606797749979*(1.732050807568877*(((-315.0*BdriftX[1]*Bmag[4])-70.0*Bmag[1]*BdriftX[4])*Apar[7]*dfac_x*wm+((BdriftY[4]*((-140.0*Apar[2]*Phi[7])-70.0*Phi[2]*Apar[7])+BdriftY[1]*((-70.0*Apar[5]*Phi[6])-140.0*Phi[5]*Apar[6]))*dfac_y+(((-50.0*BdriftX[1]*Apar[5])-70.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4]))*Phi[7]+((-315.0*BdriftX[1]*Phi[4])-70.0*Phi[1]*BdriftX[4])*Apar[7]-140.0*Apar[2]*BdriftX[4]*Phi[6])*dfac_x)*q_)+(BmagInv[4]*(210.0*Apar[3]*Phi[7]-210.0*Phi[3]*Apar[7])+BmagInv[0]*(1050.0*Phi[5]*Apar[6]-1050.0*Apar[5]*Phi[6]))*dfac_x*dfac_y*q_)+3.872983346207417*(2.23606797749979*(((-70.0*BdriftX[4]*Bmag[4])-35.0*BdriftX[1]*Bmag[1])*Apar[5]*dfac_x*wm+((1.732050807568877*BmagInv[1]*(70.0*Apar[3]*Phi[5]-70.0*Phi[3]*Apar[5])*dfac_x+BdriftY[4]*((-110.0*Apar[6]*Phi[7])-55.0*Phi[6]*Apar[7])-70.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[5]-35.0*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*Apar[5])*dfac_y+(BdriftX[4]*((-20.0*Apar[7]*Phi[7])-110.0*Apar[6]*Phi[6])+((-70.0*BdriftX[4]*Phi[4])-35.0*BdriftX[1]*Phi[1])*Apar[5]-28.0*Apar[3]*Phi[3]*BdriftX[4])*dfac_x)*q_)-175.0*BdriftX[0]*Bmag[4]*Apar[5]*dfac_x*wm+((1.732050807568877*BmagInv[1]*(560.0*Apar[6]*Phi[7]-560.0*Phi[6]*Apar[7])*dfac_x+BdriftY[0]*((-140.0*Apar[6]*Phi[7])-70.0*Phi[6]*Apar[7])+BdriftY[4]*((-140.0*Apar[3]*Phi[5])-70.0*Phi[3]*Apar[5]))*dfac_y+(BdriftX[0]*((-50.0*Apar[7]*Phi[7])-140.0*Apar[6]*Phi[6]-175.0*Phi[4]*Apar[5])-70.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[3])*dfac_x)*q_)+(((525.0*BmagInv[0]*Apar[3]-525.0*BmagInv[1]*Apar[2])*Phi[7]+(525.0*BmagInv[1]*Phi[2]-525.0*BmagInv[0]*Phi[3])*Apar[7]+BmagInv[4]*(2100.0*Phi[5]*Apar[6]-2100.0*Apar[5]*Phi[6]))*dfac_x*dfac_y-700.0*dApardt[7])*q_)))/(dfac_v*m_); 
  alphaUp[13] = -(0.003367175148507369*dfac_x*(3.872983346207417*(2.23606797749979*(1.732050807568877*(dfac_v*((28.0*BdriftX[1]*Bmag[4]+14.0*Bmag[1]*BdriftX[4])*m_*wv+(14.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Bmag[4]+7.0*Bmag[1]*(Apar[0]*BdriftX[4]+BdriftX[0]*Apar[4]))*q_)+((-28.0*BdriftX[1]*Bmag[4])-14.0*Bmag[1]*BdriftX[4])*m_)+(21.0*Bmag[1]*Apar[2]*BmagInv[4]+42.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4])*dfac_v*dfac_y*q_)+dfac_v*(Apar[3]*(165.0*Bmag[4]*BmagInv[4]+42.0*Bmag[1]*BmagInv[1])*dfac_y+1.732050807568877*(55.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])*Bmag[4]+Bmag[1]*(10.0*Apar[4]*BdriftX[4]+14.0*Apar[1]*BdriftX[1])))*q_)+(3.872983346207417*(30.0*Bmag[1]*BmagInv[4]+165.0*BmagInv[1]*Bmag[4])+181.8653347947321*BmagInv[0]*Bmag[1])*Apar[6]*dfac_v*dfac_y*q_))/(dfac_m*dfac_v*m_*q_); 
  alphaUp[14] = -(0.02357022603955158*(((30.0*BdriftX[4]+33.54101966249685*BdriftX[0])*Bmag[4]+15.0*BdriftX[1]*Bmag[1])*Apar[7]+3.872983346207417*(8.660254037844386*BdriftX[1]*Bmag[4]+3.872983346207417*BdriftX[0]*Bmag[1])*Apar[5])*dfac_x)/(dfac_m*m_); 
  alphaUp[17] = -(0.003367175148507369*dfac_x*(3.872983346207417*(2.23606797749979*((165.0*Bmag[4]*BmagInv[4]+42.0*Bmag[1]*BmagInv[1])*Apar[7]*dfac_y+12.12435565298214*BdriftX[0]*Bmag[1]*Apar[6])+210.0*BmagInv[0]*Bmag[4]*Apar[7]*dfac_y+1.732050807568877*(55.0*BdriftX[1]*Bmag[4]+10.0*Bmag[1]*BdriftX[4])*Apar[6])+2.23606797749979*(1.732050807568877*(105.0*Bmag[1]*BmagInv[4]+210.0*BmagInv[1]*Bmag[4])*Apar[5]*dfac_y+Apar[3]*(165.0*BdriftX[4]*Bmag[4]+42.0*BdriftX[1]*Bmag[1]))+210.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Bmag[4]+105.0*Bmag[1]*Apar[2]*BdriftX[4]))/(dfac_m*m_); 
  alphaUp[18] = -(0.02357022603955158*(3.872983346207417*(1.732050807568877*(9.0*BdriftX[1]*Bmag[4]+2.0*Bmag[1]*BdriftX[4])+3.872983346207417*BdriftX[0]*Bmag[1])*Apar[7]+((30.0*BdriftX[4]+33.54101966249685*BdriftX[0])*Bmag[4]+15.0*BdriftX[1]*Bmag[1])*Apar[5])*dfac_x)/(dfac_m*m_); 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[13]+fl[13])+1.732050807568877*(fl[3]-1.0*fr[3])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[23]+fl[23])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[24]+fl[24])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[2]+fl[2])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[27]+fl[27])+3.0*(fl[10]-1.0*fr[10]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[34]+fl[34])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[5]+fl[5]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[39]+fl[39])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[40]+fl[40])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[9]+fl[9]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*(fr[21]-1.0*fl[21])-5.0*(fr[11]+fl[11])); 
  favg[8] = -0.1414213562373095*(8.660254037844387*(fr[22]-1.0*fl[22])-5.0*(fr[12]+fl[12])); 
  favg[9] = -0.1414213562373095*(8.660254037844387*(fr[30]-1.0*fl[30])-5.0*(fr[14]+fl[14])); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[46]+fl[46])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[16]+fl[16])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*(fr[32]-1.0*fl[32])-5.0*(fr[19]+fl[19])); 
  favg[12] = -0.1414213562373095*(8.660254037844387*(fr[33]-1.0*fl[33])-5.0*(fr[20]+fl[20])); 
  favg[13] = -0.1414213562373095*(8.660254037844387*(fr[37]-1.0*fl[37])-5.0*(fr[25]+fl[25])); 
  favg[14] = -0.1414213562373095*(8.660254037844387*(fr[38]-1.0*fl[38])-5.0*(fr[26]+fl[26])); 
  favg[15] = -0.1414213562373095*(8.660254037844387*(fr[42]-1.0*fl[42])-5.0*(fr[28]+fl[28])); 
  favg[16] = -0.1414213562373095*(8.660254037844387*(fr[43]-1.0*fl[43])-5.0*(fr[29]+fl[29])); 
  favg[17] = -0.1414213562373095*(8.660254037844387*(fr[44]-1.0*fl[44])-5.0*(fr[35]+fl[35])); 
  favg[18] = -0.1414213562373095*(8.660254037844387*(fr[45]-1.0*fl[45])-5.0*(fr[36]+fl[36])); 
  favg[19] = -0.1414213562373095*(8.660254037844387*(fr[47]-1.0*fl[47])-5.0*(fr[41]+fl[41])); 

//
// //
  Ghat[0] = -0.125*(1.414213562373095*((2.0*fr[0]-2.0*fl[0])*amax-1.0*(alpha[18]*favg[18]+alpha[17]*favg[17]+alpha[14]*favg[14]+alpha[13]*favg[13]+alpha[12]*favg[12]+alpha[11]*favg[11]+alpha[10]*favg[10]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[6]*favg[6]+alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[3]*favg[3]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0]))+(3.16227766016838*(2.0*fr[13]-2.0*fl[13])-4.898979485566357*(fr[3]+fl[3]))*amax); 
  Ghat[1] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[23]-10.0*fr[23])*amax+2.0*(alpha[5]*favg[13]+favg[5]*alpha[13]+alpha[4]*favg[11]+favg[4]*alpha[11]))+5.477225575051662*(alpha[14]*favg[18]+favg[14]*alpha[18]+alpha[8]*favg[12]+favg[8]*alpha[12]))+1.414213562373095*((30.0*fl[1]-30.0*fr[1])*amax+15.0*(alpha[6]*favg[10]+favg[6]*alpha[10]+alpha[3]*favg[5]+favg[3]*alpha[5]+alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1]))+73.48469228349535*(fr[6]+fl[6])*amax+18.97366596101028*(alpha[10]*favg[17]+favg[10]*alpha[17]+alpha[1]*favg[7]+favg[1]*alpha[7])); 
  Ghat[2] = 0.008333333333333333*(3.872983346207417*(2.449489742783178*((10.0*fl[24]-10.0*fr[24])*amax+2.0*(alpha[6]*favg[14]+favg[6]*alpha[14]+alpha[4]*favg[12]+favg[4]*alpha[12]))+5.477225575051662*(alpha[13]*favg[17]+favg[13]*alpha[17]+alpha[7]*favg[11]+favg[7]*alpha[11]))+1.414213562373095*((30.0*fl[2]-30.0*fr[2])*amax+15.0*(alpha[5]*favg[10]+favg[5]*alpha[10]+alpha[3]*favg[6]+favg[3]*alpha[6]+alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2]))+73.48469228349535*(fr[7]+fl[7])*amax+18.97366596101028*(alpha[10]*favg[18]+favg[10]*alpha[18]+alpha[2]*favg[8]+favg[2]*alpha[8])); 
  Ghat[3] = 0.01443375672974065*(3.872983346207417*(1.414213562373095*((10.0*fl[27]-10.0*fr[27])*amax+2.0*(alpha[6]*favg[16]+alpha[5]*favg[15]))+3.16227766016838*(alpha[12]*favg[18]+favg[12]*alpha[18]+alpha[11]*favg[17]+favg[11]*alpha[17]+alpha[8]*favg[14]+favg[8]*alpha[14]+alpha[7]*favg[13]+favg[7]*alpha[13]))+2.449489742783178*((10.0*fl[4]-10.0*fr[4])*amax+5.0*(alpha[4]*favg[10]+favg[4]*alpha[10]+alpha[2]*favg[6]+favg[2]*alpha[6]+alpha[1]*favg[5]+favg[1]*alpha[5]+alpha[0]*favg[3]+favg[0]*alpha[3]))+42.42640687119285*(fr[10]+fl[10])*amax+10.95445115010332*(alpha[10]*favg[19]+alpha[3]*favg[9])); 
  Ghat[4] = 0.008333333333333333*(3.16227766016838*((30.0*fl[34]-30.0*fr[34])*amax+6.0*(alpha[6]*favg[18]+favg[6]*alpha[18]+alpha[5]*favg[17]+favg[5]*alpha[17]+alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7]))+1.414213562373095*((30.0*fl[5]-30.0*fr[5])*amax+12.0*(alpha[17]*favg[18]+favg[17]*alpha[18]+alpha[11]*favg[12]+favg[11]*alpha[12])+15.0*(alpha[3]*favg[10]+favg[3]*alpha[10]+alpha[5]*favg[6]+favg[5]*alpha[6]+alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2]))+73.48469228349535*(fr[15]+fl[15])*amax+18.97366596101028*(alpha[10]*favg[14]+favg[10]*alpha[14]+alpha[10]*favg[13]+favg[10]*alpha[13]+alpha[2]*favg[12]+favg[2]*alpha[12]+alpha[1]*favg[11]+favg[1]*alpha[11])); 
  Ghat[5] = 0.008333333333333333*(3.16227766016838*((30.0*fl[39]-30.0*fr[39])*amax+6.0*(alpha[6]*favg[19]+alpha[4]*favg[17]+favg[4]*alpha[17]+alpha[5]*(favg[9]+favg[7])+favg[5]*alpha[7]))+1.414213562373095*((30.0*fl[8]-30.0*fr[8])*amax+12.0*alpha[17]*favg[19]+15.0*(alpha[8]*favg[18]+favg[8]*alpha[18])+12.0*alpha[13]*favg[15]+15.0*(alpha[12]*favg[14]+favg[12]*alpha[14]+alpha[2]*favg[10]+favg[2]*alpha[10]+alpha[4]*favg[6]+favg[4]*alpha[6]+alpha[0]*favg[5]+favg[0]*alpha[5]+alpha[1]*favg[3]+favg[1]*alpha[3]))+73.48469228349535*(fr[17]+fl[17])*amax+18.97366596101028*(alpha[10]*favg[16]+alpha[3]*favg[15]+alpha[1]*favg[13]+favg[1]*alpha[13]+alpha[10]*favg[11]+favg[10]*alpha[11])); 
  Ghat[6] = 0.008333333333333333*(3.16227766016838*((30.0*fl[40]-30.0*fr[40])*amax+6.0*(alpha[5]*favg[19]+alpha[4]*favg[18]+favg[4]*alpha[18]+alpha[6]*(favg[9]+favg[8])+favg[6]*alpha[8]))+1.414213562373095*((30.0*fl[9]-30.0*fr[9])*amax+12.0*alpha[18]*favg[19]+15.0*(alpha[7]*favg[17]+favg[7]*alpha[17])+12.0*alpha[14]*favg[16]+15.0*(alpha[11]*favg[13]+favg[11]*alpha[13]+alpha[1]*favg[10]+favg[1]*alpha[10]+alpha[0]*favg[6]+favg[0]*alpha[6]+alpha[4]*favg[5]+favg[4]*alpha[5]+alpha[2]*favg[3]+favg[2]*alpha[3]))+73.48469228349535*(fr[18]+fl[18])*amax+18.97366596101028*(alpha[3]*favg[16]+alpha[10]*favg[15]+alpha[2]*favg[14]+favg[2]*alpha[14]+alpha[10]*favg[12]+favg[10]*alpha[12])); 
  Ghat[7] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[21]+fl[21])*amax+17.14642819948225*(alpha[3]*favg[13]+favg[3]*alpha[13]+alpha[2]*favg[11]+favg[2]*alpha[11]))+1.414213562373095*((210.0*fl[11]-210.0*fr[11])*amax+105.0*(alpha[6]*favg[17]+favg[6]*alpha[17]+alpha[0]*favg[7]+favg[0]*alpha[7]))+3.16227766016838*(42.0*alpha[18]*favg[18]+30.0*(alpha[17]*favg[17]+alpha[13]*favg[13])+42.0*alpha[12]*favg[12]+30.0*alpha[11]*favg[11]+42.0*alpha[10]*favg[10]+30.0*alpha[7]*favg[7]+42.0*(alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[1]*favg[1]))); 
  Ghat[8] = 0.001190476190476191*(8.660254037844387*(59.39696961967*(fr[22]+fl[22])*amax+17.14642819948225*(alpha[3]*favg[14]+favg[3]*alpha[14]+alpha[1]*favg[12]+favg[1]*alpha[12]))+1.414213562373095*((210.0*fl[12]-210.0*fr[12])*amax+105.0*(alpha[5]*favg[18]+favg[5]*alpha[18]+alpha[0]*favg[8]+favg[0]*alpha[8]))+3.16227766016838*(30.0*alpha[18]*favg[18]+42.0*alpha[17]*favg[17]+30.0*(alpha[14]*favg[14]+alpha[12]*favg[12])+42.0*(alpha[11]*favg[11]+alpha[10]*favg[10])+30.0*alpha[8]*favg[8]+42.0*(alpha[6]*favg[6]+alpha[4]*favg[4]+alpha[2]*favg[2]))); 
  Ghat[9] = 0.008333333333333333*(8.660254037844387*(8.485281374238571*(fr[30]+fl[30])*amax+2.449489742783178*(alpha[2]*favg[16]+alpha[1]*favg[15]))+1.414213562373095*((30.0*fl[14]-30.0*fr[14])*amax+15.0*(alpha[4]*favg[19]+alpha[0]*favg[9]))+18.97366596101028*(alpha[18]*favg[18]+alpha[17]*favg[17]+alpha[14]*favg[14]+alpha[13]*favg[13]+alpha[10]*favg[10]+alpha[6]*favg[6]+alpha[5]*favg[5]+alpha[3]*favg[3])); 
  Ghat[10] = 0.002886751345948129*(3.872983346207417*(1.414213562373095*((50.0*fl[46]-50.0*fr[46])*amax+10.0*(alpha[5]*favg[16]+alpha[6]*favg[15]+alpha[4]*favg[14]+favg[4]*alpha[14]+alpha[4]*favg[13]+favg[4]*alpha[13]+alpha[6]*favg[12]+favg[6]*alpha[12]+alpha[5]*favg[11]+favg[5]*alpha[11]))+12.64911064067352*((alpha[14]+alpha[13])*favg[19]+alpha[11]*favg[18]+(favg[16]+favg[11])*alpha[18]+alpha[12]*favg[17]+(favg[15]+favg[12])*alpha[17]))+2.449489742783178*((50.0*fl[16]-50.0*fr[16])*amax+25.0*(alpha[0]*favg[10]+favg[0]*alpha[10]+alpha[1]*favg[6]+favg[1]*alpha[6]+alpha[2]*favg[5]+favg[2]*alpha[5]+alpha[3]*favg[4]+favg[3]*alpha[4]))+212.1320343559643*(fr[31]+fl[31])*amax+54.77225575051662*(alpha[3]*favg[19]+alpha[2]*favg[18]+favg[2]*alpha[18]+alpha[1]*favg[17]+favg[1]*alpha[17]+(alpha[8]+alpha[7])*favg[10]+(favg[9]+favg[8]+favg[7])*alpha[10])); 
  Ghat[11] = 2.380952380952381e-4*(3.872983346207417*(2.23606797749979*(296.98484809835*(fr[32]+fl[32])*amax+2.449489742783178*(28.0*(alpha[10]*favg[18]+favg[10]*alpha[18])+35.0*(alpha[3]*favg[17]+favg[3]*alpha[17]+alpha[2]*favg[7]+favg[2]*alpha[7])))+171.4642819948225*(alpha[5]*favg[10]+favg[5]*alpha[10]+alpha[1]*favg[4]+favg[1]*alpha[4]))+1.414213562373095*((1050.0*fl[19]-1050.0*fr[19])*amax+525.0*(alpha[6]*favg[13]+favg[6]*alpha[13])+420.0*(alpha[4]*favg[12]+favg[4]*alpha[12])+525.0*(alpha[0]*favg[11]+favg[0]*alpha[11]))+3.16227766016838*((210.0*alpha[14]+150.0*alpha[13])*favg[17]+(210.0*favg[14]+150.0*favg[13])*alpha[17]+(210.0*alpha[8]+150.0*alpha[7])*favg[11]+(210.0*favg[8]+150.0*favg[7])*alpha[11])); 
  Ghat[12] = 2.380952380952381e-4*(3.872983346207417*(2.23606797749979*(296.98484809835*(fr[33]+fl[33])*amax+2.449489742783178*(35.0*(alpha[3]*favg[18]+favg[3]*alpha[18])+28.0*(alpha[10]*favg[17]+favg[10]*alpha[17])+35.0*(alpha[1]*favg[8]+favg[1]*alpha[8])))+171.4642819948225*(alpha[6]*favg[10]+favg[6]*alpha[10]+alpha[2]*favg[4]+favg[2]*alpha[4]))+1.414213562373095*((1050.0*fl[20]-1050.0*fr[20])*amax+525.0*(alpha[5]*favg[14]+favg[5]*alpha[14]+alpha[0]*favg[12]+favg[0]*alpha[12])+420.0*(alpha[4]*favg[11]+favg[4]*alpha[11]))+3.16227766016838*((150.0*alpha[14]+210.0*alpha[13])*favg[18]+(150.0*favg[14]+210.0*favg[13])*alpha[18]+(150.0*alpha[8]+210.0*alpha[7])*favg[12]+(150.0*favg[8]+210.0*favg[7])*alpha[12])); 
  Ghat[13] = 9.221388919541468e-4*(3.872983346207417*(1.414213562373095*((70.0*fl[25]-70.0*fr[25])*amax+28.0*alpha[5]*favg[15]+35.0*(alpha[0]*favg[13]+favg[0]*alpha[13]+alpha[6]*favg[11]+favg[6]*alpha[11]))+3.16227766016838*(14.0*(alpha[12]*favg[18]+favg[12]*alpha[18])+10.0*alpha[11]*favg[17]+(14.0*favg[16]+10.0*favg[11])*alpha[17]+10.0*alpha[7]*favg[13]+(14.0*favg[9]+10.0*favg[7])*alpha[13]))+2.23606797749979*(296.98484809835*(fr[37]+fl[37])*amax+2.449489742783178*(28.0*alpha[10]*favg[19]+35.0*(alpha[2]*favg[17]+favg[2]*alpha[17]+alpha[3]*favg[7]+favg[3]*alpha[7])))+171.4642819948225*(alpha[4]*favg[10]+favg[4]*alpha[10]+alpha[1]*favg[5]+favg[1]*alpha[5])); 
  Ghat[14] = 9.221388919541468e-4*(3.872983346207417*(1.414213562373095*((70.0*fl[26]-70.0*fr[26])*amax+28.0*alpha[6]*favg[16]+35.0*(alpha[0]*favg[14]+favg[0]*alpha[14]+alpha[5]*favg[12]+favg[5]*alpha[12]))+3.16227766016838*(10.0*alpha[12]*favg[18]+(14.0*favg[15]+10.0*favg[12])*alpha[18]+14.0*(alpha[11]*favg[17]+favg[11]*alpha[17])+10.0*alpha[8]*favg[14]+(14.0*favg[9]+10.0*favg[8])*alpha[14]))+2.23606797749979*(296.98484809835*(fr[38]+fl[38])*amax+2.449489742783178*(28.0*alpha[10]*favg[19]+35.0*(alpha[1]*favg[18]+favg[1]*alpha[18]+alpha[3]*favg[8]+favg[3]*alpha[8])))+171.4642819948225*(alpha[4]*favg[10]+favg[4]*alpha[10]+alpha[2]*favg[6]+favg[2]*alpha[6])); 
  Ghat[15] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[28]-10.0*fr[28])*amax+5.0*(alpha[4]*favg[16]+alpha[0]*favg[15])+4.0*(alpha[5]*favg[13]+favg[5]*alpha[13]))+6.324555320336759*(alpha[11]*favg[19]+alpha[14]*favg[18]+favg[14]*alpha[18]+alpha[7]*favg[15]))+2.23606797749979*(42.42640687119285*(fr[42]+fl[42])*amax+2.449489742783178*(5.0*alpha[2]*favg[19]+4.0*(alpha[10]*favg[17]+favg[10]*alpha[17])+5.0*alpha[1]*favg[9]))+24.49489742783178*(alpha[6]*favg[10]+favg[6]*alpha[10]+alpha[3]*favg[5]+favg[3]*alpha[5])); 
  Ghat[16] = 0.006454972243679028*(3.872983346207417*(1.414213562373095*((10.0*fl[29]-10.0*fr[29])*amax+5.0*(alpha[0]*favg[16]+alpha[4]*favg[15])+4.0*(alpha[6]*favg[14]+favg[6]*alpha[14]))+6.324555320336759*(alpha[12]*favg[19]+alpha[13]*favg[17]+favg[13]*alpha[17]+alpha[8]*favg[16]))+2.23606797749979*(42.42640687119285*(fr[43]+fl[43])*amax+2.449489742783178*(5.0*alpha[1]*favg[19]+4.0*(alpha[10]*favg[18]+favg[10]*alpha[18])+5.0*alpha[2]*favg[9]))+24.49489742783178*(alpha[5]*favg[10]+favg[5]*alpha[10]+alpha[3]*favg[6]+favg[3]*alpha[6])); 
  Ghat[17] = 2.380952380952381e-4*(8.660254037844387*(296.98484809835*(fr[44]+fl[44])*amax+2.449489742783178*(28.0*alpha[10]*favg[15]+35.0*(alpha[2]*favg[13]+favg[2]*alpha[13])+28.0*(alpha[10]*favg[12]+favg[10]*alpha[12])+35.0*(alpha[3]*favg[11]+favg[3]*alpha[11])))+1.414213562373095*((1050.0*fl[35]-1050.0*fr[35])*amax+420.0*(alpha[5]*favg[19]+alpha[4]*favg[18]+favg[4]*alpha[18])+525.0*(alpha[0]*favg[17]+favg[0]*alpha[17]+alpha[6]*favg[7]+favg[6]*alpha[7]))+3.16227766016838*(168.0*alpha[18]*favg[19]+(210.0*alpha[8]+150.0*alpha[7])*favg[17]+(210.0*(favg[9]+favg[8])+150.0*favg[7])*alpha[17]+210.0*(alpha[13]*favg[16]+alpha[11]*favg[14]+favg[11]*alpha[14])+150.0*(alpha[11]*favg[13]+favg[11]*alpha[13])+210.0*(alpha[1]*favg[10]+favg[1]*alpha[10]+alpha[4]*favg[5]+favg[4]*alpha[5]))); 
  Ghat[18] = 2.380952380952381e-4*(8.660254037844387*(296.98484809835*(fr[45]+fl[45])*amax+2.449489742783178*(28.0*alpha[10]*favg[16]+35.0*(alpha[1]*favg[14]+favg[1]*alpha[14]+alpha[3]*favg[12]+favg[3]*alpha[12])+28.0*(alpha[10]*favg[11]+favg[10]*alpha[11])))+1.414213562373095*((1050.0*fl[36]-1050.0*fr[36])*amax+420.0*alpha[6]*favg[19]+525.0*(alpha[0]*favg[18]+favg[0]*alpha[18])+420.0*(alpha[4]*favg[17]+favg[4]*alpha[17])+525.0*(alpha[5]*favg[8]+favg[5]*alpha[8]))+3.16227766016838*(168.0*alpha[17]*favg[19]+(150.0*alpha[8]+210.0*alpha[7])*favg[18]+(210.0*favg[9]+150.0*favg[8]+210.0*favg[7])*alpha[18]+210.0*alpha[14]*favg[15]+150.0*(alpha[12]*favg[14]+favg[12]*alpha[14])+210.0*(alpha[12]*favg[13]+favg[12]*alpha[13]+alpha[2]*favg[10]+favg[2]*alpha[10]+alpha[4]*favg[6]+favg[4]*alpha[6]))); 
  Ghat[19] = 0.001666666666666667*(8.660254037844387*(42.42640687119285*(fr[47]+fl[47])*amax+2.449489742783178*(5.0*(alpha[1]*favg[16]+alpha[2]*favg[15])+4.0*(alpha[10]*favg[14]+favg[10]*alpha[14]+alpha[10]*favg[13]+favg[10]*alpha[13])))+1.414213562373095*((150.0*fl[41]-150.0*fr[41])*amax+75.0*alpha[0]*favg[19]+60.0*(alpha[6]*favg[18]+favg[6]*alpha[18]+alpha[5]*favg[17]+favg[5]*alpha[17])+75.0*alpha[4]*favg[9])+3.16227766016838*(30.0*(alpha[8]+alpha[7])*favg[19]+24.0*(alpha[17]*favg[18]+favg[17]*alpha[18])+30.0*(alpha[12]*favg[16]+alpha[11]*favg[15]+alpha[3]*favg[10]+favg[3]*alpha[10]+alpha[5]*favg[6]+favg[5]*alpha[6]))); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_v; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_v; 
  incr[2] = 0.7071067811865475*Ghat[2]*dfac_v; 
  incr[3] = -1.224744871391589*Ghat[0]*dfac_v; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_v; 
  incr[5] = 0.7071067811865475*Ghat[4]*dfac_v; 
  incr[6] = -1.224744871391589*Ghat[1]*dfac_v; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_v; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_v; 
  incr[9] = 0.7071067811865475*Ghat[6]*dfac_v; 
  incr[10] = -1.224744871391589*Ghat[3]*dfac_v; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_v; 
  incr[12] = 0.7071067811865475*Ghat[8]*dfac_v; 
  incr[13] = 1.58113883008419*Ghat[0]*dfac_v; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_v; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_v; 
  incr[16] = 0.7071067811865475*Ghat[10]*dfac_v; 
  incr[17] = -1.224744871391589*Ghat[5]*dfac_v; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_v; 
  incr[19] = 0.7071067811865475*Ghat[11]*dfac_v; 
  incr[20] = 0.7071067811865475*Ghat[12]*dfac_v; 
  incr[21] = -1.224744871391589*Ghat[7]*dfac_v; 
  incr[22] = -1.224744871391589*Ghat[8]*dfac_v; 
  incr[23] = 1.58113883008419*Ghat[1]*dfac_v; 
  incr[24] = 1.58113883008419*Ghat[2]*dfac_v; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_v; 
  incr[26] = 0.7071067811865475*Ghat[14]*dfac_v; 
  incr[27] = 1.58113883008419*Ghat[3]*dfac_v; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_v; 
  incr[29] = 0.7071067811865475*Ghat[16]*dfac_v; 
  incr[30] = -1.224744871391589*Ghat[9]*dfac_v; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_v; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_v; 
  incr[33] = -1.224744871391589*Ghat[12]*dfac_v; 
  incr[34] = 1.58113883008419*Ghat[4]*dfac_v; 
  incr[35] = 0.7071067811865475*Ghat[17]*dfac_v; 
  incr[36] = 0.7071067811865475*Ghat[18]*dfac_v; 
  incr[37] = -1.224744871391589*Ghat[13]*dfac_v; 
  incr[38] = -1.224744871391589*Ghat[14]*dfac_v; 
  incr[39] = 1.58113883008419*Ghat[5]*dfac_v; 
  incr[40] = 1.58113883008419*Ghat[6]*dfac_v; 
  incr[41] = 0.7071067811865475*Ghat[19]*dfac_v; 
  incr[42] = -1.224744871391589*Ghat[15]*dfac_v; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_v; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_v; 
  incr[45] = -1.224744871391589*Ghat[18]*dfac_v; 
  incr[46] = 1.58113883008419*Ghat[10]*dfac_v; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_v; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += -1.0*incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += -1.0*incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += incr[21]; 
  outl[22] += incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += -1.0*incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += incr[37]; 
  outl[38] += incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += -1.0*incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += -1.0*incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
