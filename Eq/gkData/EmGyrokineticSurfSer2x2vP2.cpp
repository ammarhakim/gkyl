#include <GyrokineticModDecl.h> 
double EmGyrokineticSurf2x2vSer_X_P2_Bvars_0(const double q_, const double m_, const double cfl, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *geoX, const double *geoY, const double *geoZ, const double *Phi, const double *Apar, const double *dApardt, const double *fl, const double *fr, double *outl, double *outr) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = 0.0625*geoZ[0]*dfac_y*(BmagInv[0]*(3.872983346207417*Apar[6]-3.0*Apar[3]+1.732050807568877*Apar[2])*wv-2.0*(3.872983346207417*Phi[6]-3.0*Phi[3]+1.732050807568877*Phi[2])); 

  double alpha[20]; 
  alpha[0] = 0.3535533905932737*geoZ[0]*dfac_y*(BmagInv[0]*(3.872983346207417*Apar[6]-3.0*Apar[3]+1.732050807568877*Apar[2])*wv-7.745966692414834*Phi[6]+6.0*Phi[3]-3.464101615137754*Phi[2]); 
  alpha[1] = -0.3535533905932737*geoZ[0]*dfac_y*(BmagInv[0]*(6.708203932499369*Apar[7]-3.872983346207417*Apar[5])*wv-13.41640786499874*Phi[7]+7.745966692414834*Phi[5]); 
  alpha[2] = (0.1178511301977579*BmagInv[0]*geoZ[0]*(6.708203932499369*Apar[6]-5.196152422706631*Apar[3]+3.0*Apar[2])*dfac_y)/dfac_v; 
  alpha[4] = -(0.3535533905932737*BmagInv[0]*geoZ[0]*(3.872983346207417*Apar[7]-2.23606797749979*Apar[5])*dfac_y)/dfac_v; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[11]+fl[11])+1.732050807568877*(fl[1]-1.0*fr[1])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[19]+fl[19])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[2]+fl[2])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[21]+fl[21])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[25]+fl[25])+3.0*(fl[8]-1.0*fr[8]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[32]+fl[32])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[7]+fl[7]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[35]+fl[35])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[9]+fl[9]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[37]+fl[37])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[20]-1.0*(8.660254037844387*fl[20]+5.0*(fr[12]+fl[12]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[23]-1.0*(8.660254037844387*fl[23]+5.0*(fr[13]+fl[13]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[28]-1.0*(8.660254037844387*fl[28]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[44]+fl[44])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[18]+fl[18])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[33]-1.0*(8.660254037844387*fl[33]+5.0*(fr[22]+fl[22]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[34]-1.0*(8.660254037844387*fl[34]+5.0*(fr[24]+fl[24]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[36]-1.0*(8.660254037844387*fl[36]+5.0*(fr[26]+fl[26]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[39]-1.0*(8.660254037844387*fl[39]+5.0*(fr[27]+fl[27]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[41]-1.0*(8.660254037844387*fl[41]+5.0*(fr[29]+fl[29]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[42]-1.0*(8.660254037844387*fl[42]+5.0*(fr[30]+fl[30]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[45]-1.0*(8.660254037844387*fl[45]+5.0*(fr[38]+fl[38]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[46]-1.0*(8.660254037844387*fl[46]+5.0*(fr[40]+fl[40]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[43]+fl[43]))); 

//
// //
  Ghat[0] = -0.125*((6.324555320336761*fr[11]-6.324555320336761*fl[11]-4.898979485566357*(fr[1]+fl[1])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[19]-94.8683298050514*fl[19]-73.48469228349535*(fr[5]+fl[5])+42.42640687119286*fr[2]-42.42640687119286*fl[2])*amax-18.97366596101028*(alpha[4]*favg[11]+alpha[1]*favg[7])-21.21320343559643*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[21]-94.8683298050514*fl[21]-73.48469228349535*(fr[6]+fl[6])+42.42640687119286*fr[3]-42.42640687119286*fl[3])*amax-18.97366596101028*(alpha[4]*favg[12]+alpha[2]*favg[8])-21.21320343559643*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.04166666666666666*((18.97366596101028*fr[25]-18.97366596101028*fl[25]-14.69693845669907*(fr[8]+fl[8])+8.485281374238571*fr[4]-8.485281374238571*fl[4])*amax-4.242640687119286*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[32]-94.86832980505142*fl[32]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[7]-42.42640687119286*fl[7])*amax-18.97366596101028*(alpha[2]*favg[12]+alpha[1]*favg[11]+alpha[4]*(favg[8]+favg[7]))-21.21320343559643*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -0.008333333333333333*((94.86832980505142*fr[35]-94.86832980505142*fl[35]-73.48469228349535*(fr[16]+fl[16])+42.42640687119286*fr[9]-42.42640687119286*fl[9])*amax-18.97366596101028*(alpha[4]*favg[17]+alpha[1]*favg[13])-21.21320343559643*(alpha[2]*favg[10]+alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[37]-94.86832980505142*fl[37]-73.48469228349535*(fr[17]+fl[17])+42.42640687119286*fr[10]-42.42640687119286*fl[10])*amax-18.97366596101028*(alpha[4]*favg[18]+alpha[2]*favg[14])-21.21320343559643*(alpha[1]*favg[10]+alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3])); 
  Ghat[7] = 0.008333333333333333*((73.48469228349536*(fr[20]+fl[20])-42.42640687119286*fr[12]+42.42640687119286*fl[12])*amax+21.21320343559643*alpha[2]*favg[11]+21.21320343559643*alpha[0]*favg[7]+18.97366596101028*(alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.008333333333333333*((73.48469228349536*(fr[23]+fl[23])-42.42640687119286*fr[13]+42.42640687119286*fl[13])*amax+21.21320343559643*alpha[1]*favg[12]+21.21320343559643*alpha[0]*favg[8]+18.97366596101028*(alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.01863389981249824*((32.86335345030997*(fr[28]+fl[28])-18.97366596101028*fr[14]+18.97366596101028*fl[14])*amax+9.48683298050514*(alpha[4]*favg[19]+alpha[2]*favg[16]+alpha[1]*favg[15]+alpha[0]*favg[9])); 
  Ghat[10] = -0.008333333333333333*((94.8683298050514*fr[44]-94.8683298050514*fl[44]-73.48469228349535*(fr[31]+fl[31])+42.42640687119286*fr[18]-42.42640687119286*fl[18])*amax-18.97366596101028*(alpha[2]*favg[18]+alpha[1]*favg[17]+alpha[4]*(favg[14]+favg[13]))-21.21320343559643*(alpha[0]*favg[10]+alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4])); 
  Ghat[11] = 0.008333333333333333*((73.48469228349536*(fr[33]+fl[33])-42.42640687119286*fr[22]+42.42640687119286*fl[22])*amax+16.97056274847715*alpha[4]*favg[12]+21.21320343559643*alpha[0]*favg[11]+21.21320343559643*alpha[2]*favg[7]+18.97366596101028*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 0.008333333333333333*((73.48469228349536*(fr[34]+fl[34])-42.42640687119286*fr[24]+42.42640687119286*fl[24])*amax+21.21320343559643*alpha[0]*favg[12]+16.97056274847715*alpha[4]*favg[11]+21.21320343559643*alpha[1]*favg[8]+18.97366596101028*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.008333333333333333*((73.48469228349536*(fr[36]+fl[36])-42.42640687119286*fr[26]+42.42640687119286*fl[26])*amax+21.21320343559643*alpha[2]*favg[17]+21.21320343559643*alpha[0]*favg[13]+18.97366596101028*(alpha[4]*favg[10]+alpha[1]*favg[5])); 
  Ghat[14] = 0.008333333333333333*((73.48469228349536*(fr[39]+fl[39])-42.42640687119286*fr[27]+42.42640687119286*fl[27])*amax+21.21320343559643*alpha[1]*favg[18]+21.21320343559643*alpha[0]*favg[14]+18.97366596101028*(alpha[4]*favg[10]+alpha[2]*favg[6])); 
  Ghat[15] = 0.03227486121839514*((18.97366596101028*(fr[41]+fl[41])-10.95445115010333*fr[29]+10.95445115010333*fl[29])*amax+5.477225575051662*(alpha[2]*favg[19]+alpha[4]*favg[16]+alpha[0]*favg[15]+alpha[1]*favg[9])); 
  Ghat[16] = 0.03227486121839514*((18.97366596101028*(fr[42]+fl[42])-10.95445115010333*fr[30]+10.95445115010333*fl[30])*amax+5.477225575051662*(alpha[1]*favg[19]+alpha[0]*favg[16]+alpha[4]*favg[15]+alpha[2]*favg[9])); 
  Ghat[17] = 0.008333333333333333*((73.48469228349536*(fr[45]+fl[45])-42.42640687119286*fr[38]+42.42640687119286*fl[38])*amax+16.97056274847715*alpha[4]*favg[18]+21.21320343559643*alpha[0]*favg[17]+21.21320343559643*alpha[2]*favg[13]+18.97366596101028*(alpha[1]*favg[10]+alpha[4]*favg[5])); 
  Ghat[18] = 0.008333333333333333*((73.48469228349536*(fr[46]+fl[46])-42.42640687119286*fr[40]+42.42640687119286*fl[40])*amax+21.21320343559643*alpha[0]*favg[18]+16.97056274847715*alpha[4]*favg[17]+21.21320343559643*alpha[1]*favg[14]+18.97366596101028*(alpha[2]*favg[10]+alpha[4]*favg[6])); 
  Ghat[19] = 0.01863389981249824*((32.86335345030997*(fr[47]+fl[47])-18.97366596101028*fr[43]+18.97366596101028*fl[43])*amax+9.48683298050514*(alpha[0]*favg[19]+alpha[1]*favg[16]+alpha[2]*favg[15]+alpha[4]*favg[9])); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_x; 
  incr[1] = -1.224744871391589*Ghat[0]*dfac_x; 
  incr[2] = 0.7071067811865475*Ghat[1]*dfac_x; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_x; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_x; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_x; 
  incr[6] = -1.224744871391589*Ghat[2]*dfac_x; 
  incr[7] = 0.7071067811865475*Ghat[4]*dfac_x; 
  incr[8] = -1.224744871391589*Ghat[3]*dfac_x; 
  incr[9] = 0.7071067811865475*Ghat[5]*dfac_x; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_x; 
  incr[11] = 1.58113883008419*Ghat[0]*dfac_x; 
  incr[12] = 0.7071067811865475*Ghat[7]*dfac_x; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_x; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_x; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_x; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_x; 
  incr[17] = -1.224744871391589*Ghat[6]*dfac_x; 
  incr[18] = 0.7071067811865475*Ghat[10]*dfac_x; 
  incr[19] = 1.58113883008419*Ghat[1]*dfac_x; 
  incr[20] = -1.224744871391589*Ghat[7]*dfac_x; 
  incr[21] = 1.58113883008419*Ghat[2]*dfac_x; 
  incr[22] = 0.7071067811865475*Ghat[11]*dfac_x; 
  incr[23] = -1.224744871391589*Ghat[8]*dfac_x; 
  incr[24] = 0.7071067811865475*Ghat[12]*dfac_x; 
  incr[25] = 1.58113883008419*Ghat[3]*dfac_x; 
  incr[26] = 0.7071067811865475*Ghat[13]*dfac_x; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_x; 
  incr[28] = -1.224744871391589*Ghat[9]*dfac_x; 
  incr[29] = 0.7071067811865475*Ghat[15]*dfac_x; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_x; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_x; 
  incr[32] = 1.58113883008419*Ghat[4]*dfac_x; 
  incr[33] = -1.224744871391589*Ghat[11]*dfac_x; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_x; 
  incr[35] = 1.58113883008419*Ghat[5]*dfac_x; 
  incr[36] = -1.224744871391589*Ghat[13]*dfac_x; 
  incr[37] = 1.58113883008419*Ghat[6]*dfac_x; 
  incr[38] = 0.7071067811865475*Ghat[17]*dfac_x; 
  incr[39] = -1.224744871391589*Ghat[14]*dfac_x; 
  incr[40] = 0.7071067811865475*Ghat[18]*dfac_x; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_x; 
  incr[42] = -1.224744871391589*Ghat[16]*dfac_x; 
  incr[43] = 0.7071067811865475*Ghat[19]*dfac_x; 
  incr[44] = 1.58113883008419*Ghat[10]*dfac_x; 
  incr[45] = -1.224744871391589*Ghat[17]*dfac_x; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_x; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_x; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += -1.0*incr[7]; 
  outl[8] += incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += -1.0*incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += -1.0*incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += -1.0*incr[43]; 
  outl[44] += -1.0*incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Y_P2_Bvars_0(const double q_, const double m_, const double cfl, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *geoX, const double *geoY, const double *geoZ, const double *Phi, const double *Apar, const double *dApardt, const double *fl, const double *fr, double *outl, double *outr) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = -0.0625*geoZ[0]*dfac_x*(BmagInv[0]*(3.872983346207417*Apar[7]-3.0*Apar[3]+1.732050807568877*Apar[1])*wv-2.0*(3.872983346207417*Phi[7]-3.0*Phi[3]+1.732050807568877*Phi[1])); 

  double alpha[20]; 
  alpha[0] = -0.3535533905932737*geoZ[0]*dfac_x*(BmagInv[0]*(3.872983346207417*Apar[7]-3.0*Apar[3]+1.732050807568877*Apar[1])*wv-7.745966692414834*Phi[7]+6.0*Phi[3]-3.464101615137754*Phi[1]); 
  alpha[1] = 0.3535533905932737*geoZ[0]*dfac_x*(BmagInv[0]*(6.708203932499369*Apar[6]-3.872983346207417*Apar[4])*wv-13.41640786499874*Phi[6]+7.745966692414834*Phi[4]); 
  alpha[2] = -(0.1178511301977579*BmagInv[0]*geoZ[0]*(6.708203932499369*Apar[7]-5.196152422706631*Apar[3]+3.0*Apar[1])*dfac_x)/dfac_v; 
  alpha[4] = (0.3535533905932737*BmagInv[0]*geoZ[0]*(3.872983346207417*Apar[6]-2.23606797749979*Apar[4])*dfac_x)/dfac_v; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[12]+fl[12])+1.732050807568877*(fl[2]-1.0*fr[2])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[20]+fl[20])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[22]+fl[22])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[26]+fl[26])+3.0*(fl[9]-1.0*fr[9]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[33]+fl[33])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[6]+fl[6]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[36]+fl[36])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[38]+fl[38])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[19]-1.0*(8.660254037844387*fl[19]+5.0*(fr[11]+fl[11]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[24]-1.0*(8.660254037844387*fl[24]+5.0*(fr[13]+fl[13]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[29]-1.0*(8.660254037844387*fl[29]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[45]+fl[45])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[17]+fl[17])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[32]-1.0*(8.660254037844387*fl[32]+5.0*(fr[21]+fl[21]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[34]-1.0*(8.660254037844387*fl[34]+5.0*(fr[23]+fl[23]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[35]-1.0*(8.660254037844387*fl[35]+5.0*(fr[25]+fl[25]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[40]-1.0*(8.660254037844387*fl[40]+5.0*(fr[27]+fl[27]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[41]-1.0*(8.660254037844387*fl[41]+5.0*(fr[28]+fl[28]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[43]-1.0*(8.660254037844387*fl[43]+5.0*(fr[30]+fl[30]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[44]-1.0*(8.660254037844387*fl[44]+5.0*(fr[37]+fl[37]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[46]-1.0*(8.660254037844387*fl[46]+5.0*(fr[39]+fl[39]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[42]+fl[42]))); 

//
// //
  Ghat[0] = -0.125*((6.324555320336761*fr[12]-6.324555320336761*fl[12]-4.898979485566357*(fr[2]+fl[2])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[20]-94.8683298050514*fl[20]-73.48469228349535*(fr[5]+fl[5])+42.42640687119286*fr[1]-42.42640687119286*fl[1])*amax-18.97366596101028*(alpha[4]*favg[11]+alpha[1]*favg[7])-21.21320343559643*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[22]-94.8683298050514*fl[22]-73.48469228349535*(fr[7]+fl[7])+42.42640687119286*fr[3]-42.42640687119286*fl[3])*amax-18.97366596101028*(alpha[4]*favg[12]+alpha[2]*favg[8])-21.21320343559643*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.04166666666666666*((18.97366596101028*fr[26]-18.97366596101028*fl[26]-14.69693845669907*(fr[9]+fl[9])+8.485281374238571*fr[4]-8.485281374238571*fl[4])*amax-4.242640687119286*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[33]-94.86832980505142*fl[33]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[6]-42.42640687119286*fl[6])*amax-18.97366596101028*(alpha[2]*favg[12]+alpha[1]*favg[11]+alpha[4]*(favg[8]+favg[7]))-21.21320343559643*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -0.008333333333333333*((94.86832980505142*fr[36]-94.86832980505142*fl[36]-73.48469228349535*(fr[16]+fl[16])+42.42640687119286*fr[8]-42.42640687119286*fl[8])*amax-18.97366596101028*(alpha[4]*favg[17]+alpha[1]*favg[13])-21.21320343559643*(alpha[2]*favg[10]+alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[38]-94.86832980505142*fl[38]-73.48469228349535*(fr[18]+fl[18])+42.42640687119286*fr[10]-42.42640687119286*fl[10])*amax-18.97366596101028*(alpha[4]*favg[18]+alpha[2]*favg[14])-21.21320343559643*(alpha[1]*favg[10]+alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3])); 
  Ghat[7] = 0.008333333333333333*((73.48469228349536*(fr[19]+fl[19])-42.42640687119286*fr[11]+42.42640687119286*fl[11])*amax+21.21320343559643*alpha[2]*favg[11]+21.21320343559643*alpha[0]*favg[7]+18.97366596101028*(alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.008333333333333333*((73.48469228349536*(fr[24]+fl[24])-42.42640687119286*fr[13]+42.42640687119286*fl[13])*amax+21.21320343559643*alpha[1]*favg[12]+21.21320343559643*alpha[0]*favg[8]+18.97366596101028*(alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.01863389981249824*((32.86335345030997*(fr[29]+fl[29])-18.97366596101028*fr[14]+18.97366596101028*fl[14])*amax+9.48683298050514*(alpha[4]*favg[19]+alpha[2]*favg[16]+alpha[1]*favg[15]+alpha[0]*favg[9])); 
  Ghat[10] = -0.008333333333333333*((94.8683298050514*fr[45]-94.8683298050514*fl[45]-73.48469228349535*(fr[31]+fl[31])+42.42640687119286*fr[17]-42.42640687119286*fl[17])*amax-18.97366596101028*(alpha[2]*favg[18]+alpha[1]*favg[17]+alpha[4]*(favg[14]+favg[13]))-21.21320343559643*(alpha[0]*favg[10]+alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4])); 
  Ghat[11] = 0.008333333333333333*((73.48469228349536*(fr[32]+fl[32])-42.42640687119286*fr[21]+42.42640687119286*fl[21])*amax+16.97056274847715*alpha[4]*favg[12]+21.21320343559643*alpha[0]*favg[11]+21.21320343559643*alpha[2]*favg[7]+18.97366596101028*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 0.008333333333333333*((73.48469228349536*(fr[34]+fl[34])-42.42640687119286*fr[23]+42.42640687119286*fl[23])*amax+21.21320343559643*alpha[0]*favg[12]+16.97056274847715*alpha[4]*favg[11]+21.21320343559643*alpha[1]*favg[8]+18.97366596101028*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.008333333333333333*((73.48469228349536*(fr[35]+fl[35])-42.42640687119286*fr[25]+42.42640687119286*fl[25])*amax+21.21320343559643*alpha[2]*favg[17]+21.21320343559643*alpha[0]*favg[13]+18.97366596101028*(alpha[4]*favg[10]+alpha[1]*favg[5])); 
  Ghat[14] = 0.008333333333333333*((73.48469228349536*(fr[40]+fl[40])-42.42640687119286*fr[27]+42.42640687119286*fl[27])*amax+21.21320343559643*alpha[1]*favg[18]+21.21320343559643*alpha[0]*favg[14]+18.97366596101028*(alpha[4]*favg[10]+alpha[2]*favg[6])); 
  Ghat[15] = 0.03227486121839514*((18.97366596101028*(fr[41]+fl[41])-10.95445115010333*fr[28]+10.95445115010333*fl[28])*amax+5.477225575051662*(alpha[2]*favg[19]+alpha[4]*favg[16]+alpha[0]*favg[15]+alpha[1]*favg[9])); 
  Ghat[16] = 0.03227486121839514*((18.97366596101028*(fr[43]+fl[43])-10.95445115010333*fr[30]+10.95445115010333*fl[30])*amax+5.477225575051662*(alpha[1]*favg[19]+alpha[0]*favg[16]+alpha[4]*favg[15]+alpha[2]*favg[9])); 
  Ghat[17] = 0.008333333333333333*((73.48469228349536*(fr[44]+fl[44])-42.42640687119286*fr[37]+42.42640687119286*fl[37])*amax+16.97056274847715*alpha[4]*favg[18]+21.21320343559643*alpha[0]*favg[17]+21.21320343559643*alpha[2]*favg[13]+18.97366596101028*(alpha[1]*favg[10]+alpha[4]*favg[5])); 
  Ghat[18] = 0.008333333333333333*((73.48469228349536*(fr[46]+fl[46])-42.42640687119286*fr[39]+42.42640687119286*fl[39])*amax+21.21320343559643*alpha[0]*favg[18]+16.97056274847715*alpha[4]*favg[17]+21.21320343559643*alpha[1]*favg[14]+18.97366596101028*(alpha[2]*favg[10]+alpha[4]*favg[6])); 
  Ghat[19] = 0.01863389981249824*((32.86335345030997*(fr[47]+fl[47])-18.97366596101028*fr[42]+18.97366596101028*fl[42])*amax+9.48683298050514*(alpha[0]*favg[19]+alpha[1]*favg[16]+alpha[2]*favg[15]+alpha[4]*favg[9])); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_y; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_y; 
  incr[2] = -1.224744871391589*Ghat[0]*dfac_y; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_y; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_y; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_y; 
  incr[6] = 0.7071067811865475*Ghat[4]*dfac_y; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_y; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_y; 
  incr[9] = -1.224744871391589*Ghat[3]*dfac_y; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_y; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_y; 
  incr[12] = 1.58113883008419*Ghat[0]*dfac_y; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_y; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_y; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_y; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_y; 
  incr[17] = 0.7071067811865475*Ghat[10]*dfac_y; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_y; 
  incr[19] = -1.224744871391589*Ghat[7]*dfac_y; 
  incr[20] = 1.58113883008419*Ghat[1]*dfac_y; 
  incr[21] = 0.7071067811865475*Ghat[11]*dfac_y; 
  incr[22] = 1.58113883008419*Ghat[2]*dfac_y; 
  incr[23] = 0.7071067811865475*Ghat[12]*dfac_y; 
  incr[24] = -1.224744871391589*Ghat[8]*dfac_y; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_y; 
  incr[26] = 1.58113883008419*Ghat[3]*dfac_y; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_y; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_y; 
  incr[29] = -1.224744871391589*Ghat[9]*dfac_y; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_y; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_y; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_y; 
  incr[33] = 1.58113883008419*Ghat[4]*dfac_y; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_y; 
  incr[35] = -1.224744871391589*Ghat[13]*dfac_y; 
  incr[36] = 1.58113883008419*Ghat[5]*dfac_y; 
  incr[37] = 0.7071067811865475*Ghat[17]*dfac_y; 
  incr[38] = 1.58113883008419*Ghat[6]*dfac_y; 
  incr[39] = 0.7071067811865475*Ghat[18]*dfac_y; 
  incr[40] = -1.224744871391589*Ghat[14]*dfac_y; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_y; 
  incr[42] = 0.7071067811865475*Ghat[19]*dfac_y; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_y; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_y; 
  incr[45] = 1.58113883008419*Ghat[10]*dfac_y; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_y; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_y; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += -1.0*incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += -1.0*incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += -1.0*incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += -1.0*incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += -1.0*incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Vpar_P2_Bvars_0(const double q_, const double m_, const double cfl, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *geoX, const double *geoY, const double *geoZ, const double *Phi, const double *Apar, const double *dApardt, const double *fl, const double *fr, double *outl, double *outr) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = (0.03125*(3.0*BmagInv[0]*geoZ[0]*(5.0*(Apar[6]*Phi[7]-1.0*Phi[6]*Apar[7])+2.23606797749979*(Apar[3]*Phi[5]-1.0*(Phi[3]*Apar[5]+Apar[3]*Phi[4]-1.0*Phi[3]*Apar[4]))+Apar[1]*Phi[2]-1.0*Phi[1]*Apar[2])*dfac_x*dfac_y-8.0*dApardt[0])*q_)/m_; 

  double alpha[20]; 
  alpha[0] = (0.1767766952966368*(BmagInv[0]*geoZ[0]*(15.0*Apar[6]*Phi[7]-15.0*Phi[6]*Apar[7]+6.708203932499369*Apar[3]*Phi[5]-6.708203932499369*(Phi[3]*Apar[5]+Apar[3]*Phi[4])+6.708203932499369*Phi[3]*Apar[4]+3.0*Apar[1]*Phi[2]-3.0*Phi[1]*Apar[2])*dfac_x*dfac_y-8.0*dApardt[0])*q_)/m_; 
  alpha[1] = (0.03535533905932736*(BmagInv[0]*geoZ[0]*(33.54101966249684*Apar[3]*Phi[7]-33.54101966249684*Phi[3]*Apar[7]+(30.0*Apar[4]-75.00000000000001*Apar[5])*Phi[6]+(75.00000000000001*Phi[5]-30.0*Phi[4])*Apar[6]-33.54101966249685*Apar[2]*Phi[4]+33.54101966249685*Phi[2]*Apar[4]+15.0*Apar[1]*Phi[3]-15.0*Phi[1]*Apar[3])*dfac_x*dfac_y-40.0*dApardt[1])*q_)/m_; 
  alpha[2] = -(0.03535533905932736*(BmagInv[0]*geoZ[0]*((30.0*Apar[5]-75.00000000000001*Apar[4])*Phi[7]+(75.00000000000001*Phi[4]-30.0*Phi[5])*Apar[7]+33.54101966249684*Apar[3]*Phi[6]-33.54101966249684*Phi[3]*Apar[6]-33.54101966249685*Apar[1]*Phi[5]+33.54101966249685*Phi[1]*Apar[5]+15.0*Apar[2]*Phi[3]-15.0*Phi[2]*Apar[3])*dfac_x*dfac_y+40.0*dApardt[2])*q_)/m_; 
  alpha[4] = (0.1767766952966368*(BmagInv[0]*geoZ[0]*(6.708203932499369*Apar[1]*Phi[7]-6.708203932499369*(Phi[1]*Apar[7]+Apar[2]*Phi[6])+6.708203932499369*Phi[2]*Apar[6]+15.0*Apar[4]*Phi[5]-15.0*Phi[4]*Apar[5])*dfac_x*dfac_y-8.0*dApardt[3])*q_)/m_; 
  alpha[7] = (0.03535533905932736*(BmagInv[0]*geoZ[0]*(67.0820393249937*Apar[6]*Phi[7]+Phi[6]*(15.0*Apar[1]-67.0820393249937*Apar[7])-15.0*Phi[1]*Apar[6]-30.0*Apar[3]*Phi[4]+30.0*Phi[3]*Apar[4])*dfac_x*dfac_y-40.0*dApardt[4])*q_)/m_; 
  alpha[8] = (0.03535533905932736*(BmagInv[0]*geoZ[0]*((67.0820393249937*Apar[6]-15.0*Apar[2])*Phi[7]+(15.0*Phi[2]-67.0820393249937*Phi[6])*Apar[7]+30.0*Apar[3]*Phi[5]-30.0*Phi[3]*Apar[5])*dfac_x*dfac_y-40.0*dApardt[5])*q_)/m_; 
  alpha[11] = (0.1767766952966368*(BmagInv[0]*geoZ[0]*(13.41640786499874*Apar[4]*Phi[7]-13.41640786499874*Phi[4]*Apar[7]-3.0*Apar[3]*Phi[6]+3.0*Phi[3]*Apar[6])*dfac_x*dfac_y-8.0*dApardt[6])*q_)/m_; 
  alpha[12] = (0.1767766952966368*(BmagInv[0]*geoZ[0]*(3.0*Apar[3]*Phi[7]-3.0*Phi[3]*Apar[7]-13.41640786499874*Apar[5]*Phi[6]+13.41640786499874*Phi[5]*Apar[6])*dfac_x*dfac_y-8.0*dApardt[7])*q_)/m_; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[13]+fl[13])+1.732050807568877*(fl[3]-1.0*fr[3])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[23]+fl[23])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[24]+fl[24])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[2]+fl[2])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[27]+fl[27])+3.0*(fl[10]-1.0*fr[10]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[34]+fl[34])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[5]+fl[5]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[39]+fl[39])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[40]+fl[40])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[9]+fl[9]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[21]-1.0*(8.660254037844387*fl[21]+5.0*(fr[11]+fl[11]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[22]-1.0*(8.660254037844387*fl[22]+5.0*(fr[12]+fl[12]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[30]-1.0*(8.660254037844387*fl[30]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[46]+fl[46])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[16]+fl[16])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[32]-1.0*(8.660254037844387*fl[32]+5.0*(fr[19]+fl[19]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[33]-1.0*(8.660254037844387*fl[33]+5.0*(fr[20]+fl[20]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[37]-1.0*(8.660254037844387*fl[37]+5.0*(fr[25]+fl[25]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[38]-1.0*(8.660254037844387*fl[38]+5.0*(fr[26]+fl[26]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[42]-1.0*(8.660254037844387*fl[42]+5.0*(fr[28]+fl[28]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[43]-1.0*(8.660254037844387*fl[43]+5.0*(fr[29]+fl[29]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[44]-1.0*(8.660254037844387*fl[44]+5.0*(fr[35]+fl[35]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[45]-1.0*(8.660254037844387*fl[45]+5.0*(fr[36]+fl[36]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[41]+fl[41]))); 

//
// //
  Ghat[0] = -0.125*((6.324555320336761*fr[13]-6.324555320336761*fl[13]-4.898979485566357*(fr[3]+fl[3])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[12]*favg[12]+alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[23]-94.8683298050514*fl[23]-73.48469228349535*(fr[6]+fl[6])+42.42640687119286*fr[1]-42.42640687119286*fl[1])*amax-21.21320343559643*(alpha[8]*favg[12]+favg[8]*alpha[12])-18.97366596101028*(alpha[4]*favg[11]+favg[4]*alpha[11]+alpha[1]*favg[7]+favg[1]*alpha[7])-21.21320343559643*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[24]-94.8683298050514*fl[24]-73.48469228349535*(fr[7]+fl[7])+42.42640687119286*fr[2]-42.42640687119286*fl[2])*amax-18.97366596101028*(alpha[4]*favg[12]+favg[4]*alpha[12])-21.21320343559643*(alpha[7]*favg[11]+favg[7]*alpha[11])-18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])-21.21320343559643*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.008333333333333333*((94.8683298050514*fr[27]-94.8683298050514*fl[27]-73.48469228349535*(fr[10]+fl[10])+42.42640687119286*fr[4]-42.42640687119286*fl[4])*amax-21.21320343559643*(alpha[12]*favg[18]+alpha[11]*favg[17]+alpha[8]*favg[14]+alpha[7]*favg[13])-21.21320343559643*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[34]-94.86832980505142*fl[34]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[5]-42.42640687119286*fl[5])*amax+((-16.97056274847715*alpha[11])-18.97366596101028*alpha[2])*favg[12]+((-16.97056274847715*favg[11])-18.97366596101028*favg[2])*alpha[12]-18.97366596101028*(alpha[1]*favg[11]+favg[1]*alpha[11]+alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7])-21.21320343559643*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -0.008333333333333333*((94.86832980505142*fr[39]-94.86832980505142*fl[39]-73.48469228349535*(fr[17]+fl[17])+42.42640687119286*fr[8]-42.42640687119286*fl[8])*amax-21.21320343559643*alpha[8]*favg[18]-18.97366596101028*alpha[4]*favg[17]-21.21320343559643*alpha[12]*favg[14]-18.97366596101028*alpha[1]*favg[13]+favg[10]*((-18.97366596101028*alpha[11])-21.21320343559643*alpha[2])-18.97366596101028*favg[5]*alpha[7]-21.21320343559643*(alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[40]-94.86832980505142*fl[40]-73.48469228349535*(fr[18]+fl[18])+42.42640687119286*fr[9]-42.42640687119286*fl[9])*amax-18.97366596101028*alpha[4]*favg[18]-21.21320343559643*alpha[7]*favg[17]-18.97366596101028*alpha[2]*favg[14]-21.21320343559643*alpha[11]*favg[13]+favg[10]*((-18.97366596101028*alpha[12])-21.21320343559643*alpha[1])-18.97366596101028*favg[6]*alpha[8]-21.21320343559643*(alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3])); 
  Ghat[7] = 0.001190476190476191*((514.3928459844675*(fr[21]+fl[21])-296.98484809835*fr[11]+296.98484809835*fl[11])*amax+132.815661727072*alpha[12]*favg[12]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[11]+148.492424049175*favg[2]*alpha[11]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[7]+148.492424049175*favg[0]*alpha[7]+132.815661727072*(alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.001190476190476191*((514.3928459844675*(fr[22]+fl[22])-296.98484809835*fr[12]+296.98484809835*fl[12])*amax+(94.86832980505142*alpha[12]+148.492424049175*alpha[1])*favg[12]+148.492424049175*favg[1]*alpha[12]+132.815661727072*alpha[11]*favg[11]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[8]+148.492424049175*favg[0]*alpha[8]+132.815661727072*(alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.01863389981249824*((32.86335345030997*(fr[30]+fl[30])-18.97366596101028*fr[14]+18.97366596101028*fl[14])*amax+9.48683298050514*(alpha[4]*favg[19]+alpha[2]*favg[16]+alpha[1]*favg[15]+alpha[0]*favg[9])); 
  Ghat[10] = -0.001666666666666667*((474.341649025257*fr[46]-474.341649025257*fl[46]-367.4234614174767*(fr[31]+fl[31])+212.1320343559643*fr[16]-212.1320343559643*fl[16])*amax+((-84.85281374238573*alpha[11])-94.86832980505142*alpha[2])*favg[18]+((-84.85281374238573*alpha[12])-94.86832980505142*alpha[1])*favg[17]-94.8683298050514*(alpha[4]*(favg[14]+favg[13])+favg[6]*alpha[12]+favg[5]*alpha[11])+((-94.86832980505142*(alpha[8]+alpha[7]))-106.0660171779821*alpha[0])*favg[10]-106.0660171779821*(alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4])); 
  Ghat[11] = 0.001190476190476191*((514.3928459844675*(fr[32]+fl[32])-296.98484809835*fr[19]+296.98484809835*fl[19])*amax+118.79393923934*(alpha[4]*favg[12]+favg[4]*alpha[12])+(132.815661727072*alpha[8]+94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[11]+(132.815661727072*favg[8]+94.86832980505142*favg[7]+148.492424049175*favg[0])*alpha[11]+148.492424049175*(alpha[2]*favg[7]+favg[2]*alpha[7])+132.815661727072*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 0.001190476190476191*((514.3928459844675*(fr[33]+fl[33])-296.98484809835*fr[20]+296.98484809835*fl[20])*amax+(94.86832980505142*alpha[8]+132.815661727072*alpha[7]+148.492424049175*alpha[0])*favg[12]+(94.86832980505142*favg[8]+132.815661727072*favg[7]+148.492424049175*favg[0])*alpha[12]+118.79393923934*(alpha[4]*favg[11]+favg[4]*alpha[11])+148.492424049175*(alpha[1]*favg[8]+favg[1]*alpha[8])+132.815661727072*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.001190476190476191*((514.3928459844675*(fr[37]+fl[37])-296.98484809835*fr[25]+296.98484809835*fl[25])*amax+132.815661727072*alpha[12]*favg[18]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[17]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[13]+148.492424049175*favg[6]*alpha[11]+132.815661727072*alpha[4]*favg[10]+148.492424049175*favg[3]*alpha[7]+132.815661727072*alpha[1]*favg[5]); 
  Ghat[14] = 0.001190476190476191*((514.3928459844675*(fr[38]+fl[38])-296.98484809835*fr[26]+296.98484809835*fl[26])*amax+(94.86832980505142*alpha[12]+148.492424049175*alpha[1])*favg[18]+132.815661727072*alpha[11]*favg[17]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[14]+148.492424049175*favg[5]*alpha[12]+132.815661727072*alpha[4]*favg[10]+148.492424049175*favg[3]*alpha[8]+132.815661727072*alpha[2]*favg[6]); 
  Ghat[15] = 0.006454972243679028*((94.86832980505142*(fr[42]+fl[42])-54.77225575051663*fr[28]+54.77225575051663*fl[28])*amax+(24.49489742783179*alpha[11]+27.38612787525831*alpha[2])*favg[19]+27.38612787525831*alpha[4]*favg[16]+(24.49489742783179*alpha[7]+27.38612787525831*alpha[0])*favg[15]+27.38612787525831*alpha[1]*favg[9]); 
  Ghat[16] = 0.006454972243679028*((94.86832980505142*(fr[43]+fl[43])-54.77225575051663*fr[29]+54.77225575051663*fl[29])*amax+(24.49489742783179*alpha[12]+27.38612787525831*alpha[1])*favg[19]+(24.49489742783179*alpha[8]+27.38612787525831*alpha[0])*favg[16]+27.38612787525831*alpha[4]*favg[15]+27.38612787525831*alpha[2]*favg[9]); 
  Ghat[17] = 2.380952380952381e-4*((2571.964229922338*(fr[44]+fl[44])-1484.92424049175*fr[35]+1484.92424049175*fl[35])*amax+593.9696961967002*alpha[4]*favg[18]+(664.0783086353599*alpha[8]+474.3416490252571*alpha[7]+742.462120245875*alpha[0])*favg[17]+664.0783086353599*alpha[11]*favg[14]+(474.3416490252571*alpha[11]+742.462120245875*alpha[2])*favg[13]+593.9696961967002*favg[10]*alpha[12]+742.462120245875*favg[3]*alpha[11]+664.0783086353599*alpha[1]*favg[10]+742.462120245875*favg[6]*alpha[7]+664.0783086353599*alpha[4]*favg[5]); 
  Ghat[18] = 2.380952380952381e-4*((2571.964229922338*(fr[45]+fl[45])-1484.92424049175*fr[36]+1484.92424049175*fl[36])*amax+(474.3416490252571*alpha[8]+664.0783086353599*alpha[7]+742.462120245875*alpha[0])*favg[18]+593.9696961967002*alpha[4]*favg[17]+(474.3416490252571*alpha[12]+742.462120245875*alpha[1])*favg[14]+alpha[12]*(664.0783086353599*favg[13]+742.462120245875*favg[3])+favg[10]*(593.9696961967002*alpha[11]+664.0783086353599*alpha[2])+742.462120245875*favg[5]*alpha[8]+664.0783086353599*alpha[4]*favg[6]); 
  Ghat[19] = 0.01863389981249824*((32.86335345030997*(fr[47]+fl[47])-18.97366596101028*fr[41]+18.97366596101028*fl[41])*amax+(8.485281374238571*(alpha[8]+alpha[7])+9.48683298050514*alpha[0])*favg[19]+(8.485281374238571*alpha[12]+9.48683298050514*alpha[1])*favg[16]+(8.485281374238571*alpha[11]+9.48683298050514*alpha[2])*favg[15]+9.48683298050514*alpha[4]*favg[9]); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_v; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_v; 
  incr[2] = 0.7071067811865475*Ghat[2]*dfac_v; 
  incr[3] = -1.224744871391589*Ghat[0]*dfac_v; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_v; 
  incr[5] = 0.7071067811865475*Ghat[4]*dfac_v; 
  incr[6] = -1.224744871391589*Ghat[1]*dfac_v; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_v; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_v; 
  incr[9] = 0.7071067811865475*Ghat[6]*dfac_v; 
  incr[10] = -1.224744871391589*Ghat[3]*dfac_v; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_v; 
  incr[12] = 0.7071067811865475*Ghat[8]*dfac_v; 
  incr[13] = 1.58113883008419*Ghat[0]*dfac_v; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_v; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_v; 
  incr[16] = 0.7071067811865475*Ghat[10]*dfac_v; 
  incr[17] = -1.224744871391589*Ghat[5]*dfac_v; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_v; 
  incr[19] = 0.7071067811865475*Ghat[11]*dfac_v; 
  incr[20] = 0.7071067811865475*Ghat[12]*dfac_v; 
  incr[21] = -1.224744871391589*Ghat[7]*dfac_v; 
  incr[22] = -1.224744871391589*Ghat[8]*dfac_v; 
  incr[23] = 1.58113883008419*Ghat[1]*dfac_v; 
  incr[24] = 1.58113883008419*Ghat[2]*dfac_v; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_v; 
  incr[26] = 0.7071067811865475*Ghat[14]*dfac_v; 
  incr[27] = 1.58113883008419*Ghat[3]*dfac_v; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_v; 
  incr[29] = 0.7071067811865475*Ghat[16]*dfac_v; 
  incr[30] = -1.224744871391589*Ghat[9]*dfac_v; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_v; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_v; 
  incr[33] = -1.224744871391589*Ghat[12]*dfac_v; 
  incr[34] = 1.58113883008419*Ghat[4]*dfac_v; 
  incr[35] = 0.7071067811865475*Ghat[17]*dfac_v; 
  incr[36] = 0.7071067811865475*Ghat[18]*dfac_v; 
  incr[37] = -1.224744871391589*Ghat[13]*dfac_v; 
  incr[38] = -1.224744871391589*Ghat[14]*dfac_v; 
  incr[39] = 1.58113883008419*Ghat[5]*dfac_v; 
  incr[40] = 1.58113883008419*Ghat[6]*dfac_v; 
  incr[41] = 0.7071067811865475*Ghat[19]*dfac_v; 
  incr[42] = -1.224744871391589*Ghat[15]*dfac_v; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_v; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_v; 
  incr[45] = -1.224744871391589*Ghat[18]*dfac_v; 
  incr[46] = 1.58113883008419*Ghat[10]*dfac_v; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_v; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += -1.0*incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += -1.0*incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += incr[21]; 
  outl[22] += incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += -1.0*incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += incr[37]; 
  outl[38] += incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += -1.0*incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += -1.0*incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_X_P2_Bvars_1(const double q_, const double m_, const double cfl, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *geoX, const double *geoY, const double *geoZ, const double *Phi, const double *Apar, const double *dApardt, const double *fl, const double *fr, double *outl, double *outr) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = 0.0625*dfac_y*((3.872983346207417*((5.0*BmagInv[4]+2.23606797749979*(BmagInv[0]-1.732050807568877*BmagInv[1]))*geoZ[4]+2.23606797749979*(geoZ[0]-1.732050807568877*geoZ[1])*BmagInv[4]+(3.0*BmagInv[1]-1.732050807568877*BmagInv[0])*geoZ[1]+geoZ[0]*(BmagInv[0]-1.732050807568877*BmagInv[1]))*Apar[6]+(5.0*(1.732050807568877*Apar[2]-3.0*Apar[3])*BmagInv[4]+2.23606797749979*((5.196152422706631*BmagInv[1]-3.0*BmagInv[0])*Apar[3]+(1.732050807568877*BmagInv[0]-3.0*BmagInv[1])*Apar[2]))*geoZ[4]+2.23606797749979*((5.196152422706631*geoZ[1]-3.0*geoZ[0])*Apar[3]+(1.732050807568877*geoZ[0]-3.0*geoZ[1])*Apar[2])*BmagInv[4]+((5.196152422706631*BmagInv[0]-9.0*BmagInv[1])*geoZ[1]+geoZ[0]*(5.196152422706631*BmagInv[1]-3.0*BmagInv[0]))*Apar[3]+((5.196152422706631*BmagInv[1]-3.0*BmagInv[0])*geoZ[1]+geoZ[0]*(1.732050807568877*BmagInv[0]-3.0*BmagInv[1]))*Apar[2])*wv-2.0*(3.872983346207417*(2.23606797749979*geoZ[4]-1.732050807568877*geoZ[1]+geoZ[0])*Phi[6]-1.0*(2.23606797749979*(3.0*Phi[3]-1.732050807568877*Phi[2])*geoZ[4]+(3.0*geoZ[0]-5.196152422706631*geoZ[1])*Phi[3]+(3.0*geoZ[1]-1.732050807568877*geoZ[0])*Phi[2]))); 

  double alpha[20]; 
  alpha[0] = 0.3535533905932737*dfac_y*((((19.36491673103708*BmagInv[4]-15.0*BmagInv[1]+8.660254037844387*BmagInv[0])*geoZ[4]+(8.660254037844387*geoZ[0]-15.0*geoZ[1])*BmagInv[4]+(11.61895003862225*BmagInv[1]-6.708203932499369*BmagInv[0])*geoZ[1]+geoZ[0]*(3.872983346207417*BmagInv[0]-6.708203932499369*BmagInv[1]))*Apar[6]+((8.660254037844386*Apar[2]-15.0*Apar[3])*BmagInv[4]+(11.61895003862225*BmagInv[1]-6.708203932499369*BmagInv[0])*Apar[3]+(3.872983346207417*BmagInv[0]-6.708203932499369*BmagInv[1])*Apar[2])*geoZ[4]+((11.61895003862225*geoZ[1]-6.708203932499369*geoZ[0])*Apar[3]+(3.872983346207417*geoZ[0]-6.708203932499369*geoZ[1])*Apar[2])*BmagInv[4]+((5.196152422706631*BmagInv[0]-9.0*BmagInv[1])*geoZ[1]+geoZ[0]*(5.196152422706631*BmagInv[1]-3.0*BmagInv[0]))*Apar[3]+((5.196152422706631*BmagInv[1]-3.0*BmagInv[0])*geoZ[1]+geoZ[0]*(1.732050807568877*BmagInv[0]-3.0*BmagInv[1]))*Apar[2])*wv+((-17.32050807568877*geoZ[4])+13.41640786499874*geoZ[1]-7.745966692414834*geoZ[0])*Phi[6]+(13.41640786499874*Phi[3]-7.745966692414834*Phi[2])*geoZ[4]+(6.0*geoZ[0]-10.39230484541326*geoZ[1])*Phi[3]+(6.0*geoZ[1]-3.464101615137754*geoZ[0])*Phi[2]); 
  alpha[1] = -0.3535533905932737*dfac_y*((((33.54101966249684*BmagInv[4]-25.98076211353316*BmagInv[1]+15.0*BmagInv[0])*geoZ[4]+(15.0*geoZ[0]-25.98076211353316*geoZ[1])*BmagInv[4]+(20.1246117974981*BmagInv[1]-11.61895003862225*BmagInv[0])*geoZ[1]+geoZ[0]*(6.708203932499369*BmagInv[0]-11.61895003862225*BmagInv[1]))*Apar[7]+(((-19.36491673103709*BmagInv[4])+15.0*BmagInv[1]-8.660254037844386*BmagInv[0])*geoZ[4]+(15.0*geoZ[1]-8.660254037844386*geoZ[0])*BmagInv[4]+(6.708203932499369*BmagInv[0]-11.61895003862225*BmagInv[1])*geoZ[1]+geoZ[0]*(6.708203932499369*BmagInv[1]-3.872983346207417*BmagInv[0]))*Apar[5])*wv+((-30.0*geoZ[4])+23.2379000772445*geoZ[1]-13.41640786499874*geoZ[0])*Phi[7]+(17.32050807568877*geoZ[4]-13.41640786499874*geoZ[1]+7.745966692414834*geoZ[0])*Phi[5]); 
  alpha[2] = (0.1178511301977579*(((33.54101966249684*BmagInv[4]-25.98076211353316*BmagInv[1]+15.0*BmagInv[0])*geoZ[4]+(15.0*geoZ[0]-25.98076211353316*geoZ[1])*BmagInv[4]+(20.1246117974981*BmagInv[1]-11.61895003862225*BmagInv[0])*geoZ[1]+geoZ[0]*(6.708203932499369*BmagInv[0]-11.61895003862225*BmagInv[1]))*Apar[6]+((15.0*Apar[2]-25.98076211353316*Apar[3])*BmagInv[4]+(20.12461179749811*BmagInv[1]-11.61895003862225*BmagInv[0])*Apar[3]+(6.708203932499369*BmagInv[0]-11.61895003862225*BmagInv[1])*Apar[2])*geoZ[4]+((20.12461179749811*geoZ[1]-11.61895003862225*geoZ[0])*Apar[3]+(6.708203932499369*geoZ[0]-11.61895003862225*geoZ[1])*Apar[2])*BmagInv[4]+((9.0*BmagInv[0]-15.58845726811989*BmagInv[1])*geoZ[1]+geoZ[0]*(9.0*BmagInv[1]-5.196152422706631*BmagInv[0]))*Apar[3]+((9.0*BmagInv[1]-5.196152422706631*BmagInv[0])*geoZ[1]+geoZ[0]*(3.0*BmagInv[0]-5.196152422706631*BmagInv[1]))*Apar[2])*dfac_y)/dfac_v; 
  alpha[4] = -(0.3535533905932737*(((19.36491673103708*BmagInv[4]-15.0*BmagInv[1]+8.660254037844387*BmagInv[0])*geoZ[4]+(8.660254037844387*geoZ[0]-15.0*geoZ[1])*BmagInv[4]+(11.61895003862225*BmagInv[1]-6.708203932499369*BmagInv[0])*geoZ[1]+geoZ[0]*(3.872983346207417*BmagInv[0]-6.708203932499369*BmagInv[1]))*Apar[7]+(((-11.18033988749895*BmagInv[4])+8.660254037844386*BmagInv[1]-5.0*BmagInv[0])*geoZ[4]+(8.660254037844386*geoZ[1]-5.0*geoZ[0])*BmagInv[4]+(3.872983346207417*BmagInv[0]-6.708203932499369*BmagInv[1])*geoZ[1]+geoZ[0]*(3.872983346207417*BmagInv[1]-2.23606797749979*BmagInv[0]))*Apar[5])*dfac_y)/dfac_v; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[11]+fl[11])+1.732050807568877*(fl[1]-1.0*fr[1])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[19]+fl[19])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[2]+fl[2])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[21]+fl[21])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[25]+fl[25])+3.0*(fl[8]-1.0*fr[8]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[32]+fl[32])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[7]+fl[7]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[35]+fl[35])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[9]+fl[9]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[37]+fl[37])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[20]-1.0*(8.660254037844387*fl[20]+5.0*(fr[12]+fl[12]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[23]-1.0*(8.660254037844387*fl[23]+5.0*(fr[13]+fl[13]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[28]-1.0*(8.660254037844387*fl[28]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[44]+fl[44])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[18]+fl[18])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[33]-1.0*(8.660254037844387*fl[33]+5.0*(fr[22]+fl[22]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[34]-1.0*(8.660254037844387*fl[34]+5.0*(fr[24]+fl[24]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[36]-1.0*(8.660254037844387*fl[36]+5.0*(fr[26]+fl[26]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[39]-1.0*(8.660254037844387*fl[39]+5.0*(fr[27]+fl[27]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[41]-1.0*(8.660254037844387*fl[41]+5.0*(fr[29]+fl[29]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[42]-1.0*(8.660254037844387*fl[42]+5.0*(fr[30]+fl[30]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[45]-1.0*(8.660254037844387*fl[45]+5.0*(fr[38]+fl[38]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[46]-1.0*(8.660254037844387*fl[46]+5.0*(fr[40]+fl[40]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[43]+fl[43]))); 

//
// //
  Ghat[0] = -0.125*((6.324555320336761*fr[11]-6.324555320336761*fl[11]-4.898979485566357*(fr[1]+fl[1])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[19]-94.8683298050514*fl[19]-73.48469228349535*(fr[5]+fl[5])+42.42640687119286*fr[2]-42.42640687119286*fl[2])*amax-18.97366596101028*(alpha[4]*favg[11]+alpha[1]*favg[7])-21.21320343559643*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[21]-94.8683298050514*fl[21]-73.48469228349535*(fr[6]+fl[6])+42.42640687119286*fr[3]-42.42640687119286*fl[3])*amax-18.97366596101028*(alpha[4]*favg[12]+alpha[2]*favg[8])-21.21320343559643*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.04166666666666666*((18.97366596101028*fr[25]-18.97366596101028*fl[25]-14.69693845669907*(fr[8]+fl[8])+8.485281374238571*fr[4]-8.485281374238571*fl[4])*amax-4.242640687119286*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[32]-94.86832980505142*fl[32]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[7]-42.42640687119286*fl[7])*amax-18.97366596101028*(alpha[2]*favg[12]+alpha[1]*favg[11]+alpha[4]*(favg[8]+favg[7]))-21.21320343559643*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -0.008333333333333333*((94.86832980505142*fr[35]-94.86832980505142*fl[35]-73.48469228349535*(fr[16]+fl[16])+42.42640687119286*fr[9]-42.42640687119286*fl[9])*amax-18.97366596101028*(alpha[4]*favg[17]+alpha[1]*favg[13])-21.21320343559643*(alpha[2]*favg[10]+alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[37]-94.86832980505142*fl[37]-73.48469228349535*(fr[17]+fl[17])+42.42640687119286*fr[10]-42.42640687119286*fl[10])*amax-18.97366596101028*(alpha[4]*favg[18]+alpha[2]*favg[14])-21.21320343559643*(alpha[1]*favg[10]+alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3])); 
  Ghat[7] = 0.008333333333333333*((73.48469228349536*(fr[20]+fl[20])-42.42640687119286*fr[12]+42.42640687119286*fl[12])*amax+21.21320343559643*alpha[2]*favg[11]+21.21320343559643*alpha[0]*favg[7]+18.97366596101028*(alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.008333333333333333*((73.48469228349536*(fr[23]+fl[23])-42.42640687119286*fr[13]+42.42640687119286*fl[13])*amax+21.21320343559643*alpha[1]*favg[12]+21.21320343559643*alpha[0]*favg[8]+18.97366596101028*(alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.01863389981249824*((32.86335345030997*(fr[28]+fl[28])-18.97366596101028*fr[14]+18.97366596101028*fl[14])*amax+9.48683298050514*(alpha[4]*favg[19]+alpha[2]*favg[16]+alpha[1]*favg[15]+alpha[0]*favg[9])); 
  Ghat[10] = -0.008333333333333333*((94.8683298050514*fr[44]-94.8683298050514*fl[44]-73.48469228349535*(fr[31]+fl[31])+42.42640687119286*fr[18]-42.42640687119286*fl[18])*amax-18.97366596101028*(alpha[2]*favg[18]+alpha[1]*favg[17]+alpha[4]*(favg[14]+favg[13]))-21.21320343559643*(alpha[0]*favg[10]+alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4])); 
  Ghat[11] = 0.008333333333333333*((73.48469228349536*(fr[33]+fl[33])-42.42640687119286*fr[22]+42.42640687119286*fl[22])*amax+16.97056274847715*alpha[4]*favg[12]+21.21320343559643*alpha[0]*favg[11]+21.21320343559643*alpha[2]*favg[7]+18.97366596101028*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 0.008333333333333333*((73.48469228349536*(fr[34]+fl[34])-42.42640687119286*fr[24]+42.42640687119286*fl[24])*amax+21.21320343559643*alpha[0]*favg[12]+16.97056274847715*alpha[4]*favg[11]+21.21320343559643*alpha[1]*favg[8]+18.97366596101028*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.008333333333333333*((73.48469228349536*(fr[36]+fl[36])-42.42640687119286*fr[26]+42.42640687119286*fl[26])*amax+21.21320343559643*alpha[2]*favg[17]+21.21320343559643*alpha[0]*favg[13]+18.97366596101028*(alpha[4]*favg[10]+alpha[1]*favg[5])); 
  Ghat[14] = 0.008333333333333333*((73.48469228349536*(fr[39]+fl[39])-42.42640687119286*fr[27]+42.42640687119286*fl[27])*amax+21.21320343559643*alpha[1]*favg[18]+21.21320343559643*alpha[0]*favg[14]+18.97366596101028*(alpha[4]*favg[10]+alpha[2]*favg[6])); 
  Ghat[15] = 0.03227486121839514*((18.97366596101028*(fr[41]+fl[41])-10.95445115010333*fr[29]+10.95445115010333*fl[29])*amax+5.477225575051662*(alpha[2]*favg[19]+alpha[4]*favg[16]+alpha[0]*favg[15]+alpha[1]*favg[9])); 
  Ghat[16] = 0.03227486121839514*((18.97366596101028*(fr[42]+fl[42])-10.95445115010333*fr[30]+10.95445115010333*fl[30])*amax+5.477225575051662*(alpha[1]*favg[19]+alpha[0]*favg[16]+alpha[4]*favg[15]+alpha[2]*favg[9])); 
  Ghat[17] = 0.008333333333333333*((73.48469228349536*(fr[45]+fl[45])-42.42640687119286*fr[38]+42.42640687119286*fl[38])*amax+16.97056274847715*alpha[4]*favg[18]+21.21320343559643*alpha[0]*favg[17]+21.21320343559643*alpha[2]*favg[13]+18.97366596101028*(alpha[1]*favg[10]+alpha[4]*favg[5])); 
  Ghat[18] = 0.008333333333333333*((73.48469228349536*(fr[46]+fl[46])-42.42640687119286*fr[40]+42.42640687119286*fl[40])*amax+21.21320343559643*alpha[0]*favg[18]+16.97056274847715*alpha[4]*favg[17]+21.21320343559643*alpha[1]*favg[14]+18.97366596101028*(alpha[2]*favg[10]+alpha[4]*favg[6])); 
  Ghat[19] = 0.01863389981249824*((32.86335345030997*(fr[47]+fl[47])-18.97366596101028*fr[43]+18.97366596101028*fl[43])*amax+9.48683298050514*(alpha[0]*favg[19]+alpha[1]*favg[16]+alpha[2]*favg[15]+alpha[4]*favg[9])); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_x; 
  incr[1] = -1.224744871391589*Ghat[0]*dfac_x; 
  incr[2] = 0.7071067811865475*Ghat[1]*dfac_x; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_x; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_x; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_x; 
  incr[6] = -1.224744871391589*Ghat[2]*dfac_x; 
  incr[7] = 0.7071067811865475*Ghat[4]*dfac_x; 
  incr[8] = -1.224744871391589*Ghat[3]*dfac_x; 
  incr[9] = 0.7071067811865475*Ghat[5]*dfac_x; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_x; 
  incr[11] = 1.58113883008419*Ghat[0]*dfac_x; 
  incr[12] = 0.7071067811865475*Ghat[7]*dfac_x; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_x; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_x; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_x; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_x; 
  incr[17] = -1.224744871391589*Ghat[6]*dfac_x; 
  incr[18] = 0.7071067811865475*Ghat[10]*dfac_x; 
  incr[19] = 1.58113883008419*Ghat[1]*dfac_x; 
  incr[20] = -1.224744871391589*Ghat[7]*dfac_x; 
  incr[21] = 1.58113883008419*Ghat[2]*dfac_x; 
  incr[22] = 0.7071067811865475*Ghat[11]*dfac_x; 
  incr[23] = -1.224744871391589*Ghat[8]*dfac_x; 
  incr[24] = 0.7071067811865475*Ghat[12]*dfac_x; 
  incr[25] = 1.58113883008419*Ghat[3]*dfac_x; 
  incr[26] = 0.7071067811865475*Ghat[13]*dfac_x; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_x; 
  incr[28] = -1.224744871391589*Ghat[9]*dfac_x; 
  incr[29] = 0.7071067811865475*Ghat[15]*dfac_x; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_x; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_x; 
  incr[32] = 1.58113883008419*Ghat[4]*dfac_x; 
  incr[33] = -1.224744871391589*Ghat[11]*dfac_x; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_x; 
  incr[35] = 1.58113883008419*Ghat[5]*dfac_x; 
  incr[36] = -1.224744871391589*Ghat[13]*dfac_x; 
  incr[37] = 1.58113883008419*Ghat[6]*dfac_x; 
  incr[38] = 0.7071067811865475*Ghat[17]*dfac_x; 
  incr[39] = -1.224744871391589*Ghat[14]*dfac_x; 
  incr[40] = 0.7071067811865475*Ghat[18]*dfac_x; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_x; 
  incr[42] = -1.224744871391589*Ghat[16]*dfac_x; 
  incr[43] = 0.7071067811865475*Ghat[19]*dfac_x; 
  incr[44] = 1.58113883008419*Ghat[10]*dfac_x; 
  incr[45] = -1.224744871391589*Ghat[17]*dfac_x; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_x; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_x; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += -1.0*incr[7]; 
  outl[8] += incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += -1.0*incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += -1.0*incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += -1.0*incr[43]; 
  outl[44] += -1.0*incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Y_P2_Bvars_1(const double q_, const double m_, const double cfl, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *geoX, const double *geoY, const double *geoZ, const double *Phi, const double *Apar, const double *dApardt, const double *fl, const double *fr, double *outl, double *outr) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = (2.976190476190477e-4*dfac_x*(dfac_v2*wv*(72.74613391789283*(5.0*(Bmag[1]*BmagInv[4]+2.0*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(10.0*geoZ[1]*BmagInv[4]+11.18033988749895*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+5.0*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*m_*wv+(3.872983346207417*(((368.9512162874654*Bmag[4]-210.0)*BmagInv[4]+14.0*(15.0*BmagInv[0]*Bmag[4]+6.708203932499369*Bmag[1]*BmagInv[1]))*geoZ[4]+7.0*(2.0*(15.0*geoZ[0]*Bmag[4]+6.708203932499369*Bmag[1]*geoZ[1])*BmagInv[4]+3.0*(2.23606797749979*(9.0*BmagInv[1]*geoZ[1]+5.0*BmagInv[0]*geoZ[0])*Bmag[4]+5.0*((BmagInv[0]*Bmag[1]-2.0*BmagInv[1])*geoZ[1]+geoZ[0]*Bmag[1]*BmagInv[1]))))*Apar[7]+5.196152422706631*(7.0*(11.18033988749895*(Bmag[1]*BmagInv[4]+2.0*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(22.3606797749979*geoZ[1]*BmagInv[4]+25.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+11.18033988749895*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*Apar[5]-3.872983346207417*((5.0*(2.0*Bmag[1]*BmagInv[4]+11.0*BmagInv[1]*Bmag[4])+15.65247584249853*(BmagInv[0]*Bmag[1]-4.0*BmagInv[1]))*geoZ[4]+(55.0*geoZ[1]*Bmag[4]+15.65247584249853*(geoZ[0]*Bmag[1]-4.0*geoZ[1]))*BmagInv[4]+14.0*(2.23606797749979*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]-1.0*((5.0*BmagInv[0]-1.0*Bmag[1]*BmagInv[1])*geoZ[1]+5.0*geoZ[0]*BmagInv[1])))*Apar[6])+((11.18033988749895*(11.0*(5.196152422706631*Apar[1]-9.0*Apar[3])*Bmag[4]+10.39230484541326*Bmag[1]*Apar[4])+35.0*(9.0*(2.0*Apar[3]-1.0*Bmag[1]*Apar[2])+5.196152422706631*(Apar[0]*Bmag[1]-2.0*Apar[1])))*BmagInv[4]+(639.0422521242239*BmagInv[1]*Apar[4]+70.0*(5.196152422706631*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])-9.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])))*Bmag[4]+7.0*(25.98076211353316*(BmagInv[0]*Bmag[1]-4.0*BmagInv[1])*Apar[4]+4.47213595499958*Bmag[1]*BmagInv[1]*(5.196152422706631*Apar[1]-9.0*Apar[3])))*geoZ[4]+((639.0422521242239*geoZ[1]*Apar[4]+70.0*(5.196152422706631*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1])-9.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])))*Bmag[4]+7.0*(25.98076211353316*(geoZ[0]*Bmag[1]-4.0*geoZ[1])*Apar[4]+4.47213595499958*Bmag[1]*geoZ[1]*(5.196152422706631*Apar[1]-9.0*Apar[3])))*BmagInv[4]+7.0*((51.96152422706631*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+2.23606797749979*(5.196152422706631*((9.0*Apar[1]*BmagInv[1]+5.0*Apar[0]*BmagInv[0])*geoZ[1]+5.0*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))-9.0*((9.0*BmagInv[1]*geoZ[1]+5.0*BmagInv[0]*geoZ[0])*Apar[3]+5.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])))*Bmag[4]+23.2379000772445*((Bmag[1]*BmagInv[1]-5.0*BmagInv[0])*geoZ[1]-5.0*geoZ[0]*BmagInv[1])*Apar[4]+5.0*(9.0*(((2.0*BmagInv[1]-1.0*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(2.0*BmagInv[0]-1.0*Bmag[1]*BmagInv[1]))*Apar[3]-1.0*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2])+5.196152422706631*(((Apar[0]*Bmag[1]-2.0*Apar[1])*BmagInv[1]+BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+geoZ[0]*(Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(Apar[0]*Bmag[1]-2.0*Apar[1]))))))*q_)+14.0*(2.0*dfac_v2*(5.196152422706631*(11.18033988749895*geoZ[1]*Bmag[4]+5.0*geoZ[0]*Bmag[1])*wm+(58.09475019311126*geoZ[0]*Phi[7]+5.196152422706631*geoZ[1]*(11.18033988749895*Phi[4]-19.36491673103708*Phi[6])+5.0*geoZ[0]*(5.196152422706631*Phi[1]-9.0*Phi[3]))*q_)+1.732050807568877*(5.0*(Bmag[1]*BmagInv[4]+2.0*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(10.0*geoZ[1]*BmagInv[4]+11.18033988749895*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+5.0*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*m_)))/(dfac_v2*q_); 

  double alpha[20]; 
  alpha[0] = (0.001683587574253684*dfac_x*(dfac_v2*(((363.7306695894642*Bmag[1]*BmagInv[4]+727.4613391789284*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(727.4613391789284*geoZ[1]*BmagInv[4]+813.3265027035576*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+363.7306695894642*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*m_*wv2+((((1428.941916244324*Bmag[4]-813.3265027035576)*BmagInv[4]+813.3265027035576*BmagInv[0]*Bmag[4]+363.7306695894642*Bmag[1]*BmagInv[1])*geoZ[4]+(813.3265027035576*geoZ[0]*Bmag[4]+363.7306695894642*Bmag[1]*geoZ[1])*BmagInv[4]+(1636.788013152589*BmagInv[1]*geoZ[1]+909.3266739736608*BmagInv[0]*geoZ[0])*Bmag[4]+(406.6632513517788*BmagInv[0]*Bmag[1]-813.3265027035576*BmagInv[1])*geoZ[1]+geoZ[0]*(406.6632513517788*Bmag[1]*BmagInv[1]-813.3265027035576*BmagInv[0]))*Apar[7]+(((-201.246117974981*Bmag[1]*BmagInv[4])+BmagInv[1]*(1260.0-1106.853648862396*Bmag[4])-314.9999999999999*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(1260.0-1106.853648862396*Bmag[4])-314.9999999999999*geoZ[0]*Bmag[1])*BmagInv[4]-629.9999999999999*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(1408.722825824867*BmagInv[0]-281.7445651649734*Bmag[1]*BmagInv[1])*geoZ[1]+1408.722825824867*geoZ[0]*BmagInv[1])*Apar[6]+((406.6632513517788*Bmag[1]*BmagInv[4]+813.3265027035576*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(813.3265027035576*geoZ[1]*BmagInv[4]+909.3266739736605*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+406.6632513517788*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*Apar[5]+(((639.0422521242239*Apar[1]-1106.853648862396*Apar[3])*Bmag[4]+116.1895003862225*Bmag[1]*Apar[4]+630.0*Apar[3]+Bmag[1]*(181.8653347947321*Apar[0]-315.0*Apar[2])-363.7306695894642*Apar[1])*BmagInv[4]+(639.0422521242239*BmagInv[1]*Apar[4]-630.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])+363.7306695894642*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+(181.8653347947321*BmagInv[0]*Bmag[1]-727.4613391789284*BmagInv[1])*Apar[4]+Bmag[1]*BmagInv[1]*(162.6653005407115*Apar[1]-281.7445651649735*Apar[3]))*geoZ[4]+((639.0422521242239*geoZ[1]*Apar[4]-630.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])+363.7306695894642*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1]))*Bmag[4]+(181.8653347947321*geoZ[0]*Bmag[1]-727.4613391789284*geoZ[1])*Apar[4]+Bmag[1]*geoZ[1]*(162.6653005407115*Apar[1]-281.7445651649735*Apar[3]))*BmagInv[4]+(363.7306695894642*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+((-1267.850543242381*BmagInv[1]*geoZ[1])-704.3614129124339*BmagInv[0]*geoZ[0])*Apar[3]-704.3614129124339*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]+(731.9938524332015*Apar[1]*BmagInv[1]+406.6632513517788*Apar[0]*BmagInv[0])*geoZ[1]+406.6632513517788*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+((162.6653005407115*Bmag[1]*BmagInv[1]-813.3265027035576*BmagInv[0])*geoZ[1]-813.3265027035576*geoZ[0]*BmagInv[1])*Apar[4]+((630.0*BmagInv[1]-315.0*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(630.0*BmagInv[0]-315.0*Bmag[1]*BmagInv[1]))*Apar[3]-315.0*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2]+((181.8653347947321*Apar[0]*Bmag[1]-363.7306695894642*Apar[1])*BmagInv[1]+181.8653347947321*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+geoZ[0]*(181.8653347947321*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(181.8653347947321*Apar[0]*Bmag[1]-363.7306695894642*Apar[1])))*q_*wv+(1626.653005407115*geoZ[1]*Bmag[4]+727.4613391789284*geoZ[0]*Bmag[1])*wm+(1626.653005407115*geoZ[0]*Phi[7]+geoZ[1]*(1626.653005407115*Phi[4]-2817.445651649735*Phi[6])+geoZ[0]*(727.4613391789284*Phi[1]-1260.0*Phi[3]))*q_)+((121.2435565298214*Bmag[1]*BmagInv[4]+242.4871130596428*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(242.4871130596428*geoZ[1]*BmagInv[4]+271.1088342345192*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+121.2435565298214*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*m_))/(dfac_v2*q_); 
  alpha[1] = (0.001683587574253684*dfac_x*(dfac_v2*(((Bmag[4]*(1278.084504248448*BmagInv[4]+727.4613391789284*BmagInv[0])+325.330601081423*Bmag[1]*BmagInv[1])*geoZ[4]+(727.4613391789284*geoZ[0]*Bmag[4]+325.330601081423*Bmag[1]*geoZ[1])*BmagInv[4]+(1463.987704866403*BmagInv[1]*geoZ[1]+813.3265027035576*BmagInv[0]*geoZ[0])*Bmag[4]+363.7306695894642*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*m_*wv2+(((639.0422521242239*Bmag[1]*BmagInv[4]+BmagInv[1]*(2091.411006952005*Bmag[4]-727.4613391789285)+363.7306695894642*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(2091.411006952005*Bmag[4]-727.4613391789285)+363.7306695894642*geoZ[0]*Bmag[1])*BmagInv[4]+1636.788013152589*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(731.9938524332018*Bmag[1]*BmagInv[1]-813.3265027035576*BmagInv[0])*geoZ[1]+geoZ[0]*(406.6632513517788*BmagInv[0]*Bmag[1]-813.3265027035576*BmagInv[1]))*Apar[7]+(((2213.707297724792-1800.0*Bmag[4])*BmagInv[4]-1106.853648862396*BmagInv[0]*Bmag[4]-495.0*Bmag[1]*BmagInv[1]+1260.0*BmagInv[0])*geoZ[4]+((-1106.853648862396*geoZ[0]*Bmag[4])-495.0*Bmag[1]*geoZ[1]+1260.0*geoZ[0])*BmagInv[4]+((-1620.0*BmagInv[1]*geoZ[1])-629.9999999999999*BmagInv[0]*geoZ[0])*Bmag[4]+(2535.70108648476*BmagInv[1]-281.7445651649734*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(1408.722825824867*BmagInv[0]-281.7445651649734*Bmag[1]*BmagInv[1]))*Apar[6]+((Bmag[4]*(1428.941916244323*BmagInv[4]+813.3265027035576*BmagInv[0])+363.7306695894642*Bmag[1]*BmagInv[1])*geoZ[4]+(813.3265027035576*geoZ[0]*Bmag[4]+363.7306695894642*Bmag[1]*geoZ[1])*BmagInv[4]+(1636.788013152588*BmagInv[1]*geoZ[1]+909.3266739736605*BmagInv[0]*geoZ[0])*Bmag[4]+406.6632513517788*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[5]+(((1039.230484541326*Apar[4]-1106.853648862396*Apar[2]+639.0422521242239*Apar[0])*Bmag[4]-1278.084504248448*Apar[4]+Bmag[1]*(285.7883832488647*Apar[1]-495.0*Apar[3]))*BmagInv[4]+(639.0422521242239*BmagInv[0]*Apar[4]-1620.0*BmagInv[1]*Apar[3]-630.0*BmagInv[0]*Apar[2]+935.3074360871933*Apar[1]*BmagInv[1]+363.7306695894642*Apar[0]*BmagInv[0])*Bmag[4]+(285.7883832488647*Bmag[1]*BmagInv[1]-727.4613391789284*BmagInv[0])*Apar[4]+(563.489130329947*BmagInv[1]-281.7445651649735*BmagInv[0]*Bmag[1])*Apar[3]+BmagInv[1]*(Bmag[1]*(162.6653005407115*Apar[0]-281.7445651649735*Apar[2])-325.330601081423*Apar[1])+162.6653005407115*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[4]+((639.0422521242239*geoZ[0]*Apar[4]-1620.0*geoZ[1]*Apar[3]-630.0*geoZ[0]*Apar[2]+935.3074360871933*Apar[1]*geoZ[1]+363.7306695894642*Apar[0]*geoZ[0])*Bmag[4]+(285.7883832488647*Bmag[1]*geoZ[1]-727.4613391789284*geoZ[0])*Apar[4]+(563.489130329947*geoZ[1]-281.7445651649735*geoZ[0]*Bmag[1])*Apar[3]+geoZ[1]*(Bmag[1]*(162.6653005407115*Apar[0]-281.7445651649735*Apar[2])-325.330601081423*Apar[1])+162.6653005407115*geoZ[0]*Apar[1]*Bmag[1])*BmagInv[4]+((935.3074360871933*BmagInv[1]*geoZ[1]+363.7306695894642*BmagInv[0]*geoZ[0])*Apar[4]-1267.850543242381*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+((-1267.850543242381*BmagInv[1]*geoZ[1])-704.3614129124339*BmagInv[0]*geoZ[0])*Apar[2]+731.9938524332015*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*geoZ[1]+geoZ[0]*(731.9938524332015*Apar[1]*BmagInv[1]+406.6632513517788*Apar[0]*BmagInv[0]))*Bmag[4]+((162.6653005407115*BmagInv[0]*Bmag[1]-1463.987704866403*BmagInv[1])*geoZ[1]+geoZ[0]*(162.6653005407115*Bmag[1]*BmagInv[1]-813.3265027035576*BmagInv[0]))*Apar[4]+((630.0*BmagInv[0]-567.0*Bmag[1]*BmagInv[1])*geoZ[1]+geoZ[0]*(630.0*BmagInv[1]-315.0*BmagInv[0]*Bmag[1]))*Apar[3]-315.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]+(327.3576026305176*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(181.8653347947321*Apar[0]*Bmag[1]-363.7306695894642*Apar[1]))*geoZ[1]+geoZ[0]*((181.8653347947321*Apar[0]*Bmag[1]-363.7306695894642*Apar[1])*BmagInv[1]+181.8653347947321*BmagInv[0]*Apar[1]*Bmag[1]))*q_*wv+(Bmag[4]*(1454.922678357857*geoZ[4]+1626.653005407115*geoZ[0])+727.4613391789284*Bmag[1]*geoZ[1])*wm+(1626.653005407115*geoZ[1]*Phi[7]+((-2520.0*geoZ[4])-2817.445651649735*geoZ[0])*Phi[6]+Phi[4]*(1454.922678357857*geoZ[4]+1626.653005407115*geoZ[0])+geoZ[1]*(727.4613391789284*Phi[1]-1260.0*Phi[3]))*q_)+((Bmag[4]*(426.0281680828159*BmagInv[4]+242.4871130596428*BmagInv[0])+108.4435336938077*Bmag[1]*BmagInv[1])*geoZ[4]+(242.4871130596428*geoZ[0]*Bmag[4]+108.4435336938077*Bmag[1]*geoZ[1])*BmagInv[4]+(487.9959016221344*BmagInv[1]*geoZ[1]+271.1088342345192*BmagInv[0]*geoZ[0])*Bmag[4]+121.2435565298214*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*m_))/(dfac_v2*q_); 
  alpha[2] = (0.002916059217599021*dfac_x*(((242.4871130596428*Bmag[1]*BmagInv[4]+484.9742261192856*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(484.9742261192856*geoZ[1]*BmagInv[4]+542.2176684690385*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+242.4871130596428*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*m_*wv+((((476.3139720814414*Bmag[4]-271.1088342345192)*BmagInv[4]+271.1088342345192*BmagInv[0]*Bmag[4]+121.2435565298214*Bmag[1]*BmagInv[1])*geoZ[4]+(271.1088342345192*geoZ[0]*Bmag[4]+121.2435565298214*Bmag[1]*geoZ[1])*BmagInv[4]+(545.5960043841964*BmagInv[1]*geoZ[1]+303.1088913245536*BmagInv[0]*geoZ[0])*Bmag[4]+(135.5544171172596*BmagInv[0]*Bmag[1]-271.1088342345192*BmagInv[1])*geoZ[1]+geoZ[0]*(135.5544171172596*Bmag[1]*BmagInv[1]-271.1088342345192*BmagInv[0]))*Apar[7]+(((-67.08203932499369*Bmag[1]*BmagInv[4])+BmagInv[1]*(420.0000000000001-368.9512162874653*Bmag[4])-105.0*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(420.0000000000001-368.9512162874653*Bmag[4])-105.0*geoZ[0]*Bmag[1])*BmagInv[4]-210.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(469.5742752749558*BmagInv[0]-93.91485505499116*Bmag[1]*BmagInv[1])*geoZ[1]+469.5742752749558*geoZ[0]*BmagInv[1])*Apar[6]+((135.5544171172596*Bmag[1]*BmagInv[4]+271.1088342345192*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(271.1088342345192*geoZ[1]*BmagInv[4]+303.1088913245535*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+135.5544171172596*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*Apar[5]+(((213.014084041408*Apar[1]-368.9512162874654*Apar[3])*Bmag[4]+38.72983346207418*Bmag[1]*Apar[4]+210.0*Apar[3]+Bmag[1]*(60.6217782649107*Apar[0]-105.0*Apar[2])-121.2435565298214*Apar[1])*BmagInv[4]+(213.014084041408*BmagInv[1]*Apar[4]-210.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])+121.2435565298214*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+(60.6217782649107*BmagInv[0]*Bmag[1]-242.4871130596428*BmagInv[1])*Apar[4]+Bmag[1]*BmagInv[1]*(54.22176684690384*Apar[1]-93.91485505499116*Apar[3]))*geoZ[4]+((213.014084041408*geoZ[1]*Apar[4]-210.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])+121.2435565298214*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1]))*Bmag[4]+(60.6217782649107*geoZ[0]*Bmag[1]-242.4871130596428*geoZ[1])*Apar[4]+Bmag[1]*geoZ[1]*(54.22176684690384*Apar[1]-93.91485505499116*Apar[3]))*BmagInv[4]+(121.2435565298214*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+((-422.6168477474603*BmagInv[1]*geoZ[1])-234.787137637478*BmagInv[0]*geoZ[0])*Apar[3]-234.787137637478*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]+(243.9979508110672*Apar[1]*BmagInv[1]+135.5544171172596*Apar[0]*BmagInv[0])*geoZ[1]+135.5544171172596*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+((54.22176684690384*Bmag[1]*BmagInv[1]-271.1088342345192*BmagInv[0])*geoZ[1]-271.1088342345192*geoZ[0]*BmagInv[1])*Apar[4]+((210.0*BmagInv[1]-105.0*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(210.0*BmagInv[0]-105.0*Bmag[1]*BmagInv[1]))*Apar[3]-105.0*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2]+((60.6217782649107*Apar[0]*Bmag[1]-121.2435565298214*Apar[1])*BmagInv[1]+60.6217782649107*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+geoZ[0]*(60.6217782649107*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(60.6217782649107*Apar[0]*Bmag[1]-121.2435565298214*Apar[1])))*q_))/(dfac_v*q_); 
  alpha[3] = (0.7071067811865475*(2.23606797749979*geoZ[1]*Bmag[4]+geoZ[0]*Bmag[1])*dfac_x)/(dfac_m*q_); 
  alpha[4] = (0.001683587574253684*dfac_x*(((Bmag[4]*(1475.804865149862*BmagInv[4]+840.0*BmagInv[0])+375.6594202199647*Bmag[1]*BmagInv[1])*geoZ[4]+(840.0*geoZ[0]*Bmag[4]+375.6594202199647*Bmag[1]*geoZ[1])*BmagInv[4]+(1690.467390989841*BmagInv[1]*geoZ[1]+939.1485505499119*BmagInv[0]*geoZ[0])*Bmag[4]+420.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*m_*wv+(((368.9512162874653*Bmag[1]*BmagInv[4]+BmagInv[1]*(1207.476707849886*Bmag[4]-420.0000000000001)+210.0*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(1207.476707849886*Bmag[4]-420.0000000000001)+210.0*geoZ[0]*Bmag[1])*BmagInv[4]+944.9999999999998*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(422.6168477474601*Bmag[1]*BmagInv[1]-469.5742752749558*BmagInv[0])*geoZ[1]+geoZ[0]*(234.7871376374779*BmagInv[0]*Bmag[1]-469.5742752749558*BmagInv[1]))*Apar[7]+(((1278.084504248448-1039.230484541327*Bmag[4])*BmagInv[4]-639.0422521242239*BmagInv[0]*Bmag[4]-285.7883832488648*Bmag[1]*BmagInv[1]+727.4613391789285*BmagInv[0])*geoZ[4]+((-639.0422521242239*geoZ[0]*Bmag[4])-285.7883832488648*Bmag[1]*geoZ[1]+727.4613391789285*geoZ[0])*BmagInv[4]+((-935.3074360871939*BmagInv[1]*geoZ[1])-363.7306695894642*BmagInv[0]*geoZ[0])*Bmag[4]+(1463.987704866404*BmagInv[1]-162.6653005407115*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(813.3265027035576*BmagInv[0]-162.6653005407115*Bmag[1]*BmagInv[1]))*Apar[6]+((Bmag[4]*(825.0*BmagInv[4]+469.5742752749559*BmagInv[0])+210.0*Bmag[1]*BmagInv[1])*geoZ[4]+(469.5742752749559*geoZ[0]*Bmag[4]+210.0*Bmag[1]*geoZ[1])*BmagInv[4]+(945.0*BmagInv[1]*geoZ[1]+525.0*BmagInv[0]*geoZ[0])*Bmag[4]+234.787137637478*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[5]+(((600.0*Apar[4]-639.0422521242239*Apar[2]+368.9512162874654*Apar[0])*Bmag[4]-737.9024325749308*Apar[4]+Bmag[1]*(165.0*Apar[1]-285.7883832488647*Apar[3]))*BmagInv[4]+(368.9512162874654*BmagInv[0]*Apar[4]-935.3074360871933*BmagInv[1]*Apar[3]-363.7306695894642*BmagInv[0]*Apar[2]+540.0*Apar[1]*BmagInv[1]+210.0*Apar[0]*BmagInv[0])*Bmag[4]+(165.0*Bmag[1]*BmagInv[1]-420.0*BmagInv[0])*Apar[4]+(325.330601081423*BmagInv[1]-162.6653005407115*BmagInv[0]*Bmag[1])*Apar[3]+BmagInv[1]*(Bmag[1]*(93.91485505499116*Apar[0]-162.6653005407115*Apar[2])-187.8297101099823*Apar[1])+93.91485505499116*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[4]+((368.9512162874654*geoZ[0]*Apar[4]-935.3074360871933*geoZ[1]*Apar[3]-363.7306695894642*geoZ[0]*Apar[2]+540.0*Apar[1]*geoZ[1]+210.0*Apar[0]*geoZ[0])*Bmag[4]+(165.0*Bmag[1]*geoZ[1]-420.0*geoZ[0])*Apar[4]+(325.330601081423*geoZ[1]-162.6653005407115*geoZ[0]*Bmag[1])*Apar[3]+geoZ[1]*(Bmag[1]*(93.91485505499116*Apar[0]-162.6653005407115*Apar[2])-187.8297101099823*Apar[1])+93.91485505499116*geoZ[0]*Apar[1]*Bmag[1])*BmagInv[4]+((540.0*BmagInv[1]*geoZ[1]+210.0*BmagInv[0]*geoZ[0])*Apar[4]-731.9938524332015*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+((-731.9938524332015*BmagInv[1]*geoZ[1])-406.6632513517788*BmagInv[0]*geoZ[0])*Apar[2]+422.6168477474603*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*geoZ[1]+geoZ[0]*(422.6168477474603*Apar[1]*BmagInv[1]+234.787137637478*Apar[0]*BmagInv[0]))*Bmag[4]+((93.91485505499116*BmagInv[0]*Bmag[1]-845.2336954949205*BmagInv[1])*geoZ[1]+geoZ[0]*(93.91485505499116*Bmag[1]*BmagInv[1]-469.5742752749559*BmagInv[0]))*Apar[4]+((363.7306695894642*BmagInv[0]-327.3576026305176*Bmag[1]*BmagInv[1])*geoZ[1]+geoZ[0]*(363.7306695894642*BmagInv[1]-181.8653347947321*BmagInv[0]*Bmag[1]))*Apar[3]-181.8653347947321*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]+(189.0*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(105.0*Apar[0]*Bmag[1]-210.0*Apar[1]))*geoZ[1]+geoZ[0]*((105.0*Apar[0]*Bmag[1]-210.0*Apar[1])*BmagInv[1]+105.0*BmagInv[0]*Apar[1]*Bmag[1]))*q_))/(dfac_v*q_); 
  alpha[5] = (0.7071067811865475*(Bmag[4]*(2.0*geoZ[4]+2.23606797749979*geoZ[0])+Bmag[1]*geoZ[1])*dfac_x)/(dfac_m*q_); 
  alpha[7] = (0.001683587574253684*dfac_x*(dfac_v2*(((232.379000772445*Bmag[1]*BmagInv[4]+1278.084504248448*BmagInv[1]*Bmag[4]+363.7306695894642*BmagInv[0]*Bmag[1])*geoZ[4]+(1278.084504248448*geoZ[1]*Bmag[4]+363.7306695894642*geoZ[0]*Bmag[1])*BmagInv[4]+727.4613391789284*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+325.330601081423*Bmag[1]*BmagInv[1]*geoZ[1])*m_*wv2+((((2323.79000772445*Bmag[4]-519.6152422706633)*BmagInv[4]+1428.941916244324*BmagInv[0]*Bmag[4]+639.0422521242239*Bmag[1]*BmagInv[1]-813.3265027035576*BmagInv[0])*geoZ[4]+(1428.941916244324*geoZ[0]*Bmag[4]+639.0422521242239*Bmag[1]*geoZ[1]-813.3265027035576*geoZ[0])*BmagInv[4]+(2091.411006952005*BmagInv[1]*geoZ[1]+813.3265027035576*BmagInv[0]*geoZ[0])*Bmag[4]+(363.7306695894642*BmagInv[0]*Bmag[1]-727.4613391789285*BmagInv[1])*geoZ[1]+363.7306695894642*geoZ[0]*Bmag[1]*BmagInv[1])*Apar[7]+(((-674.9999999999999*Bmag[1]*BmagInv[4])+BmagInv[1]*(2213.707297724792-1800.0*Bmag[4])-201.246117974981*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(2213.707297724792-1800.0*Bmag[4])-201.246117974981*geoZ[0]*Bmag[1])*BmagInv[4]-1106.853648862396*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(1260.0*BmagInv[0]-495.0*Bmag[1]*BmagInv[1])*geoZ[1]+geoZ[0]*(1260.0*BmagInv[1]-314.9999999999999*BmagInv[0]*Bmag[1]))*Apar[6]+((259.8076211353315*Bmag[1]*BmagInv[4]+1428.941916244323*BmagInv[1]*Bmag[4]+406.6632513517788*BmagInv[0]*Bmag[1])*geoZ[4]+(1428.941916244323*geoZ[1]*Bmag[4]+406.6632513517788*geoZ[0]*Bmag[1])*BmagInv[4]+813.3265027035576*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+363.7306695894642*Bmag[1]*BmagInv[1]*geoZ[1])*Apar[5]+(((1039.230484541326*Apar[1]-1800.0*Apar[3])*Bmag[4]+389.7114317029973*Bmag[1]*Apar[4]+402.4922359499622*Apar[3]+Bmag[1]*(116.1895003862225*Apar[0]-201.2461179749811*Apar[2])-232.379000772445*Apar[1])*BmagInv[4]+(1039.230484541326*BmagInv[1]*Apar[4]-1106.853648862396*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])+639.0422521242239*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+(116.1895003862225*BmagInv[0]*Bmag[1]-1278.084504248448*BmagInv[1])*Apar[4]+(630.0*BmagInv[0]-495.0*Bmag[1]*BmagInv[1])*Apar[3]+Bmag[1]*(285.7883832488647*Apar[1]*BmagInv[1]-315.0*BmagInv[0]*Apar[2])+BmagInv[0]*(181.8653347947321*Apar[0]*Bmag[1]-363.7306695894642*Apar[1]))*geoZ[4]+((1039.230484541326*geoZ[1]*Apar[4]-1106.853648862396*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])+639.0422521242239*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1]))*Bmag[4]+(116.1895003862225*geoZ[0]*Bmag[1]-1278.084504248448*geoZ[1])*Apar[4]+(630.0*geoZ[0]-495.0*Bmag[1]*geoZ[1])*Apar[3]+Bmag[1]*(285.7883832488647*Apar[1]*geoZ[1]-315.0*geoZ[0]*Apar[2])+geoZ[0]*(181.8653347947321*Apar[0]*Bmag[1]-363.7306695894642*Apar[1]))*BmagInv[4]+(639.0422521242239*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+((-1620.0*BmagInv[1]*geoZ[1])-630.0*BmagInv[0]*geoZ[0])*Apar[3]-630.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]+(935.3074360871933*Apar[1]*BmagInv[1]+363.7306695894642*Apar[0]*BmagInv[0])*geoZ[1]+363.7306695894642*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+((285.7883832488647*Bmag[1]*BmagInv[1]-727.4613391789284*BmagInv[0])*geoZ[1]+geoZ[0]*(181.8653347947321*BmagInv[0]*Bmag[1]-727.4613391789284*BmagInv[1]))*Apar[4]+((563.489130329947*BmagInv[1]-281.7445651649735*BmagInv[0]*Bmag[1])*geoZ[1]-281.7445651649735*geoZ[0]*Bmag[1]*BmagInv[1])*Apar[3]+geoZ[1]*(BmagInv[1]*(Bmag[1]*(162.6653005407115*Apar[0]-281.7445651649735*Apar[2])-325.330601081423*Apar[1])+162.6653005407115*BmagInv[0]*Apar[1]*Bmag[1])+162.6653005407115*geoZ[0]*Apar[1]*Bmag[1]*BmagInv[1])*q_*wv+(727.4613391789284*Bmag[1]*geoZ[4]+1454.922678357857*geoZ[1]*Bmag[4])*wm+(1626.653005407115*geoZ[4]*Phi[7]-2520.0*geoZ[1]*Phi[6]+(727.4613391789284*Phi[1]-1260.0*Phi[3])*geoZ[4]+1454.922678357857*geoZ[1]*Phi[4])*q_)+((77.45966692414835*Bmag[1]*BmagInv[4]+426.0281680828159*BmagInv[1]*Bmag[4]+121.2435565298214*BmagInv[0]*Bmag[1])*geoZ[4]+(426.0281680828159*geoZ[1]*Bmag[4]+121.2435565298214*geoZ[0]*Bmag[1])*BmagInv[4]+242.4871130596428*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+108.4435336938077*Bmag[1]*BmagInv[1]*geoZ[1])*m_))/(dfac_v2*q_); 
  alpha[8] = (0.04714045207910316*((3.872983346207417*Bmag[1]*BmagInv[4]+7.745966692414834*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(7.745966692414834*geoZ[1]*BmagInv[4]+8.660254037844386*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+3.872983346207417*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*dfac_x*m_)/(dfac_v2*q_); 
  alpha[11] = (0.00652050663696626*dfac_x*(((69.28203230275508*Bmag[1]*BmagInv[4]+381.051177665153*BmagInv[1]*Bmag[4]+108.4435336938077*BmagInv[0]*Bmag[1])*geoZ[4]+(381.051177665153*geoZ[1]*Bmag[4]+108.4435336938077*geoZ[0]*Bmag[1])*BmagInv[4]+216.8870673876154*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+96.99484522385713*Bmag[1]*BmagInv[1]*geoZ[1])*m_*wv+((((346.4101615137756*Bmag[4]-77.45966692414834)*BmagInv[4]+213.0140840414079*BmagInv[0]*Bmag[4]+95.26279441628826*Bmag[1]*BmagInv[1]-121.2435565298214*BmagInv[0])*geoZ[4]+(213.0140840414079*geoZ[0]*Bmag[4]+95.26279441628826*Bmag[1]*geoZ[1]-121.2435565298214*geoZ[0])*BmagInv[4]+(311.7691453623979*BmagInv[1]*geoZ[1]+121.2435565298214*BmagInv[0]*geoZ[0])*Bmag[4]+(54.22176684690384*BmagInv[0]*Bmag[1]-108.4435336938077*BmagInv[1])*geoZ[1]+54.22176684690384*geoZ[0]*Bmag[1]*BmagInv[1])*Apar[7]+(((-100.6230589874905*Bmag[1]*BmagInv[4])+BmagInv[1]*(330.0000000000001-268.3281572999747*Bmag[4])-30.0*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(330.0000000000001-268.3281572999747*Bmag[4])-30.0*geoZ[0]*Bmag[1])*BmagInv[4]-165.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(187.8297101099823*BmagInv[0]-73.79024325749306*Bmag[1]*BmagInv[1])*geoZ[1]+geoZ[0]*(187.8297101099823*BmagInv[1]-46.95742752749558*BmagInv[0]*Bmag[1]))*Apar[6]+((38.72983346207418*Bmag[1]*BmagInv[4]+213.014084041408*BmagInv[1]*Bmag[4]+60.6217782649107*BmagInv[0]*Bmag[1])*geoZ[4]+(213.014084041408*geoZ[1]*Bmag[4]+60.6217782649107*geoZ[0]*Bmag[1])*BmagInv[4]+121.2435565298214*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+54.22176684690384*Bmag[1]*BmagInv[1]*geoZ[1])*Apar[5]+(((154.9193338482967*Apar[1]-268.3281572999748*Apar[3])*Bmag[4]+58.09475019311126*Bmag[1]*Apar[4]+60.0*Apar[3]+Bmag[1]*(17.32050807568877*Apar[0]-30.0*Apar[2])-34.64101615137754*Apar[1])*BmagInv[4]+(154.9193338482967*BmagInv[1]*Apar[4]-165.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])+95.26279441628824*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+(17.32050807568877*BmagInv[0]*Bmag[1]-190.5255888325765*BmagInv[1])*Apar[4]+(93.91485505499116*BmagInv[0]-73.79024325749306*Bmag[1]*BmagInv[1])*Apar[3]+Bmag[1]*(42.60281680828159*Apar[1]*BmagInv[1]-46.95742752749558*BmagInv[0]*Apar[2])+BmagInv[0]*(27.11088342345192*Apar[0]*Bmag[1]-54.22176684690384*Apar[1]))*geoZ[4]+((154.9193338482967*geoZ[1]*Apar[4]-165.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])+95.26279441628824*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1]))*Bmag[4]+(17.32050807568877*geoZ[0]*Bmag[1]-190.5255888325765*geoZ[1])*Apar[4]+(93.91485505499116*geoZ[0]-73.79024325749306*Bmag[1]*geoZ[1])*Apar[3]+Bmag[1]*(42.60281680828159*Apar[1]*geoZ[1]-46.95742752749558*geoZ[0]*Apar[2])+geoZ[0]*(27.11088342345192*Apar[0]*Bmag[1]-54.22176684690384*Apar[1]))*BmagInv[4]+(95.26279441628824*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+((-241.4953415699773*BmagInv[1]*geoZ[1])-93.91485505499116*BmagInv[0]*geoZ[0])*Apar[3]-93.91485505499116*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]+(139.427400463467*Apar[1]*BmagInv[1]+54.22176684690384*Apar[0]*BmagInv[0])*geoZ[1]+54.22176684690384*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+((42.60281680828159*Bmag[1]*BmagInv[1]-108.4435336938077*BmagInv[0])*geoZ[1]+geoZ[0]*(27.11088342345192*BmagInv[0]*Bmag[1]-108.4435336938077*BmagInv[1]))*Apar[4]+((84.0*BmagInv[1]-42.0*BmagInv[0]*Bmag[1])*geoZ[1]-42.0*geoZ[0]*Bmag[1]*BmagInv[1])*Apar[3]+geoZ[1]*(BmagInv[1]*(Bmag[1]*(24.24871130596428*Apar[0]-42.0*Apar[2])-48.49742261192856*Apar[1])+24.24871130596428*BmagInv[0]*Apar[1]*Bmag[1])+24.24871130596428*geoZ[0]*Apar[1]*Bmag[1]*BmagInv[1])*q_))/(dfac_v*q_); 
  alpha[12] = (0.001346870059402948*((Bmag[4]*(476.3139720814414*BmagInv[4]+271.1088342345192*BmagInv[0])+121.2435565298214*Bmag[1]*BmagInv[1])*geoZ[4]+(271.1088342345192*geoZ[0]*Bmag[4]+121.2435565298214*Bmag[1]*geoZ[1])*BmagInv[4]+(545.5960043841964*BmagInv[1]*geoZ[1]+303.1088913245536*BmagInv[0]*geoZ[0])*Bmag[4]+135.5544171172596*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*dfac_x*m_)/(dfac_v2*q_); 
  alpha[13] = (0.04714045207910316*(15.0*Bmag[1]*geoZ[4]+30.0*geoZ[1]*Bmag[4])*dfac_x)/(dfac_m*q_); 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[12]+fl[12])+1.732050807568877*(fl[2]-1.0*fr[2])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[20]+fl[20])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[22]+fl[22])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[26]+fl[26])+3.0*(fl[9]-1.0*fr[9]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[33]+fl[33])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[6]+fl[6]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[36]+fl[36])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[38]+fl[38])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[19]-1.0*(8.660254037844387*fl[19]+5.0*(fr[11]+fl[11]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[24]-1.0*(8.660254037844387*fl[24]+5.0*(fr[13]+fl[13]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[29]-1.0*(8.660254037844387*fl[29]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[45]+fl[45])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[17]+fl[17])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[32]-1.0*(8.660254037844387*fl[32]+5.0*(fr[21]+fl[21]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[34]-1.0*(8.660254037844387*fl[34]+5.0*(fr[23]+fl[23]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[35]-1.0*(8.660254037844387*fl[35]+5.0*(fr[25]+fl[25]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[40]-1.0*(8.660254037844387*fl[40]+5.0*(fr[27]+fl[27]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[41]-1.0*(8.660254037844387*fl[41]+5.0*(fr[28]+fl[28]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[43]-1.0*(8.660254037844387*fl[43]+5.0*(fr[30]+fl[30]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[44]-1.0*(8.660254037844387*fl[44]+5.0*(fr[37]+fl[37]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[46]-1.0*(8.660254037844387*fl[46]+5.0*(fr[39]+fl[39]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[42]+fl[42]))); 

//
// //
  Ghat[0] = -0.125*((6.324555320336761*fr[12]-6.324555320336761*fl[12]-4.898979485566357*(fr[2]+fl[2])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[13]*favg[13]+alpha[12]*favg[12]+alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[3]*favg[3]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[20]-94.8683298050514*fl[20]-73.48469228349535*(fr[5]+fl[5])+42.42640687119286*fr[1]-42.42640687119286*fl[1])*amax-18.97366596101028*(alpha[5]*favg[13]+favg[5]*alpha[13])-21.21320343559643*(alpha[8]*favg[12]+favg[8]*alpha[12])-18.97366596101028*(alpha[4]*favg[11]+favg[4]*alpha[11]+alpha[1]*favg[7]+favg[1]*alpha[7])-21.21320343559643*(alpha[3]*favg[5]+favg[3]*alpha[5]+alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[22]-94.8683298050514*fl[22]-73.48469228349535*(fr[7]+fl[7])+42.42640687119286*fr[3]-42.42640687119286*fl[3])*amax-21.21320343559643*alpha[13]*favg[17]-18.97366596101028*(alpha[4]*favg[12]+favg[4]*alpha[12])-21.21320343559643*(alpha[7]*favg[11]+favg[7]*alpha[11])-21.21320343559643*alpha[5]*favg[10]-18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])-21.21320343559643*(alpha[3]*favg[6]+alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.008333333333333333*((94.8683298050514*fr[26]-94.8683298050514*fl[26]-73.48469228349535*(fr[9]+fl[9])+42.42640687119286*fr[4]-42.42640687119286*fl[4])*amax-21.21320343559643*(alpha[12]*favg[18]+alpha[11]*favg[17])-18.97366596101028*alpha[5]*favg[15]-21.21320343559643*(alpha[8]*favg[14]+alpha[7]*favg[13]+favg[7]*alpha[13])-21.21320343559643*alpha[4]*favg[10]-18.97366596101028*alpha[3]*favg[9]-21.21320343559643*(alpha[2]*favg[6]+alpha[1]*favg[5]+favg[1]*alpha[5]+alpha[0]*favg[3]+favg[0]*alpha[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[33]-94.86832980505142*fl[33]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[6]-42.42640687119286*fl[6])*amax-18.97366596101028*(alpha[5]*favg[17]+favg[10]*alpha[13])+((-16.97056274847715*alpha[11])-18.97366596101028*alpha[2])*favg[12]+((-16.97056274847715*favg[11])-18.97366596101028*favg[2])*alpha[12]-18.97366596101028*(alpha[1]*favg[11]+favg[1]*alpha[11])-21.21320343559643*alpha[3]*favg[10]-18.97366596101028*(alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7])-21.21320343559643*(alpha[5]*favg[6]+alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -0.008333333333333333*((94.86832980505142*fr[36]-94.86832980505142*fl[36]-73.48469228349535*(fr[16]+fl[16])+42.42640687119286*fr[8]-42.42640687119286*fl[8])*amax-21.21320343559643*alpha[8]*favg[18]-18.97366596101028*alpha[4]*favg[17]+((-16.97056274847715*alpha[13])-18.97366596101028*alpha[3])*favg[15]-21.21320343559643*alpha[12]*favg[14]-18.97366596101028*(alpha[1]*favg[13]+favg[1]*alpha[13])+favg[10]*((-18.97366596101028*alpha[11])-21.21320343559643*alpha[2])-18.97366596101028*(alpha[5]*(favg[9]+favg[7])+favg[5]*alpha[7])-21.21320343559643*(alpha[4]*favg[6]+alpha[0]*favg[5]+favg[0]*alpha[5]+alpha[1]*favg[3]+favg[1]*alpha[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[38]-94.86832980505142*fl[38]-73.48469228349535*(fr[18]+fl[18])+42.42640687119286*fr[10]-42.42640687119286*fl[10])*amax-18.97366596101028*(alpha[5]*favg[19]+alpha[4]*favg[18])-21.21320343559643*alpha[7]*favg[17]-18.97366596101028*(alpha[3]*favg[16]+alpha[2]*favg[14])-21.21320343559643*(alpha[11]*favg[13]+favg[11]*alpha[13])+favg[10]*((-18.97366596101028*alpha[12])-21.21320343559643*alpha[1])-18.97366596101028*favg[6]*alpha[8]-21.21320343559643*(alpha[0]*favg[6]+alpha[4]*favg[5]+favg[4]*alpha[5]+alpha[2]*favg[3]+favg[2]*alpha[3])); 
  Ghat[7] = 0.001190476190476191*((514.3928459844675*(fr[19]+fl[19])-296.98484809835*fr[11]+296.98484809835*fl[11])*amax+(94.86832980505142*alpha[13]+148.492424049175*alpha[3])*favg[13]+148.492424049175*favg[3]*alpha[13]+132.815661727072*alpha[12]*favg[12]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[11]+148.492424049175*favg[2]*alpha[11]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[7]+148.492424049175*favg[0]*alpha[7]+132.815661727072*(alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.001190476190476191*((514.3928459844675*(fr[24]+fl[24])-296.98484809835*fr[13]+296.98484809835*fl[13])*amax+148.492424049175*(alpha[5]*favg[18]+alpha[3]*favg[14])+(94.86832980505142*alpha[12]+148.492424049175*alpha[1])*favg[12]+148.492424049175*favg[1]*alpha[12]+132.815661727072*alpha[11]*favg[11]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[8]+148.492424049175*favg[0]*alpha[8]+132.815661727072*(alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.00116461873828114*((525.8136552049599*(fr[29]+fl[29])-303.5786553761646*fr[14]+303.5786553761646*fl[14])*amax+151.7893276880823*(alpha[4]*favg[19]+alpha[2]*favg[16])+(82.15838362577493*alpha[5]+151.7893276880823*alpha[1])*favg[15]+135.7645019878172*alpha[13]*favg[13]+151.7893276880823*alpha[0]*favg[9]+135.7645019878172*(alpha[5]*favg[5]+alpha[3]*favg[3])); 
  Ghat[10] = -0.002886751345948129*((273.8612787525831*fr[45]-273.8612787525831*fl[45]-212.1320343559643*(fr[31]+fl[31])+122.4744871391589*fr[17]-122.4744871391589*fl[17])*amax+((-48.98979485566359*alpha[13])-54.77225575051663*alpha[3])*favg[19]+((-48.98979485566359*alpha[11])-54.77225575051663*alpha[2])*favg[18]+((-48.98979485566359*alpha[12])-54.77225575051663*alpha[1])*favg[17]-54.77225575051663*(alpha[5]*favg[16]+alpha[4]*(favg[14]+favg[13])+favg[4]*alpha[13]+favg[6]*alpha[12]+alpha[5]*favg[11]+favg[5]*alpha[11])+((-54.77225575051663*(alpha[8]+alpha[7]))-61.23724356957945*alpha[0])*favg[10]-61.23724356957945*(alpha[1]*favg[6]+alpha[2]*favg[5]+favg[2]*alpha[5]+alpha[3]*favg[4]+favg[3]*alpha[4])); 
  Ghat[11] = 0.001190476190476191*((514.3928459844675*(fr[32]+fl[32])-296.98484809835*fr[21]+296.98484809835*fl[21])*amax+(94.86832980505142*alpha[13]+148.492424049175*alpha[3])*favg[17]+148.492424049175*favg[6]*alpha[13]+118.79393923934*(alpha[4]*favg[12]+favg[4]*alpha[12])+(132.815661727072*alpha[8]+94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[11]+(132.815661727072*favg[8]+94.86832980505142*favg[7]+148.492424049175*favg[0])*alpha[11]+132.815661727072*alpha[5]*favg[10]+148.492424049175*(alpha[2]*favg[7]+favg[2]*alpha[7])+132.815661727072*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 9.221388919541468e-4*((664.0783086353599*(fr[34]+fl[34])-383.4057902536164*fr[23]+383.4057902536164*fl[23])*amax+(171.4642819948225*alpha[13]+191.7028951268082*alpha[3])*favg[18]+191.7028951268082*alpha[5]*favg[14]+(122.474487139159*alpha[8]+171.4642819948225*alpha[7]+191.7028951268082*alpha[0])*favg[12]+(122.474487139159*favg[8]+171.4642819948225*favg[7]+191.7028951268082*favg[0])*alpha[12]+153.3623161014466*(alpha[4]*favg[11]+favg[4]*alpha[11])+191.7028951268082*(alpha[1]*favg[8]+favg[1]*alpha[8])+171.4642819948225*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.001190476190476191*((514.3928459844675*(fr[35]+fl[35])-296.98484809835*fr[25]+296.98484809835*fl[25])*amax+132.815661727072*alpha[12]*favg[18]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[17]+118.79393923934*alpha[5]*favg[15]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[13]+(132.815661727072*favg[9]+94.86832980505142*favg[7]+148.492424049175*favg[0])*alpha[13]+148.492424049175*favg[6]*alpha[11]+132.815661727072*alpha[4]*favg[10]+148.492424049175*(alpha[3]*favg[7]+favg[3]*alpha[7])+132.815661727072*(alpha[1]*favg[5]+favg[1]*alpha[5])); 
  Ghat[14] = 0.001190476190476191*((514.3928459844675*(fr[40]+fl[40])-296.98484809835*fr[27]+296.98484809835*fl[27])*amax+(94.86832980505142*alpha[12]+148.492424049175*alpha[1])*favg[18]+132.815661727072*alpha[11]*favg[17]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[14]+148.492424049175*(alpha[5]*favg[12]+favg[5]*alpha[12])+132.815661727072*alpha[4]*favg[10]+148.492424049175*(alpha[3]*favg[8]+favg[3]*alpha[8])+132.815661727072*alpha[2]*favg[6]); 
  Ghat[15] = 0.006454972243679028*((94.86832980505142*(fr[41]+fl[41])-54.77225575051663*fr[28]+54.77225575051663*fl[28])*amax+(24.49489742783179*alpha[11]+27.38612787525831*alpha[2])*favg[19]+27.38612787525831*alpha[4]*favg[16]+(24.49489742783179*alpha[7]+27.38612787525831*alpha[0])*favg[15]+21.90890230020666*(alpha[5]*favg[13]+favg[5]*alpha[13])+27.38612787525831*alpha[1]*favg[9]+24.49489742783179*(alpha[3]*favg[5]+favg[3]*alpha[5])); 
  Ghat[16] = 0.006454972243679028*((94.86832980505142*(fr[43]+fl[43])-54.77225575051663*fr[30]+54.77225575051663*fl[30])*amax+(24.49489742783179*alpha[12]+27.38612787525831*alpha[1])*favg[19]+24.49489742783179*alpha[13]*favg[17]+(24.49489742783179*alpha[8]+27.38612787525831*alpha[0])*favg[16]+27.38612787525831*alpha[4]*favg[15]+24.49489742783179*alpha[5]*favg[10]+27.38612787525831*alpha[2]*favg[9]+24.49489742783179*alpha[3]*favg[6]); 
  Ghat[17] = 2.380952380952381e-4*((2571.964229922338*(fr[44]+fl[44])-1484.92424049175*fr[37]+1484.92424049175*fl[37])*amax+593.9696961967002*(alpha[5]*favg[19]+alpha[4]*favg[18])+(664.0783086353599*alpha[8]+474.3416490252571*alpha[7]+742.462120245875*alpha[0])*favg[17]+664.0783086353599*(alpha[13]*favg[16]+alpha[11]*favg[14])+(474.3416490252571*alpha[11]+742.462120245875*alpha[2])*favg[13]+(474.3416490252571*favg[11]+742.462120245875*favg[2])*alpha[13]+593.9696961967002*favg[10]*alpha[12]+742.462120245875*(alpha[3]*favg[11]+favg[3]*alpha[11])+664.0783086353599*alpha[1]*favg[10]+742.462120245875*favg[6]*alpha[7]+664.0783086353599*(alpha[4]*favg[5]+favg[4]*alpha[5])); 
  Ghat[18] = 2.380952380952381e-4*((2571.964229922338*(fr[46]+fl[46])-1484.92424049175*fr[39]+1484.92424049175*fl[39])*amax+(474.3416490252571*alpha[8]+664.0783086353599*alpha[7]+742.462120245875*alpha[0])*favg[18]+593.9696961967002*alpha[4]*favg[17]+(474.3416490252571*alpha[12]+742.462120245875*alpha[1])*favg[14]+664.0783086353599*(alpha[12]*favg[13]+favg[12]*alpha[13])+742.462120245875*(alpha[3]*favg[12]+favg[3]*alpha[12])+favg[10]*(593.9696961967002*alpha[11]+664.0783086353599*alpha[2])+742.462120245875*(alpha[5]*favg[8]+favg[5]*alpha[8])+664.0783086353599*alpha[4]*favg[6]); 
  Ghat[19] = 0.001666666666666667*((367.4234614174769*(fr[47]+fl[47])-212.1320343559643*fr[42]+212.1320343559643*fl[42])*amax+(94.86832980505142*(alpha[8]+alpha[7])+106.0660171779821*alpha[0])*favg[19]+84.85281374238573*alpha[5]*favg[17]+(94.86832980505142*alpha[12]+106.0660171779822*alpha[1])*favg[16]+(94.86832980505142*alpha[11]+106.0660171779822*alpha[2])*favg[15]+favg[10]*(84.85281374238573*alpha[13]+94.86832980505142*alpha[3])+106.0660171779821*alpha[4]*favg[9]+94.86832980505142*alpha[5]*favg[6]); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_y; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_y; 
  incr[2] = -1.224744871391589*Ghat[0]*dfac_y; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_y; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_y; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_y; 
  incr[6] = 0.7071067811865475*Ghat[4]*dfac_y; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_y; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_y; 
  incr[9] = -1.224744871391589*Ghat[3]*dfac_y; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_y; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_y; 
  incr[12] = 1.58113883008419*Ghat[0]*dfac_y; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_y; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_y; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_y; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_y; 
  incr[17] = 0.7071067811865475*Ghat[10]*dfac_y; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_y; 
  incr[19] = -1.224744871391589*Ghat[7]*dfac_y; 
  incr[20] = 1.58113883008419*Ghat[1]*dfac_y; 
  incr[21] = 0.7071067811865475*Ghat[11]*dfac_y; 
  incr[22] = 1.58113883008419*Ghat[2]*dfac_y; 
  incr[23] = 0.7071067811865475*Ghat[12]*dfac_y; 
  incr[24] = -1.224744871391589*Ghat[8]*dfac_y; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_y; 
  incr[26] = 1.58113883008419*Ghat[3]*dfac_y; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_y; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_y; 
  incr[29] = -1.224744871391589*Ghat[9]*dfac_y; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_y; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_y; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_y; 
  incr[33] = 1.58113883008419*Ghat[4]*dfac_y; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_y; 
  incr[35] = -1.224744871391589*Ghat[13]*dfac_y; 
  incr[36] = 1.58113883008419*Ghat[5]*dfac_y; 
  incr[37] = 0.7071067811865475*Ghat[17]*dfac_y; 
  incr[38] = 1.58113883008419*Ghat[6]*dfac_y; 
  incr[39] = 0.7071067811865475*Ghat[18]*dfac_y; 
  incr[40] = -1.224744871391589*Ghat[14]*dfac_y; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_y; 
  incr[42] = 0.7071067811865475*Ghat[19]*dfac_y; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_y; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_y; 
  incr[45] = 1.58113883008419*Ghat[10]*dfac_y; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_y; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_y; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += -1.0*incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += -1.0*incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += -1.0*incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += -1.0*incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += -1.0*incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Vpar_P2_Bvars_1(const double q_, const double m_, const double cfl, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *geoX, const double *geoY, const double *geoZ, const double *Phi, const double *Apar, const double *dApardt, const double *fl, const double *fr, double *outl, double *outr) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = -(4.464285714285714e-4*(dfac_v*(2.0*dfac_x*dfac_y*((6.708203932499369*((5.0*(2.0*Bmag[1]*BmagInv[4]+11.0*BmagInv[1]*Bmag[4])+15.65247584249853*BmagInv[0]*Bmag[1])*geoZ[4]+(55.0*geoZ[1]*Bmag[4]+15.65247584249853*geoZ[0]*Bmag[1])*BmagInv[4]+14.0*(2.23606797749979*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*BmagInv[1]*geoZ[1]))*Phi[6]+3.0*(((122.9837387624885*Phi[3]*Bmag[4]+35.0*Bmag[1]*Phi[2])*BmagInv[4]+14.0*(5.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Bmag[4]+2.23606797749979*Bmag[1]*BmagInv[1]*Phi[3]))*geoZ[4]+7.0*(2.0*(5.0*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Bmag[4]+2.23606797749979*Bmag[1]*geoZ[1]*Phi[3])*BmagInv[4]+2.23606797749979*((9.0*BmagInv[1]*geoZ[1]+5.0*BmagInv[0]*geoZ[0])*Phi[3]+5.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Bmag[4]+5.0*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Phi[2]))))*m_*wv+(6.708203932499369*((5.0*(2.0*Bmag[1]*BmagInv[4]+11.0*BmagInv[1]*Bmag[4])+15.65247584249853*BmagInv[0]*Bmag[1])*geoZ[4]+(55.0*geoZ[1]*Bmag[4]+15.65247584249853*geoZ[0]*Bmag[1])*BmagInv[4]+14.0*(2.23606797749979*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*BmagInv[1]*geoZ[1]))*Apar[6]+3.0*(((122.9837387624885*Apar[3]*Bmag[4]+35.0*Bmag[1]*Apar[2])*BmagInv[4]+14.0*(5.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+2.23606797749979*Bmag[1]*BmagInv[1]*Apar[3]))*geoZ[4]+7.0*(2.0*(5.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+2.23606797749979*Bmag[1]*geoZ[1]*Apar[3])*BmagInv[4]+2.23606797749979*((9.0*BmagInv[1]*geoZ[1]+5.0*BmagInv[0]*geoZ[0])*Apar[3]+5.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+5.0*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2]))))*wm)+(((3.0*((2.0*(223.606797749979*Bmag[4]-275.0)*BmagInv[4]+275.0*BmagInv[0]*Bmag[4]+11.18033988749895*(11.0*Bmag[1]*BmagInv[1]-28.0*BmagInv[0]))*geoZ[4]+(275.0*geoZ[0]*Bmag[4]+11.18033988749895*(11.0*Bmag[1]*geoZ[1]-28.0*geoZ[0]))*BmagInv[4]+2.0*(11.18033988749895*(18.0*BmagInv[1]*geoZ[1]+7.0*BmagInv[0]*geoZ[0])*Bmag[4]+35.0*((BmagInv[0]*Bmag[1]-9.0*BmagInv[1])*geoZ[1]+geoZ[0]*(Bmag[1]*BmagInv[1]-5.0*BmagInv[0]))))*Apar[6]+6.708203932499369*((11.0*(11.18033988749895*Apar[2]*Bmag[4]+5.0*Bmag[1]*Apar[3])*BmagInv[4]+2.0*(5.0*(18.0*BmagInv[1]*Apar[3]+7.0*BmagInv[0]*Apar[2])*Bmag[4]+15.65247584249853*((BmagInv[0]*Bmag[1]-2.0*BmagInv[1])*Apar[3]+Bmag[1]*BmagInv[1]*Apar[2])))*geoZ[4]+2.0*(5.0*(18.0*geoZ[1]*Apar[3]+7.0*geoZ[0]*Apar[2])*Bmag[4]+15.65247584249853*((geoZ[0]*Bmag[1]-2.0*geoZ[1])*Apar[3]+Bmag[1]*geoZ[1]*Apar[2]))*BmagInv[4]+7.0*(2.23606797749979*(9.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(9.0*BmagInv[1]*geoZ[1]+5.0*BmagInv[0]*geoZ[0])*Apar[2])*Bmag[4]+((9.0*Bmag[1]*BmagInv[1]-10.0*BmagInv[0])*geoZ[1]+5.0*geoZ[0]*(BmagInv[0]*Bmag[1]-2.0*BmagInv[1]))*Apar[3]+5.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])))*Phi[7]+2.0*(3.0*((275.0*BmagInv[4]+156.5247584249853*BmagInv[0])*geoZ[4]+7.0*(22.3606797749979*geoZ[0]*BmagInv[4]+5.0*(9.0*BmagInv[1]*geoZ[1]+5.0*BmagInv[0]*geoZ[0])))*Phi[6]+46.95742752749558*Phi[3]*(4.47213595499958*(BmagInv[1]*geoZ[4]+geoZ[1]*BmagInv[4])+5.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])))*Apar[7]+6.708203932499369*((14.0*(10.0*(BmagInv[1]*geoZ[4]+geoZ[1]*BmagInv[4])+11.18033988749895*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[5]+((11.18033988749895*(8.0*Apar[1]*Bmag[4]+3.0*Bmag[1]*Apar[4])+10.0*(Apar[0]*Bmag[1]-2.0*Apar[1]))*BmagInv[4]+(89.4427190999916*BmagInv[1]*Apar[4]+55.0*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+10.0*(BmagInv[0]*Bmag[1]-11.0*BmagInv[1])*Apar[4]+2.23606797749979*(11.0*Apar[1]*Bmag[1]*BmagInv[1]+7.0*BmagInv[0]*(Apar[0]*Bmag[1]-2.0*Apar[1])))*geoZ[4]+((89.4427190999916*geoZ[1]*Apar[4]+55.0*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1]))*Bmag[4]+10.0*(geoZ[0]*Bmag[1]-11.0*geoZ[1])*Apar[4]+2.23606797749979*(11.0*Apar[1]*Bmag[1]*geoZ[1]+7.0*geoZ[0]*(Apar[0]*Bmag[1]-2.0*Apar[1])))*BmagInv[4]+(55.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+4.47213595499958*((18.0*Apar[1]*BmagInv[1]+7.0*Apar[0]*BmagInv[0])*geoZ[1]+7.0*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])))*Bmag[4]+2.23606797749979*((11.0*Bmag[1]*BmagInv[1]-28.0*BmagInv[0])*geoZ[1]+7.0*geoZ[0]*(BmagInv[0]*Bmag[1]-4.0*BmagInv[1]))*Apar[4]+14.0*(((Apar[0]*Bmag[1]-2.0*Apar[1])*BmagInv[1]+BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+geoZ[0]*Apar[1]*Bmag[1]*BmagInv[1]))*Phi[6]+(((11.18033988749895*(2.0*Bmag[1]*BmagInv[4]+11.0*BmagInv[1]*Bmag[4])+35.0*(BmagInv[0]*Bmag[1]-4.0*BmagInv[1]))*geoZ[4]+(122.9837387624885*geoZ[1]*Bmag[4]+35.0*(geoZ[0]*Bmag[1]-4.0*geoZ[1]))*BmagInv[4]+14.0*(5.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+2.23606797749979*((Bmag[1]*BmagInv[1]-5.0*BmagInv[0])*geoZ[1]-5.0*geoZ[0]*BmagInv[1])))*Phi[5]+2.0*((55.0*BmagInv[1]*Phi[4]+Phi[1]*(10.0*BmagInv[4]+15.65247584249853*BmagInv[0]))*geoZ[4]+(55.0*geoZ[1]*BmagInv[4]+31.30495168499706*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[4]+7.0*Phi[1]*(2.23606797749979*geoZ[0]*BmagInv[4]+2.0*BmagInv[1]*geoZ[1])))*Apar[6])+3.0*((((275.0*Apar[3]*Bmag[4]+78.26237921249266*(Bmag[1]*Apar[2]-2.0*Apar[3]))*BmagInv[4]+14.0*(11.18033988749895*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+5.0*Bmag[1]*BmagInv[1]*Apar[3]))*geoZ[4]+7.0*(2.0*(11.18033988749895*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+5.0*Bmag[1]*geoZ[1]*Apar[3])*BmagInv[4]+5.0*((9.0*BmagInv[1]*geoZ[1]+5.0*BmagInv[0]*geoZ[0])*Apar[3]+5.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+11.18033988749895*(((BmagInv[0]*Bmag[1]-2.0*BmagInv[1])*geoZ[1]+geoZ[0]*(Bmag[1]*BmagInv[1]-2.0*BmagInv[0]))*Apar[3]+Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2])))*Phi[5]+156.5247584249853*Phi[3]*(BmagInv[4]*geoZ[4]+BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[5]+(2.0*(122.9837387624885*Apar[3]*BmagInv[4]+70.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*Phi[4]+((200.0*Phi[3]*Apar[4]+122.9837387624885*(Apar[0]*Phi[3]+Apar[1]*Phi[2]))*Bmag[4]+22.3606797749979*(Bmag[1]*Phi[2]-11.0*Phi[3])*Apar[4]+5.0*(11.0*Apar[1]*Bmag[1]*Phi[3]+7.0*((Apar[0]*Bmag[1]-2.0*Apar[1])*Phi[2]+2.0*Phi[1]*Apar[2])))*BmagInv[4]+(122.9837387624885*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[4]+10.0*((18.0*Apar[1]*BmagInv[1]+7.0*Apar[0]*BmagInv[0])*Phi[3]+7.0*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*Phi[2]))*Bmag[4]+5.0*((11.0*Bmag[1]*BmagInv[1]-28.0*BmagInv[0])*Phi[3]+7.0*(BmagInv[0]*Bmag[1]-4.0*BmagInv[1])*Phi[2])*Apar[4]+31.30495168499706*(((Apar[0]*Bmag[1]-2.0*Apar[1])*BmagInv[1]+BmagInv[0]*Apar[1]*Bmag[1])*Phi[3]+BmagInv[1]*(2.0*Phi[1]*Apar[3]+Apar[1]*Bmag[1]*Phi[2])))*geoZ[4]+14.0*(10.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*BmagInv[4]+2.23606797749979*((9.0*BmagInv[1]*geoZ[1]+5.0*BmagInv[0]*geoZ[0])*Apar[3]+5.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]))*Phi[4]+((122.9837387624885*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Apar[4]+10.0*((18.0*Apar[1]*geoZ[1]+7.0*Apar[0]*geoZ[0])*Phi[3]+7.0*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1])*Phi[2]))*Bmag[4]+5.0*((11.0*Bmag[1]*geoZ[1]-28.0*geoZ[0])*Phi[3]+7.0*(geoZ[0]*Bmag[1]-4.0*geoZ[1])*Phi[2])*Apar[4]+31.30495168499706*(((Apar[0]*Bmag[1]-2.0*Apar[1])*geoZ[1]+geoZ[0]*Apar[1]*Bmag[1])*Phi[3]+geoZ[1]*(2.0*Phi[1]*Apar[3]+Apar[1]*Bmag[1]*Phi[2])))*BmagInv[4]+(10.0*((18.0*BmagInv[1]*geoZ[1]+7.0*BmagInv[0]*geoZ[0])*Phi[3]+7.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Apar[4]+15.65247584249853*((9.0*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*geoZ[1]+geoZ[0]*(9.0*Apar[1]*BmagInv[1]+5.0*Apar[0]*BmagInv[0]))*Phi[3]+((9.0*Apar[1]*BmagInv[1]+5.0*Apar[0]*BmagInv[0])*geoZ[1]+5.0*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Phi[2]))*Bmag[4]+7.0*(4.47213595499958*(((BmagInv[0]*Bmag[1]-9.0*BmagInv[1])*geoZ[1]+geoZ[0]*(Bmag[1]*BmagInv[1]-5.0*BmagInv[0]))*Phi[3]+((Bmag[1]*BmagInv[1]-5.0*BmagInv[0])*geoZ[1]-5.0*geoZ[0]*BmagInv[1])*Phi[2])*Apar[4]+((9.0*Apar[1]*Bmag[1]*BmagInv[1]+5.0*BmagInv[0]*(Apar[0]*Bmag[1]-2.0*Apar[1]))*geoZ[1]+5.0*geoZ[0]*((Apar[0]*Bmag[1]-2.0*Apar[1])*BmagInv[1]+BmagInv[0]*Apar[1]*Bmag[1]))*Phi[3]+5.0*(2.0*Phi[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(((Apar[0]*Bmag[1]-2.0*Apar[1])*BmagInv[1]+BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+geoZ[0]*(Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(Apar[0]*Bmag[1]-2.0*Apar[1])))*Phi[2]+2.0*Phi[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2]))))*dfac_x*dfac_y+560.0*dApardt[0])*q_)-2.0*(6.708203932499369*((5.0*(2.0*Bmag[1]*BmagInv[4]+11.0*BmagInv[1]*Bmag[4])+15.65247584249853*BmagInv[0]*Bmag[1])*geoZ[4]+(55.0*geoZ[1]*Bmag[4]+15.65247584249853*geoZ[0]*Bmag[1])*BmagInv[4]+14.0*(2.23606797749979*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*BmagInv[1]*geoZ[1]))*Phi[6]+3.0*(((122.9837387624885*Phi[3]*Bmag[4]+35.0*Bmag[1]*Phi[2])*BmagInv[4]+14.0*(5.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Bmag[4]+2.23606797749979*Bmag[1]*BmagInv[1]*Phi[3]))*geoZ[4]+7.0*(2.0*(5.0*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Bmag[4]+2.23606797749979*Bmag[1]*geoZ[1]*Phi[3])*BmagInv[4]+2.23606797749979*((9.0*BmagInv[1]*geoZ[1]+5.0*BmagInv[0]*geoZ[0])*Phi[3]+5.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Bmag[4]+5.0*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Phi[2]))))*dfac_x*dfac_y*m_))/(dfac_v*m_); 

  double alpha[20]; 
  alpha[0] = -(0.002525381361380526*(dfac_v*(dfac_x*dfac_y*((((134.1640786499874*Bmag[1]*BmagInv[4]+737.9024325749306*BmagInv[1]*Bmag[4]+210.0*BmagInv[0]*Bmag[1])*geoZ[4]+(737.9024325749306*geoZ[1]*Bmag[4]+210.0*geoZ[0]*Bmag[1])*BmagInv[4]+420.0000000000001*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+187.8297101099823*Bmag[1]*BmagInv[1]*geoZ[1])*Phi[6]+((737.9024325749308*Phi[3]*Bmag[4]+210.0*Bmag[1]*Phi[2])*BmagInv[4]+420.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Bmag[4]+187.8297101099823*Bmag[1]*BmagInv[1]*Phi[3])*geoZ[4]+(420.0*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Bmag[4]+187.8297101099823*Bmag[1]*geoZ[1]*Phi[3])*BmagInv[4]+((845.2336954949205*BmagInv[1]*geoZ[1]+469.5742752749559*BmagInv[0]*geoZ[0])*Phi[3]+469.5742752749559*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Bmag[4]+210.0*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Phi[2]))*m_*wv+(((134.1640786499874*Bmag[1]*BmagInv[4]+737.9024325749306*BmagInv[1]*Bmag[4]+210.0*BmagInv[0]*Bmag[1])*geoZ[4]+(737.9024325749306*geoZ[1]*Bmag[4]+210.0*geoZ[0]*Bmag[1])*BmagInv[4]+420.0000000000001*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+187.8297101099823*Bmag[1]*BmagInv[1]*geoZ[1])*Apar[6]+((737.9024325749308*Apar[3]*Bmag[4]+210.0*Bmag[1]*Apar[2])*BmagInv[4]+420.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+187.8297101099823*Bmag[1]*BmagInv[1]*Apar[3])*geoZ[4]+(420.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+187.8297101099823*Bmag[1]*geoZ[1]*Apar[3])*BmagInv[4]+((845.2336954949205*BmagInv[1]*geoZ[1]+469.5742752749559*BmagInv[0]*geoZ[0])*Apar[3]+469.5742752749559*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+210.0*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2]))*wm)+((((((1341.640786499874*Bmag[4]-1650.0)*BmagInv[4]+825.0*BmagInv[0]*Bmag[4]+368.9512162874654*Bmag[1]*BmagInv[1]-939.1485505499119*BmagInv[0])*geoZ[4]+(825.0*geoZ[0]*Bmag[4]+368.9512162874654*Bmag[1]*geoZ[1]-939.1485505499119*geoZ[0])*BmagInv[4]+(1207.476707849887*BmagInv[1]*geoZ[1]+469.5742752749559*BmagInv[0]*geoZ[0])*Bmag[4]+(210.0*BmagInv[0]*Bmag[1]-1890.0*BmagInv[1])*geoZ[1]+geoZ[0]*(210.0*Bmag[1]*BmagInv[1]-1050.0*BmagInv[0]))*Apar[6]+((825.0000000000001*Apar[2]*Bmag[4]+368.9512162874653*Bmag[1]*Apar[3])*BmagInv[4]+(1207.476707849886*BmagInv[1]*Apar[3]+469.5742752749558*BmagInv[0]*Apar[2])*Bmag[4]+(210.0*BmagInv[0]*Bmag[1]-420.0000000000001*BmagInv[1])*Apar[3]+210.0*Bmag[1]*BmagInv[1]*Apar[2])*geoZ[4]+((1207.476707849886*geoZ[1]*Apar[3]+469.5742752749558*geoZ[0]*Apar[2])*Bmag[4]+(210.0*geoZ[0]*Bmag[1]-420.0000000000001*geoZ[1])*Apar[3]+210.0*Bmag[1]*geoZ[1]*Apar[2])*BmagInv[4]+(944.9999999999998*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(944.9999999999998*BmagInv[1]*geoZ[1]+525.0000000000001*BmagInv[0]*geoZ[0])*Apar[2])*Bmag[4]+((422.6168477474601*Bmag[1]*BmagInv[1]-469.5742752749558*BmagInv[0])*geoZ[1]+geoZ[0]*(234.7871376374779*BmagInv[0]*Bmag[1]-469.5742752749558*BmagInv[1]))*Apar[3]+234.7871376374779*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Phi[7]+(((1650.0*BmagInv[4]+939.1485505499119*BmagInv[0])*geoZ[4]+939.1485505499119*geoZ[0]*BmagInv[4]+1890.0*BmagInv[1]*geoZ[1]+1050.0*BmagInv[0]*geoZ[0])*Phi[6]+Phi[3]*(420.0000000000001*(BmagInv[1]*geoZ[4]+geoZ[1]*BmagInv[4])+469.5742752749558*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])))*Apar[7]+((939.1485505499116*(BmagInv[1]*geoZ[4]+geoZ[1]*BmagInv[4])+1050.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[5]+((600.0000000000001*Apar[1]*Bmag[4]+Bmag[1]*(225.0*Apar[4]+67.08203932499369*Apar[0])-134.1640786499874*Apar[1])*BmagInv[4]+(600.0000000000001*BmagInv[1]*Apar[4]+368.9512162874653*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+(67.08203932499369*BmagInv[0]*Bmag[1]-737.9024325749306*BmagInv[1])*Apar[4]+165.0*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(105.0*Apar[0]*Bmag[1]-210.0*Apar[1]))*geoZ[4]+((600.0000000000001*geoZ[1]*Apar[4]+368.9512162874653*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1]))*Bmag[4]+(67.08203932499369*geoZ[0]*Bmag[1]-737.9024325749306*geoZ[1])*Apar[4]+165.0*Apar[1]*Bmag[1]*geoZ[1]+geoZ[0]*(105.0*Apar[0]*Bmag[1]-210.0*Apar[1]))*BmagInv[4]+(368.9512162874653*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+(539.9999999999999*Apar[1]*BmagInv[1]+210.0*Apar[0]*BmagInv[0])*geoZ[1]+210.0*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+((165.0*Bmag[1]*BmagInv[1]-420.0000000000001*BmagInv[0])*geoZ[1]+geoZ[0]*(105.0*BmagInv[0]*Bmag[1]-420.0000000000001*BmagInv[1]))*Apar[4]+((93.91485505499116*Apar[0]*Bmag[1]-187.8297101099823*Apar[1])*BmagInv[1]+93.91485505499116*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+93.91485505499116*geoZ[0]*Apar[1]*Bmag[1]*BmagInv[1])*Phi[6]+(((150.0*Bmag[1]*BmagInv[4]+BmagInv[1]*(825.0000000000001*Bmag[4]-939.1485505499116)+234.7871376374779*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(825.0000000000001*Bmag[4]-939.1485505499116)+234.7871376374779*geoZ[0]*Bmag[1])*BmagInv[4]+469.5742752749558*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(210.0*Bmag[1]*BmagInv[1]-1050.0*BmagInv[0])*geoZ[1]-1050.0*geoZ[0]*BmagInv[1])*Phi[5]+(737.9024325749306*BmagInv[1]*Phi[4]+Phi[1]*(134.1640786499874*BmagInv[4]+210.0*BmagInv[0]))*geoZ[4]+(737.9024325749306*geoZ[1]*BmagInv[4]+420.0000000000001*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[4]+Phi[1]*(210.0*geoZ[0]*BmagInv[4]+187.8297101099823*BmagInv[1]*geoZ[1]))*Apar[6]+(((Apar[3]*(825.0*Bmag[4]-469.5742752749559)+234.787137637478*Bmag[1]*Apar[2])*BmagInv[4]+469.5742752749559*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+210.0*Bmag[1]*BmagInv[1]*Apar[3])*geoZ[4]+(469.5742752749559*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+210.0*Bmag[1]*geoZ[1]*Apar[3])*BmagInv[4]+((945.0*BmagInv[1]*geoZ[1]+525.0*BmagInv[0]*geoZ[0])*Apar[3]+525.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+((234.787137637478*BmagInv[0]*Bmag[1]-469.5742752749559*BmagInv[1])*geoZ[1]+geoZ[0]*(234.787137637478*Bmag[1]*BmagInv[1]-469.5742752749559*BmagInv[0]))*Apar[3]+234.787137637478*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2])*Phi[5]+469.5742752749559*Phi[3]*(BmagInv[4]*geoZ[4]+BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[5]+((737.9024325749308*Apar[3]*BmagInv[4]+420.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*Phi[4]+((600.0*Phi[3]*Apar[4]+368.9512162874654*(Apar[0]*Phi[3]+Apar[1]*Phi[2]))*Bmag[4]+(67.0820393249937*Bmag[1]*Phi[2]-737.9024325749308*Phi[3])*Apar[4]+165.0*Apar[1]*Bmag[1]*Phi[3]+(105.0*Apar[0]*Bmag[1]-210.0*Apar[1])*Phi[2]+210.0*Phi[1]*Apar[2])*BmagInv[4]+(368.9512162874654*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[4]+(540.0*Apar[1]*BmagInv[1]+210.0*Apar[0]*BmagInv[0])*Phi[3]+210.0*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*Phi[2])*Bmag[4]+((165.0*Bmag[1]*BmagInv[1]-420.0*BmagInv[0])*Phi[3]+(105.0*BmagInv[0]*Bmag[1]-420.0*BmagInv[1])*Phi[2])*Apar[4]+((93.91485505499116*Apar[0]*Bmag[1]-187.8297101099823*Apar[1])*BmagInv[1]+93.91485505499116*BmagInv[0]*Apar[1]*Bmag[1])*Phi[3]+BmagInv[1]*(187.8297101099823*Phi[1]*Apar[3]+93.91485505499116*Apar[1]*Bmag[1]*Phi[2]))*geoZ[4]+(420.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*BmagInv[4]+(845.2336954949205*BmagInv[1]*geoZ[1]+469.5742752749559*BmagInv[0]*geoZ[0])*Apar[3]+469.5742752749559*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Phi[4]+((368.9512162874654*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Apar[4]+(540.0*Apar[1]*geoZ[1]+210.0*Apar[0]*geoZ[0])*Phi[3]+210.0*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1])*Phi[2])*Bmag[4]+((165.0*Bmag[1]*geoZ[1]-420.0*geoZ[0])*Phi[3]+(105.0*geoZ[0]*Bmag[1]-420.0*geoZ[1])*Phi[2])*Apar[4]+((93.91485505499116*Apar[0]*Bmag[1]-187.8297101099823*Apar[1])*geoZ[1]+93.91485505499116*geoZ[0]*Apar[1]*Bmag[1])*Phi[3]+geoZ[1]*(187.8297101099823*Phi[1]*Apar[3]+93.91485505499116*Apar[1]*Bmag[1]*Phi[2]))*BmagInv[4]+(((540.0*BmagInv[1]*geoZ[1]+210.0*BmagInv[0]*geoZ[0])*Phi[3]+210.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Apar[4]+(422.6168477474603*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*geoZ[1]+geoZ[0]*(422.6168477474603*Apar[1]*BmagInv[1]+234.787137637478*Apar[0]*BmagInv[0]))*Phi[3]+((422.6168477474603*Apar[1]*BmagInv[1]+234.787137637478*Apar[0]*BmagInv[0])*geoZ[1]+234.787137637478*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Phi[2])*Bmag[4]+(((93.91485505499116*BmagInv[0]*Bmag[1]-845.2336954949205*BmagInv[1])*geoZ[1]+geoZ[0]*(93.91485505499116*Bmag[1]*BmagInv[1]-469.5742752749559*BmagInv[0]))*Phi[3]+((93.91485505499116*Bmag[1]*BmagInv[1]-469.5742752749559*BmagInv[0])*geoZ[1]-469.5742752749559*geoZ[0]*BmagInv[1])*Phi[2])*Apar[4]+((189.0*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(105.0*Apar[0]*Bmag[1]-210.0*Apar[1]))*geoZ[1]+geoZ[0]*((105.0*Apar[0]*Bmag[1]-210.0*Apar[1])*BmagInv[1]+105.0*BmagInv[0]*Apar[1]*Bmag[1]))*Phi[3]+210.0*Phi[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(((105.0*Apar[0]*Bmag[1]-210.0*Apar[1])*BmagInv[1]+105.0*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+geoZ[0]*(105.0*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(105.0*Apar[0]*Bmag[1]-210.0*Apar[1])))*Phi[2]+210.0*Phi[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2])*dfac_x*dfac_y+560.0*dApardt[0])*q_)+((((-134.1640786499874*Bmag[1]*BmagInv[4])-737.9024325749306*BmagInv[1]*Bmag[4]-210.0*BmagInv[0]*Bmag[1])*geoZ[4]+((-737.9024325749306*geoZ[1]*Bmag[4])-210.0*geoZ[0]*Bmag[1])*BmagInv[4]-420.0000000000001*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]-187.8297101099823*Bmag[1]*BmagInv[1]*geoZ[1])*Phi[6]+(((-737.9024325749308*Phi[3]*Bmag[4])-210.0*Bmag[1]*Phi[2])*BmagInv[4]-420.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Bmag[4]-187.8297101099823*Bmag[1]*BmagInv[1]*Phi[3])*geoZ[4]+((-420.0*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Bmag[4])-187.8297101099823*Bmag[1]*geoZ[1]*Phi[3])*BmagInv[4]+(((-845.2336954949205*BmagInv[1]*geoZ[1])-469.5742752749559*BmagInv[0]*geoZ[0])*Phi[3]-469.5742752749559*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Bmag[4]-210.0*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Phi[2]))*dfac_x*dfac_y*m_))/(dfac_v*m_); 
  alpha[1] = -(2.29580123761866e-4*(dfac_v*(dfac_x*dfac_y*((((Bmag[4]*(13200.0*BmagInv[4]+8116.926758324235*BmagInv[0])+3630.0*Bmag[1]*BmagInv[1])*geoZ[4]+(8116.926758324235*geoZ[0]*Bmag[4]+3630.0*Bmag[1]*geoZ[1])*BmagInv[4]+(11880.0*BmagInv[1]*geoZ[1]+4620.0*BmagInv[0]*geoZ[0])*Bmag[4]+2066.126811209806*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[6]+((8116.926758324238*Phi[2]*Bmag[4]+3630.0*Bmag[1]*Phi[3])*BmagInv[4]+(11880.0*BmagInv[1]*Phi[3]+4620.0*BmagInv[0]*Phi[2])*Bmag[4]+2066.126811209806*Bmag[1]*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2]))*geoZ[4]+((11880.0*geoZ[1]*Phi[3]+4620.0*geoZ[0]*Phi[2])*Bmag[4]+2066.126811209806*Bmag[1]*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2]))*BmagInv[4]+(9297.570650444126*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+(9297.570650444126*BmagInv[1]*geoZ[1]+5165.317028024515*BmagInv[0]*geoZ[0])*Phi[2])*Bmag[4]+Bmag[1]*((4158.0*BmagInv[1]*geoZ[1]+2310.0*BmagInv[0]*geoZ[0])*Phi[3]+2310.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2]))*m_*wv+(((Bmag[4]*(13200.0*BmagInv[4]+8116.926758324235*BmagInv[0])+3630.0*Bmag[1]*BmagInv[1])*geoZ[4]+(8116.926758324235*geoZ[0]*Bmag[4]+3630.0*Bmag[1]*geoZ[1])*BmagInv[4]+(11880.0*BmagInv[1]*geoZ[1]+4620.0*BmagInv[0]*geoZ[0])*Bmag[4]+2066.126811209806*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[6]+((8116.926758324238*Apar[2]*Bmag[4]+3630.0*Bmag[1]*Apar[3])*BmagInv[4]+(11880.0*BmagInv[1]*Apar[3]+4620.0*BmagInv[0]*Apar[2])*Bmag[4]+2066.126811209806*Bmag[1]*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*geoZ[4]+((11880.0*geoZ[1]*Apar[3]+4620.0*geoZ[0]*Apar[2])*Bmag[4]+2066.126811209806*Bmag[1]*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2]))*BmagInv[4]+(9297.570650444126*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(9297.570650444126*BmagInv[1]*geoZ[1]+5165.317028024515*BmagInv[0]*geoZ[0])*Apar[2])*Bmag[4]+Bmag[1]*((4158.0*BmagInv[1]*geoZ[1]+2310.0*BmagInv[0]*geoZ[0])*Apar[3]+2310.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]))*wm)+(((((6600.0*Bmag[1]*BmagInv[4]+BmagInv[1]*(22275.0*Bmag[4]-26564.48757269751)+4058.463379162119*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(22275.0*Bmag[4]-26564.48757269751)+4058.463379162119*geoZ[0]*Bmag[1])*BmagInv[4]+13282.24378634875*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(5940.0*Bmag[1]*BmagInv[1]-20790.0*BmagInv[0])*geoZ[1]+geoZ[0]*(2310.0*BmagInv[0]*Bmag[1]-20790.0*BmagInv[1]))*Apar[6]+((Apar[3]*(22275.0*Bmag[4]-8116.926758324235)+4058.463379162118*Bmag[1]*Apar[2])*BmagInv[4]+13282.24378634875*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+(5939.999999999999*Bmag[1]*BmagInv[1]-4620.0*BmagInv[0])*Apar[3]+2310.0*BmagInv[0]*Bmag[1]*Apar[2])*geoZ[4]+(13282.24378634875*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+(5939.999999999999*Bmag[1]*geoZ[1]-4620.0*geoZ[0])*Apar[3]+2310.0*geoZ[0]*Bmag[1]*Apar[2])*BmagInv[4]+((22275.0*BmagInv[1]*geoZ[1]+10395.0*BmagInv[0]*geoZ[0])*Apar[3]+10395.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+((4648.785325222062*BmagInv[0]*Bmag[1]-9297.570650444124*BmagInv[1])*geoZ[1]+geoZ[0]*(4648.785325222062*Bmag[1]*BmagInv[1]-5165.317028024514*BmagInv[0]))*Apar[3]+Bmag[1]*(4648.785325222062*BmagInv[1]*geoZ[1]+2582.658514012257*BmagInv[0]*geoZ[0])*Apar[2])*Phi[7]+((26564.48757269751*(BmagInv[1]*geoZ[4]+geoZ[1]*BmagInv[4])+20790.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[6]+Phi[3]*((8116.926758324235*BmagInv[4]+4620.0*BmagInv[0])*geoZ[4]+4620.0*geoZ[0]*BmagInv[4]+9297.570650444124*BmagInv[1]*geoZ[1]+5165.317028024514*BmagInv[0]*geoZ[0]))*Apar[7]+(((18150.0*BmagInv[4]+10330.63405604903*BmagInv[0])*geoZ[4]+10330.63405604903*geoZ[0]*BmagInv[4]+20790.0*BmagInv[1]*geoZ[1]+11550.0*BmagInv[0]*geoZ[0])*Apar[5]+(((12242.47217681135*Apar[4]+6600.000000000001*Apar[0])*Bmag[4]-13200.0*Apar[4]+2951.609730299722*Apar[1]*Bmag[1])*BmagInv[4]+(6600.000000000001*BmagInv[0]*Apar[4]+9961.682839761559*Apar[1]*BmagInv[1]+4058.463379162118*Apar[0]*BmagInv[0])*Bmag[4]+(2951.609730299722*Bmag[1]*BmagInv[1]-8116.926758324235*BmagInv[0])*Apar[4]+(1815.0*Apar[0]*Bmag[1]-3630.0*Apar[1])*BmagInv[1]+1815.0*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[4]+((6600.000000000001*geoZ[0]*Apar[4]+9961.682839761559*Apar[1]*geoZ[1]+4058.463379162118*Apar[0]*geoZ[0])*Bmag[4]+(2951.609730299722*Bmag[1]*geoZ[1]-8116.926758324235*geoZ[0])*Apar[4]+(1815.0*Apar[0]*Bmag[1]-3630.0*Apar[1])*geoZ[1]+1815.0*geoZ[0]*Apar[1]*Bmag[1])*BmagInv[4]+((9961.682839761559*BmagInv[1]*geoZ[1]+4058.463379162118*BmagInv[0]*geoZ[0])*Apar[4]+5939.999999999999*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*geoZ[1]+geoZ[0]*(5939.999999999999*Apar[1]*BmagInv[1]+2310.0*Apar[0]*BmagInv[0]))*Bmag[4]+((1815.0*BmagInv[0]*Bmag[1]-11880.0*BmagInv[1])*geoZ[1]+geoZ[0]*(1815.0*Bmag[1]*BmagInv[1]-4620.0*BmagInv[0]))*Apar[4]+(2656.448757269749*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(1033.063405604903*Apar[0]*Bmag[1]-2066.126811209806*Apar[1]))*geoZ[1]+geoZ[0]*((1033.063405604903*Apar[0]*Bmag[1]-2066.126811209806*Apar[1])*BmagInv[1]+1033.063405604903*BmagInv[0]*Apar[1]*Bmag[1]))*Phi[6]+((((14758.04865149861*Bmag[4]-18150.0)*BmagInv[4]+9075.000000000002*BmagInv[0]*Bmag[4]+4058.463379162118*Bmag[1]*BmagInv[1]-10330.63405604903*BmagInv[0])*geoZ[4]+(9075.000000000002*geoZ[0]*Bmag[4]+4058.463379162118*Bmag[1]*geoZ[1]-10330.63405604903*geoZ[0])*BmagInv[4]+(13282.24378634875*BmagInv[1]*geoZ[1]+5165.317028024514*BmagInv[0]*geoZ[0])*Bmag[4]+(2310.0*BmagInv[0]*Bmag[1]-20790.0*BmagInv[1])*geoZ[1]+geoZ[0]*(2310.0*Bmag[1]*BmagInv[1]-11550.0*BmagInv[0]))*Phi[5]+((13200.0*BmagInv[4]+8116.926758324235*BmagInv[0])*Phi[4]+3630.0*BmagInv[1]*Phi[1])*geoZ[4]+(8116.926758324235*geoZ[0]*BmagInv[4]+11880.0*BmagInv[1]*geoZ[1]+4620.0*BmagInv[0]*geoZ[0])*Phi[4]+Phi[1]*(3630.0*geoZ[1]*BmagInv[4]+2066.126811209806*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])))*Apar[6]+(((9075.0*Apar[2]*Bmag[4]+4058.463379162119*Bmag[1]*Apar[3])*BmagInv[4]+(13282.24378634875*BmagInv[1]*Apar[3]+5165.317028024515*BmagInv[0]*Apar[2])*Bmag[4]+(2310.0*BmagInv[0]*Bmag[1]-4620.0*BmagInv[1])*Apar[3]+2310.0*Bmag[1]*BmagInv[1]*Apar[2])*geoZ[4]+((13282.24378634875*geoZ[1]*Apar[3]+5165.317028024515*geoZ[0]*Apar[2])*Bmag[4]+(2310.0*geoZ[0]*Bmag[1]-4620.0*geoZ[1])*Apar[3]+2310.0*Bmag[1]*geoZ[1]*Apar[2])*BmagInv[4]+(10395.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(10395.0*BmagInv[1]*geoZ[1]+5775.0*BmagInv[0]*geoZ[0])*Apar[2])*Bmag[4]+((4648.785325222063*Bmag[1]*BmagInv[1]-5165.317028024515*BmagInv[0])*geoZ[1]+geoZ[0]*(2582.658514012257*BmagInv[0]*Bmag[1]-5165.317028024515*BmagInv[1]))*Apar[3]+2582.658514012257*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Phi[5]+Phi[3]*(4620.0*(BmagInv[1]*geoZ[4]+geoZ[1]*BmagInv[4])+5165.317028024515*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[5]+((8116.926758324238*Apar[2]*BmagInv[4]+11880.0*BmagInv[1]*Apar[3]+4620.0*BmagInv[0]*Apar[2])*Phi[4]+((6600.0*Phi[2]*Apar[4]+9961.682839761565*Apar[1]*Phi[3]+4058.463379162119*Apar[0]*Phi[2])*Bmag[4]+(2951.609730299723*Bmag[1]*Phi[3]-8116.926758324238*Phi[2])*Apar[4]+(1815.0*Apar[0]*Bmag[1]-3630.0*Apar[1])*Phi[3]+3630.0*Phi[1]*Apar[3]+1815.0*Apar[1]*Bmag[1]*Phi[2])*BmagInv[4]+((9961.682839761565*BmagInv[1]*Phi[3]+4058.463379162119*BmagInv[0]*Phi[2])*Apar[4]+5940.0*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*Phi[3]+(5940.0*Apar[1]*BmagInv[1]+2310.0*Apar[0]*BmagInv[0])*Phi[2])*Bmag[4]+((1815.0*BmagInv[0]*Bmag[1]-11880.0*BmagInv[1])*Phi[3]+(1815.0*Bmag[1]*BmagInv[1]-4620.0*BmagInv[0])*Phi[2])*Apar[4]+(2656.44875726975*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(1033.063405604903*Apar[0]*Bmag[1]-2066.126811209806*Apar[1]))*Phi[3]+2066.126811209806*BmagInv[0]*Phi[1]*Apar[3]+((1033.063405604903*Apar[0]*Bmag[1]-2066.126811209806*Apar[1])*BmagInv[1]+1033.063405604903*BmagInv[0]*Apar[1]*Bmag[1])*Phi[2]+2066.126811209806*BmagInv[1]*Phi[1]*Apar[2])*geoZ[4]+((11880.0*geoZ[1]*Apar[3]+4620.0*geoZ[0]*Apar[2])*BmagInv[4]+9297.570650444126*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(9297.570650444126*BmagInv[1]*geoZ[1]+5165.317028024515*BmagInv[0]*geoZ[0])*Apar[2])*Phi[4]+(((9961.682839761565*geoZ[1]*Phi[3]+4058.463379162119*geoZ[0]*Phi[2])*Apar[4]+5940.0*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1])*Phi[3]+(5940.0*Apar[1]*geoZ[1]+2310.0*Apar[0]*geoZ[0])*Phi[2])*Bmag[4]+((1815.0*geoZ[0]*Bmag[1]-11880.0*geoZ[1])*Phi[3]+(1815.0*Bmag[1]*geoZ[1]-4620.0*geoZ[0])*Phi[2])*Apar[4]+(2656.44875726975*Apar[1]*Bmag[1]*geoZ[1]+geoZ[0]*(1033.063405604903*Apar[0]*Bmag[1]-2066.126811209806*Apar[1]))*Phi[3]+2066.126811209806*geoZ[0]*Phi[1]*Apar[3]+((1033.063405604903*Apar[0]*Bmag[1]-2066.126811209806*Apar[1])*geoZ[1]+1033.063405604903*geoZ[0]*Apar[1]*Bmag[1])*Phi[2]+2066.126811209806*Phi[1]*geoZ[1]*Apar[2])*BmagInv[4]+((5940.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+(5940.0*BmagInv[1]*geoZ[1]+2310.0*BmagInv[0]*geoZ[0])*Phi[2])*Apar[4]+((9961.682839761565*Apar[1]*BmagInv[1]+4648.785325222063*Apar[0]*BmagInv[0])*geoZ[1]+4648.785325222063*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Phi[3]+(4648.785325222063*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*geoZ[1]+geoZ[0]*(4648.785325222063*Apar[1]*BmagInv[1]+2582.658514012257*Apar[0]*BmagInv[0]))*Phi[2])*Bmag[4]+(((2656.44875726975*Bmag[1]*BmagInv[1]-9297.570650444126*BmagInv[0])*geoZ[1]+geoZ[0]*(1033.063405604903*BmagInv[0]*Bmag[1]-9297.570650444126*BmagInv[1]))*Phi[3]+((1033.063405604903*BmagInv[0]*Bmag[1]-9297.570650444126*BmagInv[1])*geoZ[1]+geoZ[0]*(1033.063405604903*Bmag[1]*BmagInv[1]-5165.317028024515*BmagInv[0]))*Phi[2])*Apar[4]+(((2079.0*Apar[0]*Bmag[1]-4158.0*Apar[1])*BmagInv[1]+2079.0*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+geoZ[0]*(2079.0*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(1155.0*Apar[0]*Bmag[1]-2310.0*Apar[1])))*Phi[3]+Phi[1]*(4158.0*BmagInv[1]*geoZ[1]+2310.0*BmagInv[0]*geoZ[0])*Apar[3]+((2079.0*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(1155.0*Apar[0]*Bmag[1]-2310.0*Apar[1]))*geoZ[1]+geoZ[0]*((1155.0*Apar[0]*Bmag[1]-2310.0*Apar[1])*BmagInv[1]+1155.0*BmagInv[0]*Apar[1]*Bmag[1]))*Phi[2]+2310.0*Phi[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*dfac_x*dfac_y+6160.0*dApardt[1])*q_)+(((Bmag[4]*((-13200.0*BmagInv[4])-8116.926758324235*BmagInv[0])-3630.0*Bmag[1]*BmagInv[1])*geoZ[4]+((-8116.926758324235*geoZ[0]*Bmag[4])-3630.0*Bmag[1]*geoZ[1])*BmagInv[4]+((-11880.0*BmagInv[1]*geoZ[1])-4620.0*BmagInv[0]*geoZ[0])*Bmag[4]-2066.126811209806*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[6]+(((-8116.926758324238*Phi[2]*Bmag[4])-3630.0*Bmag[1]*Phi[3])*BmagInv[4]+((-11880.0*BmagInv[1]*Phi[3])-4620.0*BmagInv[0]*Phi[2])*Bmag[4]-2066.126811209806*Bmag[1]*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2]))*geoZ[4]+(((-11880.0*geoZ[1]*Phi[3])-4620.0*geoZ[0]*Phi[2])*Bmag[4]-2066.126811209806*Bmag[1]*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2]))*BmagInv[4]+(((-9297.570650444126*BmagInv[1]*geoZ[1])-5165.317028024515*BmagInv[0]*geoZ[0])*Phi[2]-9297.570650444126*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3])*Bmag[4]+Bmag[1]*(((-4158.0*BmagInv[1]*geoZ[1])-2310.0*BmagInv[0]*geoZ[0])*Phi[3]-2310.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2]))*dfac_x*dfac_y*m_))/(dfac_v*m_); 
  alpha[2] = -(0.002525381361380526*(dfac_v*(dfac_x*dfac_y*((((Bmag[4]*(1650.0*BmagInv[4]+939.1485505499116*BmagInv[0])+420.0000000000001*Bmag[1]*BmagInv[1])*geoZ[4]+(939.1485505499116*geoZ[0]*Bmag[4]+420.0000000000001*Bmag[1]*geoZ[1])*BmagInv[4]+(1890.0*BmagInv[1]*geoZ[1]+1050.0*BmagInv[0]*geoZ[0])*Bmag[4]+469.5742752749558*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[7]+((469.5742752749559*Bmag[1]*BmagInv[4]+939.1485505499119*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(939.1485505499119*geoZ[1]*BmagInv[4]+1050.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+469.5742752749559*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*Phi[5])*m_*wv+(((Bmag[4]*(1650.0*BmagInv[4]+939.1485505499116*BmagInv[0])+420.0000000000001*Bmag[1]*BmagInv[1])*geoZ[4]+(939.1485505499116*geoZ[0]*Bmag[4]+420.0000000000001*Bmag[1]*geoZ[1])*BmagInv[4]+(1890.0*BmagInv[1]*geoZ[1]+1050.0*BmagInv[0]*geoZ[0])*Bmag[4]+469.5742752749558*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[7]+((469.5742752749559*Bmag[1]*BmagInv[4]+939.1485505499119*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(939.1485505499119*geoZ[1]*BmagInv[4]+1050.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+469.5742752749559*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*Apar[5])*wm)+(((((330.0*Bmag[1]*BmagInv[4]+1080.0*BmagInv[1]*Bmag[4]+187.8297101099823*BmagInv[0]*Bmag[1])*geoZ[4]+(1080.0*geoZ[1]*Bmag[4]+187.8297101099823*geoZ[0]*Bmag[1])*BmagInv[4]+845.2336954949205*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*(378.0*BmagInv[1]*geoZ[1]+210.0*BmagInv[0]*geoZ[0]))*Apar[7]+(((737.9024325749306*Bmag[4]+420.0000000000001)*BmagInv[4]+420.0000000000001*BmagInv[0]*Bmag[4]+187.8297101099823*Bmag[1]*BmagInv[1])*geoZ[4]+(420.0000000000001*geoZ[0]*Bmag[4]+187.8297101099823*Bmag[1]*geoZ[1])*BmagInv[4]+(845.2336954949202*BmagInv[1]*geoZ[1]+469.5742752749558*BmagInv[0]*geoZ[0])*Bmag[4]+(420.0000000000001*BmagInv[1]+210.0*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(210.0*Bmag[1]*BmagInv[1]+420.0000000000001*BmagInv[0]))*Apar[5]+(((1341.640786499874*Apar[4]+825.0000000000001*Apar[0])*Bmag[4]-1650.0*Apar[4]+368.9512162874653*Apar[1]*Bmag[1])*BmagInv[4]+(825.0000000000001*BmagInv[0]*Apar[4]+1207.476707849886*Apar[1]*BmagInv[1]+469.5742752749558*Apar[0]*BmagInv[0])*Bmag[4]+(368.9512162874653*Bmag[1]*BmagInv[1]-939.1485505499116*BmagInv[0])*Apar[4]+(210.0*Apar[0]*Bmag[1]-420.0000000000001*Apar[1])*BmagInv[1]+210.0*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[4]+((825.0000000000001*geoZ[0]*Apar[4]+1207.476707849886*Apar[1]*geoZ[1]+469.5742752749558*Apar[0]*geoZ[0])*Bmag[4]+(368.9512162874653*Bmag[1]*geoZ[1]-939.1485505499116*geoZ[0])*Apar[4]+(210.0*Apar[0]*Bmag[1]-420.0000000000001*Apar[1])*geoZ[1]+210.0*geoZ[0]*Apar[1]*Bmag[1])*BmagInv[4]+((1207.476707849886*BmagInv[1]*geoZ[1]+469.5742752749558*BmagInv[0]*geoZ[0])*Apar[4]+944.9999999999998*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*geoZ[1]+geoZ[0]*(944.9999999999998*Apar[1]*BmagInv[1]+525.0000000000001*Apar[0]*BmagInv[0]))*Bmag[4]+((210.0*BmagInv[0]*Bmag[1]-1890.0*BmagInv[1])*geoZ[1]+geoZ[0]*(210.0*Bmag[1]*BmagInv[1]-1050.0*BmagInv[0]))*Apar[4]+(422.6168477474601*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(234.7871376374779*Apar[0]*Bmag[1]-469.5742752749558*Apar[1]))*geoZ[1]+geoZ[0]*((234.7871376374779*Apar[0]*Bmag[1]-469.5742752749558*Apar[1])*BmagInv[1]+234.7871376374779*BmagInv[0]*Apar[1]*Bmag[1]))*Phi[7]+((((737.9024325749306*Bmag[4]-420.0000000000001)*BmagInv[4]+420.0000000000001*BmagInv[0]*Bmag[4]+187.8297101099823*Bmag[1]*BmagInv[1])*geoZ[4]+(420.0000000000001*geoZ[0]*Bmag[4]+187.8297101099823*Bmag[1]*geoZ[1])*BmagInv[4]+(845.2336954949202*BmagInv[1]*geoZ[1]+469.5742752749558*BmagInv[0]*geoZ[0])*Bmag[4]+(210.0*BmagInv[0]*Bmag[1]-420.0000000000001*BmagInv[1])*geoZ[1]+geoZ[0]*(210.0*Bmag[1]*BmagInv[1]-420.0000000000001*BmagInv[0]))*Phi[5]+((1650.0*BmagInv[4]+939.1485505499116*BmagInv[0])*Phi[4]+420.0000000000001*BmagInv[1]*Phi[1])*geoZ[4]+(939.1485505499116*geoZ[0]*BmagInv[4]+1890.0*BmagInv[1]*geoZ[1]+1050.0*BmagInv[0]*geoZ[0])*Phi[4]+Phi[1]*(420.0000000000001*geoZ[1]*BmagInv[4]+469.5742752749558*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])))*Apar[7]+(((225.0*Bmag[1]*BmagInv[4]+600.0*BmagInv[1]*Bmag[4]+67.0820393249937*BmagInv[0]*Bmag[1])*geoZ[4]+(600.0*geoZ[1]*Bmag[4]+67.0820393249937*geoZ[0]*Bmag[1])*BmagInv[4]+368.9512162874654*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*(165.0*BmagInv[1]*geoZ[1]+105.0*BmagInv[0]*geoZ[0]))*Apar[6]+((Apar[3]*(600.0000000000001*Bmag[4]+603.738353924943)+67.08203932499369*Bmag[1]*Apar[2])*BmagInv[4]+368.9512162874653*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+(165.0*Bmag[1]*BmagInv[1]+210.0*BmagInv[0])*Apar[3]+(420.0000000000001*BmagInv[1]+105.0*BmagInv[0]*Bmag[1])*Apar[2])*geoZ[4]+(368.9512162874653*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+(165.0*Bmag[1]*geoZ[1]+210.0*geoZ[0])*Apar[3]+(420.0000000000001*geoZ[1]+105.0*geoZ[0]*Bmag[1])*Apar[2])*BmagInv[4]+((539.9999999999999*BmagInv[1]*geoZ[1]+210.0*BmagInv[0]*geoZ[0])*Apar[3]+210.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+((657.4039853849381*BmagInv[1]+93.91485505499116*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(93.91485505499116*Bmag[1]*BmagInv[1]+469.5742752749558*BmagInv[0]))*Apar[3]+((93.91485505499116*Bmag[1]*BmagInv[1]+469.5742752749558*BmagInv[0])*geoZ[1]+469.5742752749558*geoZ[0]*BmagInv[1])*Apar[2])*Phi[6]+(((Phi[3]*(600.0000000000001*Bmag[4]-603.738353924943)+67.08203932499369*Bmag[1]*Phi[2])*BmagInv[4]+368.9512162874653*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Bmag[4]+(165.0*Bmag[1]*BmagInv[1]-210.0*BmagInv[0])*Phi[3]+(105.0*BmagInv[0]*Bmag[1]-420.0000000000001*BmagInv[1])*Phi[2])*geoZ[4]+(368.9512162874653*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Bmag[4]+(165.0*Bmag[1]*geoZ[1]-210.0*geoZ[0])*Phi[3]+(105.0*geoZ[0]*Bmag[1]-420.0000000000001*geoZ[1])*Phi[2])*BmagInv[4]+((539.9999999999999*BmagInv[1]*geoZ[1]+210.0*BmagInv[0]*geoZ[0])*Phi[3]+210.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Bmag[4]+((93.91485505499116*BmagInv[0]*Bmag[1]-657.4039853849381*BmagInv[1])*geoZ[1]+geoZ[0]*(93.91485505499116*Bmag[1]*BmagInv[1]-469.5742752749558*BmagInv[0]))*Phi[3]+((93.91485505499116*Bmag[1]*BmagInv[1]-469.5742752749558*BmagInv[0])*geoZ[1]-469.5742752749558*geoZ[0]*BmagInv[1])*Phi[2])*Apar[6]+(((210.0*Bmag[1]*BmagInv[4]+420.0*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(420.0*geoZ[1]*BmagInv[4]+469.5742752749559*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+210.0*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*Apar[5]+((825.0*Apar[1]*Bmag[4]+Bmag[1]*(150.0*Apar[4]+234.787137637478*Apar[0])-469.5742752749559*Apar[1])*BmagInv[4]+(825.0*BmagInv[1]*Apar[4]+469.5742752749559*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+(234.787137637478*BmagInv[0]*Bmag[1]-939.1485505499119*BmagInv[1])*Apar[4]+210.0*Apar[1]*Bmag[1]*BmagInv[1])*geoZ[4]+((825.0*geoZ[1]*Apar[4]+469.5742752749559*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1]))*Bmag[4]+(234.787137637478*geoZ[0]*Bmag[1]-939.1485505499119*geoZ[1])*Apar[4]+210.0*Apar[1]*Bmag[1]*geoZ[1])*BmagInv[4]+(469.5742752749559*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+(945.0*Apar[1]*BmagInv[1]+525.0*Apar[0]*BmagInv[0])*geoZ[1]+525.0*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+((210.0*Bmag[1]*BmagInv[1]-1050.0*BmagInv[0])*geoZ[1]-1050.0*geoZ[0]*BmagInv[1])*Apar[4]+((234.787137637478*Apar[0]*Bmag[1]-469.5742752749559*Apar[1])*BmagInv[1]+234.787137637478*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+geoZ[0]*(234.787137637478*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(234.787137637478*Apar[0]*Bmag[1]-469.5742752749559*Apar[1])))*Phi[5]+((939.1485505499119*BmagInv[1]*Phi[4]+469.5742752749559*Phi[1]*BmagInv[4])*geoZ[4]+(939.1485505499119*geoZ[1]*BmagInv[4]+1050.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[4]+469.5742752749559*Phi[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*Apar[5]+((368.9512162874654*(Apar[2]*Phi[3]+Phi[2]*Apar[3])*Bmag[4]+(165.0*Bmag[1]*Apar[3]+210.0*Apar[2])*Phi[3]+Phi[2]*(105.0*Bmag[1]*Apar[2]-210.0*Apar[3]))*BmagInv[4]+((540.0*BmagInv[1]*Apar[3]+210.0*BmagInv[0]*Apar[2])*Phi[3]+210.0*Phi[2]*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*Bmag[4]+93.91485505499116*Bmag[1]*((BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Phi[3]+BmagInv[1]*Phi[2]*Apar[3]))*geoZ[4]+(((540.0*geoZ[1]*Apar[3]+210.0*geoZ[0]*Apar[2])*Phi[3]+210.0*Phi[2]*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2]))*Bmag[4]+93.91485505499116*Bmag[1]*((geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Phi[3]+geoZ[1]*Phi[2]*Apar[3]))*BmagInv[4]+((422.6168477474603*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(422.6168477474603*BmagInv[1]*geoZ[1]+234.787137637478*BmagInv[0]*geoZ[0])*Apar[2])*Phi[3]+Phi[2]*((422.6168477474603*BmagInv[1]*geoZ[1]+234.787137637478*BmagInv[0]*geoZ[0])*Apar[3]+234.787137637478*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]))*Bmag[4]+(Bmag[1]*(189.0*BmagInv[1]*geoZ[1]+105.0*BmagInv[0]*geoZ[0])*Apar[3]+((210.0*BmagInv[1]+105.0*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(105.0*Bmag[1]*BmagInv[1]+210.0*BmagInv[0]))*Apar[2])*Phi[3]+Phi[2]*(((105.0*BmagInv[0]*Bmag[1]-210.0*BmagInv[1])*geoZ[1]+geoZ[0]*(105.0*Bmag[1]*BmagInv[1]-210.0*BmagInv[0]))*Apar[3]+105.0*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2]))*dfac_x*dfac_y+560.0*dApardt[2])*q_)+(((Bmag[4]*((-1650.0*BmagInv[4])-939.1485505499116*BmagInv[0])-420.0000000000001*Bmag[1]*BmagInv[1])*geoZ[4]+((-939.1485505499116*geoZ[0]*Bmag[4])-420.0000000000001*Bmag[1]*geoZ[1])*BmagInv[4]+((-1890.0*BmagInv[1]*geoZ[1])-1050.0*BmagInv[0]*geoZ[0])*Bmag[4]-469.5742752749558*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[7]+(((-469.5742752749559*Bmag[1]*BmagInv[4])-939.1485505499119*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*((-939.1485505499119*geoZ[1]*BmagInv[4])-1050.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))-469.5742752749559*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*Phi[5])*dfac_x*dfac_y*m_))/(dfac_v*m_); 
  alpha[3] = -(0.005050762722761052*(((38.72983346207417*Bmag[1]*BmagInv[4]+213.0140840414079*BmagInv[1]*Bmag[4]+60.62177826491071*BmagInv[0]*Bmag[1])*geoZ[4]+(213.0140840414079*geoZ[1]*Bmag[4]+60.62177826491071*geoZ[0]*Bmag[1])*BmagInv[4]+121.2435565298214*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+54.22176684690384*Bmag[1]*BmagInv[1]*geoZ[1])*Apar[6]+((213.014084041408*Apar[3]*Bmag[4]+60.6217782649107*Bmag[1]*Apar[2])*BmagInv[4]+121.2435565298214*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+54.22176684690384*Bmag[1]*BmagInv[1]*Apar[3])*geoZ[4]+(121.2435565298214*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+54.22176684690384*Bmag[1]*geoZ[1]*Apar[3])*BmagInv[4]+((243.9979508110672*BmagInv[1]*geoZ[1]+135.5544171172596*BmagInv[0]*geoZ[0])*Apar[3]+135.5544171172596*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+60.6217782649107*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2]))*dfac_x*dfac_y)/(dfac_m*m_); 
  alpha[4] = -(4.59160247523732e-5*(dfac_v*(dfac_x*dfac_y*((((40584.63379162118*Bmag[1]*BmagInv[4]+132822.4378634875*BmagInv[1]*Bmag[4]+23100.0*BmagInv[0]*Bmag[1])*geoZ[4]+(132822.4378634875*geoZ[1]*Bmag[4]+23100.0*geoZ[0]*Bmag[1])*BmagInv[4]+103950.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*(46487.85325222062*BmagInv[1]*geoZ[1]+25826.58514012257*BmagInv[0]*geoZ[0]))*Phi[7]+((Bmag[4]*(90750.0*BmagInv[4]+51653.17028024515*BmagInv[0])+23100.0*Bmag[1]*BmagInv[1])*geoZ[4]+(51653.17028024515*geoZ[0]*Bmag[4]+23100.0*Bmag[1]*geoZ[1])*BmagInv[4]+(103950.0*BmagInv[1]*geoZ[1]+57750.0*BmagInv[0]*geoZ[0])*Bmag[4]+25826.58514012258*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[5])*m_*wv+(((40584.63379162118*Bmag[1]*BmagInv[4]+132822.4378634875*BmagInv[1]*Bmag[4]+23100.0*BmagInv[0]*Bmag[1])*geoZ[4]+(132822.4378634875*geoZ[1]*Bmag[4]+23100.0*geoZ[0]*Bmag[1])*BmagInv[4]+103950.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*(46487.85325222062*BmagInv[1]*geoZ[1]+25826.58514012257*BmagInv[0]*geoZ[0]))*Apar[7]+((Bmag[4]*(90750.0*BmagInv[4]+51653.17028024515*BmagInv[0])+23100.0*Bmag[1]*BmagInv[1])*geoZ[4]+(51653.17028024515*geoZ[0]*Bmag[4]+23100.0*Bmag[1]*geoZ[1])*BmagInv[4]+(103950.0*BmagInv[1]*geoZ[1]+57750.0*BmagInv[0]*geoZ[0])*Bmag[4]+25826.58514012258*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[5])*wm)+(((((Bmag[4]*(99616.82839761565*BmagInv[4]+59400.0*BmagInv[0])+26564.48757269751*Bmag[1]*BmagInv[1])*geoZ[4]+(59400.0*geoZ[0]*Bmag[4]+26564.48757269751*Bmag[1]*geoZ[1])*BmagInv[4]+(99616.82839761565*BmagInv[1]*geoZ[1]+46487.85325222064*BmagInv[0]*geoZ[0])*Bmag[4]+20790.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[7]+((18150.0*Bmag[1]*BmagInv[4]+BmagInv[1]*(59400.0*Bmag[4]+20661.26811209806)+10330.63405604903*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(59400.0*Bmag[4]+20661.26811209806)+10330.63405604903*geoZ[0]*Bmag[1])*BmagInv[4]+46487.85325222062*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(20790.0*Bmag[1]*BmagInv[1]+23100.0*BmagInv[0])*geoZ[1]+geoZ[0]*(23100.0*BmagInv[1]+11550.0*BmagInv[0]*Bmag[1]))*Apar[5]+((111375.0*Apar[1]*Bmag[4]+Bmag[1]*(33000.00000000001*Apar[4]+20292.31689581059*Apar[0])-40584.63379162118*Apar[1])*BmagInv[4]+(111375.0*BmagInv[1]*Apar[4]+66411.21893174374*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+(20292.31689581059*BmagInv[0]*Bmag[1]-132822.4378634875*BmagInv[1])*Apar[4]+29700.0*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(11550.0*Apar[0]*Bmag[1]-23100.0*Apar[1]))*geoZ[4]+((111375.0*geoZ[1]*Apar[4]+66411.21893174374*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1]))*Bmag[4]+(20292.31689581059*geoZ[0]*Bmag[1]-132822.4378634875*geoZ[1])*Apar[4]+29700.0*Apar[1]*Bmag[1]*geoZ[1]+geoZ[0]*(11550.0*Apar[0]*Bmag[1]-23100.0*Apar[1]))*BmagInv[4]+(66411.21893174374*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+(111375.0*Apar[1]*BmagInv[1]+51975.0*Apar[0]*BmagInv[0])*geoZ[1]+51975.0*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+((29700.0*Bmag[1]*BmagInv[1]-103950.0*BmagInv[0])*geoZ[1]+geoZ[0]*(11550.0*BmagInv[0]*Bmag[1]-103950.0*BmagInv[1]))*Apar[4]+((23243.92662611031*Apar[0]*Bmag[1]-46487.85325222062*Apar[1])*BmagInv[1]+23243.92662611031*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+geoZ[0]*(23243.92662611031*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(12913.29257006129*Apar[0]*Bmag[1]-25826.58514012257*Apar[1])))*Phi[7]+(((18150.0*Bmag[1]*BmagInv[4]+BmagInv[1]*(59400.0*Bmag[4]-20661.26811209806)+10330.63405604903*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(59400.0*Bmag[4]-20661.26811209806)+10330.63405604903*geoZ[0]*Bmag[1])*BmagInv[4]+46487.85325222062*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(20790.0*Bmag[1]*BmagInv[1]-23100.0*BmagInv[0])*geoZ[1]+geoZ[0]*(11550.0*BmagInv[0]*Bmag[1]-23100.0*BmagInv[1]))*Phi[5]+(132822.4378634875*BmagInv[1]*Phi[4]+Phi[1]*(40584.63379162118*BmagInv[4]+23100.0*BmagInv[0]))*geoZ[4]+(132822.4378634875*geoZ[1]*BmagInv[4]+103950.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[4]+Phi[1]*(23100.0*geoZ[0]*BmagInv[4]+46487.85325222062*BmagInv[1]*geoZ[1]+25826.58514012257*BmagInv[0]*geoZ[0]))*Apar[7]+(((Bmag[4]*(61212.36088405675*BmagInv[4]+33000.0*BmagInv[0])+14758.04865149862*Bmag[1]*BmagInv[1])*geoZ[4]+(33000.0*geoZ[0]*Bmag[4]+14758.04865149862*Bmag[1]*geoZ[1])*BmagInv[4]+(49808.41419880783*BmagInv[1]*geoZ[1]+20292.3168958106*BmagInv[0]*geoZ[0])*Bmag[4]+9075.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[6]+((33000.00000000001*Apar[2]*Bmag[4]+14758.04865149861*Bmag[1]*Apar[3]+40584.63379162118*Apar[2])*BmagInv[4]+(49808.4141988078*BmagInv[1]*Apar[3]+20292.31689581059*BmagInv[0]*Apar[2])*Bmag[4]+(41250.00000000001*BmagInv[1]+9075.000000000002*BmagInv[0]*Bmag[1])*Apar[3]+(9075.000000000002*Bmag[1]*BmagInv[1]+23100.0*BmagInv[0])*Apar[2])*geoZ[4]+((49808.4141988078*geoZ[1]*Apar[3]+20292.31689581059*geoZ[0]*Apar[2])*Bmag[4]+(41250.00000000001*geoZ[1]+9075.000000000002*geoZ[0]*Bmag[1])*Apar[3]+(9075.000000000002*Bmag[1]*geoZ[1]+23100.0*geoZ[0])*Apar[2])*BmagInv[4]+(29700.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(29700.0*BmagInv[1]*geoZ[1]+11550.0*BmagInv[0]*geoZ[0])*Apar[2])*Bmag[4]+((13282.24378634875*Bmag[1]*BmagInv[1]+36157.21919617159*BmagInv[0])*geoZ[1]+geoZ[0]*(36157.21919617159*BmagInv[1]+5165.317028024514*BmagInv[0]*Bmag[1]))*Apar[3]+((46487.85325222062*BmagInv[1]+5165.317028024514*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(5165.317028024514*Bmag[1]*BmagInv[1]+25826.58514012257*BmagInv[0]))*Apar[2])*Phi[6]+(((33000.00000000001*Phi[2]*Bmag[4]+14758.04865149861*Bmag[1]*Phi[3]-40584.63379162118*Phi[2])*BmagInv[4]+(49808.4141988078*BmagInv[1]*Phi[3]+20292.31689581059*BmagInv[0]*Phi[2])*Bmag[4]+(9075.000000000002*BmagInv[0]*Bmag[1]-41250.00000000001*BmagInv[1])*Phi[3]+(9075.000000000002*Bmag[1]*BmagInv[1]-23100.0*BmagInv[0])*Phi[2])*geoZ[4]+((49808.4141988078*geoZ[1]*Phi[3]+20292.31689581059*geoZ[0]*Phi[2])*Bmag[4]+(9075.000000000002*geoZ[0]*Bmag[1]-41250.00000000001*geoZ[1])*Phi[3]+(9075.000000000002*Bmag[1]*geoZ[1]-23100.0*geoZ[0])*Phi[2])*BmagInv[4]+(29700.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+(29700.0*BmagInv[1]*geoZ[1]+11550.0*BmagInv[0]*geoZ[0])*Phi[2])*Bmag[4]+((13282.24378634875*Bmag[1]*BmagInv[1]-36157.21919617159*BmagInv[0])*geoZ[1]+geoZ[0]*(5165.317028024514*BmagInv[0]*Bmag[1]-36157.21919617159*BmagInv[1]))*Phi[3]+((5165.317028024514*BmagInv[0]*Bmag[1]-46487.85325222062*BmagInv[1])*geoZ[1]+geoZ[0]*(5165.317028024514*Bmag[1]*BmagInv[1]-25826.58514012257*BmagInv[0]))*Phi[2])*Apar[6]+(((Bmag[4]*(40584.63379162119*BmagInv[4]+23100.0*BmagInv[0])+10330.63405604903*Bmag[1]*BmagInv[1])*geoZ[4]+(23100.0*geoZ[0]*Bmag[4]+10330.63405604903*Bmag[1]*geoZ[1])*BmagInv[4]+(46487.85325222064*BmagInv[1]*geoZ[1]+25826.58514012258*BmagInv[0]*geoZ[0])*Bmag[4]+11550.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[5]+(((73790.24325749307*Apar[4]+45375.0*Apar[0])*Bmag[4]-90750.0*Apar[4]+20292.3168958106*Apar[1]*Bmag[1])*BmagInv[4]+(45375.0*BmagInv[0]*Apar[4]+66411.21893174377*Apar[1]*BmagInv[1]+25826.58514012258*Apar[0]*BmagInv[0])*Bmag[4]+(20292.3168958106*Bmag[1]*BmagInv[1]-51653.17028024515*BmagInv[0])*Apar[4]+(11550.0*Apar[0]*Bmag[1]-23100.0*Apar[1])*BmagInv[1]+11550.0*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[4]+((45375.0*geoZ[0]*Apar[4]+66411.21893174377*Apar[1]*geoZ[1]+25826.58514012258*Apar[0]*geoZ[0])*Bmag[4]+(20292.3168958106*Bmag[1]*geoZ[1]-51653.17028024515*geoZ[0])*Apar[4]+(11550.0*Apar[0]*Bmag[1]-23100.0*Apar[1])*geoZ[1]+11550.0*geoZ[0]*Apar[1]*Bmag[1])*BmagInv[4]+((66411.21893174377*BmagInv[1]*geoZ[1]+25826.58514012258*BmagInv[0]*geoZ[0])*Apar[4]+51975.0*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*geoZ[1]+geoZ[0]*(51975.0*Apar[1]*BmagInv[1]+28875.0*Apar[0]*BmagInv[0]))*Bmag[4]+((11550.0*BmagInv[0]*Bmag[1]-103950.0*BmagInv[1])*geoZ[1]+geoZ[0]*(11550.0*Bmag[1]*BmagInv[1]-57750.0*BmagInv[0]))*Apar[4]+(23243.92662611032*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(12913.29257006129*Apar[0]*Bmag[1]-25826.58514012258*Apar[1]))*geoZ[1]+geoZ[0]*((12913.29257006129*Apar[0]*Bmag[1]-25826.58514012258*Apar[1])*BmagInv[1]+12913.29257006129*BmagInv[0]*Apar[1]*Bmag[1]))*Phi[5]+(((90750.0*BmagInv[4]+51653.17028024515*BmagInv[0])*Phi[4]+23100.0*BmagInv[1]*Phi[1])*geoZ[4]+(51653.17028024515*geoZ[0]*BmagInv[4]+103950.0*BmagInv[1]*geoZ[1]+57750.0*BmagInv[0]*geoZ[0])*Phi[4]+Phi[1]*(23100.0*geoZ[1]*BmagInv[4]+25826.58514012258*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])))*Apar[5]+(((49808.41419880783*Apar[3]*Phi[3]+20292.3168958106*Apar[2]*Phi[2])*Bmag[4]+9075.0*Bmag[1]*(Apar[2]*Phi[3]+Phi[2]*Apar[3]))*BmagInv[4]+(29700.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Phi[3]+Phi[2]*(29700.0*BmagInv[1]*Apar[3]+11550.0*BmagInv[0]*Apar[2]))*Bmag[4]+(13282.24378634875*Bmag[1]*BmagInv[1]*Apar[3]+(10330.63405604903*BmagInv[1]+5165.317028024515*BmagInv[0]*Bmag[1])*Apar[2])*Phi[3]+Phi[2]*((5165.317028024515*BmagInv[0]*Bmag[1]-10330.63405604903*BmagInv[1])*Apar[3]+5165.317028024515*Bmag[1]*BmagInv[1]*Apar[2]))*geoZ[4]+((29700.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Phi[3]+Phi[2]*(29700.0*geoZ[1]*Apar[3]+11550.0*geoZ[0]*Apar[2]))*Bmag[4]+(13282.24378634875*Bmag[1]*geoZ[1]*Apar[3]+(10330.63405604903*geoZ[1]+5165.317028024515*geoZ[0]*Bmag[1])*Apar[2])*Phi[3]+Phi[2]*((5165.317028024515*geoZ[0]*Bmag[1]-10330.63405604903*geoZ[1])*Apar[3]+5165.317028024515*Bmag[1]*geoZ[1]*Apar[2]))*BmagInv[4]+(((49808.41419880783*BmagInv[1]*geoZ[1]+23243.92662611032*BmagInv[0]*geoZ[0])*Apar[3]+23243.92662611032*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Phi[3]+Phi[2]*(23243.92662611032*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(23243.92662611032*BmagInv[1]*geoZ[1]+12913.29257006129*BmagInv[0]*geoZ[0])*Apar[2]))*Bmag[4]+(10395.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+((10395.0*Bmag[1]*BmagInv[1]+11550.0*BmagInv[0])*geoZ[1]+geoZ[0]*(11550.0*BmagInv[1]+5775.0*BmagInv[0]*Bmag[1]))*Apar[2])*Phi[3]+Phi[2]*(((10395.0*Bmag[1]*BmagInv[1]-11550.0*BmagInv[0])*geoZ[1]+geoZ[0]*(5775.0*BmagInv[0]*Bmag[1]-11550.0*BmagInv[1]))*Apar[3]+5775.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]))*dfac_x*dfac_y+30800.0*dApardt[3])*q_)+((((-40584.63379162118*Bmag[1]*BmagInv[4])-132822.4378634875*BmagInv[1]*Bmag[4]-23100.0*BmagInv[0]*Bmag[1])*geoZ[4]+((-132822.4378634875*geoZ[1]*Bmag[4])-23100.0*geoZ[0]*Bmag[1])*BmagInv[4]-103950.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*((-46487.85325222062*BmagInv[1]*geoZ[1])-25826.58514012257*BmagInv[0]*geoZ[0]))*Phi[7]+((Bmag[4]*((-90750.0*BmagInv[4])-51653.17028024515*BmagInv[0])-23100.0*Bmag[1]*BmagInv[1])*geoZ[4]+((-51653.17028024515*geoZ[0]*Bmag[4])-23100.0*Bmag[1]*geoZ[1])*BmagInv[4]+((-103950.0*BmagInv[1]*geoZ[1])-57750.0*BmagInv[0]*geoZ[0])*Bmag[4]-25826.58514012258*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[5])*dfac_x*dfac_y*m_))/(dfac_v*m_); 
  alpha[5] = -(0.005050762722761052*(((Bmag[4]*(346.4101615137756*BmagInv[4]+213.0140840414079*BmagInv[0])+95.26279441628826*Bmag[1]*BmagInv[1])*geoZ[4]+(213.0140840414079*geoZ[0]*Bmag[4]+95.26279441628826*Bmag[1]*geoZ[1])*BmagInv[4]+(311.7691453623979*BmagInv[1]*geoZ[1]+121.2435565298214*BmagInv[0]*geoZ[0])*Bmag[4]+54.22176684690384*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[6]+((213.014084041408*Apar[2]*Bmag[4]+95.26279441628824*Bmag[1]*Apar[3])*BmagInv[4]+(311.7691453623978*BmagInv[1]*Apar[3]+121.2435565298214*BmagInv[0]*Apar[2])*Bmag[4]+54.22176684690384*Bmag[1]*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*geoZ[4]+((311.7691453623978*geoZ[1]*Apar[3]+121.2435565298214*geoZ[0]*Apar[2])*Bmag[4]+54.22176684690384*Bmag[1]*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2]))*BmagInv[4]+(243.9979508110672*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(243.9979508110672*BmagInv[1]*geoZ[1]+135.5544171172596*BmagInv[0]*geoZ[0])*Apar[2])*Bmag[4]+Bmag[1]*((109.1192008768392*BmagInv[1]*geoZ[1]+60.6217782649107*BmagInv[0]*geoZ[0])*Apar[3]+60.6217782649107*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]))*dfac_x*dfac_y)/(dfac_m*m_); 
  alpha[6] = -(0.005050762722761052*(((Bmag[4]*(476.3139720814414*BmagInv[4]+271.1088342345192*BmagInv[0])+121.2435565298214*Bmag[1]*BmagInv[1])*geoZ[4]+(271.1088342345192*geoZ[0]*Bmag[4]+121.2435565298214*Bmag[1]*geoZ[1])*BmagInv[4]+(545.5960043841964*BmagInv[1]*geoZ[1]+303.1088913245536*BmagInv[0]*geoZ[0])*Bmag[4]+135.5544171172596*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[7]+((135.5544171172596*Bmag[1]*BmagInv[4]+271.1088342345192*BmagInv[1]*Bmag[4])*geoZ[4]+Bmag[4]*(271.1088342345192*geoZ[1]*BmagInv[4]+303.1088913245535*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))+135.5544171172596*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0]))*Apar[5])*dfac_x*dfac_y)/(dfac_m*m_); 
  alpha[7] = -(2.29580123761866e-4*(dfac_v*(dfac_x*dfac_y*((((4950.000000000001*Bmag[1]*BmagInv[4]+13200.0*BmagInv[1]*Bmag[4]+1475.804865149861*BmagInv[0]*Bmag[1])*geoZ[4]+(13200.0*geoZ[1]*Bmag[4]+1475.804865149861*geoZ[0]*Bmag[1])*BmagInv[4]+8116.926758324235*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*(3630.0*BmagInv[1]*geoZ[1]+2310.0*BmagInv[0]*geoZ[0]))*Phi[6]+((13200.0*Phi[3]*Bmag[4]+1475.804865149862*Bmag[1]*Phi[2])*BmagInv[4]+8116.926758324238*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Bmag[4]+Bmag[1]*(3630.0*BmagInv[1]*Phi[3]+2310.0*BmagInv[0]*Phi[2]))*geoZ[4]+(8116.926758324238*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Bmag[4]+Bmag[1]*(3630.0*geoZ[1]*Phi[3]+2310.0*geoZ[0]*Phi[2]))*BmagInv[4]+((11880.0*BmagInv[1]*geoZ[1]+4620.0*BmagInv[0]*geoZ[0])*Phi[3]+4620.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Bmag[4]+2066.126811209806*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+BmagInv[1]*geoZ[1]*Phi[2]))*m_*wv+(((4950.000000000001*Bmag[1]*BmagInv[4]+13200.0*BmagInv[1]*Bmag[4]+1475.804865149861*BmagInv[0]*Bmag[1])*geoZ[4]+(13200.0*geoZ[1]*Bmag[4]+1475.804865149861*geoZ[0]*Bmag[1])*BmagInv[4]+8116.926758324235*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*(3630.0*BmagInv[1]*geoZ[1]+2310.0*BmagInv[0]*geoZ[0]))*Apar[6]+((13200.0*Apar[3]*Bmag[4]+1475.804865149862*Bmag[1]*Apar[2])*BmagInv[4]+8116.926758324238*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+Bmag[1]*(3630.0*BmagInv[1]*Apar[3]+2310.0*BmagInv[0]*Apar[2]))*geoZ[4]+(8116.926758324238*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+Bmag[1]*(3630.0*geoZ[1]*Apar[3]+2310.0*geoZ[0]*Apar[2]))*BmagInv[4]+((11880.0*BmagInv[1]*geoZ[1]+4620.0*BmagInv[0]*geoZ[0])*Apar[3]+4620.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+2066.126811209806*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+BmagInv[1]*geoZ[1]*Apar[2]))*wm)+((((((27375.0*Bmag[4]-29516.09730299723)*BmagInv[4]+14758.04865149862*BmagInv[0]*Bmag[4]+6600.0*Bmag[1]*BmagInv[1]-18150.0*BmagInv[0])*geoZ[4]+(14758.04865149862*geoZ[0]*Bmag[4]+6600.0*Bmag[1]*geoZ[1]-18150.0*geoZ[0])*BmagInv[4]+(22275.0*BmagInv[1]*geoZ[1]+9075.0*BmagInv[0]*geoZ[0])*Bmag[4]+(4058.463379162119*BmagInv[0]*Bmag[1]-26564.48757269751*BmagInv[1])*geoZ[1]+geoZ[0]*(4058.463379162119*Bmag[1]*BmagInv[1]-10330.63405604903*BmagInv[0]))*Apar[6]+((14758.04865149861*Apar[2]*Bmag[4]+6600.000000000001*Bmag[1]*Apar[3])*BmagInv[4]+(22275.0*BmagInv[1]*Apar[3]+9075.000000000002*BmagInv[0]*Apar[2])*Bmag[4]+(4058.463379162118*BmagInv[0]*Bmag[1]-8116.926758324235*BmagInv[1])*Apar[3]+4058.463379162118*Bmag[1]*BmagInv[1]*Apar[2])*geoZ[4]+((22275.0*geoZ[1]*Apar[3]+9075.000000000002*geoZ[0]*Apar[2])*Bmag[4]+(4058.463379162118*geoZ[0]*Bmag[1]-8116.926758324235*geoZ[1])*Apar[3]+4058.463379162118*Bmag[1]*geoZ[1]*Apar[2])*BmagInv[4]+(13282.24378634875*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(13282.24378634875*BmagInv[1]*geoZ[1]+5165.317028024514*BmagInv[0]*geoZ[0])*Apar[2])*Bmag[4]+((5939.999999999999*Bmag[1]*BmagInv[1]-4620.0*BmagInv[0])*geoZ[1]+geoZ[0]*(2310.0*BmagInv[0]*Bmag[1]-4620.0*BmagInv[1]))*Apar[3]+2310.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Phi[7]+(((29516.09730299723*BmagInv[4]+18150.0*BmagInv[0])*geoZ[4]+18150.0*geoZ[0]*BmagInv[4]+26564.48757269751*BmagInv[1]*geoZ[1]+10330.63405604903*BmagInv[0]*geoZ[0])*Phi[6]+Phi[3]*(8116.926758324235*(BmagInv[1]*geoZ[4]+geoZ[1]*BmagInv[4])+4620.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])))*Apar[7]+((18150.0*(BmagInv[1]*geoZ[4]+geoZ[1]*BmagInv[4])+10330.63405604903*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[5]+((12242.47217681135*Apar[1]*Bmag[4]+Bmag[1]*(3354.101966249685*Apar[4]+2475.0*Apar[0])-4950.000000000001*Apar[1])*BmagInv[4]+(12242.47217681135*BmagInv[1]*Apar[4]+6600.000000000001*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+(2475.0*BmagInv[0]*Bmag[1]-13200.0*BmagInv[1])*Apar[4]+2951.609730299722*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(737.9024325749306*Apar[0]*Bmag[1]-1475.804865149861*Apar[1]))*geoZ[4]+((12242.47217681135*geoZ[1]*Apar[4]+6600.000000000001*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1]))*Bmag[4]+(2475.0*geoZ[0]*Bmag[1]-13200.0*geoZ[1])*Apar[4]+2951.609730299722*Apar[1]*Bmag[1]*geoZ[1]+geoZ[0]*(737.9024325749306*Apar[0]*Bmag[1]-1475.804865149861*Apar[1]))*BmagInv[4]+(6600.000000000001*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+(9961.682839761559*Apar[1]*BmagInv[1]+4058.463379162118*Apar[0]*BmagInv[0])*geoZ[1]+4058.463379162118*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+((2951.609730299722*Bmag[1]*BmagInv[1]-8116.926758324235*BmagInv[0])*geoZ[1]+geoZ[0]*(737.9024325749306*BmagInv[0]*Bmag[1]-8116.926758324235*BmagInv[1]))*Apar[4]+((1815.0*Apar[0]*Bmag[1]-3630.0*Apar[1])*BmagInv[1]+1815.0*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+geoZ[0]*(1815.0*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(1155.0*Apar[0]*Bmag[1]-2310.0*Apar[1])))*Phi[6]+(((5534.268244311978*Bmag[1]*BmagInv[4]+BmagInv[1]*(14758.04865149861*Bmag[4]-18150.0)+1650.0*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(14758.04865149861*Bmag[4]-18150.0)+1650.0*geoZ[0]*Bmag[1])*BmagInv[4]+9075.000000000002*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(4058.463379162118*Bmag[1]*BmagInv[1]-10330.63405604903*BmagInv[0])*geoZ[1]+geoZ[0]*(2582.658514012257*BmagInv[0]*Bmag[1]-10330.63405604903*BmagInv[1]))*Phi[5]+(13200.0*BmagInv[1]*Phi[4]+Phi[1]*(4950.000000000001*BmagInv[4]+1475.804865149861*BmagInv[0]))*geoZ[4]+(13200.0*geoZ[1]*BmagInv[4]+8116.926758324235*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[4]+Phi[1]*(1475.804865149861*geoZ[0]*BmagInv[4]+3630.0*BmagInv[1]*geoZ[1]+2310.0*BmagInv[0]*geoZ[0]))*Apar[6]+(((Apar[3]*(14758.04865149862*Bmag[4]-3300.0)+1650.0*Bmag[1]*Apar[2])*BmagInv[4]+9075.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+(4058.463379162119*Bmag[1]*BmagInv[1]-5165.317028024515*BmagInv[0])*Apar[3]+2582.658514012257*BmagInv[0]*Bmag[1]*Apar[2])*geoZ[4]+(9075.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+(4058.463379162119*Bmag[1]*geoZ[1]-5165.317028024515*geoZ[0])*Apar[3]+2582.658514012257*geoZ[0]*Bmag[1]*Apar[2])*BmagInv[4]+((13282.24378634875*BmagInv[1]*geoZ[1]+5165.317028024515*BmagInv[0]*geoZ[0])*Apar[3]+5165.317028024515*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+((2310.0*BmagInv[0]*Bmag[1]-4620.0*BmagInv[1])*geoZ[1]+2310.0*geoZ[0]*Bmag[1]*BmagInv[1])*Apar[3]+2310.0*Bmag[1]*BmagInv[1]*geoZ[1]*Apar[2])*Phi[5]+Phi[3]*((3300.0*BmagInv[4]+5165.317028024515*BmagInv[0])*geoZ[4]+5165.317028024515*geoZ[0]*BmagInv[4]+4620.0*BmagInv[1]*geoZ[1])*Apar[5]+((13200.0*Apar[3]*BmagInv[4]+8116.926758324238*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*Phi[4]+((12242.47217681135*Phi[3]*Apar[4]+6600.0*(Apar[0]*Phi[3]+Apar[1]*Phi[2]))*Bmag[4]+(2475.0*Bmag[1]*Phi[2]-13200.0*Phi[3])*Apar[4]+2951.609730299723*Apar[1]*Bmag[1]*Phi[3]+(737.9024325749308*Apar[0]*Bmag[1]-1475.804865149862*Apar[1])*Phi[2]+1475.804865149862*Phi[1]*Apar[2])*BmagInv[4]+(6600.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[4]+(9961.682839761565*Apar[1]*BmagInv[1]+4058.463379162119*Apar[0]*BmagInv[0])*Phi[3]+4058.463379162119*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*Phi[2])*Bmag[4]+((2951.609730299723*Bmag[1]*BmagInv[1]-8116.926758324238*BmagInv[0])*Phi[3]+(737.9024325749308*BmagInv[0]*Bmag[1]-8116.926758324238*BmagInv[1])*Phi[2])*Apar[4]+((1815.0*Apar[0]*Bmag[1]-3630.0*Apar[1])*BmagInv[1]+1815.0*BmagInv[0]*Apar[1]*Bmag[1])*Phi[3]+3630.0*BmagInv[1]*Phi[1]*Apar[3]+(1815.0*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(1155.0*Apar[0]*Bmag[1]-2310.0*Apar[1]))*Phi[2]+2310.0*BmagInv[0]*Phi[1]*Apar[2])*geoZ[4]+(8116.926758324238*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*BmagInv[4]+(11880.0*BmagInv[1]*geoZ[1]+4620.0*BmagInv[0]*geoZ[0])*Apar[3]+4620.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Phi[4]+((6600.0*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Apar[4]+(9961.682839761565*Apar[1]*geoZ[1]+4058.463379162119*Apar[0]*geoZ[0])*Phi[3]+4058.463379162119*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1])*Phi[2])*Bmag[4]+((2951.609730299723*Bmag[1]*geoZ[1]-8116.926758324238*geoZ[0])*Phi[3]+(737.9024325749308*geoZ[0]*Bmag[1]-8116.926758324238*geoZ[1])*Phi[2])*Apar[4]+((1815.0*Apar[0]*Bmag[1]-3630.0*Apar[1])*geoZ[1]+1815.0*geoZ[0]*Apar[1]*Bmag[1])*Phi[3]+3630.0*Phi[1]*geoZ[1]*Apar[3]+(1815.0*Apar[1]*Bmag[1]*geoZ[1]+geoZ[0]*(1155.0*Apar[0]*Bmag[1]-2310.0*Apar[1]))*Phi[2]+2310.0*geoZ[0]*Phi[1]*Apar[2])*BmagInv[4]+(((9961.682839761565*BmagInv[1]*geoZ[1]+4058.463379162119*BmagInv[0]*geoZ[0])*Phi[3]+4058.463379162119*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Apar[4]+(5940.0*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*geoZ[1]+geoZ[0]*(5940.0*Apar[1]*BmagInv[1]+2310.0*Apar[0]*BmagInv[0]))*Phi[3]+((5940.0*Apar[1]*BmagInv[1]+2310.0*Apar[0]*BmagInv[0])*geoZ[1]+2310.0*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Phi[2])*Bmag[4]+(((1815.0*BmagInv[0]*Bmag[1]-11880.0*BmagInv[1])*geoZ[1]+geoZ[0]*(1815.0*Bmag[1]*BmagInv[1]-4620.0*BmagInv[0]))*Phi[3]+((1815.0*Bmag[1]*BmagInv[1]-4620.0*BmagInv[0])*geoZ[1]+geoZ[0]*(1155.0*BmagInv[0]*Bmag[1]-4620.0*BmagInv[1]))*Phi[2])*Apar[4]+((2656.44875726975*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(1033.063405604903*Apar[0]*Bmag[1]-2066.126811209806*Apar[1]))*geoZ[1]+geoZ[0]*((1033.063405604903*Apar[0]*Bmag[1]-2066.126811209806*Apar[1])*BmagInv[1]+1033.063405604903*BmagInv[0]*Apar[1]*Bmag[1]))*Phi[3]+2066.126811209806*Phi[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(((1033.063405604903*Apar[0]*Bmag[1]-2066.126811209806*Apar[1])*BmagInv[1]+1033.063405604903*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+1033.063405604903*geoZ[0]*Apar[1]*Bmag[1]*BmagInv[1])*Phi[2]+2066.126811209806*BmagInv[1]*Phi[1]*geoZ[1]*Apar[2])*dfac_x*dfac_y+6160.0*dApardt[4])*q_)+((((-4950.000000000001*Bmag[1]*BmagInv[4])-13200.0*BmagInv[1]*Bmag[4]-1475.804865149861*BmagInv[0]*Bmag[1])*geoZ[4]+((-13200.0*geoZ[1]*Bmag[4])-1475.804865149861*geoZ[0]*Bmag[1])*BmagInv[4]-8116.926758324235*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*((-3630.0*BmagInv[1]*geoZ[1])-2310.0*BmagInv[0]*geoZ[0]))*Phi[6]+(((-13200.0*Phi[3]*Bmag[4])-1475.804865149862*Bmag[1]*Phi[2])*BmagInv[4]-8116.926758324238*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Bmag[4]+Bmag[1]*((-3630.0*BmagInv[1]*Phi[3])-2310.0*BmagInv[0]*Phi[2]))*geoZ[4]+(Bmag[1]*((-3630.0*geoZ[1]*Phi[3])-2310.0*geoZ[0]*Phi[2])-8116.926758324238*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Bmag[4])*BmagInv[4]+(((-11880.0*BmagInv[1]*geoZ[1])-4620.0*BmagInv[0]*geoZ[0])*Phi[3]-4620.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Bmag[4]-2066.126811209806*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+BmagInv[1]*geoZ[1]*Phi[2]))*dfac_x*dfac_y*m_))/(dfac_v*m_); 
  alpha[8] = -(0.001129384878631563*((((((2683.281572999748*Bmag[4]-3000.0)*BmagInv[4]+1650.0*BmagInv[0]*Bmag[4]+737.9024325749308*Bmag[1]*BmagInv[1]-1408.722825824868*BmagInv[0])*geoZ[4]+(1650.0*geoZ[0]*Bmag[4]+737.9024325749308*Bmag[1]*geoZ[1]-1408.722825824868*geoZ[0])*BmagInv[4]+(2414.953415699773*BmagInv[1]*geoZ[1]+939.1485505499119*BmagInv[0]*geoZ[0])*Bmag[4]+(420.0*BmagInv[0]*Bmag[1]-3360.0*BmagInv[1])*geoZ[1]+geoZ[0]*(420.0*Bmag[1]*BmagInv[1]-2100.0*BmagInv[0]))*Apar[6]+((1650.0*Apar[2]*Bmag[4]+737.9024325749306*Bmag[1]*Apar[3]+469.5742752749558*Apar[2])*BmagInv[4]+(2414.953415699772*BmagInv[1]*Apar[3]+939.1485505499116*BmagInv[0]*Apar[2])*Bmag[4]+(420.0000000000001*BmagInv[0]*Bmag[1]-420.0000000000001*BmagInv[1])*Apar[3]+420.0000000000001*Bmag[1]*BmagInv[1]*Apar[2])*geoZ[4]+((2414.953415699772*geoZ[1]*Apar[3]+939.1485505499116*geoZ[0]*Apar[2])*Bmag[4]+(420.0000000000001*geoZ[0]*Bmag[1]-420.0000000000001*geoZ[1])*Apar[3]+420.0000000000001*Bmag[1]*geoZ[1]*Apar[2])*BmagInv[4]+(1890.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(1890.0*BmagInv[1]*geoZ[1]+1050.0*BmagInv[0]*geoZ[0])*Apar[2])*Bmag[4]+((845.2336954949202*Bmag[1]*BmagInv[1]-469.5742752749558*BmagInv[0])*geoZ[1]+geoZ[0]*(469.5742752749558*BmagInv[0]*Bmag[1]-469.5742752749558*BmagInv[1]))*Apar[3]+469.5742752749558*((BmagInv[1]+BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(Bmag[1]*BmagInv[1]+BmagInv[0]))*Apar[2])*Phi[7]+((((1341.640786499874*Bmag[4]+3000.0)*BmagInv[4]+825.0*BmagInv[0]*Bmag[4]+368.9512162874654*Bmag[1]*BmagInv[1]+1408.722825824868*BmagInv[0])*geoZ[4]+(825.0*geoZ[0]*Bmag[4]+368.9512162874654*Bmag[1]*geoZ[1]+1408.722825824868*geoZ[0])*BmagInv[4]+(1207.476707849887*BmagInv[1]*geoZ[1]+469.5742752749559*BmagInv[0]*geoZ[0])*Bmag[4]+(3360.0*BmagInv[1]+210.0*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(210.0*Bmag[1]*BmagInv[1]+2100.0*BmagInv[0]))*Phi[6]+((825.0000000000001*Phi[2]*Bmag[4]+368.9512162874653*Bmag[1]*Phi[3]-469.5742752749558*Phi[2])*BmagInv[4]+(1207.476707849886*BmagInv[1]*Phi[3]+469.5742752749558*BmagInv[0]*Phi[2])*Bmag[4]+(420.0000000000001*BmagInv[1]+210.0*BmagInv[0]*Bmag[1])*Phi[3]+210.0*Bmag[1]*BmagInv[1]*Phi[2])*geoZ[4]+((1207.476707849886*geoZ[1]*Phi[3]+469.5742752749558*geoZ[0]*Phi[2])*Bmag[4]+(420.0000000000001*geoZ[1]+210.0*geoZ[0]*Bmag[1])*Phi[3]+210.0*Bmag[1]*geoZ[1]*Phi[2])*BmagInv[4]+(944.9999999999998*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+(944.9999999999998*BmagInv[1]*geoZ[1]+525.0000000000001*BmagInv[0]*geoZ[0])*Phi[2])*Bmag[4]+((422.6168477474601*Bmag[1]*BmagInv[1]+469.5742752749558*BmagInv[0])*geoZ[1]+geoZ[0]*(469.5742752749558*BmagInv[1]+234.7871376374779*BmagInv[0]*Bmag[1]))*Phi[3]+((234.7871376374779*BmagInv[0]*Bmag[1]-469.5742752749558*BmagInv[1])*geoZ[1]+geoZ[0]*(234.7871376374779*Bmag[1]*BmagInv[1]-469.5742752749558*BmagInv[0]))*Phi[2])*Apar[7]+((150.0*Bmag[1]*BmagInv[4]+BmagInv[1]*(825.0000000000001*Bmag[4]+1878.297101099823)+234.7871376374779*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(825.0000000000001*Bmag[4]+1878.297101099823)+234.7871376374779*geoZ[0]*Bmag[1])*BmagInv[4]+469.5742752749558*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(210.0*Bmag[1]*BmagInv[1]+2100.0*BmagInv[0])*geoZ[1]+2100.0*geoZ[0]*BmagInv[1])*Apar[5]*Phi[6]+Phi[5]*(((300.0000000000001*Bmag[1]*BmagInv[4]+BmagInv[1]*(1650.0*Bmag[4]-1878.297101099823)+469.5742752749558*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(1650.0*Bmag[4]-1878.297101099823)+469.5742752749558*geoZ[0]*Bmag[1])*BmagInv[4]+939.1485505499116*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(420.0000000000001*Bmag[1]*BmagInv[1]-2100.0*BmagInv[0])*geoZ[1]-2100.0*geoZ[0]*BmagInv[1])*Apar[6]+((Apar[3]*(1650.0*Bmag[4]-939.1485505499119)+469.5742752749559*Bmag[1]*Apar[2])*BmagInv[4]+939.1485505499119*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+420.0*Bmag[1]*BmagInv[1]*Apar[3])*geoZ[4]+(939.1485505499119*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+420.0*Bmag[1]*geoZ[1]*Apar[3])*BmagInv[4]+((1890.0*BmagInv[1]*geoZ[1]+1050.0*BmagInv[0]*geoZ[0])*Apar[3]+1050.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+((469.5742752749559*BmagInv[0]*Bmag[1]-939.1485505499119*BmagInv[1])*geoZ[1]+geoZ[0]*(469.5742752749559*Bmag[1]*BmagInv[1]-939.1485505499119*BmagInv[0]))*Apar[3]+469.5742752749559*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Apar[2])+(((Phi[3]*(825.0*Bmag[4]+939.1485505499119)+234.787137637478*Bmag[1]*Phi[2])*BmagInv[4]+469.5742752749559*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Bmag[4]+210.0*Bmag[1]*BmagInv[1]*Phi[3])*geoZ[4]+(469.5742752749559*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Bmag[4]+210.0*Bmag[1]*geoZ[1]*Phi[3])*BmagInv[4]+((945.0*BmagInv[1]*geoZ[1]+525.0*BmagInv[0]*geoZ[0])*Phi[3]+525.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Bmag[4]+((939.1485505499119*BmagInv[1]+234.787137637478*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(234.787137637478*Bmag[1]*BmagInv[1]+939.1485505499119*BmagInv[0]))*Phi[3]+234.787137637478*Bmag[1]*(BmagInv[1]*geoZ[1]+BmagInv[0]*geoZ[0])*Phi[2])*Apar[5])*dfac_x*dfac_y+1252.198067399883*dApardt[5])*q_)/m_; 
  alpha[10] = -(0.005050762722761052*(((213.0140840414079*Bmag[1]*BmagInv[4]+697.1370023173351*BmagInv[1]*Bmag[4]+121.2435565298214*BmagInv[0]*Bmag[1])*geoZ[4]+(697.1370023173351*geoZ[1]*Bmag[4]+121.2435565298214*geoZ[0]*Bmag[1])*BmagInv[4]+545.5960043841964*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*(243.9979508110673*BmagInv[1]*geoZ[1]+135.5544171172596*BmagInv[0]*geoZ[0]))*Apar[7]+((Bmag[4]*(476.3139720814412*BmagInv[4]+271.1088342345192*BmagInv[0])+121.2435565298214*Bmag[1]*BmagInv[1])*geoZ[4]+(271.1088342345192*geoZ[0]*Bmag[4]+121.2435565298214*Bmag[1]*geoZ[1])*BmagInv[4]+(545.5960043841961*BmagInv[1]*geoZ[1]+303.1088913245535*BmagInv[0]*geoZ[0])*Bmag[4]+135.5544171172596*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[5])*dfac_x*dfac_y)/(dfac_m*m_); 
  alpha[11] = -(2.29580123761866e-4*(dfac_v*(dfac_x*dfac_y*((((Bmag[4]*(29516.09730299723*BmagInv[4]+18150.0*BmagInv[0])+8116.926758324238*Bmag[1]*BmagInv[1])*geoZ[4]+(18150.0*geoZ[0]*Bmag[4]+8116.926758324238*Bmag[1]*geoZ[1])*BmagInv[4]+(26564.48757269751*BmagInv[1]*geoZ[1]+10330.63405604903*BmagInv[0]*geoZ[0])*Bmag[4]+4620.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[7]+((3300.0*Bmag[1]*BmagInv[4]+18150.0*BmagInv[1]*Bmag[4]+5165.317028024514*BmagInv[0]*Bmag[1])*geoZ[4]+(18150.0*geoZ[1]*Bmag[4]+5165.317028024514*geoZ[0]*Bmag[1])*BmagInv[4]+10330.63405604903*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+4620.0*Bmag[1]*BmagInv[1]*geoZ[1])*Phi[5])*m_*wv+(((Bmag[4]*(29516.09730299723*BmagInv[4]+18150.0*BmagInv[0])+8116.926758324238*Bmag[1]*BmagInv[1])*geoZ[4]+(18150.0*geoZ[0]*Bmag[4]+8116.926758324238*Bmag[1]*geoZ[1])*BmagInv[4]+(26564.48757269751*BmagInv[1]*geoZ[1]+10330.63405604903*BmagInv[0]*geoZ[0])*Bmag[4]+4620.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[7]+((3300.0*Bmag[1]*BmagInv[4]+18150.0*BmagInv[1]*Bmag[4]+5165.317028024514*BmagInv[0]*Bmag[1])*geoZ[4]+(18150.0*geoZ[1]*Bmag[4]+5165.317028024514*geoZ[0]*Bmag[1])*BmagInv[4]+10330.63405604903*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+4620.0*Bmag[1]*BmagInv[1]*geoZ[1])*Apar[5])*wm)+(((((5903.219460599445*Bmag[1]*BmagInv[4]+19923.36567952312*BmagInv[1]*Bmag[4]+3630.0*BmagInv[0]*Bmag[1])*geoZ[4]+(19923.36567952312*geoZ[1]*Bmag[4]+3630.0*geoZ[0]*Bmag[1])*BmagInv[4]+11880.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*(5312.897514539499*BmagInv[1]*geoZ[1]+2066.126811209806*BmagInv[0]*geoZ[0]))*Apar[7]+(((13200.0*Bmag[4]+2951.609730299723)*BmagInv[4]+8116.926758324238*BmagInv[0]*Bmag[4]+3630.0*Bmag[1]*BmagInv[1]+4620.0*BmagInv[0])*geoZ[4]+(8116.926758324238*geoZ[0]*Bmag[4]+3630.0*Bmag[1]*geoZ[1]+4620.0*geoZ[0])*BmagInv[4]+(11880.0*BmagInv[1]*geoZ[1]+4620.0*BmagInv[0]*geoZ[0])*Bmag[4]+(4132.253622419612*BmagInv[1]+2066.126811209806*BmagInv[0]*Bmag[1])*geoZ[1]+2066.126811209806*geoZ[0]*Bmag[1]*BmagInv[1])*Apar[5]+(((27375.0*Apar[4]+14758.04865149862*Apar[0])*Bmag[4]-29516.09730299723*Apar[4]+6600.0*Apar[1]*Bmag[1])*BmagInv[4]+(14758.04865149862*BmagInv[0]*Apar[4]+22275.0*Apar[1]*BmagInv[1]+9075.0*Apar[0]*BmagInv[0])*Bmag[4]+(6600.0*Bmag[1]*BmagInv[1]-18150.0*BmagInv[0])*Apar[4]+(4058.463379162119*Apar[0]*Bmag[1]-8116.926758324238*Apar[1])*BmagInv[1]+4058.463379162119*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[4]+((14758.04865149862*geoZ[0]*Apar[4]+22275.0*Apar[1]*geoZ[1]+9075.0*Apar[0]*geoZ[0])*Bmag[4]+(6600.0*Bmag[1]*geoZ[1]-18150.0*geoZ[0])*Apar[4]+(4058.463379162119*Apar[0]*Bmag[1]-8116.926758324238*Apar[1])*geoZ[1]+4058.463379162119*geoZ[0]*Apar[1]*Bmag[1])*BmagInv[4]+((22275.0*BmagInv[1]*geoZ[1]+9075.0*BmagInv[0]*geoZ[0])*Apar[4]+13282.24378634875*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1])*geoZ[1]+geoZ[0]*(13282.24378634875*Apar[1]*BmagInv[1]+5165.317028024515*Apar[0]*BmagInv[0]))*Bmag[4]+((4058.463379162119*BmagInv[0]*Bmag[1]-26564.48757269751*BmagInv[1])*geoZ[1]+geoZ[0]*(4058.463379162119*Bmag[1]*BmagInv[1]-10330.63405604903*BmagInv[0]))*Apar[4]+(5940.0*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(2310.0*Apar[0]*Bmag[1]-4620.0*Apar[1]))*geoZ[1]+geoZ[0]*((2310.0*Apar[0]*Bmag[1]-4620.0*Apar[1])*BmagInv[1]+2310.0*BmagInv[0]*Apar[1]*Bmag[1]))*Phi[7]+((((13200.0*Bmag[4]-2951.609730299723)*BmagInv[4]+8116.926758324238*BmagInv[0]*Bmag[4]+3630.0*Bmag[1]*BmagInv[1]-4620.0*BmagInv[0])*geoZ[4]+(8116.926758324238*geoZ[0]*Bmag[4]+3630.0*Bmag[1]*geoZ[1]-4620.0*geoZ[0])*BmagInv[4]+(11880.0*BmagInv[1]*geoZ[1]+4620.0*BmagInv[0]*geoZ[0])*Bmag[4]+(2066.126811209806*BmagInv[0]*Bmag[1]-4132.253622419612*BmagInv[1])*geoZ[1]+2066.126811209806*geoZ[0]*Bmag[1]*BmagInv[1])*Phi[5]+((29516.09730299723*BmagInv[4]+18150.0*BmagInv[0])*Phi[4]+8116.926758324238*BmagInv[1]*Phi[1])*geoZ[4]+(18150.0*geoZ[0]*BmagInv[4]+26564.48757269751*BmagInv[1]*geoZ[1]+10330.63405604903*BmagInv[0]*geoZ[0])*Phi[4]+Phi[1]*(8116.926758324238*geoZ[1]*BmagInv[4]+4620.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])))*Apar[7]+(((3354.101966249685*Bmag[1]*BmagInv[4]+12242.47217681135*BmagInv[1]*Bmag[4]+2475.0*BmagInv[0]*Bmag[1])*geoZ[4]+(12242.47217681135*geoZ[1]*Bmag[4]+2475.0*geoZ[0]*Bmag[1])*BmagInv[4]+6600.000000000001*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*(2951.609730299722*BmagInv[1]*geoZ[1]+737.9024325749306*BmagInv[0]*geoZ[0]))*Apar[6]+((Apar[3]*(12242.47217681135*Bmag[4]+8250.0)+2475.0*Bmag[1]*Apar[2])*BmagInv[4]+6600.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+(2951.609730299723*Bmag[1]*BmagInv[1]+6641.121893174377*BmagInv[0])*Apar[3]+(8116.926758324238*BmagInv[1]+737.9024325749308*BmagInv[0]*Bmag[1])*Apar[2])*geoZ[4]+(6600.0*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+(2951.609730299723*Bmag[1]*geoZ[1]+6641.121893174377*geoZ[0])*Apar[3]+(8116.926758324238*geoZ[1]+737.9024325749308*geoZ[0]*Bmag[1])*Apar[2])*BmagInv[4]+((9961.682839761565*BmagInv[1]*geoZ[1]+4058.463379162119*BmagInv[0]*geoZ[0])*Apar[3]+4058.463379162119*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+((8250.0*BmagInv[1]+1815.0*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(1815.0*Bmag[1]*BmagInv[1]+2310.0*BmagInv[0]))*Apar[3]+((1815.0*Bmag[1]*BmagInv[1]+4620.0*BmagInv[0])*geoZ[1]+geoZ[0]*(4620.0*BmagInv[1]+1155.0*BmagInv[0]*Bmag[1]))*Apar[2])*Phi[6]+(((Phi[3]*(12242.47217681135*Bmag[4]-8250.0)+2475.0*Bmag[1]*Phi[2])*BmagInv[4]+6600.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Bmag[4]+(2951.609730299723*Bmag[1]*BmagInv[1]-6641.121893174377*BmagInv[0])*Phi[3]+(737.9024325749308*BmagInv[0]*Bmag[1]-8116.926758324238*BmagInv[1])*Phi[2])*geoZ[4]+(6600.0*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Bmag[4]+(2951.609730299723*Bmag[1]*geoZ[1]-6641.121893174377*geoZ[0])*Phi[3]+(737.9024325749308*geoZ[0]*Bmag[1]-8116.926758324238*geoZ[1])*Phi[2])*BmagInv[4]+((9961.682839761565*BmagInv[1]*geoZ[1]+4058.463379162119*BmagInv[0]*geoZ[0])*Phi[3]+4058.463379162119*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Bmag[4]+((1815.0*BmagInv[0]*Bmag[1]-8250.0*BmagInv[1])*geoZ[1]+geoZ[0]*(1815.0*Bmag[1]*BmagInv[1]-2310.0*BmagInv[0]))*Phi[3]+((1815.0*Bmag[1]*BmagInv[1]-4620.0*BmagInv[0])*geoZ[1]+geoZ[0]*(1155.0*BmagInv[0]*Bmag[1]-4620.0*BmagInv[1]))*Phi[2])*Apar[6]+(((1475.804865149861*Bmag[1]*BmagInv[4]+8116.926758324235*BmagInv[1]*Bmag[4]+2310.0*BmagInv[0]*Bmag[1])*geoZ[4]+(8116.926758324235*geoZ[1]*Bmag[4]+2310.0*geoZ[0]*Bmag[1])*BmagInv[4]+4620.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+2066.126811209806*Bmag[1]*BmagInv[1]*geoZ[1])*Apar[5]+((14758.04865149861*Apar[1]*Bmag[4]+Bmag[1]*(5534.268244311978*Apar[4]+1650.0*Apar[0])-3300.0*Apar[1])*BmagInv[4]+(14758.04865149861*BmagInv[1]*Apar[4]+9075.000000000002*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+(1650.0*BmagInv[0]*Bmag[1]-18150.0*BmagInv[1])*Apar[4]+4058.463379162118*Apar[1]*Bmag[1]*BmagInv[1]+BmagInv[0]*(2582.658514012257*Apar[0]*Bmag[1]-5165.317028024514*Apar[1]))*geoZ[4]+((14758.04865149861*geoZ[1]*Apar[4]+9075.000000000002*(Apar[0]*geoZ[1]+geoZ[0]*Apar[1]))*Bmag[4]+(1650.0*geoZ[0]*Bmag[1]-18150.0*geoZ[1])*Apar[4]+4058.463379162118*Apar[1]*Bmag[1]*geoZ[1]+geoZ[0]*(2582.658514012257*Apar[0]*Bmag[1]-5165.317028024514*Apar[1]))*BmagInv[4]+(9075.000000000002*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[4]+(13282.24378634875*Apar[1]*BmagInv[1]+5165.317028024514*Apar[0]*BmagInv[0])*geoZ[1]+5165.317028024514*geoZ[0]*(Apar[0]*BmagInv[1]+BmagInv[0]*Apar[1]))*Bmag[4]+((4058.463379162118*Bmag[1]*BmagInv[1]-10330.63405604903*BmagInv[0])*geoZ[1]+geoZ[0]*(2582.658514012257*BmagInv[0]*Bmag[1]-10330.63405604903*BmagInv[1]))*Apar[4]+((2310.0*Apar[0]*Bmag[1]-4620.0*Apar[1])*BmagInv[1]+2310.0*BmagInv[0]*Apar[1]*Bmag[1])*geoZ[1]+2310.0*geoZ[0]*Apar[1]*Bmag[1]*BmagInv[1])*Phi[5]+((18150.0*BmagInv[1]*Phi[4]+Phi[1]*(3300.0*BmagInv[4]+5165.317028024514*BmagInv[0]))*geoZ[4]+(18150.0*geoZ[1]*BmagInv[4]+10330.63405604903*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[4]+Phi[1]*(5165.317028024514*geoZ[0]*BmagInv[4]+4620.0*BmagInv[1]*geoZ[1]))*Apar[5]+((6600.000000000001*(Apar[2]*Phi[3]+Phi[2]*Apar[3])*Bmag[4]+(2951.609730299722*Bmag[1]*Apar[3]+1475.804865149861*Apar[2])*Phi[3]+Phi[2]*(737.9024325749306*Bmag[1]*Apar[2]-1475.804865149861*Apar[3]))*BmagInv[4]+((9961.682839761559*BmagInv[1]*Apar[3]+4058.463379162118*BmagInv[0]*Apar[2])*Phi[3]+4058.463379162118*Phi[2]*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*Bmag[4]+(1815.0*BmagInv[0]*Bmag[1]*Apar[3]+(1815.0*Bmag[1]*BmagInv[1]+2310.0*BmagInv[0])*Apar[2])*Phi[3]+Phi[2]*((1815.0*Bmag[1]*BmagInv[1]-2310.0*BmagInv[0])*Apar[3]+1155.0*BmagInv[0]*Bmag[1]*Apar[2]))*geoZ[4]+(((9961.682839761559*geoZ[1]*Apar[3]+4058.463379162118*geoZ[0]*Apar[2])*Phi[3]+4058.463379162118*Phi[2]*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2]))*Bmag[4]+(1815.0*geoZ[0]*Bmag[1]*Apar[3]+(1815.0*Bmag[1]*geoZ[1]+2310.0*geoZ[0])*Apar[2])*Phi[3]+Phi[2]*((1815.0*Bmag[1]*geoZ[1]-2310.0*geoZ[0])*Apar[3]+1155.0*geoZ[0]*Bmag[1]*Apar[2]))*BmagInv[4]+((5939.999999999999*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(5939.999999999999*BmagInv[1]*geoZ[1]+2310.0*BmagInv[0]*geoZ[0])*Apar[2])*Phi[3]+Phi[2]*((5939.999999999999*BmagInv[1]*geoZ[1]+2310.0*BmagInv[0]*geoZ[0])*Apar[3]+2310.0*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2]))*Bmag[4]+(Bmag[1]*(2656.448757269749*BmagInv[1]*geoZ[1]+1033.063405604903*BmagInv[0]*geoZ[0])*Apar[3]+((2066.126811209806*BmagInv[1]+1033.063405604903*BmagInv[0]*Bmag[1])*geoZ[1]+1033.063405604903*geoZ[0]*Bmag[1]*BmagInv[1])*Apar[2])*Phi[3]+Phi[2]*(((1033.063405604903*BmagInv[0]*Bmag[1]-2066.126811209806*BmagInv[1])*geoZ[1]+1033.063405604903*geoZ[0]*Bmag[1]*BmagInv[1])*Apar[3]+1033.063405604903*Bmag[1]*BmagInv[1]*geoZ[1]*Apar[2]))*dfac_x*dfac_y+6160.0*dApardt[6])*q_)+(((Bmag[4]*((-29516.09730299723*BmagInv[4])-18150.0*BmagInv[0])-8116.926758324238*Bmag[1]*BmagInv[1])*geoZ[4]+((-18150.0*geoZ[0]*Bmag[4])-8116.926758324238*Bmag[1]*geoZ[1])*BmagInv[4]+((-26564.48757269751*BmagInv[1]*geoZ[1])-10330.63405604903*BmagInv[0]*geoZ[0])*Bmag[4]-4620.0*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Phi[7]+(((-3300.0*Bmag[1]*BmagInv[4])-18150.0*BmagInv[1]*Bmag[4]-5165.317028024514*BmagInv[0]*Bmag[1])*geoZ[4]+((-18150.0*geoZ[1]*Bmag[4])-5165.317028024514*geoZ[0]*Bmag[1])*BmagInv[4]-10330.63405604903*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]-4620.0*Bmag[1]*BmagInv[1]*geoZ[1])*Phi[5])*dfac_x*dfac_y*m_))/(dfac_v*m_); 
  alpha[12] = -(6.52050663696626e-4*(((((2078.460969082652*Bmag[1]*BmagInv[4]+BmagInv[1]*(7014.805770653949*Bmag[4]-7087.559523559573)+1278.084504248448*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(7014.805770653949*Bmag[4]-7087.559523559573)+1278.084504248448*geoZ[0]*Bmag[1])*BmagInv[4]+4182.82201390401*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(1870.614872174387*Bmag[1]*BmagInv[1]-5819.690713431427*BmagInv[0])*geoZ[1]+geoZ[0]*(727.4613391789284*BmagInv[0]*Bmag[1]-5819.690713431427*BmagInv[1]))*Apar[6]+((Apar[3]*(7014.805770653955*Bmag[4]-1278.084504248448)+1278.084504248448*Bmag[1]*Apar[2])*BmagInv[4]+4182.82201390401*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+(1870.614872174388*Bmag[1]*BmagInv[1]-727.4613391789285*BmagInv[0])*Apar[3]+727.4613391789285*(BmagInv[1]+BmagInv[0]*Bmag[1])*Apar[2])*geoZ[4]+(4182.82201390401*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+(1870.614872174388*Bmag[1]*geoZ[1]-727.4613391789285*geoZ[0])*Apar[3]+727.4613391789285*(geoZ[1]+geoZ[0]*Bmag[1])*Apar[2])*BmagInv[4]+((7014.805770653955*BmagInv[1]*geoZ[1]+3273.576026305178*BmagInv[0]*geoZ[0])*Apar[3]+3273.576026305178*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+((1463.987704866404*BmagInv[0]*Bmag[1]-1463.987704866404*BmagInv[1])*geoZ[1]+geoZ[0]*(1463.987704866404*Bmag[1]*BmagInv[1]-813.3265027035576*BmagInv[0]))*Apar[3]+((1463.987704866404*Bmag[1]*BmagInv[1]+813.3265027035576*BmagInv[0])*geoZ[1]+813.3265027035576*geoZ[0]*(BmagInv[1]+BmagInv[0]*Bmag[1]))*Apar[2])*Phi[7]+(((1039.230484541326*Bmag[1]*BmagInv[4]+BmagInv[1]*(3507.402885326975*Bmag[4]+7087.559523559573)+639.0422521242239*BmagInv[0]*Bmag[1])*geoZ[4]+(geoZ[1]*(3507.402885326975*Bmag[4]+7087.559523559573)+639.0422521242239*geoZ[0]*Bmag[1])*BmagInv[4]+2091.411006952005*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+(935.3074360871933*Bmag[1]*BmagInv[1]+5819.690713431427*BmagInv[0])*geoZ[1]+geoZ[0]*(5819.690713431427*BmagInv[1]+363.7306695894642*BmagInv[0]*Bmag[1]))*Phi[6]+((Phi[3]*(3507.402885326977*Bmag[4]+1278.084504248448)+639.0422521242239*Bmag[1]*Phi[2])*BmagInv[4]+2091.411006952005*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Bmag[4]+(935.3074360871939*Bmag[1]*BmagInv[1]+727.4613391789285*BmagInv[0])*Phi[3]+(363.7306695894642*BmagInv[0]*Bmag[1]-727.4613391789285*BmagInv[1])*Phi[2])*geoZ[4]+(2091.411006952005*(geoZ[0]*Phi[3]+geoZ[1]*Phi[2])*Bmag[4]+(935.3074360871939*Bmag[1]*geoZ[1]+727.4613391789285*geoZ[0])*Phi[3]+(363.7306695894642*geoZ[0]*Bmag[1]-727.4613391789285*geoZ[1])*Phi[2])*BmagInv[4]+((3507.402885326977*BmagInv[1]*geoZ[1]+1636.788013152589*BmagInv[0]*geoZ[0])*Phi[3]+1636.788013152589*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Bmag[4]+((1463.987704866404*BmagInv[1]+731.9938524332018*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(731.9938524332018*Bmag[1]*BmagInv[1]+813.3265027035576*BmagInv[0]))*Phi[3]+((731.9938524332018*Bmag[1]*BmagInv[1]-813.3265027035576*BmagInv[0])*geoZ[1]+geoZ[0]*(406.6632513517788*BmagInv[0]*Bmag[1]-813.3265027035576*BmagInv[1]))*Phi[2])*Apar[7]+(((2323.79000772445*Bmag[4]+5715.767664977297)*BmagInv[4]+1428.941916244324*BmagInv[0]*Bmag[4]+639.0422521242239*Bmag[1]*BmagInv[1]+3253.30601081423*BmagInv[0])*geoZ[4]+(1428.941916244324*geoZ[0]*Bmag[4]+639.0422521242239*Bmag[1]*geoZ[1]+3253.30601081423*geoZ[0])*BmagInv[4]+(2091.411006952005*BmagInv[1]*geoZ[1]+813.3265027035576*BmagInv[0]*geoZ[0])*Bmag[4]+(6547.152052610357*BmagInv[1]+363.7306695894642*BmagInv[0]*Bmag[1])*geoZ[1]+geoZ[0]*(363.7306695894642*Bmag[1]*BmagInv[1]+3637.306695894643*BmagInv[0]))*Apar[5]*Phi[6]+Phi[5]*((((4647.580015448901*Bmag[4]-5715.767664977297)*BmagInv[4]+2857.883832488648*BmagInv[0]*Bmag[4]+1278.084504248448*Bmag[1]*BmagInv[1]-3253.30601081423*BmagInv[0])*geoZ[4]+(2857.883832488648*geoZ[0]*Bmag[4]+1278.084504248448*Bmag[1]*geoZ[1]-3253.30601081423*geoZ[0])*BmagInv[4]+(4182.82201390401*BmagInv[1]*geoZ[1]+1626.653005407115*BmagInv[0]*geoZ[0])*Bmag[4]+(727.4613391789285*BmagInv[0]*Bmag[1]-6547.152052610357*BmagInv[1])*geoZ[1]+geoZ[0]*(727.4613391789285*Bmag[1]*BmagInv[1]-3637.306695894643*BmagInv[0]))*Apar[6]+((2857.883832488647*Apar[2]*Bmag[4]+1278.084504248448*Bmag[1]*Apar[3])*BmagInv[4]+(4182.82201390401*BmagInv[1]*Apar[3]+1626.653005407115*BmagInv[0]*Apar[2])*Bmag[4]+(727.4613391789284*BmagInv[0]*Bmag[1]-1454.922678357857*BmagInv[1])*Apar[3]+727.4613391789284*Bmag[1]*BmagInv[1]*Apar[2])*geoZ[4]+((4182.82201390401*geoZ[1]*Apar[3]+1626.653005407115*geoZ[0]*Apar[2])*Bmag[4]+(727.4613391789284*geoZ[0]*Bmag[1]-1454.922678357857*geoZ[1])*Apar[3]+727.4613391789284*Bmag[1]*geoZ[1]*Apar[2])*BmagInv[4]+(3273.576026305177*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+(3273.576026305177*BmagInv[1]*geoZ[1]+1818.653347947321*BmagInv[0]*geoZ[0])*Apar[2])*Bmag[4]+((1463.987704866403*Bmag[1]*BmagInv[1]-1626.653005407115*BmagInv[0])*geoZ[1]+geoZ[0]*(813.3265027035576*BmagInv[0]*Bmag[1]-1626.653005407115*BmagInv[1]))*Apar[3]+813.3265027035576*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])+(((1428.941916244323*Phi[2]*Bmag[4]+639.0422521242239*Bmag[1]*Phi[3])*BmagInv[4]+(2091.411006952005*BmagInv[1]*Phi[3]+813.3265027035576*BmagInv[0]*Phi[2])*Bmag[4]+(1454.922678357857*BmagInv[1]+363.7306695894642*BmagInv[0]*Bmag[1])*Phi[3]+363.7306695894642*Bmag[1]*BmagInv[1]*Phi[2])*geoZ[4]+((2091.411006952005*geoZ[1]*Phi[3]+813.3265027035576*geoZ[0]*Phi[2])*Bmag[4]+(1454.922678357857*geoZ[1]+363.7306695894642*geoZ[0]*Bmag[1])*Phi[3]+363.7306695894642*Bmag[1]*geoZ[1]*Phi[2])*BmagInv[4]+(1636.788013152588*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[3]+(1636.788013152588*BmagInv[1]*geoZ[1]+909.3266739736605*BmagInv[0]*geoZ[0])*Phi[2])*Bmag[4]+((731.9938524332015*Bmag[1]*BmagInv[1]+1626.653005407115*BmagInv[0])*geoZ[1]+geoZ[0]*(1626.653005407115*BmagInv[1]+406.6632513517788*BmagInv[0]*Bmag[1]))*Phi[3]+406.6632513517788*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Phi[2])*Apar[5])*dfac_x*dfac_y+2168.870673876153*dApardt[7])*q_)/m_; 
  alpha[13] = -(0.005050762722761052*(((129.9038105676658*Bmag[1]*BmagInv[4]+346.4101615137754*BmagInv[1]*Bmag[4]+38.72983346207418*BmagInv[0]*Bmag[1])*geoZ[4]+(346.4101615137754*geoZ[1]*Bmag[4]+38.72983346207418*geoZ[0]*Bmag[1])*BmagInv[4]+213.014084041408*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+Bmag[1]*(95.26279441628824*BmagInv[1]*geoZ[1]+60.6217782649107*BmagInv[0]*geoZ[0]))*Apar[6]+((346.4101615137756*Apar[3]*Bmag[4]+38.72983346207417*Bmag[1]*Apar[2])*BmagInv[4]+213.0140840414079*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+Bmag[1]*(95.26279441628826*BmagInv[1]*Apar[3]+60.62177826491071*BmagInv[0]*Apar[2]))*geoZ[4]+(213.0140840414079*(geoZ[0]*Apar[3]+geoZ[1]*Apar[2])*Bmag[4]+Bmag[1]*(95.26279441628826*geoZ[1]*Apar[3]+60.62177826491071*geoZ[0]*Apar[2]))*BmagInv[4]+((311.7691453623979*BmagInv[1]*geoZ[1]+121.2435565298214*BmagInv[0]*geoZ[0])*Apar[3]+121.2435565298214*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[2])*Bmag[4]+54.22176684690384*Bmag[1]*((BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Apar[3]+BmagInv[1]*geoZ[1]*Apar[2]))*dfac_x*dfac_y)/(dfac_m*m_); 
  alpha[17] = -(0.005050762722761052*(((Bmag[4]*(774.5966692414834*BmagInv[4]+476.3139720814414*BmagInv[0])+213.0140840414079*Bmag[1]*BmagInv[1])*geoZ[4]+(476.3139720814414*geoZ[0]*Bmag[4]+213.0140840414079*Bmag[1]*geoZ[1])*BmagInv[4]+(697.1370023173351*BmagInv[1]*geoZ[1]+271.1088342345192*BmagInv[0]*geoZ[0])*Bmag[4]+121.2435565298214*Bmag[1]*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1]))*Apar[7]+((86.60254037844386*Bmag[1]*BmagInv[4]+476.3139720814412*BmagInv[1]*Bmag[4]+135.5544171172596*BmagInv[0]*Bmag[1])*geoZ[4]+(476.3139720814412*geoZ[1]*Bmag[4]+135.5544171172596*geoZ[0]*Bmag[1])*BmagInv[4]+271.1088342345192*(BmagInv[0]*geoZ[1]+geoZ[0]*BmagInv[1])*Bmag[4]+121.2435565298214*Bmag[1]*BmagInv[1]*geoZ[1])*Apar[5])*dfac_x*dfac_y)/(dfac_m*m_); 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[13]+fl[13])+1.732050807568877*(fl[3]-1.0*fr[3])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[23]+fl[23])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[24]+fl[24])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[2]+fl[2])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[27]+fl[27])+3.0*(fl[10]-1.0*fr[10]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[34]+fl[34])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[5]+fl[5]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[39]+fl[39])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[40]+fl[40])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[9]+fl[9]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[21]-1.0*(8.660254037844387*fl[21]+5.0*(fr[11]+fl[11]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[22]-1.0*(8.660254037844387*fl[22]+5.0*(fr[12]+fl[12]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[30]-1.0*(8.660254037844387*fl[30]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[46]+fl[46])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[16]+fl[16])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[32]-1.0*(8.660254037844387*fl[32]+5.0*(fr[19]+fl[19]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[33]-1.0*(8.660254037844387*fl[33]+5.0*(fr[20]+fl[20]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[37]-1.0*(8.660254037844387*fl[37]+5.0*(fr[25]+fl[25]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[38]-1.0*(8.660254037844387*fl[38]+5.0*(fr[26]+fl[26]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[42]-1.0*(8.660254037844387*fl[42]+5.0*(fr[28]+fl[28]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[43]-1.0*(8.660254037844387*fl[43]+5.0*(fr[29]+fl[29]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[44]-1.0*(8.660254037844387*fl[44]+5.0*(fr[35]+fl[35]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[45]-1.0*(8.660254037844387*fl[45]+5.0*(fr[36]+fl[36]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[41]+fl[41]))); 

//
// //
  Ghat[0] = -0.125*((6.324555320336761*fr[13]-6.324555320336761*fl[13]-4.898979485566357*(fr[3]+fl[3])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[17]*favg[17]+alpha[13]*favg[13]+alpha[12]*favg[12]+alpha[11]*favg[11]+alpha[10]*favg[10]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[6]*favg[6]+alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[3]*favg[3]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[23]-94.8683298050514*fl[23]-73.48469228349535*(fr[6]+fl[6])+42.42640687119286*fr[1]-42.42640687119286*fl[1])*amax-18.97366596101028*(alpha[10]*favg[17]+favg[10]*alpha[17]+alpha[5]*favg[13]+favg[5]*alpha[13])-21.21320343559643*(alpha[8]*favg[12]+favg[8]*alpha[12])-18.97366596101028*(alpha[4]*favg[11]+favg[4]*alpha[11])-21.21320343559643*(alpha[6]*favg[10]+favg[6]*alpha[10])-18.97366596101028*(alpha[1]*favg[7]+favg[1]*alpha[7])-21.21320343559643*(alpha[3]*favg[5]+favg[3]*alpha[5]+alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[24]-94.8683298050514*fl[24]-73.48469228349535*(fr[7]+fl[7])+42.42640687119286*fr[2]-42.42640687119286*fl[2])*amax-18.97366596101028*alpha[10]*favg[18]-21.21320343559643*(alpha[13]*favg[17]+favg[13]*alpha[17])-18.97366596101028*(alpha[6]*favg[14]+alpha[4]*favg[12]+favg[4]*alpha[12])-21.21320343559643*(alpha[7]*favg[11]+favg[7]*alpha[11])-21.21320343559643*(alpha[5]*favg[10]+favg[5]*alpha[10])-18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])-21.21320343559643*(alpha[3]*favg[6]+favg[3]*alpha[6]+alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.01443375672974065*((54.77225575051663*fr[27]-54.77225575051663*fl[27]-42.42640687119286*(fr[10]+fl[10])+24.49489742783179*fr[4]-24.49489742783179*fl[4])*amax-10.95445115010332*alpha[10]*favg[19]-12.24744871391589*(alpha[12]*favg[18]+alpha[11]*favg[17]+favg[11]*alpha[17])-10.95445115010333*(alpha[6]*favg[16]+alpha[5]*favg[15])-12.24744871391589*(alpha[8]*favg[14]+alpha[7]*favg[13]+favg[7]*alpha[13])-12.24744871391589*(alpha[4]*favg[10]+favg[4]*alpha[10])-10.95445115010332*alpha[3]*favg[9]-12.24744871391589*(alpha[2]*favg[6]+favg[2]*alpha[6]+alpha[1]*favg[5]+favg[1]*alpha[5]+alpha[0]*favg[3]+favg[0]*alpha[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[34]-94.86832980505142*fl[34]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[5]-42.42640687119286*fl[5])*amax+((-16.97056274847715*alpha[17])-18.97366596101028*alpha[6])*favg[18]-18.97366596101028*(alpha[5]*favg[17]+favg[5]*alpha[17]+alpha[10]*(favg[14]+favg[13])+favg[10]*alpha[13])+((-16.97056274847715*alpha[11])-18.97366596101028*alpha[2])*favg[12]+((-16.97056274847715*favg[11])-18.97366596101028*favg[2])*alpha[12]-18.97366596101028*(alpha[1]*favg[11]+favg[1]*alpha[11])-21.21320343559643*(alpha[3]*favg[10]+favg[3]*alpha[10])-18.97366596101028*(alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7])-21.21320343559643*(alpha[5]*favg[6]+favg[5]*alpha[6]+alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -5.208333333333333e-4*((1517.893276880824*fr[39]-1517.893276880824*fl[39]-1175.755076535926*(fr[17]+fl[17])+678.8225099390861*fr[8]-678.8225099390861*fl[8])*amax+((-271.5290039756345*alpha[17])-303.5786553761646*alpha[6])*favg[19]-339.411254969543*alpha[8]*favg[18]-303.5786553761646*(alpha[4]*favg[17]+favg[4]*alpha[17])+((-303.5786553761646*alpha[10])-82.15838362577493*alpha[4])*favg[16]+((-271.5290039756345*alpha[13])-303.5786553761646*alpha[3]-82.15838362577493*alpha[0])*favg[15]-339.411254969543*alpha[12]*favg[14]-303.5786553761646*(alpha[1]*favg[13]+favg[1]*alpha[13]+alpha[10]*favg[11]+favg[10]*alpha[11])-339.411254969543*(alpha[2]*favg[10]+favg[2]*alpha[10])-303.5786553761646*(alpha[5]*(favg[9]+favg[7])+favg[5]*alpha[7])-339.411254969543*(alpha[4]*favg[6]+favg[4]*alpha[6]+alpha[0]*favg[5]+favg[0]*alpha[5]+alpha[1]*favg[3]+favg[1]*alpha[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[40]-94.86832980505142*fl[40]-73.48469228349535*(fr[18]+fl[18])+42.42640687119286*fr[9]-42.42640687119286*fl[9])*amax-18.97366596101028*(alpha[5]*favg[19]+alpha[4]*favg[18])-21.21320343559643*(alpha[7]*favg[17]+favg[7]*alpha[17])-18.97366596101028*(alpha[3]*favg[16]+alpha[10]*favg[15]+alpha[2]*favg[14])-21.21320343559643*(alpha[11]*favg[13]+favg[11]*alpha[13])-18.97366596101028*(alpha[10]*favg[12]+favg[10]*alpha[12])-21.21320343559643*(alpha[1]*favg[10]+favg[1]*alpha[10])-18.97366596101028*(alpha[6]*(favg[9]+favg[8])+favg[6]*alpha[8])-21.21320343559643*(alpha[0]*favg[6]+favg[0]*alpha[6]+alpha[4]*favg[5]+favg[4]*alpha[5]+alpha[2]*favg[3]+favg[2]*alpha[3])); 
  Ghat[7] = 0.001190476190476191*((514.3928459844675*(fr[21]+fl[21])-296.98484809835*fr[11]+296.98484809835*fl[11])*amax+(94.86832980505142*alpha[17]+148.492424049175*alpha[6])*favg[17]+148.492424049175*favg[6]*alpha[17]+(94.86832980505142*alpha[13]+148.492424049175*alpha[3])*favg[13]+148.492424049175*favg[3]*alpha[13]+132.815661727072*alpha[12]*favg[12]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[11]+148.492424049175*favg[2]*alpha[11]+132.815661727072*alpha[10]*favg[10]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[7]+148.492424049175*favg[0]*alpha[7]+132.815661727072*(alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.001190476190476191*((514.3928459844675*(fr[22]+fl[22])-296.98484809835*fr[12]+296.98484809835*fl[12])*amax+148.492424049175*alpha[5]*favg[18]+132.815661727072*alpha[17]*favg[17]+148.492424049175*alpha[3]*favg[14]+(94.86832980505142*alpha[12]+148.492424049175*alpha[1])*favg[12]+148.492424049175*favg[1]*alpha[12]+132.815661727072*(alpha[11]*favg[11]+alpha[10]*favg[10])+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[8]+148.492424049175*favg[0]*alpha[8]+132.815661727072*(alpha[6]*favg[6]+alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.008333333333333333*((73.48469228349536*(fr[30]+fl[30])-42.42640687119286*fr[14]+42.42640687119286*fl[14])*amax+21.21320343559643*alpha[4]*favg[19]+18.97366596101028*alpha[17]*favg[17]+21.21320343559643*(alpha[2]*favg[16]+alpha[1]*favg[15])+18.97366596101028*(alpha[13]*favg[13]+alpha[10]*favg[10])+21.21320343559643*alpha[0]*favg[9]+18.97366596101028*(alpha[6]*favg[6]+alpha[5]*favg[5]+alpha[3]*favg[3])); 
  Ghat[10] = -0.002886751345948129*((273.8612787525831*fr[46]-273.8612787525831*fl[46]-212.1320343559643*(fr[31]+fl[31])+122.4744871391589*fr[16]-122.4744871391589*fl[16])*amax+((-48.98979485566359*alpha[13])-54.77225575051663*alpha[3])*favg[19]+((-48.98979485566359*alpha[11])-54.77225575051663*alpha[2])*favg[18]+((-48.98979485566359*alpha[12])-54.77225575051663*alpha[1])*favg[17]+((-48.98979485566359*(favg[15]+favg[12]))-54.77225575051663*favg[1])*alpha[17]-54.77225575051663*(alpha[5]*favg[16]+alpha[6]*favg[15]+alpha[4]*(favg[14]+favg[13])+favg[4]*alpha[13]+alpha[6]*favg[12]+favg[6]*alpha[12]+alpha[5]*favg[11]+favg[5]*alpha[11])+((-54.77225575051663*(alpha[8]+alpha[7]))-61.23724356957945*alpha[0])*favg[10]+((-54.77225575051663*(favg[9]+favg[8]+favg[7]))-61.23724356957945*favg[0])*alpha[10]-61.23724356957945*(alpha[1]*favg[6]+favg[1]*alpha[6]+alpha[2]*favg[5]+favg[2]*alpha[5]+alpha[3]*favg[4]+favg[3]*alpha[4])); 
  Ghat[11] = 2.380952380952381e-4*((2571.964229922338*(fr[32]+fl[32])-1484.92424049175*fr[19]+1484.92424049175*fl[19])*amax+593.9696961967002*alpha[10]*favg[18]+(474.3416490252571*alpha[13]+742.462120245875*alpha[3])*favg[17]+(664.0783086353599*favg[14]+474.3416490252571*favg[13]+742.462120245875*favg[3])*alpha[17]+742.462120245875*(alpha[6]*favg[13]+favg[6]*alpha[13])+593.9696961967002*(alpha[4]*favg[12]+favg[4]*alpha[12])+(664.0783086353599*alpha[8]+474.3416490252571*alpha[7]+742.462120245875*alpha[0])*favg[11]+(664.0783086353599*favg[8]+474.3416490252571*favg[7]+742.462120245875*favg[0])*alpha[11]+664.0783086353598*(alpha[5]*favg[10]+favg[5]*alpha[10])+742.462120245875*(alpha[2]*favg[7]+favg[2]*alpha[7])+664.0783086353598*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 2.380952380952381e-4*((2571.964229922338*(fr[33]+fl[33])-1484.92424049175*fr[20]+1484.92424049175*fl[20])*amax+(664.0783086353599*alpha[13]+742.462120245875*alpha[3])*favg[18]+593.9696961967002*(alpha[10]*favg[17]+favg[10]*alpha[17])+742.462120245875*alpha[5]*favg[14]+(474.3416490252571*alpha[8]+664.0783086353599*alpha[7]+742.462120245875*alpha[0])*favg[12]+(474.3416490252571*favg[8]+664.0783086353599*favg[7]+742.462120245875*favg[0])*alpha[12]+593.9696961967002*(alpha[4]*favg[11]+favg[4]*alpha[11])+664.0783086353598*(alpha[6]*favg[10]+favg[6]*alpha[10])+742.462120245875*(alpha[1]*favg[8]+favg[1]*alpha[8])+664.0783086353598*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 9.221388919541468e-4*((664.0783086353599*(fr[37]+fl[37])-383.4057902536164*fr[25]+383.4057902536164*fl[25])*amax+153.3623161014466*alpha[10]*favg[19]+171.4642819948225*alpha[12]*favg[18]+(122.474487139159*alpha[11]+191.7028951268082*alpha[2])*favg[17]+(171.4642819948225*favg[16]+122.474487139159*favg[11]+191.7028951268082*favg[2])*alpha[17]+153.3623161014466*alpha[5]*favg[15]+(122.474487139159*alpha[7]+191.7028951268082*alpha[0])*favg[13]+(171.4642819948225*favg[9]+122.474487139159*favg[7]+191.7028951268082*favg[0])*alpha[13]+191.7028951268082*(alpha[6]*favg[11]+favg[6]*alpha[11])+171.4642819948225*(alpha[4]*favg[10]+favg[4]*alpha[10])+191.7028951268082*(alpha[3]*favg[7]+favg[3]*alpha[7])+171.4642819948225*(alpha[1]*favg[5]+favg[1]*alpha[5])); 
  Ghat[14] = 9.221388919541468e-4*((664.0783086353599*(fr[38]+fl[38])-383.4057902536164*fr[26]+383.4057902536164*fl[26])*amax+153.3623161014466*alpha[10]*favg[19]+(122.474487139159*alpha[12]+191.7028951268082*alpha[1])*favg[18]+171.4642819948225*(alpha[11]*favg[17]+favg[11]*alpha[17])+153.3623161014466*alpha[6]*favg[16]+(122.474487139159*alpha[8]+191.7028951268082*alpha[0])*favg[14]+191.7028951268082*(alpha[5]*favg[12]+favg[5]*alpha[12])+171.4642819948225*(alpha[4]*favg[10]+favg[4]*alpha[10])+191.7028951268082*(alpha[3]*favg[8]+favg[3]*alpha[8])+171.4642819948225*(alpha[2]*favg[6]+favg[2]*alpha[6])); 
  Ghat[15] = 0.001666666666666667*((367.4234614174769*(fr[42]+fl[42])-212.1320343559643*fr[28]+212.1320343559643*fl[28])*amax+(94.86832980505142*alpha[11]+106.0660171779822*alpha[2])*favg[19]+84.85281374238573*(alpha[10]*favg[17]+favg[10]*alpha[17])+106.0660171779821*alpha[4]*favg[16]+(94.86832980505142*alpha[7]+106.0660171779821*alpha[0])*favg[15]+84.85281374238573*(alpha[5]*favg[13]+favg[5]*alpha[13])+94.8683298050514*(alpha[6]*favg[10]+favg[6]*alpha[10])+106.0660171779822*alpha[1]*favg[9]+94.8683298050514*(alpha[3]*favg[5]+favg[3]*alpha[5])); 
  Ghat[16] = 0.006454972243679028*((94.86832980505142*(fr[43]+fl[43])-54.77225575051663*fr[29]+54.77225575051663*fl[29])*amax+(24.49489742783179*alpha[12]+27.38612787525831*alpha[1])*favg[19]+21.90890230020665*alpha[10]*favg[18]+24.49489742783179*(alpha[13]*favg[17]+favg[13]*alpha[17])+(24.49489742783179*alpha[8]+27.38612787525831*alpha[0])*favg[16]+27.38612787525831*alpha[4]*favg[15]+21.90890230020666*alpha[6]*favg[14]+24.49489742783179*(alpha[5]*favg[10]+favg[5]*alpha[10])+27.38612787525831*alpha[2]*favg[9]+24.49489742783179*(alpha[3]*favg[6]+favg[3]*alpha[6])); 
  Ghat[17] = 2.380952380952381e-4*((2571.964229922338*(fr[44]+fl[44])-1484.92424049175*fr[35]+1484.92424049175*fl[35])*amax+593.9696961967002*(alpha[5]*favg[19]+alpha[4]*favg[18])+(664.0783086353599*alpha[8]+474.3416490252571*alpha[7]+742.462120245875*alpha[0])*favg[17]+(664.0783086353599*(favg[9]+favg[8])+474.3416490252571*favg[7]+742.462120245875*favg[0])*alpha[17]+664.0783086353599*alpha[13]*favg[16]+593.9696961967002*alpha[10]*favg[15]+664.0783086353599*alpha[11]*favg[14]+(474.3416490252571*alpha[11]+742.462120245875*alpha[2])*favg[13]+(474.3416490252571*favg[11]+742.462120245875*favg[2])*alpha[13]+593.9696961967002*(alpha[10]*favg[12]+favg[10]*alpha[12])+742.462120245875*(alpha[3]*favg[11]+favg[3]*alpha[11])+664.0783086353599*(alpha[1]*favg[10]+favg[1]*alpha[10])+742.462120245875*(alpha[6]*favg[7]+favg[6]*alpha[7])+664.0783086353599*(alpha[4]*favg[5]+favg[4]*alpha[5])); 
  Ghat[18] = 5.323971374999498e-4*((1150.217370760849*(fr[45]+fl[45])-664.0783086353599*fr[36]+664.0783086353599*fl[36])*amax+(237.5878784786801*alpha[17]+265.631323454144*alpha[6])*favg[19]+(212.1320343559643*alpha[8]+296.98484809835*alpha[7]+332.0391543176799*alpha[0])*favg[18]+265.631323454144*(alpha[4]*favg[17]+favg[4]*alpha[17]+alpha[10]*favg[16])+(212.1320343559643*alpha[12]+332.0391543176798*alpha[1])*favg[14]+296.98484809835*(alpha[12]*favg[13]+favg[12]*alpha[13])+332.0391543176798*(alpha[3]*favg[12]+favg[3]*alpha[12])+265.631323454144*(alpha[10]*favg[11]+favg[10]*alpha[11])+296.98484809835*(alpha[2]*favg[10]+favg[2]*alpha[10])+332.0391543176799*(alpha[5]*favg[8]+favg[5]*alpha[8])+296.98484809835*(alpha[4]*favg[6]+favg[4]*alpha[6])); 
  Ghat[19] = 0.001666666666666667*((367.4234614174769*(fr[47]+fl[47])-212.1320343559643*fr[41]+212.1320343559643*fl[41])*amax+(94.86832980505142*(alpha[8]+alpha[7])+106.0660171779821*alpha[0])*favg[19]+(75.89466384404115*alpha[17]+84.85281374238573*alpha[6])*favg[18]+84.85281374238573*(alpha[5]*favg[17]+favg[5]*alpha[17])+(94.86832980505142*alpha[12]+106.0660171779822*alpha[1])*favg[16]+(94.86832980505142*alpha[11]+106.0660171779822*alpha[2])*favg[15]+84.85281374238573*(alpha[10]*(favg[14]+favg[13])+favg[10]*alpha[13])+94.86832980505142*(alpha[3]*favg[10]+favg[3]*alpha[10])+106.0660171779821*alpha[4]*favg[9]+94.86832980505142*(alpha[5]*favg[6]+favg[5]*alpha[6])); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_v; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_v; 
  incr[2] = 0.7071067811865475*Ghat[2]*dfac_v; 
  incr[3] = -1.224744871391589*Ghat[0]*dfac_v; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_v; 
  incr[5] = 0.7071067811865475*Ghat[4]*dfac_v; 
  incr[6] = -1.224744871391589*Ghat[1]*dfac_v; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_v; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_v; 
  incr[9] = 0.7071067811865475*Ghat[6]*dfac_v; 
  incr[10] = -1.224744871391589*Ghat[3]*dfac_v; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_v; 
  incr[12] = 0.7071067811865475*Ghat[8]*dfac_v; 
  incr[13] = 1.58113883008419*Ghat[0]*dfac_v; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_v; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_v; 
  incr[16] = 0.7071067811865475*Ghat[10]*dfac_v; 
  incr[17] = -1.224744871391589*Ghat[5]*dfac_v; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_v; 
  incr[19] = 0.7071067811865475*Ghat[11]*dfac_v; 
  incr[20] = 0.7071067811865475*Ghat[12]*dfac_v; 
  incr[21] = -1.224744871391589*Ghat[7]*dfac_v; 
  incr[22] = -1.224744871391589*Ghat[8]*dfac_v; 
  incr[23] = 1.58113883008419*Ghat[1]*dfac_v; 
  incr[24] = 1.58113883008419*Ghat[2]*dfac_v; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_v; 
  incr[26] = 0.7071067811865475*Ghat[14]*dfac_v; 
  incr[27] = 1.58113883008419*Ghat[3]*dfac_v; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_v; 
  incr[29] = 0.7071067811865475*Ghat[16]*dfac_v; 
  incr[30] = -1.224744871391589*Ghat[9]*dfac_v; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_v; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_v; 
  incr[33] = -1.224744871391589*Ghat[12]*dfac_v; 
  incr[34] = 1.58113883008419*Ghat[4]*dfac_v; 
  incr[35] = 0.7071067811865475*Ghat[17]*dfac_v; 
  incr[36] = 0.7071067811865475*Ghat[18]*dfac_v; 
  incr[37] = -1.224744871391589*Ghat[13]*dfac_v; 
  incr[38] = -1.224744871391589*Ghat[14]*dfac_v; 
  incr[39] = 1.58113883008419*Ghat[5]*dfac_v; 
  incr[40] = 1.58113883008419*Ghat[6]*dfac_v; 
  incr[41] = 0.7071067811865475*Ghat[19]*dfac_v; 
  incr[42] = -1.224744871391589*Ghat[15]*dfac_v; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_v; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_v; 
  incr[45] = -1.224744871391589*Ghat[18]*dfac_v; 
  incr[46] = 1.58113883008419*Ghat[10]*dfac_v; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_v; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += -1.0*incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += -1.0*incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += incr[21]; 
  outl[22] += incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += -1.0*incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += incr[37]; 
  outl[38] += incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += -1.0*incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += -1.0*incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
