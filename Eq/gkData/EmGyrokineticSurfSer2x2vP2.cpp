#include <GyrokineticModDecl.h> 
double EmGyrokineticSurf2x2vSer_X_P2_Bvars_0(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = (0.04166666666666666*(dfac_v2*(6.0*BdriftX[0]*m_*wv2+q_*((BmagInv[0]*(3.0*(3.872983346207417*Apar[6]-3.0*Apar[3])+5.196152422706631*Apar[2])*dfac_y+BdriftX[0]*(6.708203932499369*Apar[4]-5.196152422706631*Apar[1]+3.0*Apar[0]))*wv-1.0*BmagInv[0]*(3.0*(3.872983346207417*Phi[6]-3.0*Phi[3])+5.196152422706631*Phi[2])*dfac_y))+2.0*BdriftX[0]*m_))/(dfac_v2*q_); 

  double alpha[20]; 
  alpha[0] = (0.2357022603955158*(dfac_v2*(6.0*BdriftX[0]*m_*wv2+q_*((BmagInv[0]*(11.61895003862225*Apar[6]-9.0*Apar[3]+5.196152422706631*Apar[2])*dfac_y+BdriftX[0]*(6.708203932499369*Apar[4]-5.196152422706631*Apar[1]+3.0*Apar[0]))*wv+BmagInv[0]*((-11.61895003862225*Phi[6])+9.0*Phi[3]-5.196152422706631*Phi[2])*dfac_y))+2.0*BdriftX[0]*m_))/(dfac_v2*q_); 
  alpha[1] = -0.2357022603955158*((BmagInv[0]*(20.1246117974981*Apar[7]-11.61895003862225*Apar[5])*dfac_y+BdriftX[0]*((-6.708203932499369*Apar[6])+5.196152422706631*Apar[3]-3.0*Apar[2]))*wv+BmagInv[0]*(11.61895003862225*Phi[5]-20.1246117974981*Phi[7])*dfac_y); 
  alpha[2] = (0.2357022603955158*(6.928203230275509*BdriftX[0]*m_*wv+(BmagInv[0]*(6.708203932499369*Apar[6]-5.196152422706631*Apar[3]+3.0*Apar[2])*dfac_y+BdriftX[0]*(3.872983346207417*Apar[4]-3.0*Apar[1]+1.732050807568877*Apar[0]))*q_))/(dfac_v*q_); 
  alpha[4] = -(0.2357022603955158*(BmagInv[0]*(11.61895003862225*Apar[7]-6.708203932499369*Apar[5])*dfac_y+BdriftX[0]*((-3.872983346207417*Apar[6])+3.0*Apar[3]-1.732050807568877*Apar[2])))/dfac_v; 
  alpha[7] = -0.1414213562373095*BdriftX[0]*(8.660254037844387*Apar[7]-5.0*Apar[5])*wv; 
  alpha[8] = (0.421637021355784*BdriftX[0]*m_)/(dfac_v2*q_); 
  alpha[11] = -(0.04714045207910316*BdriftX[0]*(15.0*Apar[7]-8.660254037844387*Apar[5]))/dfac_v; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[11]+fl[11])+1.732050807568877*(fl[1]-1.0*fr[1])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[19]+fl[19])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[2]+fl[2])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[21]+fl[21])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[25]+fl[25])+3.0*(fl[8]-1.0*fr[8]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[32]+fl[32])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[7]+fl[7]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[35]+fl[35])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[9]+fl[9]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[37]+fl[37])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[20]-1.0*(8.660254037844387*fl[20]+5.0*(fr[12]+fl[12]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[23]-1.0*(8.660254037844387*fl[23]+5.0*(fr[13]+fl[13]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[28]-1.0*(8.660254037844387*fl[28]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[44]+fl[44])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[18]+fl[18])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[33]-1.0*(8.660254037844387*fl[33]+5.0*(fr[22]+fl[22]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[34]-1.0*(8.660254037844387*fl[34]+5.0*(fr[24]+fl[24]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[36]-1.0*(8.660254037844387*fl[36]+5.0*(fr[26]+fl[26]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[39]-1.0*(8.660254037844387*fl[39]+5.0*(fr[27]+fl[27]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[41]-1.0*(8.660254037844387*fl[41]+5.0*(fr[29]+fl[29]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[42]-1.0*(8.660254037844387*fl[42]+5.0*(fr[30]+fl[30]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[45]-1.0*(8.660254037844387*fl[45]+5.0*(fr[38]+fl[38]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[46]-1.0*(8.660254037844387*fl[46]+5.0*(fr[40]+fl[40]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[43]+fl[43]))); 

  Ghat[0] = -0.125*((6.324555320336761*fr[11]-6.324555320336761*fl[11]-4.898979485566357*(fr[1]+fl[1])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[19]-94.8683298050514*fl[19]-73.48469228349535*(fr[5]+fl[5])+42.42640687119286*fr[2]-42.42640687119286*fl[2])*amax-21.21320343559643*alpha[8]*favg[12]-18.97366596101028*(alpha[4]*favg[11]+favg[4]*alpha[11]+alpha[1]*favg[7]+favg[1]*alpha[7])-21.21320343559643*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[21]-94.8683298050514*fl[21]-73.48469228349535*(fr[6]+fl[6])+42.42640687119286*fr[3]-42.42640687119286*fl[3])*amax-18.97366596101028*alpha[4]*favg[12]-21.21320343559643*(alpha[7]*favg[11]+favg[7]*alpha[11])-18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])-21.21320343559643*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.008333333333333333*((94.8683298050514*fr[25]-94.8683298050514*fl[25]-73.48469228349535*(fr[8]+fl[8])+42.42640687119286*fr[4]-42.42640687119286*fl[4])*amax-21.21320343559643*(alpha[11]*favg[17]+alpha[8]*favg[14]+alpha[7]*favg[13])-21.21320343559643*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[32]-94.86832980505142*fl[32]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[7]-42.42640687119286*fl[7])*amax+((-16.97056274847715*alpha[11])-18.97366596101028*alpha[2])*favg[12]-18.97366596101028*(alpha[1]*favg[11]+favg[1]*alpha[11]+alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7])-21.21320343559643*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -0.008333333333333333*((94.86832980505142*fr[35]-94.86832980505142*fl[35]-73.48469228349535*(fr[16]+fl[16])+42.42640687119286*fr[9]-42.42640687119286*fl[9])*amax-21.21320343559643*alpha[8]*favg[18]-18.97366596101028*(alpha[4]*favg[17]+alpha[1]*favg[13])+favg[10]*((-18.97366596101028*alpha[11])-21.21320343559643*alpha[2])-18.97366596101028*favg[5]*alpha[7]-21.21320343559643*(alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[37]-94.86832980505142*fl[37]-73.48469228349535*(fr[17]+fl[17])+42.42640687119286*fr[10]-42.42640687119286*fl[10])*amax-18.97366596101028*alpha[4]*favg[18]-21.21320343559643*alpha[7]*favg[17]-18.97366596101028*alpha[2]*favg[14]-21.21320343559643*(alpha[11]*favg[13]+alpha[1]*favg[10])-18.97366596101028*favg[6]*alpha[8]-21.21320343559643*(alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3])); 
  Ghat[7] = 0.001190476190476191*((514.3928459844675*(fr[20]+fl[20])-296.98484809835*fr[12]+296.98484809835*fl[12])*amax+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[11]+148.492424049175*favg[2]*alpha[11]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[7]+148.492424049175*favg[0]*alpha[7]+132.815661727072*(alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.001190476190476191*((514.3928459844675*(fr[23]+fl[23])-296.98484809835*fr[13]+296.98484809835*fl[13])*amax+148.492424049175*alpha[1]*favg[12]+132.815661727072*alpha[11]*favg[11]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[8]+148.492424049175*favg[0]*alpha[8]+132.815661727072*(alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.01863389981249824*((32.86335345030997*(fr[28]+fl[28])-18.97366596101028*fr[14]+18.97366596101028*fl[14])*amax+9.48683298050514*(alpha[4]*favg[19]+alpha[2]*favg[16]+alpha[1]*favg[15]+alpha[0]*favg[9])); 
  Ghat[10] = -0.001666666666666667*((474.341649025257*fr[44]-474.341649025257*fl[44]-367.4234614174767*(fr[31]+fl[31])+212.1320343559643*fr[18]-212.1320343559643*fl[18])*amax+((-84.85281374238573*alpha[11])-94.86832980505142*alpha[2])*favg[18]-94.86832980505142*alpha[1]*favg[17]-94.8683298050514*(alpha[4]*(favg[14]+favg[13])+favg[5]*alpha[11])+((-94.86832980505142*(alpha[8]+alpha[7]))-106.0660171779821*alpha[0])*favg[10]-106.0660171779821*(alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4])); 
  Ghat[11] = 0.001190476190476191*((514.3928459844675*(fr[33]+fl[33])-296.98484809835*fr[22]+296.98484809835*fl[22])*amax+118.79393923934*alpha[4]*favg[12]+(132.815661727072*alpha[8]+94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[11]+(132.815661727072*favg[8]+94.86832980505142*favg[7]+148.492424049175*favg[0])*alpha[11]+148.492424049175*(alpha[2]*favg[7]+favg[2]*alpha[7])+132.815661727072*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 0.001190476190476191*((514.3928459844675*(fr[34]+fl[34])-296.98484809835*fr[24]+296.98484809835*fl[24])*amax+(94.86832980505142*alpha[8]+132.815661727072*alpha[7]+148.492424049175*alpha[0])*favg[12]+118.79393923934*(alpha[4]*favg[11]+favg[4]*alpha[11])+148.492424049175*(alpha[1]*favg[8]+favg[1]*alpha[8])+132.815661727072*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.001190476190476191*((514.3928459844675*(fr[36]+fl[36])-296.98484809835*fr[26]+296.98484809835*fl[26])*amax+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[17]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[13]+148.492424049175*favg[6]*alpha[11]+132.815661727072*alpha[4]*favg[10]+148.492424049175*favg[3]*alpha[7]+132.815661727072*alpha[1]*favg[5]); 
  Ghat[14] = 0.001190476190476191*((514.3928459844675*(fr[39]+fl[39])-296.98484809835*fr[27]+296.98484809835*fl[27])*amax+148.492424049175*alpha[1]*favg[18]+132.815661727072*alpha[11]*favg[17]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[14]+132.815661727072*alpha[4]*favg[10]+148.492424049175*favg[3]*alpha[8]+132.815661727072*alpha[2]*favg[6]); 
  Ghat[15] = 0.006454972243679028*((94.86832980505142*(fr[41]+fl[41])-54.77225575051663*fr[29]+54.77225575051663*fl[29])*amax+(24.49489742783179*alpha[11]+27.38612787525831*alpha[2])*favg[19]+27.38612787525831*alpha[4]*favg[16]+(24.49489742783179*alpha[7]+27.38612787525831*alpha[0])*favg[15]+27.38612787525831*alpha[1]*favg[9]); 
  Ghat[16] = 0.006454972243679028*((94.86832980505142*(fr[42]+fl[42])-54.77225575051663*fr[30]+54.77225575051663*fl[30])*amax+27.38612787525831*alpha[1]*favg[19]+(24.49489742783179*alpha[8]+27.38612787525831*alpha[0])*favg[16]+27.38612787525831*alpha[4]*favg[15]+27.38612787525831*alpha[2]*favg[9]); 
  Ghat[17] = 0.001190476190476191*((514.3928459844675*(fr[45]+fl[45])-296.98484809835*fr[38]+296.98484809835*fl[38])*amax+118.79393923934*alpha[4]*favg[18]+(132.815661727072*alpha[8]+94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[17]+132.815661727072*alpha[11]*favg[14]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[13]+148.492424049175*favg[3]*alpha[11]+132.815661727072*alpha[1]*favg[10]+148.492424049175*favg[6]*alpha[7]+132.815661727072*alpha[4]*favg[5]); 
  Ghat[18] = 2.380952380952381e-4*((2571.964229922338*(fr[46]+fl[46])-1484.92424049175*fr[40]+1484.92424049175*fl[40])*amax+(474.3416490252571*alpha[8]+664.0783086353599*alpha[7]+742.462120245875*alpha[0])*favg[18]+593.9696961967002*alpha[4]*favg[17]+742.462120245875*alpha[1]*favg[14]+favg[10]*(593.9696961967002*alpha[11]+664.0783086353599*alpha[2])+742.462120245875*favg[5]*alpha[8]+664.0783086353599*alpha[4]*favg[6]); 
  Ghat[19] = 0.01863389981249824*((32.86335345030997*(fr[47]+fl[47])-18.97366596101028*fr[43]+18.97366596101028*fl[43])*amax+(8.485281374238571*(alpha[8]+alpha[7])+9.48683298050514*alpha[0])*favg[19]+9.48683298050514*alpha[1]*favg[16]+(8.485281374238571*alpha[11]+9.48683298050514*alpha[2])*favg[15]+9.48683298050514*alpha[4]*favg[9]); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_x; 
  incr[1] = -1.224744871391589*Ghat[0]*dfac_x; 
  incr[2] = 0.7071067811865475*Ghat[1]*dfac_x; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_x; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_x; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_x; 
  incr[6] = -1.224744871391589*Ghat[2]*dfac_x; 
  incr[7] = 0.7071067811865475*Ghat[4]*dfac_x; 
  incr[8] = -1.224744871391589*Ghat[3]*dfac_x; 
  incr[9] = 0.7071067811865475*Ghat[5]*dfac_x; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_x; 
  incr[11] = 1.58113883008419*Ghat[0]*dfac_x; 
  incr[12] = 0.7071067811865475*Ghat[7]*dfac_x; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_x; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_x; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_x; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_x; 
  incr[17] = -1.224744871391589*Ghat[6]*dfac_x; 
  incr[18] = 0.7071067811865475*Ghat[10]*dfac_x; 
  incr[19] = 1.58113883008419*Ghat[1]*dfac_x; 
  incr[20] = -1.224744871391589*Ghat[7]*dfac_x; 
  incr[21] = 1.58113883008419*Ghat[2]*dfac_x; 
  incr[22] = 0.7071067811865475*Ghat[11]*dfac_x; 
  incr[23] = -1.224744871391589*Ghat[8]*dfac_x; 
  incr[24] = 0.7071067811865475*Ghat[12]*dfac_x; 
  incr[25] = 1.58113883008419*Ghat[3]*dfac_x; 
  incr[26] = 0.7071067811865475*Ghat[13]*dfac_x; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_x; 
  incr[28] = -1.224744871391589*Ghat[9]*dfac_x; 
  incr[29] = 0.7071067811865475*Ghat[15]*dfac_x; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_x; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_x; 
  incr[32] = 1.58113883008419*Ghat[4]*dfac_x; 
  incr[33] = -1.224744871391589*Ghat[11]*dfac_x; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_x; 
  incr[35] = 1.58113883008419*Ghat[5]*dfac_x; 
  incr[36] = -1.224744871391589*Ghat[13]*dfac_x; 
  incr[37] = 1.58113883008419*Ghat[6]*dfac_x; 
  incr[38] = 0.7071067811865475*Ghat[17]*dfac_x; 
  incr[39] = -1.224744871391589*Ghat[14]*dfac_x; 
  incr[40] = 0.7071067811865475*Ghat[18]*dfac_x; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_x; 
  incr[42] = -1.224744871391589*Ghat[16]*dfac_x; 
  incr[43] = 0.7071067811865475*Ghat[19]*dfac_x; 
  incr[44] = 1.58113883008419*Ghat[10]*dfac_x; 
  incr[45] = -1.224744871391589*Ghat[17]*dfac_x; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_x; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_x; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += -1.0*incr[7]; 
  outl[8] += incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += -1.0*incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += -1.0*incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += -1.0*incr[43]; 
  outl[44] += -1.0*incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Y_P2_Bvars_0(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = (0.04166666666666666*(dfac_v2*(6.0*BdriftY[0]*m_*wv2+q_*((BdriftY[0]*(6.708203932499369*Apar[5]-5.196152422706631*Apar[2]+3.0*Apar[0])-1.0*BmagInv[0]*(3.0*(3.872983346207417*Apar[7]-3.0*Apar[3])+5.196152422706631*Apar[1])*dfac_x)*wv+BmagInv[0]*(3.0*(3.872983346207417*Phi[7]-3.0*Phi[3])+5.196152422706631*Phi[1])*dfac_x))+2.0*BdriftY[0]*m_))/(dfac_v2*q_); 

  double alpha[20]; 
  alpha[0] = (0.2357022603955158*(dfac_v2*(6.0*BdriftY[0]*m_*wv2+q_*((BmagInv[0]*((-11.61895003862225*Apar[7])+9.0*Apar[3]-5.196152422706631*Apar[1])*dfac_x+BdriftY[0]*(6.708203932499369*Apar[5]-5.196152422706631*Apar[2]+3.0*Apar[0]))*wv+BmagInv[0]*(11.61895003862225*Phi[7]-9.0*Phi[3]+5.196152422706631*Phi[1])*dfac_x))+2.0*BdriftY[0]*m_))/(dfac_v2*q_); 
  alpha[1] = 0.2357022603955158*((BmagInv[0]*(20.1246117974981*Apar[6]-11.61895003862225*Apar[4])*dfac_x+BdriftY[0]*(6.708203932499369*Apar[7]-5.196152422706631*Apar[3]+3.0*Apar[1]))*wv+BmagInv[0]*(11.61895003862225*Phi[4]-20.1246117974981*Phi[6])*dfac_x); 
  alpha[2] = (0.2357022603955158*(6.928203230275509*BdriftY[0]*m_*wv+(BmagInv[0]*((-6.708203932499369*Apar[7])+5.196152422706631*Apar[3]-3.0*Apar[1])*dfac_x+BdriftY[0]*(3.872983346207417*Apar[5]-3.0*Apar[2]+1.732050807568877*Apar[0]))*q_))/(dfac_v*q_); 
  alpha[4] = (0.2357022603955158*(BmagInv[0]*(11.61895003862225*Apar[6]-6.708203932499369*Apar[4])*dfac_x+BdriftY[0]*(3.872983346207417*Apar[7]-3.0*Apar[3]+1.732050807568877*Apar[1])))/dfac_v; 
  alpha[7] = -0.1414213562373095*BdriftY[0]*(8.660254037844387*Apar[6]-5.0*Apar[4])*wv; 
  alpha[8] = (0.421637021355784*BdriftY[0]*m_)/(dfac_v2*q_); 
  alpha[11] = -(0.04714045207910316*BdriftY[0]*(15.0*Apar[6]-8.660254037844387*Apar[4]))/dfac_v; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[12]+fl[12])+1.732050807568877*(fl[2]-1.0*fr[2])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[20]+fl[20])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[22]+fl[22])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[26]+fl[26])+3.0*(fl[9]-1.0*fr[9]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[33]+fl[33])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[6]+fl[6]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[36]+fl[36])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[38]+fl[38])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[19]-1.0*(8.660254037844387*fl[19]+5.0*(fr[11]+fl[11]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[24]-1.0*(8.660254037844387*fl[24]+5.0*(fr[13]+fl[13]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[29]-1.0*(8.660254037844387*fl[29]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[45]+fl[45])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[17]+fl[17])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[32]-1.0*(8.660254037844387*fl[32]+5.0*(fr[21]+fl[21]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[34]-1.0*(8.660254037844387*fl[34]+5.0*(fr[23]+fl[23]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[35]-1.0*(8.660254037844387*fl[35]+5.0*(fr[25]+fl[25]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[40]-1.0*(8.660254037844387*fl[40]+5.0*(fr[27]+fl[27]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[41]-1.0*(8.660254037844387*fl[41]+5.0*(fr[28]+fl[28]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[43]-1.0*(8.660254037844387*fl[43]+5.0*(fr[30]+fl[30]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[44]-1.0*(8.660254037844387*fl[44]+5.0*(fr[37]+fl[37]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[46]-1.0*(8.660254037844387*fl[46]+5.0*(fr[39]+fl[39]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[42]+fl[42]))); 

  Ghat[0] = -0.125*((6.324555320336761*fr[12]-6.324555320336761*fl[12]-4.898979485566357*(fr[2]+fl[2])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[20]-94.8683298050514*fl[20]-73.48469228349535*(fr[5]+fl[5])+42.42640687119286*fr[1]-42.42640687119286*fl[1])*amax-21.21320343559643*alpha[8]*favg[12]-18.97366596101028*(alpha[4]*favg[11]+favg[4]*alpha[11]+alpha[1]*favg[7]+favg[1]*alpha[7])-21.21320343559643*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[22]-94.8683298050514*fl[22]-73.48469228349535*(fr[7]+fl[7])+42.42640687119286*fr[3]-42.42640687119286*fl[3])*amax-18.97366596101028*alpha[4]*favg[12]-21.21320343559643*(alpha[7]*favg[11]+favg[7]*alpha[11])-18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])-21.21320343559643*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.008333333333333333*((94.8683298050514*fr[26]-94.8683298050514*fl[26]-73.48469228349535*(fr[9]+fl[9])+42.42640687119286*fr[4]-42.42640687119286*fl[4])*amax-21.21320343559643*(alpha[11]*favg[17]+alpha[8]*favg[14]+alpha[7]*favg[13])-21.21320343559643*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[33]-94.86832980505142*fl[33]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[6]-42.42640687119286*fl[6])*amax+((-16.97056274847715*alpha[11])-18.97366596101028*alpha[2])*favg[12]-18.97366596101028*(alpha[1]*favg[11]+favg[1]*alpha[11]+alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7])-21.21320343559643*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -0.008333333333333333*((94.86832980505142*fr[36]-94.86832980505142*fl[36]-73.48469228349535*(fr[16]+fl[16])+42.42640687119286*fr[8]-42.42640687119286*fl[8])*amax-21.21320343559643*alpha[8]*favg[18]-18.97366596101028*(alpha[4]*favg[17]+alpha[1]*favg[13])+favg[10]*((-18.97366596101028*alpha[11])-21.21320343559643*alpha[2])-18.97366596101028*favg[5]*alpha[7]-21.21320343559643*(alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[38]-94.86832980505142*fl[38]-73.48469228349535*(fr[18]+fl[18])+42.42640687119286*fr[10]-42.42640687119286*fl[10])*amax-18.97366596101028*alpha[4]*favg[18]-21.21320343559643*alpha[7]*favg[17]-18.97366596101028*alpha[2]*favg[14]-21.21320343559643*(alpha[11]*favg[13]+alpha[1]*favg[10])-18.97366596101028*favg[6]*alpha[8]-21.21320343559643*(alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3])); 
  Ghat[7] = 0.001190476190476191*((514.3928459844675*(fr[19]+fl[19])-296.98484809835*fr[11]+296.98484809835*fl[11])*amax+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[11]+148.492424049175*favg[2]*alpha[11]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[7]+148.492424049175*favg[0]*alpha[7]+132.815661727072*(alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.001190476190476191*((514.3928459844675*(fr[24]+fl[24])-296.98484809835*fr[13]+296.98484809835*fl[13])*amax+148.492424049175*alpha[1]*favg[12]+132.815661727072*alpha[11]*favg[11]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[8]+148.492424049175*favg[0]*alpha[8]+132.815661727072*(alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.01863389981249824*((32.86335345030997*(fr[29]+fl[29])-18.97366596101028*fr[14]+18.97366596101028*fl[14])*amax+9.48683298050514*(alpha[4]*favg[19]+alpha[2]*favg[16]+alpha[1]*favg[15]+alpha[0]*favg[9])); 
  Ghat[10] = -0.001666666666666667*((474.341649025257*fr[45]-474.341649025257*fl[45]-367.4234614174767*(fr[31]+fl[31])+212.1320343559643*fr[17]-212.1320343559643*fl[17])*amax+((-84.85281374238573*alpha[11])-94.86832980505142*alpha[2])*favg[18]-94.86832980505142*alpha[1]*favg[17]-94.8683298050514*(alpha[4]*(favg[14]+favg[13])+favg[5]*alpha[11])+((-94.86832980505142*(alpha[8]+alpha[7]))-106.0660171779821*alpha[0])*favg[10]-106.0660171779821*(alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4])); 
  Ghat[11] = 0.001190476190476191*((514.3928459844675*(fr[32]+fl[32])-296.98484809835*fr[21]+296.98484809835*fl[21])*amax+118.79393923934*alpha[4]*favg[12]+(132.815661727072*alpha[8]+94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[11]+(132.815661727072*favg[8]+94.86832980505142*favg[7]+148.492424049175*favg[0])*alpha[11]+148.492424049175*(alpha[2]*favg[7]+favg[2]*alpha[7])+132.815661727072*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 0.001190476190476191*((514.3928459844675*(fr[34]+fl[34])-296.98484809835*fr[23]+296.98484809835*fl[23])*amax+(94.86832980505142*alpha[8]+132.815661727072*alpha[7]+148.492424049175*alpha[0])*favg[12]+118.79393923934*(alpha[4]*favg[11]+favg[4]*alpha[11])+148.492424049175*(alpha[1]*favg[8]+favg[1]*alpha[8])+132.815661727072*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.001190476190476191*((514.3928459844675*(fr[35]+fl[35])-296.98484809835*fr[25]+296.98484809835*fl[25])*amax+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[17]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[13]+148.492424049175*favg[6]*alpha[11]+132.815661727072*alpha[4]*favg[10]+148.492424049175*favg[3]*alpha[7]+132.815661727072*alpha[1]*favg[5]); 
  Ghat[14] = 0.001190476190476191*((514.3928459844675*(fr[40]+fl[40])-296.98484809835*fr[27]+296.98484809835*fl[27])*amax+148.492424049175*alpha[1]*favg[18]+132.815661727072*alpha[11]*favg[17]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[14]+132.815661727072*alpha[4]*favg[10]+148.492424049175*favg[3]*alpha[8]+132.815661727072*alpha[2]*favg[6]); 
  Ghat[15] = 0.006454972243679028*((94.86832980505142*(fr[41]+fl[41])-54.77225575051663*fr[28]+54.77225575051663*fl[28])*amax+(24.49489742783179*alpha[11]+27.38612787525831*alpha[2])*favg[19]+27.38612787525831*alpha[4]*favg[16]+(24.49489742783179*alpha[7]+27.38612787525831*alpha[0])*favg[15]+27.38612787525831*alpha[1]*favg[9]); 
  Ghat[16] = 0.006454972243679028*((94.86832980505142*(fr[43]+fl[43])-54.77225575051663*fr[30]+54.77225575051663*fl[30])*amax+27.38612787525831*alpha[1]*favg[19]+(24.49489742783179*alpha[8]+27.38612787525831*alpha[0])*favg[16]+27.38612787525831*alpha[4]*favg[15]+27.38612787525831*alpha[2]*favg[9]); 
  Ghat[17] = 0.001190476190476191*((514.3928459844675*(fr[44]+fl[44])-296.98484809835*fr[37]+296.98484809835*fl[37])*amax+118.79393923934*alpha[4]*favg[18]+(132.815661727072*alpha[8]+94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[17]+132.815661727072*alpha[11]*favg[14]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[13]+148.492424049175*favg[3]*alpha[11]+132.815661727072*alpha[1]*favg[10]+148.492424049175*favg[6]*alpha[7]+132.815661727072*alpha[4]*favg[5]); 
  Ghat[18] = 2.380952380952381e-4*((2571.964229922338*(fr[46]+fl[46])-1484.92424049175*fr[39]+1484.92424049175*fl[39])*amax+(474.3416490252571*alpha[8]+664.0783086353599*alpha[7]+742.462120245875*alpha[0])*favg[18]+593.9696961967002*alpha[4]*favg[17]+742.462120245875*alpha[1]*favg[14]+favg[10]*(593.9696961967002*alpha[11]+664.0783086353599*alpha[2])+742.462120245875*favg[5]*alpha[8]+664.0783086353599*alpha[4]*favg[6]); 
  Ghat[19] = 0.01863389981249824*((32.86335345030997*(fr[47]+fl[47])-18.97366596101028*fr[42]+18.97366596101028*fl[42])*amax+(8.485281374238571*(alpha[8]+alpha[7])+9.48683298050514*alpha[0])*favg[19]+9.48683298050514*alpha[1]*favg[16]+(8.485281374238571*alpha[11]+9.48683298050514*alpha[2])*favg[15]+9.48683298050514*alpha[4]*favg[9]); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_y; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_y; 
  incr[2] = -1.224744871391589*Ghat[0]*dfac_y; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_y; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_y; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_y; 
  incr[6] = 0.7071067811865475*Ghat[4]*dfac_y; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_y; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_y; 
  incr[9] = -1.224744871391589*Ghat[3]*dfac_y; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_y; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_y; 
  incr[12] = 1.58113883008419*Ghat[0]*dfac_y; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_y; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_y; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_y; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_y; 
  incr[17] = 0.7071067811865475*Ghat[10]*dfac_y; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_y; 
  incr[19] = -1.224744871391589*Ghat[7]*dfac_y; 
  incr[20] = 1.58113883008419*Ghat[1]*dfac_y; 
  incr[21] = 0.7071067811865475*Ghat[11]*dfac_y; 
  incr[22] = 1.58113883008419*Ghat[2]*dfac_y; 
  incr[23] = 0.7071067811865475*Ghat[12]*dfac_y; 
  incr[24] = -1.224744871391589*Ghat[8]*dfac_y; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_y; 
  incr[26] = 1.58113883008419*Ghat[3]*dfac_y; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_y; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_y; 
  incr[29] = -1.224744871391589*Ghat[9]*dfac_y; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_y; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_y; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_y; 
  incr[33] = 1.58113883008419*Ghat[4]*dfac_y; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_y; 
  incr[35] = -1.224744871391589*Ghat[13]*dfac_y; 
  incr[36] = 1.58113883008419*Ghat[5]*dfac_y; 
  incr[37] = 0.7071067811865475*Ghat[17]*dfac_y; 
  incr[38] = 1.58113883008419*Ghat[6]*dfac_y; 
  incr[39] = 0.7071067811865475*Ghat[18]*dfac_y; 
  incr[40] = -1.224744871391589*Ghat[14]*dfac_y; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_y; 
  incr[42] = 0.7071067811865475*Ghat[19]*dfac_y; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_y; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_y; 
  incr[45] = 1.58113883008419*Ghat[10]*dfac_y; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_y; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_y; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += -1.0*incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += -1.0*incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += -1.0*incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += -1.0*incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += -1.0*incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Vpar_P2_Bvars_0(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = -(0.0125*(dfac_v*(17.32050807568877*(BdriftY[0]*Phi[2]*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_*wv+((BdriftY[0]*(3.872983346207417*(5.0*Apar[3]*Phi[7]+2.23606797749979*Apar[4]*Phi[6])+1.732050807568877*(11.18033988749895*Apar[2]*Phi[5]+5.0*(Apar[1]*Phi[3]+Apar[0]*Phi[2])))-3.0*BmagInv[0]*(25.0*(Apar[6]*Phi[7]-1.0*Phi[6]*Apar[7])+11.18033988749895*(Apar[3]*Phi[5]-1.0*(Phi[3]*Apar[5]+Apar[3]*Phi[4]-1.0*Phi[3]*Apar[4]))+5.0*(Apar[1]*Phi[2]-1.0*Phi[1]*Apar[2]))*dfac_x)*dfac_y+BdriftX[0]*(3.872983346207417*(2.23606797749979*Apar[5]*Phi[7]+5.0*Apar[3]*Phi[6])+1.732050807568877*(11.18033988749895*Apar[1]*Phi[4]+5.0*(Apar[2]*Phi[3]+Apar[0]*Phi[1])))*dfac_x+20.0*dApardt[0])*q_)-17.32050807568877*(BdriftY[0]*Phi[2]*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_))/(dfac_v*m_); 

  double alpha[20]; 
  alpha[0] = -(0.07071067811865474*(dfac_v*(17.32050807568877*(BdriftY[0]*Phi[2]*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_*wv+((BmagInv[0]*((-75.0*Apar[6]*Phi[7])+75.0*Phi[6]*Apar[7]-33.54101966249685*Apar[3]*Phi[5]+33.54101966249685*(Phi[3]*Apar[5]+Apar[3]*Phi[4])-33.54101966249685*Phi[3]*Apar[4]-15.0*Apar[1]*Phi[2]+15.0*Phi[1]*Apar[2])*dfac_x+BdriftY[0]*(19.36491673103708*Apar[3]*Phi[7]+8.660254037844387*Apar[4]*Phi[6]+19.36491673103709*Apar[2]*Phi[5]+8.660254037844386*(Apar[1]*Phi[3]+Apar[0]*Phi[2])))*dfac_y+BdriftX[0]*(8.660254037844387*Apar[5]*Phi[7]+19.36491673103708*Apar[3]*Phi[6]+19.36491673103709*Apar[1]*Phi[4]+8.660254037844386*(Apar[2]*Phi[3]+Apar[0]*Phi[1]))*dfac_x+20.0*dApardt[0])*q_)-17.32050807568877*(BdriftY[0]*Phi[2]*dfac_y+BdriftX[0]*Phi[1]*dfac_x)*m_))/(dfac_v*m_); 
  alpha[1] = -(0.07071067811865474*(dfac_v*((17.32050807568877*BdriftY[0]*Phi[3]*dfac_y+38.72983346207418*BdriftX[0]*Phi[4]*dfac_x)*m_*wv+((BmagInv[0]*((-33.54101966249684*Apar[3]*Phi[7])+33.54101966249684*Phi[3]*Apar[7]+(75.00000000000001*Apar[5]-30.0*Apar[4])*Phi[6]+(30.0*Phi[4]-75.00000000000001*Phi[5])*Apar[6]+33.54101966249685*Apar[2]*Phi[4]-33.54101966249685*Phi[2]*Apar[4]-15.0*Apar[1]*Phi[3]+15.0*Phi[1]*Apar[3])*dfac_x+BdriftY[0]*((17.32050807568877*Apar[6]+19.36491673103708*Apar[2])*Phi[7]+7.745966692414834*Apar[1]*Phi[6]+19.36491673103709*Apar[3]*Phi[5]+7.745966692414834*Phi[3]*Apar[4]+8.660254037844386*(Apar[0]*Phi[3]+Apar[1]*Phi[2])))*dfac_y+BdriftX[0]*(8.660254037844386*Apar[7]*Phi[7]+(17.32050807568877*Apar[6]+19.36491673103708*Apar[2])*Phi[6]+(17.32050807568877*Apar[4]+19.36491673103709*Apar[0])*Phi[4]+8.660254037844386*(Apar[3]*Phi[3]+Apar[1]*Phi[1]))*dfac_x+20.0*dApardt[1])*q_)+((-17.32050807568877*BdriftY[0]*Phi[3]*dfac_y)-38.72983346207418*BdriftX[0]*Phi[4]*dfac_x)*m_))/(dfac_v*m_); 
  alpha[2] = -(0.07071067811865474*(dfac_v*((38.72983346207418*BdriftY[0]*Phi[5]*dfac_y+17.32050807568877*BdriftX[0]*Phi[3]*dfac_x)*m_*wv+((BmagInv[0]*((30.0*Apar[5]-75.00000000000001*Apar[4])*Phi[7]+(75.00000000000001*Phi[4]-30.0*Phi[5])*Apar[7]+33.54101966249684*Apar[3]*Phi[6]-33.54101966249684*Phi[3]*Apar[6]-33.54101966249685*Apar[1]*Phi[5]+33.54101966249685*Phi[1]*Apar[5]+15.0*Apar[2]*Phi[3]-15.0*Phi[2]*Apar[3])*dfac_x+BdriftY[0]*((17.32050807568877*Apar[7]+19.36491673103708*Apar[1])*Phi[7]+8.660254037844386*Apar[6]*Phi[6]+(17.32050807568877*Apar[5]+19.36491673103709*Apar[0])*Phi[5]+8.660254037844386*(Apar[3]*Phi[3]+Apar[2]*Phi[2])))*dfac_y+BdriftX[0]*(7.745966692414834*Apar[2]*Phi[7]+Phi[6]*(17.32050807568877*Apar[7]+19.36491673103708*Apar[1])+7.745966692414834*Phi[3]*Apar[5]+19.36491673103709*Apar[3]*Phi[4]+8.660254037844386*(Apar[0]*Phi[3]+Phi[1]*Apar[2]))*dfac_x+20.0*dApardt[2])*q_)+((-38.72983346207418*BdriftY[0]*Phi[5]*dfac_y)-17.32050807568877*BdriftX[0]*Phi[3]*dfac_x)*m_))/(dfac_v*m_); 
  alpha[4] = -(0.07071067811865474*(dfac_v*(38.72983346207417*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)*m_*wv+((BmagInv[0]*((-33.54101966249684*Apar[1]*Phi[7])+33.54101966249684*(Phi[1]*Apar[7]+Apar[2]*Phi[6])-33.54101966249684*Phi[2]*Apar[6]-75.0*Apar[4]*Phi[5]+75.0*Phi[4]*Apar[5])*dfac_x+BdriftY[0]*((17.32050807568877*(Apar[5]+Apar[4])+19.36491673103708*Apar[0])*Phi[7]+17.32050807568877*Phi[5]*Apar[7]+7.745966692414834*(Apar[3]*Phi[6]+Phi[3]*Apar[6])+19.36491673103709*Apar[1]*Phi[5]+8.660254037844386*(Apar[2]*Phi[3]+Phi[2]*Apar[3])))*dfac_y+BdriftX[0]*(7.745966692414834*(Apar[3]*Phi[7]+Phi[3]*Apar[7])+(17.32050807568877*(Apar[5]+Apar[4])+19.36491673103708*Apar[0])*Phi[6]+Phi[4]*(17.32050807568877*Apar[6]+19.36491673103709*Apar[2])+8.660254037844386*(Apar[1]*Phi[3]+Phi[1]*Apar[3]))*dfac_x+20.0*dApardt[3])*q_)-38.72983346207417*(BdriftY[0]*Phi[7]*dfac_y+BdriftX[0]*Phi[6]*dfac_x)*m_))/(dfac_v*m_); 
  alpha[7] = -(0.01010152544552211*(dfac_v*(121.2435565298214*BdriftY[0]*Phi[6]*dfac_y*m_*wv+((BmagInv[0]*((-469.5742752749559*Apar[6]*Phi[7])+Phi[6]*(469.5742752749559*Apar[7]-105.0*Apar[1])+105.0*Phi[1]*Apar[6]+210.0*Apar[3]*Phi[4]-210.0*Phi[3]*Apar[4])*dfac_x+BdriftY[0]*(121.2435565298214*Apar[3]*Phi[7]+(38.72983346207417*Apar[4]+60.62177826491071*Apar[0])*Phi[6]+135.5544171172596*Phi[5]*Apar[6]+60.6217782649107*Phi[2]*Apar[4]+54.22176684690384*Apar[1]*Phi[3]))*dfac_y+BdriftX[0]*(121.2435565298214*Apar[3]*Phi[6]+60.62177826491071*Phi[3]*Apar[6]+121.2435565298214*Apar[1]*Phi[4]+60.6217782649107*Phi[1]*Apar[4])*dfac_x+140.0*dApardt[4])*q_)-121.2435565298214*BdriftY[0]*Phi[6]*dfac_y*m_))/(dfac_v*m_); 
  alpha[8] = -(0.01010152544552211*(dfac_v*(121.2435565298214*BdriftX[0]*Phi[7]*dfac_x*m_*wv+((BmagInv[0]*((105.0*Apar[2]-469.5742752749559*Apar[6])*Phi[7]+(469.5742752749559*Phi[6]-105.0*Phi[2])*Apar[7]-210.0*Apar[3]*Phi[5]+210.0*Phi[3]*Apar[5])*dfac_x+BdriftY[0]*(121.2435565298214*Apar[3]*Phi[7]+60.62177826491071*Phi[3]*Apar[7]+121.2435565298214*Apar[2]*Phi[5]+60.6217782649107*Phi[2]*Apar[5]))*dfac_y+BdriftX[0]*((38.72983346207417*Apar[5]+60.62177826491071*Apar[0])*Phi[7]+135.5544171172596*Phi[4]*Apar[7]+121.2435565298214*Apar[3]*Phi[6]+60.6217782649107*Phi[1]*Apar[5]+54.22176684690384*Apar[2]*Phi[3])*dfac_x+140.0*dApardt[5])*q_)-121.2435565298214*BdriftX[0]*Phi[7]*dfac_x*m_))/(dfac_v*m_); 
  alpha[11] = (0.01010152544552211*((BmagInv[0]*(469.5742752749559*Apar[4]*Phi[7]-469.5742752749559*Phi[4]*Apar[7]-105.0*Apar[3]*Phi[6]+105.0*Phi[3]*Apar[6])*dfac_x+BdriftY[0]*(((-108.4435336938077*Apar[7])-121.2435565298214*Apar[1])*Phi[7]+((-38.72983346207417*Apar[6])-60.6217782649107*Apar[2])*Phi[6]-60.6217782649107*Phi[2]*Apar[6]-135.5544171172596*Apar[4]*Phi[5]-54.22176684690384*Apar[3]*Phi[3]))*dfac_y+BdriftX[0]*((-54.22176684690384*Apar[6]*Phi[7])+Phi[6]*((-108.4435336938077*Apar[7])-121.2435565298214*Apar[1])-60.6217782649107*Phi[1]*Apar[6]-121.2435565298214*Apar[3]*Phi[4]-60.62177826491071*Phi[3]*Apar[4])*dfac_x-140.0*dApardt[6])*q_)/m_; 
  alpha[12] = (0.01010152544552211*((BmagInv[0]*(105.0*Apar[3]*Phi[7]-105.0*Phi[3]*Apar[7]-469.5742752749559*Apar[5]*Phi[6]+469.5742752749559*Phi[5]*Apar[6])*dfac_x+BdriftY[0]*(((-108.4435336938077*Apar[6])-121.2435565298214*Apar[2])*Phi[7]+((-54.22176684690384*Phi[6])-60.6217782649107*Phi[2])*Apar[7]-121.2435565298214*Apar[3]*Phi[5]-60.62177826491071*Phi[3]*Apar[5]))*dfac_y+BdriftX[0]*(((-38.72983346207417*Apar[7])-60.6217782649107*Apar[1])*Phi[7]-60.6217782649107*Phi[1]*Apar[7]+((-108.4435336938077*Apar[6])-121.2435565298214*Apar[2])*Phi[6]-135.5544171172596*Phi[4]*Apar[5]-54.22176684690384*Apar[3]*Phi[3])*dfac_x-140.0*dApardt[7])*q_)/m_; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[13]+fl[13])+1.732050807568877*(fl[3]-1.0*fr[3])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[23]+fl[23])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[24]+fl[24])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[2]+fl[2])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[27]+fl[27])+3.0*(fl[10]-1.0*fr[10]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[34]+fl[34])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[5]+fl[5]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[39]+fl[39])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[40]+fl[40])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[9]+fl[9]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[21]-1.0*(8.660254037844387*fl[21]+5.0*(fr[11]+fl[11]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[22]-1.0*(8.660254037844387*fl[22]+5.0*(fr[12]+fl[12]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[30]-1.0*(8.660254037844387*fl[30]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[46]+fl[46])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[16]+fl[16])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[32]-1.0*(8.660254037844387*fl[32]+5.0*(fr[19]+fl[19]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[33]-1.0*(8.660254037844387*fl[33]+5.0*(fr[20]+fl[20]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[37]-1.0*(8.660254037844387*fl[37]+5.0*(fr[25]+fl[25]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[38]-1.0*(8.660254037844387*fl[38]+5.0*(fr[26]+fl[26]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[42]-1.0*(8.660254037844387*fl[42]+5.0*(fr[28]+fl[28]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[43]-1.0*(8.660254037844387*fl[43]+5.0*(fr[29]+fl[29]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[44]-1.0*(8.660254037844387*fl[44]+5.0*(fr[35]+fl[35]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[45]-1.0*(8.660254037844387*fl[45]+5.0*(fr[36]+fl[36]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[41]+fl[41]))); 

  Ghat[0] = -0.125*((6.324555320336761*fr[13]-6.324555320336761*fl[13]-4.898979485566357*(fr[3]+fl[3])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[12]*favg[12]+alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[23]-94.8683298050514*fl[23]-73.48469228349535*(fr[6]+fl[6])+42.42640687119286*fr[1]-42.42640687119286*fl[1])*amax-21.21320343559643*(alpha[8]*favg[12]+favg[8]*alpha[12])-18.97366596101028*(alpha[4]*favg[11]+favg[4]*alpha[11]+alpha[1]*favg[7]+favg[1]*alpha[7])-21.21320343559643*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[24]-94.8683298050514*fl[24]-73.48469228349535*(fr[7]+fl[7])+42.42640687119286*fr[2]-42.42640687119286*fl[2])*amax-18.97366596101028*(alpha[4]*favg[12]+favg[4]*alpha[12])-21.21320343559643*(alpha[7]*favg[11]+favg[7]*alpha[11])-18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])-21.21320343559643*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.008333333333333333*((94.8683298050514*fr[27]-94.8683298050514*fl[27]-73.48469228349535*(fr[10]+fl[10])+42.42640687119286*fr[4]-42.42640687119286*fl[4])*amax-21.21320343559643*(alpha[12]*favg[18]+alpha[11]*favg[17]+alpha[8]*favg[14]+alpha[7]*favg[13])-21.21320343559643*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[34]-94.86832980505142*fl[34]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[5]-42.42640687119286*fl[5])*amax+((-16.97056274847715*alpha[11])-18.97366596101028*alpha[2])*favg[12]+((-16.97056274847715*favg[11])-18.97366596101028*favg[2])*alpha[12]-18.97366596101028*(alpha[1]*favg[11]+favg[1]*alpha[11]+alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7])-21.21320343559643*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -0.008333333333333333*((94.86832980505142*fr[39]-94.86832980505142*fl[39]-73.48469228349535*(fr[17]+fl[17])+42.42640687119286*fr[8]-42.42640687119286*fl[8])*amax-21.21320343559643*alpha[8]*favg[18]-18.97366596101028*alpha[4]*favg[17]-21.21320343559643*alpha[12]*favg[14]-18.97366596101028*alpha[1]*favg[13]+favg[10]*((-18.97366596101028*alpha[11])-21.21320343559643*alpha[2])-18.97366596101028*favg[5]*alpha[7]-21.21320343559643*(alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[40]-94.86832980505142*fl[40]-73.48469228349535*(fr[18]+fl[18])+42.42640687119286*fr[9]-42.42640687119286*fl[9])*amax-18.97366596101028*alpha[4]*favg[18]-21.21320343559643*alpha[7]*favg[17]-18.97366596101028*alpha[2]*favg[14]-21.21320343559643*alpha[11]*favg[13]+favg[10]*((-18.97366596101028*alpha[12])-21.21320343559643*alpha[1])-18.97366596101028*favg[6]*alpha[8]-21.21320343559643*(alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3])); 
  Ghat[7] = 0.001190476190476191*((514.3928459844675*(fr[21]+fl[21])-296.98484809835*fr[11]+296.98484809835*fl[11])*amax+132.815661727072*alpha[12]*favg[12]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[11]+148.492424049175*favg[2]*alpha[11]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[7]+148.492424049175*favg[0]*alpha[7]+132.815661727072*(alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.001190476190476191*((514.3928459844675*(fr[22]+fl[22])-296.98484809835*fr[12]+296.98484809835*fl[12])*amax+(94.86832980505142*alpha[12]+148.492424049175*alpha[1])*favg[12]+148.492424049175*favg[1]*alpha[12]+132.815661727072*alpha[11]*favg[11]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[8]+148.492424049175*favg[0]*alpha[8]+132.815661727072*(alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.01863389981249824*((32.86335345030997*(fr[30]+fl[30])-18.97366596101028*fr[14]+18.97366596101028*fl[14])*amax+9.48683298050514*(alpha[4]*favg[19]+alpha[2]*favg[16]+alpha[1]*favg[15]+alpha[0]*favg[9])); 
  Ghat[10] = -0.001666666666666667*((474.341649025257*fr[46]-474.341649025257*fl[46]-367.4234614174767*(fr[31]+fl[31])+212.1320343559643*fr[16]-212.1320343559643*fl[16])*amax+((-84.85281374238573*alpha[11])-94.86832980505142*alpha[2])*favg[18]+((-84.85281374238573*alpha[12])-94.86832980505142*alpha[1])*favg[17]-94.8683298050514*(alpha[4]*(favg[14]+favg[13])+favg[6]*alpha[12]+favg[5]*alpha[11])+((-94.86832980505142*(alpha[8]+alpha[7]))-106.0660171779821*alpha[0])*favg[10]-106.0660171779821*(alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4])); 
  Ghat[11] = 0.001190476190476191*((514.3928459844675*(fr[32]+fl[32])-296.98484809835*fr[19]+296.98484809835*fl[19])*amax+118.79393923934*(alpha[4]*favg[12]+favg[4]*alpha[12])+(132.815661727072*alpha[8]+94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[11]+(132.815661727072*favg[8]+94.86832980505142*favg[7]+148.492424049175*favg[0])*alpha[11]+148.492424049175*(alpha[2]*favg[7]+favg[2]*alpha[7])+132.815661727072*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 0.001190476190476191*((514.3928459844675*(fr[33]+fl[33])-296.98484809835*fr[20]+296.98484809835*fl[20])*amax+(94.86832980505142*alpha[8]+132.815661727072*alpha[7]+148.492424049175*alpha[0])*favg[12]+(94.86832980505142*favg[8]+132.815661727072*favg[7]+148.492424049175*favg[0])*alpha[12]+118.79393923934*(alpha[4]*favg[11]+favg[4]*alpha[11])+148.492424049175*(alpha[1]*favg[8]+favg[1]*alpha[8])+132.815661727072*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.001190476190476191*((514.3928459844675*(fr[37]+fl[37])-296.98484809835*fr[25]+296.98484809835*fl[25])*amax+132.815661727072*alpha[12]*favg[18]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[17]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[13]+148.492424049175*favg[6]*alpha[11]+132.815661727072*alpha[4]*favg[10]+148.492424049175*favg[3]*alpha[7]+132.815661727072*alpha[1]*favg[5]); 
  Ghat[14] = 0.001190476190476191*((514.3928459844675*(fr[38]+fl[38])-296.98484809835*fr[26]+296.98484809835*fl[26])*amax+(94.86832980505142*alpha[12]+148.492424049175*alpha[1])*favg[18]+132.815661727072*alpha[11]*favg[17]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[14]+148.492424049175*favg[5]*alpha[12]+132.815661727072*alpha[4]*favg[10]+148.492424049175*favg[3]*alpha[8]+132.815661727072*alpha[2]*favg[6]); 
  Ghat[15] = 0.006454972243679028*((94.86832980505142*(fr[42]+fl[42])-54.77225575051663*fr[28]+54.77225575051663*fl[28])*amax+(24.49489742783179*alpha[11]+27.38612787525831*alpha[2])*favg[19]+27.38612787525831*alpha[4]*favg[16]+(24.49489742783179*alpha[7]+27.38612787525831*alpha[0])*favg[15]+27.38612787525831*alpha[1]*favg[9]); 
  Ghat[16] = 0.006454972243679028*((94.86832980505142*(fr[43]+fl[43])-54.77225575051663*fr[29]+54.77225575051663*fl[29])*amax+(24.49489742783179*alpha[12]+27.38612787525831*alpha[1])*favg[19]+(24.49489742783179*alpha[8]+27.38612787525831*alpha[0])*favg[16]+27.38612787525831*alpha[4]*favg[15]+27.38612787525831*alpha[2]*favg[9]); 
  Ghat[17] = 2.380952380952381e-4*((2571.964229922338*(fr[44]+fl[44])-1484.92424049175*fr[35]+1484.92424049175*fl[35])*amax+593.9696961967002*alpha[4]*favg[18]+(664.0783086353599*alpha[8]+474.3416490252571*alpha[7]+742.462120245875*alpha[0])*favg[17]+664.0783086353599*alpha[11]*favg[14]+(474.3416490252571*alpha[11]+742.462120245875*alpha[2])*favg[13]+593.9696961967002*favg[10]*alpha[12]+742.462120245875*favg[3]*alpha[11]+664.0783086353599*alpha[1]*favg[10]+742.462120245875*favg[6]*alpha[7]+664.0783086353599*alpha[4]*favg[5]); 
  Ghat[18] = 2.380952380952381e-4*((2571.964229922338*(fr[45]+fl[45])-1484.92424049175*fr[36]+1484.92424049175*fl[36])*amax+(474.3416490252571*alpha[8]+664.0783086353599*alpha[7]+742.462120245875*alpha[0])*favg[18]+593.9696961967002*alpha[4]*favg[17]+(474.3416490252571*alpha[12]+742.462120245875*alpha[1])*favg[14]+alpha[12]*(664.0783086353599*favg[13]+742.462120245875*favg[3])+favg[10]*(593.9696961967002*alpha[11]+664.0783086353599*alpha[2])+742.462120245875*favg[5]*alpha[8]+664.0783086353599*alpha[4]*favg[6]); 
  Ghat[19] = 0.01863389981249824*((32.86335345030997*(fr[47]+fl[47])-18.97366596101028*fr[41]+18.97366596101028*fl[41])*amax+(8.485281374238571*(alpha[8]+alpha[7])+9.48683298050514*alpha[0])*favg[19]+(8.485281374238571*alpha[12]+9.48683298050514*alpha[1])*favg[16]+(8.485281374238571*alpha[11]+9.48683298050514*alpha[2])*favg[15]+9.48683298050514*alpha[4]*favg[9]); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_v; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_v; 
  incr[2] = 0.7071067811865475*Ghat[2]*dfac_v; 
  incr[3] = -1.224744871391589*Ghat[0]*dfac_v; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_v; 
  incr[5] = 0.7071067811865475*Ghat[4]*dfac_v; 
  incr[6] = -1.224744871391589*Ghat[1]*dfac_v; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_v; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_v; 
  incr[9] = 0.7071067811865475*Ghat[6]*dfac_v; 
  incr[10] = -1.224744871391589*Ghat[3]*dfac_v; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_v; 
  incr[12] = 0.7071067811865475*Ghat[8]*dfac_v; 
  incr[13] = 1.58113883008419*Ghat[0]*dfac_v; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_v; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_v; 
  incr[16] = 0.7071067811865475*Ghat[10]*dfac_v; 
  incr[17] = -1.224744871391589*Ghat[5]*dfac_v; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_v; 
  incr[19] = 0.7071067811865475*Ghat[11]*dfac_v; 
  incr[20] = 0.7071067811865475*Ghat[12]*dfac_v; 
  incr[21] = -1.224744871391589*Ghat[7]*dfac_v; 
  incr[22] = -1.224744871391589*Ghat[8]*dfac_v; 
  incr[23] = 1.58113883008419*Ghat[1]*dfac_v; 
  incr[24] = 1.58113883008419*Ghat[2]*dfac_v; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_v; 
  incr[26] = 0.7071067811865475*Ghat[14]*dfac_v; 
  incr[27] = 1.58113883008419*Ghat[3]*dfac_v; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_v; 
  incr[29] = 0.7071067811865475*Ghat[16]*dfac_v; 
  incr[30] = -1.224744871391589*Ghat[9]*dfac_v; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_v; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_v; 
  incr[33] = -1.224744871391589*Ghat[12]*dfac_v; 
  incr[34] = 1.58113883008419*Ghat[4]*dfac_v; 
  incr[35] = 0.7071067811865475*Ghat[17]*dfac_v; 
  incr[36] = 0.7071067811865475*Ghat[18]*dfac_v; 
  incr[37] = -1.224744871391589*Ghat[13]*dfac_v; 
  incr[38] = -1.224744871391589*Ghat[14]*dfac_v; 
  incr[39] = 1.58113883008419*Ghat[5]*dfac_v; 
  incr[40] = 1.58113883008419*Ghat[6]*dfac_v; 
  incr[41] = 0.7071067811865475*Ghat[19]*dfac_v; 
  incr[42] = -1.224744871391589*Ghat[15]*dfac_v; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_v; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_v; 
  incr[45] = -1.224744871391589*Ghat[18]*dfac_v; 
  incr[46] = 1.58113883008419*Ghat[10]*dfac_v; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_v; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += -1.0*incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += -1.0*incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += incr[21]; 
  outl[22] += incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += -1.0*incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += incr[37]; 
  outl[38] += incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += -1.0*incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += -1.0*incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_X_P2_Bvars_1(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = (0.04166666666666666*(dfac_v2*(2.0*(6.708203932499369*BdriftX[4]-5.196152422706631*BdriftX[1]+3.0*BdriftX[0])*m_*wv2+q_*(((3.872983346207417*(6.708203932499369*BmagInv[4]-5.196152422706631*BmagInv[1]+3.0*BmagInv[0])*Apar[6]+2.23606797749979*(5.196152422706631*Apar[2]-9.0*Apar[3])*BmagInv[4]+(15.58845726811989*BmagInv[1]-9.0*BmagInv[0])*Apar[3]+(5.196152422706631*BmagInv[0]-9.0*BmagInv[1])*Apar[2])*dfac_y+(15.0*Apar[4]+2.23606797749979*(3.0*Apar[0]-5.196152422706631*Apar[1]))*BdriftX[4]+2.23606797749979*(3.0*BdriftX[0]-5.196152422706631*BdriftX[1])*Apar[4]+(9.0*Apar[1]-5.196152422706631*Apar[0])*BdriftX[1]+BdriftX[0]*(3.0*Apar[0]-5.196152422706631*Apar[1]))*wv-1.0*(3.872983346207417*(6.708203932499369*BmagInv[4]-5.196152422706631*BmagInv[1]+3.0*BmagInv[0])*Phi[6]-1.0*(2.23606797749979*(9.0*Phi[3]-5.196152422706631*Phi[2])*BmagInv[4]+(9.0*BmagInv[0]-15.58845726811989*BmagInv[1])*Phi[3]+(9.0*BmagInv[1]-5.196152422706631*BmagInv[0])*Phi[2]))*dfac_y))+2.0*(2.23606797749979*BdriftX[4]-1.732050807568877*BdriftX[1]+BdriftX[0])*m_))/(dfac_v2*q_); 

  double alpha[20]; 
  alpha[0] = (0.2357022603955158*(dfac_v2*((13.41640786499874*BdriftX[4]-10.39230484541326*BdriftX[1]+6.0*BdriftX[0])*m_*wv2+q_*((((25.98076211353316*BmagInv[4]-20.1246117974981*BmagInv[1]+11.61895003862225*BmagInv[0])*Apar[6]+(11.61895003862225*Apar[2]-20.12461179749811*Apar[3])*BmagInv[4]+(15.58845726811989*BmagInv[1]-9.0*BmagInv[0])*Apar[3]+(5.196152422706631*BmagInv[0]-9.0*BmagInv[1])*Apar[2])*dfac_y+(15.0*Apar[4]-11.61895003862225*Apar[1]+6.708203932499369*Apar[0])*BdriftX[4]+(6.708203932499369*BdriftX[0]-11.61895003862225*BdriftX[1])*Apar[4]+(9.0*Apar[1]-5.196152422706631*Apar[0])*BdriftX[1]+BdriftX[0]*(3.0*Apar[0]-5.196152422706631*Apar[1]))*wv+(((-25.98076211353316*BmagInv[4])+20.1246117974981*BmagInv[1]-11.61895003862225*BmagInv[0])*Phi[6]+(20.12461179749811*Phi[3]-11.61895003862225*Phi[2])*BmagInv[4]+(9.0*BmagInv[0]-15.58845726811989*BmagInv[1])*Phi[3]+(9.0*BmagInv[1]-5.196152422706631*BmagInv[0])*Phi[2])*dfac_y))+(4.47213595499958*BdriftX[4]-3.464101615137754*BdriftX[1]+2.0*BdriftX[0])*m_))/(dfac_v2*q_); 
  alpha[1] = -0.2357022603955158*((((45.0*BmagInv[4]-34.85685011586676*BmagInv[1]+20.1246117974981*BmagInv[0])*Apar[7]+((-25.98076211353316*BmagInv[4])+20.12461179749811*BmagInv[1]-11.61895003862225*BmagInv[0])*Apar[5])*dfac_y+((-15.0*BdriftX[4])+11.61895003862225*BdriftX[1]-6.708203932499369*BdriftX[0])*Apar[6]+(11.61895003862225*Apar[3]-6.708203932499369*Apar[2])*BdriftX[4]+(5.196152422706631*BdriftX[0]-9.0*BdriftX[1])*Apar[3]+(5.196152422706631*BdriftX[1]-3.0*BdriftX[0])*Apar[2])*wv+(((-45.0*BmagInv[4])+34.85685011586676*BmagInv[1]-20.1246117974981*BmagInv[0])*Phi[7]+(25.98076211353316*BmagInv[4]-20.12461179749811*BmagInv[1]+11.61895003862225*BmagInv[0])*Phi[5])*dfac_y); 
  alpha[2] = (0.2357022603955158*((15.49193338482967*BdriftX[4]-12.0*BdriftX[1]+6.928203230275509*BdriftX[0])*m_*wv+(((15.0*BmagInv[4]-11.61895003862225*BmagInv[1]+6.708203932499369*BmagInv[0])*Apar[6]+(6.708203932499369*Apar[2]-11.61895003862225*Apar[3])*BmagInv[4]+(9.0*BmagInv[1]-5.196152422706631*BmagInv[0])*Apar[3]+(3.0*BmagInv[0]-5.196152422706631*BmagInv[1])*Apar[2])*dfac_y+(8.660254037844386*Apar[4]-6.708203932499369*Apar[1]+3.872983346207417*Apar[0])*BdriftX[4]+(3.872983346207417*BdriftX[0]-6.708203932499369*BdriftX[1])*Apar[4]+(5.196152422706631*Apar[1]-3.0*Apar[0])*BdriftX[1]+BdriftX[0]*(1.732050807568877*Apar[0]-3.0*Apar[1]))*q_))/(dfac_v*q_); 
  alpha[4] = -(0.2357022603955158*(((25.98076211353316*BmagInv[4]-20.1246117974981*BmagInv[1]+11.61895003862225*BmagInv[0])*Apar[7]+((-15.0*BmagInv[4])+11.61895003862225*BmagInv[1]-6.708203932499369*BmagInv[0])*Apar[5])*dfac_y+((-8.660254037844387*BdriftX[4])+6.708203932499369*BdriftX[1]-3.872983346207417*BdriftX[0])*Apar[6]+(6.708203932499369*Apar[3]-3.872983346207417*Apar[2])*BdriftX[4]+(3.0*BdriftX[0]-5.196152422706631*BdriftX[1])*Apar[3]+(3.0*BdriftX[1]-1.732050807568877*BdriftX[0])*Apar[2]))/dfac_v; 
  alpha[7] = -0.1414213562373095*((19.36491673103708*BdriftX[4]-15.0*BdriftX[1]+8.660254037844387*BdriftX[0])*Apar[7]+((-11.18033988749895*BdriftX[4])+8.660254037844386*BdriftX[1]-5.0*BdriftX[0])*Apar[5])*wv; 
  alpha[8] = (0.04714045207910316*(20.0*BdriftX[4]-15.49193338482967*BdriftX[1]+8.94427190999916*BdriftX[0])*m_)/(dfac_v2*q_); 
  alpha[11] = -(0.04714045207910316*((33.54101966249685*BdriftX[4]-25.98076211353316*BdriftX[1]+15.0*BdriftX[0])*Apar[7]+((-19.36491673103708*BdriftX[4])+15.0*BdriftX[1]-8.660254037844387*BdriftX[0])*Apar[5]))/dfac_v; 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[11]+fl[11])+1.732050807568877*(fl[1]-1.0*fr[1])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[19]+fl[19])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[2]+fl[2])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[21]+fl[21])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[25]+fl[25])+3.0*(fl[8]-1.0*fr[8]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[32]+fl[32])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[7]+fl[7]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[35]+fl[35])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[9]+fl[9]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[37]+fl[37])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[20]-1.0*(8.660254037844387*fl[20]+5.0*(fr[12]+fl[12]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[23]-1.0*(8.660254037844387*fl[23]+5.0*(fr[13]+fl[13]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[28]-1.0*(8.660254037844387*fl[28]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[44]+fl[44])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[18]+fl[18])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[33]-1.0*(8.660254037844387*fl[33]+5.0*(fr[22]+fl[22]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[34]-1.0*(8.660254037844387*fl[34]+5.0*(fr[24]+fl[24]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[36]-1.0*(8.660254037844387*fl[36]+5.0*(fr[26]+fl[26]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[39]-1.0*(8.660254037844387*fl[39]+5.0*(fr[27]+fl[27]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[41]-1.0*(8.660254037844387*fl[41]+5.0*(fr[29]+fl[29]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[42]-1.0*(8.660254037844387*fl[42]+5.0*(fr[30]+fl[30]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[45]-1.0*(8.660254037844387*fl[45]+5.0*(fr[38]+fl[38]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[46]-1.0*(8.660254037844387*fl[46]+5.0*(fr[40]+fl[40]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[43]+fl[43]))); 

  Ghat[0] = -0.125*((6.324555320336761*fr[11]-6.324555320336761*fl[11]-4.898979485566357*(fr[1]+fl[1])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[4]*favg[4]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[19]-94.8683298050514*fl[19]-73.48469228349535*(fr[5]+fl[5])+42.42640687119286*fr[2]-42.42640687119286*fl[2])*amax-21.21320343559643*alpha[8]*favg[12]-18.97366596101028*(alpha[4]*favg[11]+favg[4]*alpha[11]+alpha[1]*favg[7]+favg[1]*alpha[7])-21.21320343559643*(alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[21]-94.8683298050514*fl[21]-73.48469228349535*(fr[6]+fl[6])+42.42640687119286*fr[3]-42.42640687119286*fl[3])*amax-18.97366596101028*alpha[4]*favg[12]-21.21320343559643*(alpha[7]*favg[11]+favg[7]*alpha[11])-18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])-21.21320343559643*(alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.008333333333333333*((94.8683298050514*fr[25]-94.8683298050514*fl[25]-73.48469228349535*(fr[8]+fl[8])+42.42640687119286*fr[4]-42.42640687119286*fl[4])*amax-21.21320343559643*(alpha[11]*favg[17]+alpha[8]*favg[14]+alpha[7]*favg[13])-21.21320343559643*(alpha[4]*favg[10]+alpha[2]*favg[6]+alpha[1]*favg[5]+alpha[0]*favg[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[32]-94.86832980505142*fl[32]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[7]-42.42640687119286*fl[7])*amax+((-16.97056274847715*alpha[11])-18.97366596101028*alpha[2])*favg[12]-18.97366596101028*(alpha[1]*favg[11]+favg[1]*alpha[11]+alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7])-21.21320343559643*(alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -0.008333333333333333*((94.86832980505142*fr[35]-94.86832980505142*fl[35]-73.48469228349535*(fr[16]+fl[16])+42.42640687119286*fr[9]-42.42640687119286*fl[9])*amax-21.21320343559643*alpha[8]*favg[18]-18.97366596101028*(alpha[4]*favg[17]+alpha[1]*favg[13])+favg[10]*((-18.97366596101028*alpha[11])-21.21320343559643*alpha[2])-18.97366596101028*favg[5]*alpha[7]-21.21320343559643*(alpha[4]*favg[6]+alpha[0]*favg[5]+alpha[1]*favg[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[37]-94.86832980505142*fl[37]-73.48469228349535*(fr[17]+fl[17])+42.42640687119286*fr[10]-42.42640687119286*fl[10])*amax-18.97366596101028*alpha[4]*favg[18]-21.21320343559643*alpha[7]*favg[17]-18.97366596101028*alpha[2]*favg[14]-21.21320343559643*(alpha[11]*favg[13]+alpha[1]*favg[10])-18.97366596101028*favg[6]*alpha[8]-21.21320343559643*(alpha[0]*favg[6]+alpha[4]*favg[5]+alpha[2]*favg[3])); 
  Ghat[7] = 0.001190476190476191*((514.3928459844675*(fr[20]+fl[20])-296.98484809835*fr[12]+296.98484809835*fl[12])*amax+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[11]+148.492424049175*favg[2]*alpha[11]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[7]+148.492424049175*favg[0]*alpha[7]+132.815661727072*(alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.001190476190476191*((514.3928459844675*(fr[23]+fl[23])-296.98484809835*fr[13]+296.98484809835*fl[13])*amax+148.492424049175*alpha[1]*favg[12]+132.815661727072*alpha[11]*favg[11]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[8]+148.492424049175*favg[0]*alpha[8]+132.815661727072*(alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.01863389981249824*((32.86335345030997*(fr[28]+fl[28])-18.97366596101028*fr[14]+18.97366596101028*fl[14])*amax+9.48683298050514*(alpha[4]*favg[19]+alpha[2]*favg[16]+alpha[1]*favg[15]+alpha[0]*favg[9])); 
  Ghat[10] = -0.001666666666666667*((474.341649025257*fr[44]-474.341649025257*fl[44]-367.4234614174767*(fr[31]+fl[31])+212.1320343559643*fr[18]-212.1320343559643*fl[18])*amax+((-84.85281374238573*alpha[11])-94.86832980505142*alpha[2])*favg[18]-94.86832980505142*alpha[1]*favg[17]-94.8683298050514*(alpha[4]*(favg[14]+favg[13])+favg[5]*alpha[11])+((-94.86832980505142*(alpha[8]+alpha[7]))-106.0660171779821*alpha[0])*favg[10]-106.0660171779821*(alpha[1]*favg[6]+alpha[2]*favg[5]+favg[3]*alpha[4])); 
  Ghat[11] = 0.001190476190476191*((514.3928459844675*(fr[33]+fl[33])-296.98484809835*fr[22]+296.98484809835*fl[22])*amax+118.79393923934*alpha[4]*favg[12]+(132.815661727072*alpha[8]+94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[11]+(132.815661727072*favg[8]+94.86832980505142*favg[7]+148.492424049175*favg[0])*alpha[11]+148.492424049175*(alpha[2]*favg[7]+favg[2]*alpha[7])+132.815661727072*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 0.001190476190476191*((514.3928459844675*(fr[34]+fl[34])-296.98484809835*fr[24]+296.98484809835*fl[24])*amax+(94.86832980505142*alpha[8]+132.815661727072*alpha[7]+148.492424049175*alpha[0])*favg[12]+118.79393923934*(alpha[4]*favg[11]+favg[4]*alpha[11])+148.492424049175*(alpha[1]*favg[8]+favg[1]*alpha[8])+132.815661727072*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.001190476190476191*((514.3928459844675*(fr[36]+fl[36])-296.98484809835*fr[26]+296.98484809835*fl[26])*amax+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[17]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[13]+148.492424049175*favg[6]*alpha[11]+132.815661727072*alpha[4]*favg[10]+148.492424049175*favg[3]*alpha[7]+132.815661727072*alpha[1]*favg[5]); 
  Ghat[14] = 0.001190476190476191*((514.3928459844675*(fr[39]+fl[39])-296.98484809835*fr[27]+296.98484809835*fl[27])*amax+148.492424049175*alpha[1]*favg[18]+132.815661727072*alpha[11]*favg[17]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[14]+132.815661727072*alpha[4]*favg[10]+148.492424049175*favg[3]*alpha[8]+132.815661727072*alpha[2]*favg[6]); 
  Ghat[15] = 0.006454972243679028*((94.86832980505142*(fr[41]+fl[41])-54.77225575051663*fr[29]+54.77225575051663*fl[29])*amax+(24.49489742783179*alpha[11]+27.38612787525831*alpha[2])*favg[19]+27.38612787525831*alpha[4]*favg[16]+(24.49489742783179*alpha[7]+27.38612787525831*alpha[0])*favg[15]+27.38612787525831*alpha[1]*favg[9]); 
  Ghat[16] = 0.006454972243679028*((94.86832980505142*(fr[42]+fl[42])-54.77225575051663*fr[30]+54.77225575051663*fl[30])*amax+27.38612787525831*alpha[1]*favg[19]+(24.49489742783179*alpha[8]+27.38612787525831*alpha[0])*favg[16]+27.38612787525831*alpha[4]*favg[15]+27.38612787525831*alpha[2]*favg[9]); 
  Ghat[17] = 0.001190476190476191*((514.3928459844675*(fr[45]+fl[45])-296.98484809835*fr[38]+296.98484809835*fl[38])*amax+118.79393923934*alpha[4]*favg[18]+(132.815661727072*alpha[8]+94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[17]+132.815661727072*alpha[11]*favg[14]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[13]+148.492424049175*favg[3]*alpha[11]+132.815661727072*alpha[1]*favg[10]+148.492424049175*favg[6]*alpha[7]+132.815661727072*alpha[4]*favg[5]); 
  Ghat[18] = 2.380952380952381e-4*((2571.964229922338*(fr[46]+fl[46])-1484.92424049175*fr[40]+1484.92424049175*fl[40])*amax+(474.3416490252571*alpha[8]+664.0783086353599*alpha[7]+742.462120245875*alpha[0])*favg[18]+593.9696961967002*alpha[4]*favg[17]+742.462120245875*alpha[1]*favg[14]+favg[10]*(593.9696961967002*alpha[11]+664.0783086353599*alpha[2])+742.462120245875*favg[5]*alpha[8]+664.0783086353599*alpha[4]*favg[6]); 
  Ghat[19] = 0.01863389981249824*((32.86335345030997*(fr[47]+fl[47])-18.97366596101028*fr[43]+18.97366596101028*fl[43])*amax+(8.485281374238571*(alpha[8]+alpha[7])+9.48683298050514*alpha[0])*favg[19]+9.48683298050514*alpha[1]*favg[16]+(8.485281374238571*alpha[11]+9.48683298050514*alpha[2])*favg[15]+9.48683298050514*alpha[4]*favg[9]); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_x; 
  incr[1] = -1.224744871391589*Ghat[0]*dfac_x; 
  incr[2] = 0.7071067811865475*Ghat[1]*dfac_x; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_x; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_x; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_x; 
  incr[6] = -1.224744871391589*Ghat[2]*dfac_x; 
  incr[7] = 0.7071067811865475*Ghat[4]*dfac_x; 
  incr[8] = -1.224744871391589*Ghat[3]*dfac_x; 
  incr[9] = 0.7071067811865475*Ghat[5]*dfac_x; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_x; 
  incr[11] = 1.58113883008419*Ghat[0]*dfac_x; 
  incr[12] = 0.7071067811865475*Ghat[7]*dfac_x; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_x; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_x; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_x; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_x; 
  incr[17] = -1.224744871391589*Ghat[6]*dfac_x; 
  incr[18] = 0.7071067811865475*Ghat[10]*dfac_x; 
  incr[19] = 1.58113883008419*Ghat[1]*dfac_x; 
  incr[20] = -1.224744871391589*Ghat[7]*dfac_x; 
  incr[21] = 1.58113883008419*Ghat[2]*dfac_x; 
  incr[22] = 0.7071067811865475*Ghat[11]*dfac_x; 
  incr[23] = -1.224744871391589*Ghat[8]*dfac_x; 
  incr[24] = 0.7071067811865475*Ghat[12]*dfac_x; 
  incr[25] = 1.58113883008419*Ghat[3]*dfac_x; 
  incr[26] = 0.7071067811865475*Ghat[13]*dfac_x; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_x; 
  incr[28] = -1.224744871391589*Ghat[9]*dfac_x; 
  incr[29] = 0.7071067811865475*Ghat[15]*dfac_x; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_x; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_x; 
  incr[32] = 1.58113883008419*Ghat[4]*dfac_x; 
  incr[33] = -1.224744871391589*Ghat[11]*dfac_x; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_x; 
  incr[35] = 1.58113883008419*Ghat[5]*dfac_x; 
  incr[36] = -1.224744871391589*Ghat[13]*dfac_x; 
  incr[37] = 1.58113883008419*Ghat[6]*dfac_x; 
  incr[38] = 0.7071067811865475*Ghat[17]*dfac_x; 
  incr[39] = -1.224744871391589*Ghat[14]*dfac_x; 
  incr[40] = 0.7071067811865475*Ghat[18]*dfac_x; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_x; 
  incr[42] = -1.224744871391589*Ghat[16]*dfac_x; 
  incr[43] = 0.7071067811865475*Ghat[19]*dfac_x; 
  incr[44] = 1.58113883008419*Ghat[10]*dfac_x; 
  incr[45] = -1.224744871391589*Ghat[17]*dfac_x; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_x; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_x; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += -1.0*incr[7]; 
  outl[8] += incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += -1.0*incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += -1.0*incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += -1.0*incr[43]; 
  outl[44] += -1.0*incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Y_P2_Bvars_1(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = (0.008333333333333333*(dfac_v2*(wv*(30.0*BdriftY[0]*m_*wv+((-1.0*(58.09475019311126*BmagInv[0]*Apar[7]+5.196152422706631*BmagInv[1]*(11.18033988749895*Apar[4]-19.36491673103708*Apar[6])+5.0*BmagInv[0]*(5.196152422706631*Apar[1]-9.0*Apar[3]))*dfac_x)+33.54101966249684*BdriftY[1]*Apar[7]+6.708203932499369*(5.0*BdriftY[0]*Apar[5]-3.872983346207417*BdriftY[4]*Apar[6])+5.0*(3.0*Apar[4]*BdriftY[4]-5.196152422706631*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])+3.0*(Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0])))*q_)+dfac_x*(5.196152422706631*(11.18033988749895*BmagInv[1]*Bmag[4]+5.0*BmagInv[0]*Bmag[1])*wm+(58.09475019311126*BmagInv[0]*Phi[7]+5.196152422706631*BmagInv[1]*(11.18033988749895*Phi[4]-19.36491673103708*Phi[6])+5.0*BmagInv[0]*(5.196152422706631*Phi[1]-9.0*Phi[3]))*q_))+10.0*BdriftY[0]*m_))/(dfac_v2*q_); 

  double alpha[20]; 
  alpha[0] = (0.04714045207910316*(dfac_v2*(30.0*BdriftY[0]*m_*wv2+(((-58.09475019311126*BmagInv[0]*Apar[7])+BmagInv[1]*(100.6230589874905*Apar[6]-58.09475019311126*Apar[4])+BmagInv[0]*(45.0*Apar[3]-25.98076211353316*Apar[1]))*dfac_x+33.54101966249684*BdriftY[1]*Apar[7]-25.98076211353316*BdriftY[4]*Apar[6]+33.54101966249685*BdriftY[0]*Apar[5]+15.0*Apar[4]*BdriftY[4]-25.98076211353316*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])+15.0*(Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0]))*q_*wv+dfac_x*((58.09475019311126*BmagInv[1]*Bmag[4]+25.98076211353316*BmagInv[0]*Bmag[1])*wm+(58.09475019311126*BmagInv[0]*Phi[7]+BmagInv[1]*(58.09475019311126*Phi[4]-100.6230589874905*Phi[6])+BmagInv[0]*(25.98076211353316*Phi[1]-45.0*Phi[3]))*q_))+10.0*BdriftY[0]*m_))/(dfac_v2*q_); 
  alpha[1] = (0.04714045207910316*(dfac_v2*(30.0*BdriftY[1]*m_*wv2+(((-58.09475019311126*BmagInv[1]*Apar[7])+(90.0*BmagInv[4]+100.6230589874905*BmagInv[0])*Apar[6]+Apar[4]*((-51.96152422706631*BmagInv[4])-58.09475019311126*BmagInv[0])+BmagInv[1]*(45.0*Apar[3]-25.98076211353316*Apar[1]))*dfac_x+(30.0*BdriftY[4]+33.54101966249684*BdriftY[0])*Apar[7]+BdriftY[1]*(33.54101966249685*Apar[5]-23.2379000772445*Apar[6])+(13.41640786499874*Apar[1]-23.2379000772445*Apar[3])*BdriftY[4]+13.41640786499874*BdriftY[1]*Apar[4]-25.98076211353316*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])+15.0*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1]))*q_*wv+dfac_x*((Bmag[4]*(51.96152422706631*BmagInv[4]+58.09475019311126*BmagInv[0])+25.98076211353316*Bmag[1]*BmagInv[1])*wm+(58.09475019311126*BmagInv[1]*Phi[7]+((-90.0*BmagInv[4])-100.6230589874905*BmagInv[0])*Phi[6]+(51.96152422706631*BmagInv[4]+58.09475019311126*BmagInv[0])*Phi[4]+BmagInv[1]*(25.98076211353316*Phi[1]-45.0*Phi[3]))*q_))+10.0*BdriftY[1]*m_))/(dfac_v2*q_); 
  alpha[2] = (0.02721655269759087*(60.0*BdriftY[0]*m_*wv+(((-58.09475019311126*BmagInv[0]*Apar[7])+BmagInv[1]*(100.6230589874905*Apar[6]-58.09475019311126*Apar[4])+BmagInv[0]*(45.0*Apar[3]-25.98076211353316*Apar[1]))*dfac_x+33.54101966249684*BdriftY[1]*Apar[7]-25.98076211353316*BdriftY[4]*Apar[6]+33.54101966249685*BdriftY[0]*Apar[5]+15.0*Apar[4]*BdriftY[4]-25.98076211353316*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])+15.0*(Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0]))*q_))/(dfac_v*q_); 
  alpha[3] = (0.7071067811865475*(2.23606797749979*BmagInv[1]*Bmag[4]+BmagInv[0]*Bmag[1])*dfac_x)/(dfac_m*q_); 
  alpha[4] = (0.04714045207910316*(34.64101615137754*BdriftY[1]*m_*wv+(((-33.54101966249684*BmagInv[1]*Apar[7])+(51.96152422706632*BmagInv[4]+58.09475019311126*BmagInv[0])*Apar[6]+Apar[4]*((-30.0*BmagInv[4])-33.54101966249685*BmagInv[0])+BmagInv[1]*(25.98076211353316*Apar[3]-15.0*Apar[1]))*dfac_x+(17.32050807568877*BdriftY[4]+19.36491673103708*BdriftY[0])*Apar[7]+BdriftY[1]*(19.36491673103709*Apar[5]-13.41640786499874*Apar[6])+(7.745966692414834*Apar[1]-13.41640786499874*Apar[3])*BdriftY[4]+7.745966692414834*BdriftY[1]*Apar[4]-15.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])+8.660254037844386*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1]))*q_))/(dfac_v*q_); 
  alpha[5] = (0.7071067811865475*(Bmag[4]*(2.0*BmagInv[4]+2.23606797749979*BmagInv[0])+Bmag[1]*BmagInv[1])*dfac_x)/(dfac_m*q_); 
  alpha[7] = (0.006734350297014738*(dfac_v2*(210.0*BdriftY[4]*m_*wv2+(((-406.6632513517788*BmagInv[4]*Apar[7])+629.9999999999999*BmagInv[1]*Apar[6]+(315.0*Apar[3]-181.8653347947321*Apar[1])*BmagInv[4]-363.7306695894642*BmagInv[1]*Apar[4])*dfac_x+210.0*BdriftY[1]*Apar[7]+((-116.1895003862225*BdriftY[4])-181.8653347947321*BdriftY[0])*Apar[6]+BdriftY[4]*(234.787137637478*Apar[5]+67.0820393249937*Apar[4]-181.8653347947321*Apar[2]+105.0*Apar[0])+105.0*BdriftY[0]*Apar[4]+BdriftY[1]*(93.91485505499116*Apar[1]-162.6653005407115*Apar[3]))*q_*wv+dfac_x*((181.8653347947321*Bmag[1]*BmagInv[4]+363.7306695894642*BmagInv[1]*Bmag[4])*wm+(406.6632513517788*BmagInv[4]*Phi[7]+BmagInv[1]*(363.7306695894642*Phi[4]-629.9999999999999*Phi[6])+(181.8653347947321*Phi[1]-315.0*Phi[3])*BmagInv[4])*q_))+70.0*BdriftY[4]*m_))/(dfac_v2*q_); 
  alpha[8] = (0.421637021355784*BdriftY[0]*m_)/(dfac_v2*q_); 
  alpha[11] = (0.00869400884928835*(187.8297101099823*BdriftY[4]*m_*wv+(((-181.8653347947321*BmagInv[4]*Apar[7])+281.7445651649734*BmagInv[1]*Apar[6]+(140.8722825824867*Apar[3]-81.33265027035574*Apar[1])*BmagInv[4]-162.6653005407115*BmagInv[1]*Apar[4])*dfac_x+93.91485505499116*BdriftY[1]*Apar[7]+((-51.96152422706632*BdriftY[4])-81.33265027035576*BdriftY[0])*Apar[6]+BdriftY[4]*(105.0*Apar[5]+30.0*Apar[4]-81.33265027035574*Apar[2]+46.95742752749558*Apar[0])+46.95742752749558*BdriftY[0]*Apar[4]+BdriftY[1]*(42.0*Apar[1]-72.74613391789283*Apar[3]))*q_))/(dfac_v*q_); 
  alpha[12] = (0.4216370213557841*BdriftY[1]*m_)/(dfac_v2*q_); 
  alpha[13] = (0.04714045207910316*(15.0*Bmag[1]*BmagInv[4]+30.0*BmagInv[1]*Bmag[4])*dfac_x)/(dfac_m*q_); 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[12]+fl[12])+1.732050807568877*(fl[2]-1.0*fr[2])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[20]+fl[20])+3.0*(fl[5]-1.0*fr[5]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[22]+fl[22])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[3]+fl[3])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[26]+fl[26])+3.0*(fl[9]-1.0*fr[9]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[33]+fl[33])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[6]+fl[6]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[36]+fl[36])+1.732050807568877*(fl[16]-1.0*fr[16])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[38]+fl[38])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[10]+fl[10]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[19]-1.0*(8.660254037844387*fl[19]+5.0*(fr[11]+fl[11]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[24]-1.0*(8.660254037844387*fl[24]+5.0*(fr[13]+fl[13]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[29]-1.0*(8.660254037844387*fl[29]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[45]+fl[45])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[17]+fl[17])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[32]-1.0*(8.660254037844387*fl[32]+5.0*(fr[21]+fl[21]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[34]-1.0*(8.660254037844387*fl[34]+5.0*(fr[23]+fl[23]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[35]-1.0*(8.660254037844387*fl[35]+5.0*(fr[25]+fl[25]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[40]-1.0*(8.660254037844387*fl[40]+5.0*(fr[27]+fl[27]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[41]-1.0*(8.660254037844387*fl[41]+5.0*(fr[28]+fl[28]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[43]-1.0*(8.660254037844387*fl[43]+5.0*(fr[30]+fl[30]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[44]-1.0*(8.660254037844387*fl[44]+5.0*(fr[37]+fl[37]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[46]-1.0*(8.660254037844387*fl[46]+5.0*(fr[39]+fl[39]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[42]+fl[42]))); 

  Ghat[0] = -0.125*((6.324555320336761*fr[12]-6.324555320336761*fl[12]-4.898979485566357*(fr[2]+fl[2])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[13]*favg[13]+alpha[12]*favg[12]+alpha[11]*favg[11]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[3]*favg[3]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[20]-94.8683298050514*fl[20]-73.48469228349535*(fr[5]+fl[5])+42.42640687119286*fr[1]-42.42640687119286*fl[1])*amax-18.97366596101028*(alpha[5]*favg[13]+favg[5]*alpha[13])-21.21320343559643*(alpha[8]*favg[12]+favg[8]*alpha[12])-18.97366596101028*(alpha[4]*favg[11]+favg[4]*alpha[11]+alpha[1]*favg[7]+favg[1]*alpha[7])-21.21320343559643*(alpha[3]*favg[5]+favg[3]*alpha[5]+alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[22]-94.8683298050514*fl[22]-73.48469228349535*(fr[7]+fl[7])+42.42640687119286*fr[3]-42.42640687119286*fl[3])*amax-21.21320343559643*alpha[13]*favg[17]-18.97366596101028*(alpha[4]*favg[12]+favg[4]*alpha[12])-21.21320343559643*(alpha[7]*favg[11]+favg[7]*alpha[11])-21.21320343559643*alpha[5]*favg[10]-18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])-21.21320343559643*(alpha[3]*favg[6]+alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.008333333333333333*((94.8683298050514*fr[26]-94.8683298050514*fl[26]-73.48469228349535*(fr[9]+fl[9])+42.42640687119286*fr[4]-42.42640687119286*fl[4])*amax-21.21320343559643*(alpha[12]*favg[18]+alpha[11]*favg[17])-18.97366596101028*alpha[5]*favg[15]-21.21320343559643*(alpha[8]*favg[14]+alpha[7]*favg[13]+favg[7]*alpha[13])-21.21320343559643*alpha[4]*favg[10]-18.97366596101028*alpha[3]*favg[9]-21.21320343559643*(alpha[2]*favg[6]+alpha[1]*favg[5]+favg[1]*alpha[5]+alpha[0]*favg[3]+favg[0]*alpha[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[33]-94.86832980505142*fl[33]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[6]-42.42640687119286*fl[6])*amax-18.97366596101028*(alpha[5]*favg[17]+favg[10]*alpha[13])+((-16.97056274847715*alpha[11])-18.97366596101028*alpha[2])*favg[12]+((-16.97056274847715*favg[11])-18.97366596101028*favg[2])*alpha[12]-18.97366596101028*(alpha[1]*favg[11]+favg[1]*alpha[11])-21.21320343559643*alpha[3]*favg[10]-18.97366596101028*(alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7])-21.21320343559643*(alpha[5]*favg[6]+alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -0.008333333333333333*((94.86832980505142*fr[36]-94.86832980505142*fl[36]-73.48469228349535*(fr[16]+fl[16])+42.42640687119286*fr[8]-42.42640687119286*fl[8])*amax-21.21320343559643*alpha[8]*favg[18]-18.97366596101028*alpha[4]*favg[17]+((-16.97056274847715*alpha[13])-18.97366596101028*alpha[3])*favg[15]-21.21320343559643*alpha[12]*favg[14]-18.97366596101028*(alpha[1]*favg[13]+favg[1]*alpha[13])+favg[10]*((-18.97366596101028*alpha[11])-21.21320343559643*alpha[2])-18.97366596101028*(alpha[5]*(favg[9]+favg[7])+favg[5]*alpha[7])-21.21320343559643*(alpha[4]*favg[6]+alpha[0]*favg[5]+favg[0]*alpha[5]+alpha[1]*favg[3]+favg[1]*alpha[3])); 
  Ghat[6] = -0.008333333333333333*((94.86832980505142*fr[38]-94.86832980505142*fl[38]-73.48469228349535*(fr[18]+fl[18])+42.42640687119286*fr[10]-42.42640687119286*fl[10])*amax-18.97366596101028*(alpha[5]*favg[19]+alpha[4]*favg[18])-21.21320343559643*alpha[7]*favg[17]-18.97366596101028*(alpha[3]*favg[16]+alpha[2]*favg[14])-21.21320343559643*(alpha[11]*favg[13]+favg[11]*alpha[13])+favg[10]*((-18.97366596101028*alpha[12])-21.21320343559643*alpha[1])-18.97366596101028*favg[6]*alpha[8]-21.21320343559643*(alpha[0]*favg[6]+alpha[4]*favg[5]+favg[4]*alpha[5]+alpha[2]*favg[3]+favg[2]*alpha[3])); 
  Ghat[7] = 0.001190476190476191*((514.3928459844675*(fr[19]+fl[19])-296.98484809835*fr[11]+296.98484809835*fl[11])*amax+(94.86832980505142*alpha[13]+148.492424049175*alpha[3])*favg[13]+148.492424049175*favg[3]*alpha[13]+132.815661727072*alpha[12]*favg[12]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[11]+148.492424049175*favg[2]*alpha[11]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[7]+148.492424049175*favg[0]*alpha[7]+132.815661727072*(alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.001190476190476191*((514.3928459844675*(fr[24]+fl[24])-296.98484809835*fr[13]+296.98484809835*fl[13])*amax+148.492424049175*(alpha[5]*favg[18]+alpha[3]*favg[14])+(94.86832980505142*alpha[12]+148.492424049175*alpha[1])*favg[12]+148.492424049175*favg[1]*alpha[12]+132.815661727072*alpha[11]*favg[11]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[8]+148.492424049175*favg[0]*alpha[8]+132.815661727072*(alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.00116461873828114*((525.8136552049599*(fr[29]+fl[29])-303.5786553761646*fr[14]+303.5786553761646*fl[14])*amax+151.7893276880823*(alpha[4]*favg[19]+alpha[2]*favg[16])+(82.15838362577493*alpha[5]+151.7893276880823*alpha[1])*favg[15]+135.7645019878172*alpha[13]*favg[13]+151.7893276880823*alpha[0]*favg[9]+135.7645019878172*(alpha[5]*favg[5]+alpha[3]*favg[3])); 
  Ghat[10] = -0.002886751345948129*((273.8612787525831*fr[45]-273.8612787525831*fl[45]-212.1320343559643*(fr[31]+fl[31])+122.4744871391589*fr[17]-122.4744871391589*fl[17])*amax+((-48.98979485566359*alpha[13])-54.77225575051663*alpha[3])*favg[19]+((-48.98979485566359*alpha[11])-54.77225575051663*alpha[2])*favg[18]+((-48.98979485566359*alpha[12])-54.77225575051663*alpha[1])*favg[17]-54.77225575051663*(alpha[5]*favg[16]+alpha[4]*(favg[14]+favg[13])+favg[4]*alpha[13]+favg[6]*alpha[12]+alpha[5]*favg[11]+favg[5]*alpha[11])+((-54.77225575051663*(alpha[8]+alpha[7]))-61.23724356957945*alpha[0])*favg[10]-61.23724356957945*(alpha[1]*favg[6]+alpha[2]*favg[5]+favg[2]*alpha[5]+alpha[3]*favg[4]+favg[3]*alpha[4])); 
  Ghat[11] = 0.001190476190476191*((514.3928459844675*(fr[32]+fl[32])-296.98484809835*fr[21]+296.98484809835*fl[21])*amax+(94.86832980505142*alpha[13]+148.492424049175*alpha[3])*favg[17]+148.492424049175*favg[6]*alpha[13]+118.79393923934*(alpha[4]*favg[12]+favg[4]*alpha[12])+(132.815661727072*alpha[8]+94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[11]+(132.815661727072*favg[8]+94.86832980505142*favg[7]+148.492424049175*favg[0])*alpha[11]+132.815661727072*alpha[5]*favg[10]+148.492424049175*(alpha[2]*favg[7]+favg[2]*alpha[7])+132.815661727072*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 9.221388919541468e-4*((664.0783086353599*(fr[34]+fl[34])-383.4057902536164*fr[23]+383.4057902536164*fl[23])*amax+(171.4642819948225*alpha[13]+191.7028951268082*alpha[3])*favg[18]+191.7028951268082*alpha[5]*favg[14]+(122.474487139159*alpha[8]+171.4642819948225*alpha[7]+191.7028951268082*alpha[0])*favg[12]+(122.474487139159*favg[8]+171.4642819948225*favg[7]+191.7028951268082*favg[0])*alpha[12]+153.3623161014466*(alpha[4]*favg[11]+favg[4]*alpha[11])+191.7028951268082*(alpha[1]*favg[8]+favg[1]*alpha[8])+171.4642819948225*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 0.001190476190476191*((514.3928459844675*(fr[35]+fl[35])-296.98484809835*fr[25]+296.98484809835*fl[25])*amax+132.815661727072*alpha[12]*favg[18]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[17]+118.79393923934*alpha[5]*favg[15]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[13]+(132.815661727072*favg[9]+94.86832980505142*favg[7]+148.492424049175*favg[0])*alpha[13]+148.492424049175*favg[6]*alpha[11]+132.815661727072*alpha[4]*favg[10]+148.492424049175*(alpha[3]*favg[7]+favg[3]*alpha[7])+132.815661727072*(alpha[1]*favg[5]+favg[1]*alpha[5])); 
  Ghat[14] = 0.001190476190476191*((514.3928459844675*(fr[40]+fl[40])-296.98484809835*fr[27]+296.98484809835*fl[27])*amax+(94.86832980505142*alpha[12]+148.492424049175*alpha[1])*favg[18]+132.815661727072*alpha[11]*favg[17]+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[14]+148.492424049175*(alpha[5]*favg[12]+favg[5]*alpha[12])+132.815661727072*alpha[4]*favg[10]+148.492424049175*(alpha[3]*favg[8]+favg[3]*alpha[8])+132.815661727072*alpha[2]*favg[6]); 
  Ghat[15] = 0.006454972243679028*((94.86832980505142*(fr[41]+fl[41])-54.77225575051663*fr[28]+54.77225575051663*fl[28])*amax+(24.49489742783179*alpha[11]+27.38612787525831*alpha[2])*favg[19]+27.38612787525831*alpha[4]*favg[16]+(24.49489742783179*alpha[7]+27.38612787525831*alpha[0])*favg[15]+21.90890230020666*(alpha[5]*favg[13]+favg[5]*alpha[13])+27.38612787525831*alpha[1]*favg[9]+24.49489742783179*(alpha[3]*favg[5]+favg[3]*alpha[5])); 
  Ghat[16] = 0.006454972243679028*((94.86832980505142*(fr[43]+fl[43])-54.77225575051663*fr[30]+54.77225575051663*fl[30])*amax+(24.49489742783179*alpha[12]+27.38612787525831*alpha[1])*favg[19]+24.49489742783179*alpha[13]*favg[17]+(24.49489742783179*alpha[8]+27.38612787525831*alpha[0])*favg[16]+27.38612787525831*alpha[4]*favg[15]+24.49489742783179*alpha[5]*favg[10]+27.38612787525831*alpha[2]*favg[9]+24.49489742783179*alpha[3]*favg[6]); 
  Ghat[17] = 2.380952380952381e-4*((2571.964229922338*(fr[44]+fl[44])-1484.92424049175*fr[37]+1484.92424049175*fl[37])*amax+593.9696961967002*(alpha[5]*favg[19]+alpha[4]*favg[18])+(664.0783086353599*alpha[8]+474.3416490252571*alpha[7]+742.462120245875*alpha[0])*favg[17]+664.0783086353599*(alpha[13]*favg[16]+alpha[11]*favg[14])+(474.3416490252571*alpha[11]+742.462120245875*alpha[2])*favg[13]+(474.3416490252571*favg[11]+742.462120245875*favg[2])*alpha[13]+593.9696961967002*favg[10]*alpha[12]+742.462120245875*(alpha[3]*favg[11]+favg[3]*alpha[11])+664.0783086353599*alpha[1]*favg[10]+742.462120245875*favg[6]*alpha[7]+664.0783086353599*(alpha[4]*favg[5]+favg[4]*alpha[5])); 
  Ghat[18] = 2.380952380952381e-4*((2571.964229922338*(fr[46]+fl[46])-1484.92424049175*fr[39]+1484.92424049175*fl[39])*amax+(474.3416490252571*alpha[8]+664.0783086353599*alpha[7]+742.462120245875*alpha[0])*favg[18]+593.9696961967002*alpha[4]*favg[17]+(474.3416490252571*alpha[12]+742.462120245875*alpha[1])*favg[14]+664.0783086353599*(alpha[12]*favg[13]+favg[12]*alpha[13])+742.462120245875*(alpha[3]*favg[12]+favg[3]*alpha[12])+favg[10]*(593.9696961967002*alpha[11]+664.0783086353599*alpha[2])+742.462120245875*(alpha[5]*favg[8]+favg[5]*alpha[8])+664.0783086353599*alpha[4]*favg[6]); 
  Ghat[19] = 0.001666666666666667*((367.4234614174769*(fr[47]+fl[47])-212.1320343559643*fr[42]+212.1320343559643*fl[42])*amax+(94.86832980505142*(alpha[8]+alpha[7])+106.0660171779821*alpha[0])*favg[19]+84.85281374238573*alpha[5]*favg[17]+(94.86832980505142*alpha[12]+106.0660171779822*alpha[1])*favg[16]+(94.86832980505142*alpha[11]+106.0660171779822*alpha[2])*favg[15]+favg[10]*(84.85281374238573*alpha[13]+94.86832980505142*alpha[3])+106.0660171779821*alpha[4]*favg[9]+94.86832980505142*alpha[5]*favg[6]); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_y; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_y; 
  incr[2] = -1.224744871391589*Ghat[0]*dfac_y; 
  incr[3] = 0.7071067811865475*Ghat[2]*dfac_y; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_y; 
  incr[5] = -1.224744871391589*Ghat[1]*dfac_y; 
  incr[6] = 0.7071067811865475*Ghat[4]*dfac_y; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_y; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_y; 
  incr[9] = -1.224744871391589*Ghat[3]*dfac_y; 
  incr[10] = 0.7071067811865475*Ghat[6]*dfac_y; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_y; 
  incr[12] = 1.58113883008419*Ghat[0]*dfac_y; 
  incr[13] = 0.7071067811865475*Ghat[8]*dfac_y; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_y; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_y; 
  incr[16] = -1.224744871391589*Ghat[5]*dfac_y; 
  incr[17] = 0.7071067811865475*Ghat[10]*dfac_y; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_y; 
  incr[19] = -1.224744871391589*Ghat[7]*dfac_y; 
  incr[20] = 1.58113883008419*Ghat[1]*dfac_y; 
  incr[21] = 0.7071067811865475*Ghat[11]*dfac_y; 
  incr[22] = 1.58113883008419*Ghat[2]*dfac_y; 
  incr[23] = 0.7071067811865475*Ghat[12]*dfac_y; 
  incr[24] = -1.224744871391589*Ghat[8]*dfac_y; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_y; 
  incr[26] = 1.58113883008419*Ghat[3]*dfac_y; 
  incr[27] = 0.7071067811865475*Ghat[14]*dfac_y; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_y; 
  incr[29] = -1.224744871391589*Ghat[9]*dfac_y; 
  incr[30] = 0.7071067811865475*Ghat[16]*dfac_y; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_y; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_y; 
  incr[33] = 1.58113883008419*Ghat[4]*dfac_y; 
  incr[34] = -1.224744871391589*Ghat[12]*dfac_y; 
  incr[35] = -1.224744871391589*Ghat[13]*dfac_y; 
  incr[36] = 1.58113883008419*Ghat[5]*dfac_y; 
  incr[37] = 0.7071067811865475*Ghat[17]*dfac_y; 
  incr[38] = 1.58113883008419*Ghat[6]*dfac_y; 
  incr[39] = 0.7071067811865475*Ghat[18]*dfac_y; 
  incr[40] = -1.224744871391589*Ghat[14]*dfac_y; 
  incr[41] = -1.224744871391589*Ghat[15]*dfac_y; 
  incr[42] = 0.7071067811865475*Ghat[19]*dfac_y; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_y; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_y; 
  incr[45] = 1.58113883008419*Ghat[10]*dfac_y; 
  incr[46] = -1.224744871391589*Ghat[18]*dfac_y; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_y; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += incr[2]; 
  outl[3] += -1.0*incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += incr[5]; 
  outl[6] += -1.0*incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += incr[9]; 
  outl[10] += -1.0*incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += incr[16]; 
  outl[17] += -1.0*incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += -1.0*incr[21]; 
  outl[22] += -1.0*incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += incr[29]; 
  outl[30] += -1.0*incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += -1.0*incr[33]; 
  outl[34] += incr[34]; 
  outl[35] += incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += -1.0*incr[37]; 
  outl[38] += -1.0*incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += incr[40]; 
  outl[41] += incr[41]; 
  outl[42] += -1.0*incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += -1.0*incr[45]; 
  outl[46] += incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
double EmGyrokineticSurf2x2vSer_Vpar_P2_Bvars_1(const double q_, const double m_, const double cflL, const double cflR, const double *w, const double *dxv, const double amax_in, const double *Bmag, const double *BmagInv, const double *Gradpar, const double *BdriftX, const double *BdriftY, const double *Phi, const double *Apar, const double *dApardt, const double *dApardtPrev, const double *fl, const double *fr, double *outl, double *outr, double *emModL, double *emModR) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double incr[48]; 
  // surface-averaged phase velocity in this direction 
  double alpha0 = -(0.001785714285714286*(7.0*(2.0*dfac_v*m_*(1.732050807568877*(11.18033988749895*BdriftX[1]*Bmag[4]+5.0*BdriftX[0]*Bmag[1])*dfac_x*wm+((8.660254037844387*BdriftY[4]*Phi[6]+8.660254037844386*(BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2]))*dfac_y+1.732050807568877*(11.18033988749895*BdriftX[1]*Phi[4]+5.0*BdriftX[0]*Phi[1])*dfac_x)*q_)*wv+dfac_x*(dfac_v*((15.0*(Bmag[1]*BmagInv[4]+2.0*BmagInv[1]*Bmag[4])*Apar[6]+3.0*(Bmag[4]*(10.0*Apar[3]*BmagInv[4]+11.18033988749895*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))+5.0*Bmag[1]*(BmagInv[1]*Apar[3]+BmagInv[0]*Apar[2])))*dfac_y+1.732050807568877*((10.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+11.18033988749895*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Bmag[4]+5.0*Bmag[1]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])))*q_-3.464101615137754*(11.18033988749895*BdriftX[1]*Bmag[4]+5.0*BdriftX[0]*Bmag[1])*m_)*wm)+q_*(dfac_v*((7.0*((17.32050807568877*BdriftY[1]*Apar[6]+3.872983346207417*(4.47213595499958*Apar[3]*BdriftY[4]+5.0*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])))*Phi[7]-1.0*((3.0*(22.3606797749979*BmagInv[4]+25.0*BmagInv[0])*Apar[6]+33.54101966249684*BmagInv[1]*Apar[3])*Phi[7]-1.0*(3.0*(22.3606797749979*BmagInv[4]+25.0*BmagInv[0])*Phi[6]+33.54101966249684*BmagInv[1]*Phi[3])*Apar[7]+15.0*((5.0*BmagInv[1]*Phi[5]-1.0*(2.0*BmagInv[1]*Phi[4]+Phi[1]*BmagInv[4]))*Apar[6]-1.0*(5.0*BmagInv[1]*Apar[5]-1.0*(Apar[1]*BmagInv[4]+2.0*BmagInv[1]*Apar[4]))*Phi[6])+3.0*(11.18033988749895*BmagInv[0]*Apar[3]*Phi[5]-1.0*(11.18033988749895*BmagInv[0]*Phi[3]*Apar[5]+(10.0*Apar[3]*BmagInv[4]+11.18033988749895*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*Phi[4]-1.0*Apar[4]*(10.0*Phi[3]*BmagInv[4]+11.18033988749895*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])))+5.0*(BmagInv[1]*(Apar[1]*Phi[3]-1.0*Phi[1]*Apar[3])+BmagInv[0]*(Apar[1]*Phi[2]-1.0*Phi[1]*Apar[2]))))*dfac_x)+3.872983346207417*((10.0*Apar[4]+15.65247584249853*Apar[0])*BdriftY[4]+7.0*(2.23606797749979*BdriftY[0]*Apar[4]+2.0*Apar[1]*BdriftY[1]))*Phi[6]+7.0*(19.36491673103708*BdriftY[4]*Phi[5]*Apar[6]+1.732050807568877*(11.18033988749895*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])*Phi[5]+(5.0*Phi[2]*Apar[4]+4.47213595499958*Apar[1]*Phi[3])*BdriftY[4]+4.47213595499958*BdriftY[1]*Phi[3]*Apar[4]+5.0*((Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[3]+(Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0])*Phi[2]))))*dfac_y+7.0*(((8.660254037844386*BdriftX[1]*Apar[7]+8.660254037844387*BdriftX[0]*Apar[5])*Phi[7]+(17.32050807568877*BdriftX[1]*Apar[6]+3.872983346207417*(4.47213595499958*Apar[3]*BdriftX[4]+5.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])))*Phi[6]+8.660254037844387*Phi[3]*BdriftX[4]*Apar[6]+1.732050807568877*((10.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+11.18033988749895*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Phi[4]+5.0*(Phi[1]*Apar[4]*BdriftX[4]+(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[3]+(Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])*Phi[1])))*dfac_x+20.0*dApardt[0]))*q_-14.0*((8.660254037844387*BdriftY[4]*Phi[6]+8.660254037844386*(BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2]))*dfac_y+1.732050807568877*(11.18033988749895*BdriftX[1]*Phi[4]+5.0*BdriftX[0]*Phi[1])*dfac_x)*m_)))/(dfac_v*m_*q_); 

  double alpha[20]; 
  alpha[0] = -(0.01010152544552211*(dfac_v*m_*((271.1088342345192*BdriftX[1]*Bmag[4]+121.2435565298214*BdriftX[0]*Bmag[1])*dfac_x*wm+((121.2435565298214*BdriftY[4]*Phi[6]+121.2435565298214*(BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2]))*dfac_y+(271.1088342345192*BdriftX[1]*Phi[4]+121.2435565298214*BdriftX[0]*Phi[1])*dfac_x)*q_)*wv+dfac_x*(dfac_v*(((105.0*Bmag[1]*BmagInv[4]+210.0*BmagInv[1]*Bmag[4])*Apar[6]+Bmag[4]*(210.0*Apar[3]*BmagInv[4]+234.787137637478*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))+105.0*Bmag[1]*(BmagInv[1]*Apar[3]+BmagInv[0]*Apar[2]))*dfac_y+(121.2435565298214*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+135.5544171172596*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Bmag[4]+60.6217782649107*Bmag[1]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0]))*q_+((-271.1088342345192*BdriftX[1]*Bmag[4])-121.2435565298214*BdriftX[0]*Bmag[1])*m_)*wm+(((-121.2435565298214*BdriftY[4]*Phi[6])-121.2435565298214*(BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2]))*dfac_y+((-271.1088342345192*BdriftX[1]*Phi[4])-121.2435565298214*BdriftX[0]*Phi[1])*dfac_x)*m_*q_+dfac_v*((((((-469.5742752749559*BmagInv[4])-525.0*BmagInv[0])*Apar[6]-234.7871376374779*BmagInv[1]*Apar[3])*Phi[7]+((469.5742752749559*BmagInv[4]+525.0*BmagInv[0])*Phi[6]+234.7871376374779*BmagInv[1]*Phi[3])*Apar[7]+(525.0000000000001*BmagInv[1]*Apar[5]-105.0*Apar[1]*BmagInv[4]-210.0*BmagInv[1]*Apar[4])*Phi[6]+(BmagInv[1]*(210.0*Phi[4]-525.0000000000001*Phi[5])+105.0*Phi[1]*BmagInv[4])*Apar[6]+BmagInv[0]*(234.787137637478*Phi[3]*Apar[5]-234.787137637478*Apar[3]*Phi[5])+(210.0*Apar[3]*BmagInv[4]+234.787137637478*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*Phi[4]+Apar[4]*((-210.0*Phi[3]*BmagInv[4])-234.787137637478*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2]))+BmagInv[1]*(105.0*Phi[1]*Apar[3]-105.0*Apar[1]*Phi[3])+BmagInv[0]*(105.0*Phi[1]*Apar[2]-105.0*Apar[1]*Phi[2]))*dfac_x+(121.2435565298214*BdriftY[1]*Apar[6]+121.2435565298214*Apar[3]*BdriftY[4]+135.5544171172596*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*Phi[7]+((38.72983346207417*Apar[4]+60.62177826491071*Apar[0])*BdriftY[4]+60.62177826491071*BdriftY[0]*Apar[4]+54.22176684690384*Apar[1]*BdriftY[1])*Phi[6]+Phi[5]*(135.5544171172596*BdriftY[4]*Apar[6]+135.5544171172596*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2]))+(60.6217782649107*Phi[2]*Apar[4]+54.22176684690384*Apar[1]*Phi[3])*BdriftY[4]+54.22176684690384*BdriftY[1]*Phi[3]*Apar[4]+60.6217782649107*((Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[3]+(Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0])*Phi[2]))*dfac_y+((60.6217782649107*BdriftX[1]*Apar[7]+60.62177826491071*BdriftX[0]*Apar[5])*Phi[7]+(121.2435565298214*BdriftX[1]*Apar[6]+121.2435565298214*Apar[3]*BdriftX[4]+135.5544171172596*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*Phi[6]+60.62177826491071*Phi[3]*BdriftX[4]*Apar[6]+(121.2435565298214*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+135.5544171172596*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Phi[4]+60.6217782649107*(Phi[1]*Apar[4]*BdriftX[4]+(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[3]+(Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])*Phi[1]))*dfac_x+140.0*dApardt[0])*q2))/(dfac_v*m_*q_); 
  alpha[1] = -(0.01010152544552211*(dfac_v*m_*(((242.4871130596428*BdriftX[4]+271.1088342345192*BdriftX[0])*Bmag[4]+121.2435565298214*BdriftX[1]*Bmag[1])*dfac_x*wm+((108.4435336938077*(BdriftY[1]*Phi[6]+Phi[3]*BdriftY[4])+121.2435565298214*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2]))*dfac_y+((242.4871130596428*BdriftX[4]+271.1088342345192*BdriftX[0])*Phi[4]+121.2435565298214*BdriftX[1]*Phi[1])*dfac_x)*q_)*wv+dfac_x*(dfac_v*(((Bmag[4]*(368.9512162874653*BmagInv[4]+210.0*BmagInv[0])+93.91485505499116*Bmag[1]*BmagInv[1])*Apar[6]+(210.0*Apar[2]*Bmag[4]+93.91485505499116*Bmag[1]*Apar[3])*BmagInv[4]+(422.6168477474603*BmagInv[1]*Apar[3]+234.787137637478*BmagInv[0]*Apar[2])*Bmag[4]+105.0*Bmag[1]*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*dfac_y+((213.014084041408*Apar[4]+121.2435565298214*Apar[0])*BdriftX[4]+121.2435565298214*BdriftX[0]*Apar[4]+243.9979508110672*Apar[1]*BdriftX[1]+135.5544171172596*Apar[0]*BdriftX[0])*Bmag[4]+Bmag[1]*(54.22176684690384*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+60.6217782649107*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])))*q_+(((-242.4871130596428*BdriftX[4])-271.1088342345192*BdriftX[0])*Bmag[4]-121.2435565298214*BdriftX[1]*Bmag[1])*m_)*wm+(((-108.4435336938077*(BdriftY[1]*Phi[6]+Phi[3]*BdriftY[4]))-121.2435565298214*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2]))*dfac_y+(((-242.4871130596428*BdriftX[4])-271.1088342345192*BdriftX[0])*Phi[4]-121.2435565298214*BdriftX[1]*Phi[1])*dfac_x)*m_*q_+dfac_v*((((Apar[3]*((-210.0*BmagInv[4])-234.7871376374779*BmagInv[0])-945.0*BmagInv[1]*Apar[6])*Phi[7]+(945.0*BmagInv[1]*Phi[6]+Phi[3]*(210.0*BmagInv[4]+234.7871376374779*BmagInv[0]))*Apar[7]+((469.5742752749558*BmagInv[4]+525.0000000000001*BmagInv[0])*Apar[5]+Apar[4]*((-368.9512162874653*BmagInv[4])-210.0*BmagInv[0])-93.91485505499116*Apar[1]*BmagInv[1])*Phi[6]+(((-469.5742752749558*BmagInv[4])-525.0000000000001*BmagInv[0])*Phi[5]+(368.9512162874653*BmagInv[4]+210.0*BmagInv[0])*Phi[4]+93.91485505499116*BmagInv[1]*Phi[1])*Apar[6]+BmagInv[1]*(234.787137637478*Phi[3]*Apar[5]-234.787137637478*Apar[3]*Phi[5])+(210.0*Apar[2]*BmagInv[4]+422.6168477474603*BmagInv[1]*Apar[3]+234.787137637478*BmagInv[0]*Apar[2])*Phi[4]+((-210.0*Phi[2]*Apar[4])-93.91485505499116*Apar[1]*Phi[3]+93.91485505499116*Phi[1]*Apar[3])*BmagInv[4]+((-422.6168477474603*BmagInv[1]*Phi[3])-234.787137637478*BmagInv[0]*Phi[2])*Apar[4]+BmagInv[0]*(105.0*Phi[1]*Apar[3]-105.0*Apar[1]*Phi[3])+BmagInv[1]*(105.0*Phi[1]*Apar[2]-105.0*Apar[1]*Phi[2]))*dfac_x+((213.014084041408*BdriftY[4]+121.2435565298214*BdriftY[0])*Apar[6]+121.2435565298214*Apar[2]*BdriftY[4]+243.9979508110673*BdriftY[1]*Apar[3]+135.5544171172596*BdriftY[0]*Apar[2])*Phi[7]+(95.26279441628826*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4])+54.22176684690384*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1]))*Phi[6]+Phi[5]*(121.2435565298214*BdriftY[1]*Apar[6]+121.2435565298214*Apar[3]*BdriftY[4]+135.5544171172596*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))+(95.26279441628824*Phi[3]*Apar[4]+54.22176684690384*(Apar[0]*Phi[3]+Apar[1]*Phi[2]))*BdriftY[4]+54.22176684690384*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2])*Apar[4]+(109.1192008768392*Apar[1]*BdriftY[1]+60.6217782649107*Apar[0]*BdriftY[0])*Phi[3]+60.6217782649107*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[2])*dfac_y+(((54.22176684690384*BdriftX[4]+60.6217782649107*BdriftX[0])*Apar[7]+60.62177826491071*BdriftX[1]*Apar[5])*Phi[7]+((213.014084041408*BdriftX[4]+121.2435565298214*BdriftX[0])*Apar[6]+121.2435565298214*Apar[2]*BdriftX[4]+243.9979508110673*BdriftX[1]*Apar[3]+135.5544171172596*BdriftX[0]*Apar[2])*Phi[6]+54.22176684690384*BdriftX[1]*Phi[3]*Apar[6]+((213.014084041408*Apar[4]+121.2435565298214*Apar[0])*BdriftX[4]+121.2435565298214*BdriftX[0]*Apar[4]+243.9979508110672*Apar[1]*BdriftX[1]+135.5544171172596*Apar[0]*BdriftX[0])*Phi[4]+54.22176684690384*((Apar[3]*Phi[3]+Apar[1]*Phi[1])*BdriftX[4]+BdriftX[1]*Phi[1]*Apar[4])+60.6217782649107*((BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])*Phi[3]+(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[1]))*dfac_x+140.0*dApardt[1])*q2))/(dfac_v*m_*q_); 
  alpha[2] = -(0.01010152544552211*(dfac_v*(((271.1088342345192*BdriftY[1]*Phi[7]+271.1088342345192*BdriftY[0]*Phi[5])*dfac_y+(271.1088342345192*BdriftX[1]*Phi[6]+121.2435565298214*BdriftX[0]*Phi[3])*dfac_x)*m_*wv+dfac_x*(((Bmag[4]*(469.5742752749558*BmagInv[4]+525.0000000000001*BmagInv[0])+234.7871376374779*Bmag[1]*BmagInv[1])*Apar[7]+(525.0*BmagInv[1]*Bmag[4]+234.787137637478*BmagInv[0]*Bmag[1])*Apar[5])*dfac_y+(121.2435565298214*BdriftX[1]*Bmag[4]+60.62177826491071*Bmag[1]*BdriftX[4])*Apar[6]+(121.2435565298214*Apar[3]*BdriftX[4]+135.5544171172596*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*Bmag[4]+60.6217782649107*Bmag[1]*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2]))*wm+((((210.0*BmagInv[0]*Apar[5]+Apar[4]*((-469.5742752749558*BmagInv[4])-525.0000000000001*BmagInv[0])-234.7871376374779*Apar[1]*BmagInv[1])*Phi[7]+((-210.0*BmagInv[0]*Phi[5])+(469.5742752749558*BmagInv[4]+525.0000000000001*BmagInv[0])*Phi[4]+234.7871376374779*BmagInv[1]*Phi[1])*Apar[7]+(105.0*Apar[3]*BmagInv[4]+234.7871376374779*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*Phi[6]+((-105.0*Phi[3]*BmagInv[4])-234.7871376374779*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2]))*Apar[6]+((-525.0*BmagInv[1]*Apar[4])-234.787137637478*BmagInv[0]*Apar[1])*Phi[5]+(525.0*BmagInv[1]*Phi[4]+234.787137637478*BmagInv[0]*Phi[1])*Apar[5]+BmagInv[0]*(105.0*Apar[2]*Phi[3]-105.0*Phi[2]*Apar[3]))*dfac_x+((108.4435336938077*BdriftY[4]+121.2435565298214*BdriftY[0])*Apar[7]+121.2435565298214*(BdriftY[1]*Apar[5]+Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4])+135.5544171172596*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1]))*Phi[7]+121.2435565298214*BdriftY[1]*Phi[5]*Apar[7]+((38.72983346207418*BdriftY[4]+60.6217782649107*BdriftY[0])*Apar[6]+60.62177826491071*Apar[2]*BdriftY[4]+54.22176684690384*BdriftY[1]*Apar[3])*Phi[6]+(60.62177826491071*Phi[2]*BdriftY[4]+54.22176684690384*BdriftY[1]*Phi[3])*Apar[6]+(121.2435565298214*BdriftY[0]*Apar[5]+135.5544171172596*(Apar[4]*BdriftY[4]+Apar[1]*BdriftY[1]+Apar[0]*BdriftY[0]))*Phi[5]+54.22176684690384*Apar[3]*Phi[3]*BdriftY[4]+60.6217782649107*((BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[3]+Phi[2]*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2])))*dfac_y+(54.22176684690384*(BdriftX[4]*Apar[6]+BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[7]+((108.4435336938077*BdriftX[4]+121.2435565298214*BdriftX[0])*Phi[6]+54.22176684690384*BdriftX[1]*Phi[3])*Apar[7]+(121.2435565298214*(BdriftX[1]*Apar[5]+Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+135.5544171172596*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Phi[6]+(121.2435565298214*BdriftX[1]*Phi[4]+60.62177826491071*Phi[1]*BdriftX[4])*Apar[6]+54.22176684690384*BdriftX[0]*Phi[3]*Apar[5]+(121.2435565298214*Apar[3]*BdriftX[4]+135.5544171172596*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*Phi[4]+60.6217782649107*(Phi[3]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0])+Phi[1]*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])))*dfac_x+140.0*dApardt[2])*q_)+(((-271.1088342345192*BdriftY[1]*Phi[7])-271.1088342345192*BdriftY[0]*Phi[5])*dfac_y+((-271.1088342345192*BdriftX[1]*Phi[6])-121.2435565298214*BdriftX[0]*Phi[3])*dfac_x)*m_))/(dfac_v*m_); 
  alpha[3] = -(0.07071067811865474*dfac_x*(dfac_v*((22.3606797749979*BdriftX[1]*Bmag[4]+10.0*BdriftX[0]*Bmag[1])*m_*wv+(((8.660254037844387*Bmag[1]*BmagInv[4]+17.32050807568877*BmagInv[1]*Bmag[4])*Apar[6]+Bmag[4]*(17.32050807568877*Apar[3]*BmagInv[4]+19.36491673103709*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))+8.660254037844386*Bmag[1]*(BmagInv[1]*Apar[3]+BmagInv[0]*Apar[2]))*dfac_y+(10.0*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+11.18033988749895*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Bmag[4]+5.0*Bmag[1]*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0]))*q_)+((-22.3606797749979*BdriftX[1]*Bmag[4])-10.0*BdriftX[0]*Bmag[1])*m_))/(dfac_m*dfac_v*m_*q_); 
  alpha[4] = -(0.002020305089104421*(dfac_v*((((1212.435565298214*BdriftY[4]+1355.544171172596*BdriftY[0])*Phi[7]+1355.544171172596*BdriftY[1]*Phi[5])*dfac_y+((1212.435565298214*BdriftX[4]+1355.544171172596*BdriftX[0])*Phi[6]+606.217782649107*BdriftX[1]*Phi[3])*dfac_x)*m_*wv+dfac_x*(((1050.0*Bmag[1]*BmagInv[4]+4724.999999999999*BmagInv[1]*Bmag[4]+1173.93568818739*BmagInv[0]*Bmag[1])*Apar[7]+(Bmag[4]*(2347.87137637478*BmagInv[4]+2625.0*BmagInv[0])+1173.93568818739*Bmag[1]*BmagInv[1])*Apar[5])*dfac_y+((1065.07042020704*BdriftX[4]+606.2177826491072*BdriftX[0])*Bmag[4]+271.1088342345192*BdriftX[1]*Bmag[1])*Apar[6]+(606.217782649107*Apar[2]*BdriftX[4]+1219.989754055336*BdriftX[1]*Apar[3]+677.7720855862981*BdriftX[0]*Apar[2])*Bmag[4]+Bmag[1]*(271.1088342345192*Apar[3]*BdriftX[4]+303.1088913245535*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])))*wm+((((1050.0*BmagInv[1]*Apar[5]-1050.0*Apar[1]*BmagInv[4]-4724.999999999999*BmagInv[1]*Apar[4]-1173.93568818739*BmagInv[0]*Apar[1])*Phi[7]+(BmagInv[1]*(4724.999999999999*Phi[4]-1050.0*Phi[5])+Phi[1]*(1050.0*BmagInv[4]+1173.93568818739*BmagInv[0]))*Apar[7]+(1050.0*Apar[2]*BmagInv[4]+1643.509963462345*BmagInv[1]*Apar[3]+1173.93568818739*BmagInv[0]*Apar[2])*Phi[6]+((-1050.0*Phi[2]*BmagInv[4])-1643.509963462345*BmagInv[1]*Phi[3]-1173.93568818739*BmagInv[0]*Phi[2])*Apar[6]+(Apar[4]*((-2347.87137637478*BmagInv[4])-2625.0*BmagInv[0])-1173.93568818739*Apar[1]*BmagInv[1])*Phi[5]+((2347.87137637478*BmagInv[4]+2625.0*BmagInv[0])*Phi[4]+1173.93568818739*BmagInv[1]*Phi[1])*Apar[5]+BmagInv[1]*(525.0*Apar[2]*Phi[3]-525.0*Phi[2]*Apar[3]))*dfac_x+(1091.192008768392*BdriftY[1]*Apar[7]+(542.2176684690384*BdriftY[4]+606.2177826491072*BdriftY[0])*Apar[5]+(1065.07042020704*Apar[4]+606.2177826491072*Apar[0])*BdriftY[4]+606.2177826491072*BdriftY[0]*Apar[4]+1219.989754055337*Apar[1]*BdriftY[1]+677.772085586298*Apar[0]*BdriftY[0])*Phi[7]+(542.2176684690384*BdriftY[4]+606.2177826491072*BdriftY[0])*Phi[5]*Apar[7]+(476.3139720814412*BdriftY[1]*Apar[6]+476.3139720814414*Apar[3]*BdriftY[4]+271.1088342345192*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*Phi[6]+(476.3139720814414*Phi[3]*BdriftY[4]+271.1088342345192*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2]))*Apar[6]+(606.217782649107*(BdriftY[1]*Apar[5]+Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4])+677.7720855862981*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1]))*Phi[5]+271.1088342345192*(Apar[2]*Phi[3]+Phi[2]*Apar[3])*BdriftY[4]+(545.5960043841961*BdriftY[1]*Apar[3]+303.1088913245535*BdriftY[0]*Apar[2])*Phi[3]+303.1088913245535*Phi[2]*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*dfac_y+((242.4871130596428*BdriftX[1]*Apar[6]+242.4871130596428*Apar[3]*BdriftX[4]+271.1088342345192*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*Phi[7]+(1091.192008768392*BdriftX[1]*Phi[6]+Phi[3]*(242.4871130596428*BdriftX[4]+271.1088342345192*BdriftX[0]))*Apar[7]+((542.2176684690384*BdriftX[4]+606.2177826491072*BdriftX[0])*Apar[5]+(1065.07042020704*Apar[4]+606.2177826491072*Apar[0])*BdriftX[4]+606.2177826491072*BdriftX[0]*Apar[4]+1219.989754055337*Apar[1]*BdriftX[1]+677.772085586298*Apar[0]*BdriftX[0])*Phi[6]+((1065.07042020704*BdriftX[4]+606.2177826491072*BdriftX[0])*Phi[4]+271.1088342345192*BdriftX[1]*Phi[1])*Apar[6]+271.1088342345192*BdriftX[1]*Phi[3]*Apar[5]+(606.217782649107*Apar[2]*BdriftX[4]+1219.989754055336*BdriftX[1]*Apar[3]+677.7720855862981*BdriftX[0]*Apar[2])*Phi[4]+271.1088342345192*((Apar[1]*Phi[3]+Phi[1]*Apar[3])*BdriftX[4]+BdriftX[1]*Phi[3]*Apar[4])+303.1088913245535*((Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])*Phi[3]+Phi[1]*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])))*dfac_x+700.0*dApardt[3])*q_)+((((-1212.435565298214*BdriftY[4])-1355.544171172596*BdriftY[0])*Phi[7]-1355.544171172596*BdriftY[1]*Phi[5])*dfac_y+(((-1212.435565298214*BdriftX[4])-1355.544171172596*BdriftX[0])*Phi[6]-606.217782649107*BdriftX[1]*Phi[3])*dfac_x)*m_))/(dfac_v*m_); 
  alpha[5] = -(0.01010152544552211*dfac_x*(dfac_v*(((140.0*BdriftX[4]+156.5247584249853*BdriftX[0])*Bmag[4]+70.0*BdriftX[1]*Bmag[1])*m_*wv+(((Bmag[4]*(213.0140840414079*BmagInv[4]+121.2435565298214*BmagInv[0])+54.22176684690384*Bmag[1]*BmagInv[1])*Apar[6]+(121.2435565298214*Apar[2]*Bmag[4]+54.22176684690384*Bmag[1]*Apar[3])*BmagInv[4]+(243.9979508110672*BmagInv[1]*Apar[3]+135.5544171172596*BmagInv[0]*Apar[2])*Bmag[4]+60.6217782649107*Bmag[1]*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*dfac_y+((122.9837387624885*Apar[4]+70.0*Apar[0])*BdriftX[4]+70.0*BdriftX[0]*Apar[4]+140.8722825824867*Apar[1]*BdriftX[1]+78.26237921249266*Apar[0]*BdriftX[0])*Bmag[4]+Bmag[1]*(31.30495168499706*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+35.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1])))*q_)+(((-140.0*BdriftX[4])-156.5247584249853*BdriftX[0])*Bmag[4]-70.0*BdriftX[1]*Bmag[1])*m_))/(dfac_m*dfac_v*m_*q_); 
  alpha[6] = -(0.02357022603955158*dfac_x*(((Bmag[4]*(116.1895003862225*BmagInv[4]+129.9038105676658*BmagInv[0])+58.09475019311126*Bmag[1]*BmagInv[1])*Apar[7]+(129.9038105676658*BmagInv[1]*Bmag[4]+58.09475019311126*BmagInv[0]*Bmag[1])*Apar[5])*dfac_y+(30.0*BdriftX[1]*Bmag[4]+15.0*Bmag[1]*BdriftX[4])*Apar[6]+(30.0*Apar[3]*BdriftX[4]+33.54101966249685*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*Bmag[4]+15.0*Bmag[1]*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])))/(dfac_m*m_); 
  alpha[7] = -(0.01010152544552211*(dfac_v*m_*((242.4871130596428*BdriftX[1]*Bmag[4]+121.2435565298214*Bmag[1]*BdriftX[4])*dfac_x*wm+(((77.45966692414834*BdriftY[4]+121.2435565298214*BdriftY[0])*Phi[6]+121.2435565298214*Phi[2]*BdriftY[4]+108.4435336938077*BdriftY[1]*Phi[3])*dfac_y+(242.4871130596428*BdriftX[1]*Phi[4]+121.2435565298214*Phi[1]*BdriftX[4])*dfac_x)*q_)*wv+dfac_x*(dfac_v*(((67.08203932499369*Bmag[1]*BmagInv[4]+368.9512162874653*BmagInv[1]*Bmag[4]+105.0*BmagInv[0]*Bmag[1])*Apar[6]+(368.9512162874654*Apar[3]*Bmag[4]+105.0*Bmag[1]*Apar[2])*BmagInv[4]+210.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+93.91485505499116*Bmag[1]*BmagInv[1]*Apar[3])*dfac_y+(213.014084041408*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+121.2435565298214*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Bmag[4]+Bmag[1]*((38.72983346207418*Apar[4]+60.6217782649107*Apar[0])*BdriftX[4]+60.6217782649107*BdriftX[0]*Apar[4]+54.22176684690384*Apar[1]*BdriftX[1]))*q_+((-242.4871130596428*BdriftX[1]*Bmag[4])-121.2435565298214*Bmag[1]*BdriftX[4])*m_)*wm+((((-77.45966692414834*BdriftY[4])-121.2435565298214*BdriftY[0])*Phi[6]-121.2435565298214*Phi[2]*BdriftY[4]-108.4435336938077*BdriftY[1]*Phi[3])*dfac_y+((-242.4871130596428*BdriftX[1]*Phi[4])-121.2435565298214*Phi[1]*BdriftX[4])*dfac_x)*m_*q_+dfac_v*((((((-825.0*BmagInv[4])-469.5742752749559*BmagInv[0])*Apar[6]-210.0*BmagInv[1]*Apar[3])*Phi[7]+((825.0*BmagInv[4]+469.5742752749559*BmagInv[0])*Phi[6]+210.0*BmagInv[1]*Phi[3])*Apar[7]+(469.5742752749558*BmagInv[1]*Apar[5]-67.08203932499369*Apar[1]*BmagInv[4]-368.9512162874653*BmagInv[1]*Apar[4]-105.0*BmagInv[0]*Apar[1])*Phi[6]+(BmagInv[1]*(368.9512162874653*Phi[4]-469.5742752749558*Phi[5])+Phi[1]*(67.08203932499369*BmagInv[4]+105.0*BmagInv[0]))*Apar[6]+BmagInv[4]*(234.787137637478*Phi[3]*Apar[5]-234.787137637478*Apar[3]*Phi[5])+(368.9512162874654*Apar[3]*BmagInv[4]+210.0*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2]))*Phi[4]+((-368.9512162874654*Phi[3]*Apar[4])-105.0*Apar[1]*Phi[2]+105.0*Phi[1]*Apar[2])*BmagInv[4]-210.0*(BmagInv[0]*Phi[3]+BmagInv[1]*Phi[2])*Apar[4]+BmagInv[1]*(93.91485505499116*Phi[1]*Apar[3]-93.91485505499116*Apar[1]*Phi[3]))*dfac_x+(213.014084041408*BdriftY[1]*Apar[6]+213.0140840414079*Apar[3]*BdriftY[4]+121.2435565298214*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*Phi[7]+((129.9038105676658*Apar[4]+38.72983346207417*Apar[0])*BdriftY[4]+38.72983346207417*BdriftY[0]*Apar[4]+95.26279441628826*Apar[1]*BdriftY[1]+60.62177826491071*Apar[0]*BdriftY[0])*Phi[6]+Phi[5]*((86.60254037844389*BdriftY[4]+135.5544171172596*BdriftY[0])*Apar[6]+135.5544171172596*Apar[2]*BdriftY[4]+121.2435565298214*BdriftY[1]*Apar[3])+(38.72983346207418*Phi[2]*Apar[4]+95.26279441628824*Apar[1]*Phi[3]+60.6217782649107*Apar[0]*Phi[2])*BdriftY[4]+(95.26279441628824*BdriftY[1]*Phi[3]+60.6217782649107*BdriftY[0]*Phi[2])*Apar[4]+54.22176684690384*((Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1])*Phi[3]+Apar[1]*BdriftY[1]*Phi[2]))*dfac_y+((54.22176684690384*BdriftX[1]*Apar[7]+60.62177826491071*BdriftX[4]*Apar[5])*Phi[7]+(213.014084041408*BdriftX[1]*Apar[6]+213.0140840414079*Apar[3]*BdriftX[4]+121.2435565298214*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*Phi[6]+Phi[3]*(38.72983346207417*BdriftX[4]+60.62177826491071*BdriftX[0])*Apar[6]+(213.014084041408*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+121.2435565298214*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Phi[4]+(38.72983346207418*Phi[1]*Apar[4]+60.6217782649107*(Apar[2]*Phi[3]+Apar[0]*Phi[1]))*BdriftX[4]+60.6217782649107*BdriftX[0]*Phi[1]*Apar[4]+54.22176684690384*BdriftX[1]*(Apar[3]*Phi[3]+Apar[1]*Phi[1]))*dfac_x+140.0*dApardt[4])*q2))/(dfac_v*m_*q_); 
  alpha[8] = -(0.01010152544552211*(dfac_v*(dfac_x*(121.2435565298214*BdriftX[0]*Phi[7]*m_*wv+(((121.2435565298214*BdriftX[4]+135.5544171172596*BdriftX[0])*Bmag[4]+60.62177826491071*BdriftX[1]*Bmag[1])*Apar[7]+(135.5544171172596*BdriftX[1]*Bmag[4]+60.6217782649107*BdriftX[0]*Bmag[1])*Apar[5])*wm)+((((((-315.0*BmagInv[4])-469.5742752749559*BmagInv[0])*Apar[6]-105.0*BmagInv[1]*Apar[3]+105.0*BmagInv[0]*Apar[2])*Phi[7]+((315.0*BmagInv[4]+469.5742752749559*BmagInv[0])*Phi[6]+105.0*BmagInv[1]*Phi[3]-105.0*BmagInv[0]*Phi[2])*Apar[7]+BmagInv[1]*(469.5742752749558*Apar[5]*Phi[6]-469.5742752749558*Phi[5]*Apar[6])+BmagInv[0]*(210.0*Phi[3]*Apar[5]-210.0*Apar[3]*Phi[5]))*dfac_x+(108.4435336938077*(BdriftY[1]*Apar[6]+Apar[3]*BdriftY[4])+121.2435565298214*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))*Phi[7]+(54.22176684690384*(BdriftY[1]*Phi[6]+Phi[3]*BdriftY[4])+60.62177826491071*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2]))*Apar[7]+60.62177826491071*BdriftY[4]*Apar[5]*Phi[6]+Phi[5]*(121.2435565298214*BdriftY[4]*Apar[6]+121.2435565298214*(BdriftY[1]*Apar[3]+BdriftY[0]*Apar[2]))+60.6217782649107*(BdriftY[1]*Phi[3]+BdriftY[0]*Phi[2])*Apar[5])*dfac_y+((38.72983346207418*BdriftX[1]*Apar[7]+38.72983346207417*BdriftX[0]*Apar[5]+60.62177826491071*(Apar[4]*BdriftX[4]+Apar[1]*BdriftX[1]+Apar[0]*BdriftX[0]))*Phi[7]+((121.2435565298214*BdriftX[4]+135.5544171172596*BdriftX[0])*Phi[4]+60.62177826491071*BdriftX[1]*Phi[1])*Apar[7]+(108.4435336938077*(BdriftX[1]*Apar[6]+Apar[3]*BdriftX[4])+121.2435565298214*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*Phi[6]+54.22176684690384*Phi[3]*BdriftX[4]*Apar[6]+(135.5544171172596*BdriftX[1]*Phi[4]+60.6217782649107*BdriftX[0]*Phi[1])*Apar[5]+54.22176684690384*(BdriftX[1]*Apar[3]+BdriftX[0]*Apar[2])*Phi[3])*dfac_x+140.0*dApardt[5])*q_)-121.2435565298214*BdriftX[0]*Phi[7]*dfac_x*m_))/(dfac_v*m_); 
  alpha[10] = -(0.003367175148507369*dfac_x*(((363.7306695894642*Bmag[1]*BmagInv[4]+1636.788013152589*BmagInv[1]*Bmag[4]+406.6632513517788*BmagInv[0]*Bmag[1])*Apar[7]+(Bmag[4]*(813.3265027035576*BmagInv[4]+909.3266739736605*BmagInv[0])+406.6632513517788*Bmag[1]*BmagInv[1])*Apar[5])*dfac_y+((368.9512162874653*BdriftX[4]+210.0*BdriftX[0])*Bmag[4]+93.91485505499116*BdriftX[1]*Bmag[1])*Apar[6]+(210.0*Apar[2]*BdriftX[4]+422.6168477474603*BdriftX[1]*Apar[3]+234.787137637478*BdriftX[0]*Apar[2])*Bmag[4]+Bmag[1]*(93.91485505499116*Apar[3]*BdriftX[4]+105.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))))/(dfac_m*m_); 
  alpha[11] = -(0.01010152544552211*(dfac_v*(((242.4871130596428*BdriftY[1]*Phi[7]+271.1088342345192*BdriftY[4]*Phi[5])*dfac_y+(242.4871130596428*BdriftX[1]*Phi[6]+121.2435565298214*Phi[3]*BdriftX[4])*dfac_x)*m_*wv+dfac_x*(((Bmag[4]*(825.0*BmagInv[4]+469.5742752749559*BmagInv[0])+210.0*Bmag[1]*BmagInv[1])*Apar[7]+(234.7871376374779*Bmag[1]*BmagInv[4]+469.5742752749558*BmagInv[1]*Bmag[4])*Apar[5])*dfac_y+(213.014084041408*BdriftX[1]*Bmag[4]+Bmag[1]*(38.72983346207418*BdriftX[4]+60.6217782649107*BdriftX[0]))*Apar[6]+(213.0140840414079*Apar[3]*BdriftX[4]+121.2435565298214*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*Bmag[4]+Bmag[1]*(60.62177826491071*Apar[2]*BdriftX[4]+54.22176684690384*BdriftX[1]*Apar[3]))*wm+((((210.0*BmagInv[4]*Apar[5]+Apar[4]*((-825.0*BmagInv[4])-469.5742752749559*BmagInv[0])-210.0*Apar[1]*BmagInv[1])*Phi[7]+((-210.0*BmagInv[4]*Phi[5])+(825.0*BmagInv[4]+469.5742752749559*BmagInv[0])*Phi[4]+210.0*BmagInv[1]*Phi[1])*Apar[7]+(Apar[3]*(301.8691769624717*BmagInv[4]+105.0*BmagInv[0])+210.0*BmagInv[1]*Apar[2])*Phi[6]+(Phi[3]*((-301.8691769624717*BmagInv[4])-105.0*BmagInv[0])-210.0*BmagInv[1]*Phi[2])*Apar[6]+((-234.7871376374779*Apar[1]*BmagInv[4])-469.5742752749558*BmagInv[1]*Apar[4])*Phi[5]+(469.5742752749558*BmagInv[1]*Phi[4]+234.7871376374779*Phi[1]*BmagInv[4])*Apar[5]+(105.0*Apar[2]*Phi[3]-105.0*Phi[2]*Apar[3])*BmagInv[4])*dfac_x+((190.5255888325765*BdriftY[4]+108.4435336938077*BdriftY[0])*Apar[7]+108.4435336938077*BdriftY[1]*Apar[5]+213.014084041408*(Apar[1]*BdriftY[4]+BdriftY[1]*Apar[4])+121.2435565298214*(Apar[0]*BdriftY[1]+BdriftY[0]*Apar[1]))*Phi[7]+108.4435336938077*BdriftY[1]*Phi[5]*Apar[7]+((129.9038105676658*BdriftY[4]+38.72983346207417*BdriftY[0])*Apar[6]+38.72983346207418*Apar[2]*BdriftY[4]+95.26279441628824*BdriftY[1]*Apar[3]+60.6217782649107*BdriftY[0]*Apar[2])*Phi[6]+(38.72983346207418*Phi[2]*BdriftY[4]+95.26279441628824*BdriftY[1]*Phi[3]+60.6217782649107*BdriftY[0]*Phi[2])*Apar[6]+(BdriftY[4]*(121.2435565298214*Apar[5]+86.60254037844389*Apar[4]+135.5544171172596*Apar[0])+135.5544171172596*BdriftY[0]*Apar[4]+121.2435565298214*Apar[1]*BdriftY[1])*Phi[5]+(95.26279441628826*Apar[3]*Phi[3]+60.62177826491071*Apar[2]*Phi[2])*BdriftY[4]+54.22176684690384*((BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2])*Phi[3]+BdriftY[1]*Phi[2]*Apar[3]))*dfac_y+(((34.64101615137755*BdriftX[4]+54.22176684690384*BdriftX[0])*Apar[6]+54.22176684690384*Apar[2]*BdriftX[4]+48.49742261192856*BdriftX[1]*Apar[3])*Phi[7]+((190.5255888325765*BdriftX[4]+108.4435336938077*BdriftX[0])*Phi[6]+48.49742261192856*BdriftX[1]*Phi[3])*Apar[7]+(108.4435336938077*BdriftX[1]*Apar[5]+213.014084041408*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+121.2435565298214*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Phi[6]+(213.014084041408*BdriftX[1]*Phi[4]+Phi[1]*(38.72983346207418*BdriftX[4]+60.6217782649107*BdriftX[0]))*Apar[6]+54.22176684690384*Phi[3]*BdriftX[4]*Apar[5]+(213.0140840414079*Apar[3]*BdriftX[4]+121.2435565298214*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*Phi[4]+(38.72983346207417*Phi[3]*Apar[4]+60.62177826491071*(Apar[0]*Phi[3]+Phi[1]*Apar[2]))*BdriftX[4]+60.62177826491071*BdriftX[0]*Phi[3]*Apar[4]+54.22176684690384*BdriftX[1]*(Apar[1]*Phi[3]+Phi[1]*Apar[3]))*dfac_x+140.0*dApardt[6])*q_)+(((-242.4871130596428*BdriftY[1]*Phi[7])-271.1088342345192*BdriftY[4]*Phi[5])*dfac_y+((-242.4871130596428*BdriftX[1]*Phi[6])-121.2435565298214*Phi[3]*BdriftX[4])*dfac_x)*m_))/(dfac_v*m_); 
  alpha[12] = -(0.002020305089104421*(dfac_v*(dfac_x*(606.217782649107*BdriftX[1]*Phi[7]*m_*wv+((1219.989754055336*BdriftX[1]*Bmag[4]+Bmag[1]*(271.1088342345192*BdriftX[4]+303.1088913245535*BdriftX[0]))*Apar[7]+((606.2177826491072*BdriftX[4]+677.772085586298*BdriftX[0])*Bmag[4]+303.1088913245536*BdriftX[1]*Bmag[1])*Apar[5])*wm)+(((((-3756.594202199647*BmagInv[1]*Apar[6])+Apar[3]*((-469.5742752749559*BmagInv[4])-525.0*BmagInv[0])+525.0*BmagInv[1]*Apar[2])*Phi[7]+(3756.594202199647*BmagInv[1]*Phi[6]+Phi[3]*(469.5742752749559*BmagInv[4]+525.0*BmagInv[0])-525.0*BmagInv[1]*Phi[2])*Apar[7]+(2100.0*BmagInv[4]+2347.87137637478*BmagInv[0])*Apar[5]*Phi[6]+((-2100.0*BmagInv[4])-2347.87137637478*BmagInv[0])*Phi[5]*Apar[6]+BmagInv[1]*(1050.0*Phi[3]*Apar[5]-1050.0*Apar[3]*Phi[5]))*dfac_x+((952.6279441628827*BdriftY[4]+542.2176684690384*BdriftY[0])*Apar[6]+542.2176684690385*Apar[2]*BdriftY[4]+1091.192008768392*BdriftY[1]*Apar[3]+606.217782649107*BdriftY[0]*Apar[2])*Phi[7]+((476.3139720814414*BdriftY[4]+271.1088342345192*BdriftY[0])*Phi[6]+271.1088342345192*Phi[2]*BdriftY[4]+545.5960043841961*BdriftY[1]*Phi[3]+303.1088913245535*BdriftY[0]*Phi[2])*Apar[7]+271.1088342345192*BdriftY[1]*Apar[5]*Phi[6]+Phi[5]*(542.2176684690385*BdriftY[1]*Apar[6]+542.2176684690384*Apar[3]*BdriftY[4]+606.2177826491072*(BdriftY[0]*Apar[3]+BdriftY[1]*Apar[2]))+(271.1088342345192*Phi[3]*BdriftY[4]+303.1088913245536*(BdriftY[0]*Phi[3]+BdriftY[1]*Phi[2]))*Apar[5])*dfac_y+(((173.2050807568878*BdriftX[4]+193.6491673103708*BdriftX[0])*Apar[7]+193.6491673103709*BdriftX[1]*Apar[5]+271.1088342345192*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+303.1088913245535*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Phi[7]+(1219.989754055336*BdriftX[1]*Phi[4]+Phi[1]*(271.1088342345192*BdriftX[4]+303.1088913245535*BdriftX[0]))*Apar[7]+((952.6279441628827*BdriftX[4]+542.2176684690384*BdriftX[0])*Apar[6]+542.2176684690385*Apar[2]*BdriftX[4]+1091.192008768392*BdriftX[1]*Apar[3]+606.217782649107*BdriftX[0]*Apar[2])*Phi[6]+242.4871130596428*BdriftX[1]*Phi[3]*Apar[6]+((606.2177826491072*BdriftX[4]+677.772085586298*BdriftX[0])*Phi[4]+303.1088913245536*BdriftX[1]*Phi[1])*Apar[5]+Phi[3]*(242.4871130596428*Apar[3]*BdriftX[4]+271.1088342345192*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2])))*dfac_x+700.0*dApardt[7])*q_)-606.217782649107*BdriftX[1]*Phi[7]*dfac_x*m_))/(dfac_v*m_); 
  alpha[13] = -(0.003367175148507369*dfac_x*(dfac_v*((420.0000000000001*BdriftX[1]*Bmag[4]+210.0*Bmag[1]*BdriftX[4])*m_*wv+(((116.1895003862225*Bmag[1]*BmagInv[4]+639.0422521242239*BmagInv[1]*Bmag[4]+181.8653347947321*BmagInv[0]*Bmag[1])*Apar[6]+(639.0422521242239*Apar[3]*Bmag[4]+181.8653347947321*Bmag[1]*Apar[2])*BmagInv[4]+363.7306695894642*(BmagInv[0]*Apar[3]+BmagInv[1]*Apar[2])*Bmag[4]+162.6653005407115*Bmag[1]*BmagInv[1]*Apar[3])*dfac_y+(368.9512162874653*(Apar[1]*BdriftX[4]+BdriftX[1]*Apar[4])+210.0*(Apar[0]*BdriftX[1]+BdriftX[0]*Apar[1]))*Bmag[4]+Bmag[1]*((67.08203932499369*Apar[4]+105.0*Apar[0])*BdriftX[4]+105.0*BdriftX[0]*Apar[4]+93.91485505499116*Apar[1]*BdriftX[1]))*q_)+((-420.0000000000001*BdriftX[1]*Bmag[4])-210.0*Bmag[1]*BdriftX[4])*m_))/(dfac_m*dfac_v*m_*q_); 
  alpha[14] = -(0.02357022603955158*(((30.0*BdriftX[4]+33.54101966249685*BdriftX[0])*Bmag[4]+15.0*BdriftX[1]*Bmag[1])*Apar[7]+(33.54101966249684*BdriftX[1]*Bmag[4]+15.0*BdriftX[0]*Bmag[1])*Apar[5])*dfac_x)/(dfac_m*m_); 
  alpha[17] = -(0.003367175148507369*dfac_x*(((Bmag[4]*(1428.941916244324*BmagInv[4]+813.3265027035576*BmagInv[0])+363.7306695894642*Bmag[1]*BmagInv[1])*Apar[7]+(406.6632513517788*Bmag[1]*BmagInv[4]+813.3265027035576*BmagInv[1]*Bmag[4])*Apar[5])*dfac_y+(368.9512162874653*BdriftX[1]*Bmag[4]+Bmag[1]*(67.08203932499369*BdriftX[4]+105.0*BdriftX[0]))*Apar[6]+(368.9512162874654*Apar[3]*BdriftX[4]+210.0*(BdriftX[0]*Apar[3]+BdriftX[1]*Apar[2]))*Bmag[4]+Bmag[1]*(105.0*Apar[2]*BdriftX[4]+93.91485505499116*BdriftX[1]*Apar[3])))/(dfac_m*m_); 
  alpha[18] = -(0.02357022603955158*((60.37383539249431*BdriftX[1]*Bmag[4]+Bmag[1]*(13.41640786499874*BdriftX[4]+15.0*BdriftX[0]))*Apar[7]+((30.0*BdriftX[4]+33.54101966249685*BdriftX[0])*Bmag[4]+15.0*BdriftX[1]*Bmag[1])*Apar[5])*dfac_x)/(dfac_m*m_); 
  double amax = 0.0; 
  bool upwind = false; 
  if(upwind) 
    amax = std::abs(alpha0); 
  else 
    amax = amax_in; 

  double Ghat[20]; 
  double favg[20]; 
  favg[0] = 0.7071067811865475*(2.23606797749979*(fr[13]+fl[13])+1.732050807568877*(fl[3]-1.0*fr[3])+fr[0]+fl[0]); 
  favg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[23]+fl[23])+3.0*(fl[6]-1.0*fr[6]))+3.0*(fr[1]+fl[1])); 
  favg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[24]+fl[24])+3.0*(fl[7]-1.0*fr[7]))+3.0*(fr[2]+fl[2])); 
  favg[3] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[27]+fl[27])+3.0*(fl[10]-1.0*fr[10]))+3.0*(fr[4]+fl[4])); 
  favg[4] = 0.7071067811865475*(2.23606797749979*(fr[34]+fl[34])+1.732050807568877*(fl[15]-1.0*fr[15])+fr[5]+fl[5]); 
  favg[5] = 0.7071067811865475*(2.23606797749979*(fr[39]+fl[39])+1.732050807568877*(fl[17]-1.0*fr[17])+fr[8]+fl[8]); 
  favg[6] = 0.7071067811865475*(2.23606797749979*(fr[40]+fl[40])+1.732050807568877*(fl[18]-1.0*fr[18])+fr[9]+fl[9]); 
  favg[7] = -0.1414213562373095*(8.660254037844387*fr[21]-1.0*(8.660254037844387*fl[21]+5.0*(fr[11]+fl[11]))); 
  favg[8] = -0.1414213562373095*(8.660254037844387*fr[22]-1.0*(8.660254037844387*fl[22]+5.0*(fr[12]+fl[12]))); 
  favg[9] = -0.1414213562373095*(8.660254037844387*fr[30]-1.0*(8.660254037844387*fl[30]+5.0*(fr[14]+fl[14]))); 
  favg[10] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fr[46]+fl[46])+3.0*(fl[31]-1.0*fr[31]))+3.0*(fr[16]+fl[16])); 
  favg[11] = -0.1414213562373095*(8.660254037844387*fr[32]-1.0*(8.660254037844387*fl[32]+5.0*(fr[19]+fl[19]))); 
  favg[12] = -0.1414213562373095*(8.660254037844387*fr[33]-1.0*(8.660254037844387*fl[33]+5.0*(fr[20]+fl[20]))); 
  favg[13] = -0.1414213562373095*(8.660254037844387*fr[37]-1.0*(8.660254037844387*fl[37]+5.0*(fr[25]+fl[25]))); 
  favg[14] = -0.1414213562373095*(8.660254037844387*fr[38]-1.0*(8.660254037844387*fl[38]+5.0*(fr[26]+fl[26]))); 
  favg[15] = -0.1414213562373095*(8.660254037844387*fr[42]-1.0*(8.660254037844387*fl[42]+5.0*(fr[28]+fl[28]))); 
  favg[16] = -0.1414213562373095*(8.660254037844387*fr[43]-1.0*(8.660254037844387*fl[43]+5.0*(fr[29]+fl[29]))); 
  favg[17] = -0.1414213562373095*(8.660254037844387*fr[44]-1.0*(8.660254037844387*fl[44]+5.0*(fr[35]+fl[35]))); 
  favg[18] = -0.1414213562373095*(8.660254037844387*fr[45]-1.0*(8.660254037844387*fl[45]+5.0*(fr[36]+fl[36]))); 
  favg[19] = -0.1414213562373095*(8.660254037844387*fr[47]-1.0*(8.660254037844387*fl[47]+5.0*(fr[41]+fl[41]))); 

  Ghat[0] = -0.125*((6.324555320336761*fr[13]-6.324555320336761*fl[13]-4.898979485566357*(fr[3]+fl[3])+2.828427124746191*fr[0]-2.828427124746191*fl[0])*amax-1.414213562373095*(alpha[18]*favg[18]+alpha[17]*favg[17]+alpha[14]*favg[14]+alpha[13]*favg[13]+alpha[12]*favg[12]+alpha[11]*favg[11]+alpha[10]*favg[10]+alpha[8]*favg[8]+alpha[7]*favg[7]+alpha[6]*favg[6]+alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[3]*favg[3]+alpha[2]*favg[2]+alpha[1]*favg[1]+alpha[0]*favg[0])); 
  Ghat[1] = -0.008333333333333333*((94.8683298050514*fr[23]-94.8683298050514*fl[23]-73.48469228349535*(fr[6]+fl[6])+42.42640687119286*fr[1]-42.42640687119286*fl[1])*amax-21.21320343559643*(alpha[14]*favg[18]+favg[14]*alpha[18])-18.97366596101028*(alpha[10]*favg[17]+favg[10]*alpha[17]+alpha[5]*favg[13]+favg[5]*alpha[13])-21.21320343559643*(alpha[8]*favg[12]+favg[8]*alpha[12])-18.97366596101028*(alpha[4]*favg[11]+favg[4]*alpha[11])-21.21320343559643*(alpha[6]*favg[10]+favg[6]*alpha[10])-18.97366596101028*(alpha[1]*favg[7]+favg[1]*alpha[7])-21.21320343559643*(alpha[3]*favg[5]+favg[3]*alpha[5]+alpha[2]*favg[4]+favg[2]*alpha[4]+alpha[0]*favg[1]+favg[0]*alpha[1])); 
  Ghat[2] = -0.008333333333333333*((94.8683298050514*fr[24]-94.8683298050514*fl[24]-73.48469228349535*(fr[7]+fl[7])+42.42640687119286*fr[2]-42.42640687119286*fl[2])*amax-18.97366596101028*(alpha[10]*favg[18]+favg[10]*alpha[18])-21.21320343559643*(alpha[13]*favg[17]+favg[13]*alpha[17])-18.97366596101028*(alpha[6]*favg[14]+favg[6]*alpha[14]+alpha[4]*favg[12]+favg[4]*alpha[12])-21.21320343559643*(alpha[7]*favg[11]+favg[7]*alpha[11])-21.21320343559643*(alpha[5]*favg[10]+favg[5]*alpha[10])-18.97366596101028*(alpha[2]*favg[8]+favg[2]*alpha[8])-21.21320343559643*(alpha[3]*favg[6]+favg[3]*alpha[6]+alpha[1]*favg[4]+favg[1]*alpha[4]+alpha[0]*favg[2]+favg[0]*alpha[2])); 
  Ghat[3] = -0.01443375672974065*((54.77225575051663*fr[27]-54.77225575051663*fl[27]-42.42640687119286*(fr[10]+fl[10])+24.49489742783179*fr[4]-24.49489742783179*fl[4])*amax-10.95445115010332*alpha[10]*favg[19]-12.24744871391589*(alpha[12]*favg[18]+favg[12]*alpha[18]+alpha[11]*favg[17]+favg[11]*alpha[17])-10.95445115010333*(alpha[6]*favg[16]+alpha[5]*favg[15])-12.24744871391589*(alpha[8]*favg[14]+favg[8]*alpha[14]+alpha[7]*favg[13]+favg[7]*alpha[13])-12.24744871391589*(alpha[4]*favg[10]+favg[4]*alpha[10])-10.95445115010332*alpha[3]*favg[9]-12.24744871391589*(alpha[2]*favg[6]+favg[2]*alpha[6]+alpha[1]*favg[5]+favg[1]*alpha[5]+alpha[0]*favg[3]+favg[0]*alpha[3])); 
  Ghat[4] = -0.008333333333333333*((94.86832980505142*fr[34]-94.86832980505142*fl[34]-73.48469228349535*(fr[15]+fl[15])+42.42640687119286*fr[5]-42.42640687119286*fl[5])*amax+((-16.97056274847715*alpha[17])-18.97366596101028*alpha[6])*favg[18]+((-16.97056274847715*favg[17])-18.97366596101028*favg[6])*alpha[18]-18.97366596101028*(alpha[5]*favg[17]+favg[5]*alpha[17]+alpha[10]*favg[14]+favg[10]*alpha[14]+alpha[10]*favg[13]+favg[10]*alpha[13])+((-16.97056274847715*alpha[11])-18.97366596101028*alpha[2])*favg[12]+((-16.97056274847715*favg[11])-18.97366596101028*favg[2])*alpha[12]-18.97366596101028*(alpha[1]*favg[11]+favg[1]*alpha[11])-21.21320343559643*(alpha[3]*favg[10]+favg[3]*alpha[10])-18.97366596101028*(alpha[4]*favg[8]+favg[4]*alpha[8]+alpha[4]*favg[7]+favg[4]*alpha[7])-21.21320343559643*(alpha[5]*favg[6]+favg[5]*alpha[6]+alpha[0]*favg[4]+favg[0]*alpha[4]+alpha[1]*favg[2]+favg[1]*alpha[2])); 
  Ghat[5] = -5.208333333333333e-4*((1517.893276880824*fr[39]-1517.893276880824*fl[39]-1175.755076535926*(fr[17]+fl[17])+678.8225099390861*fr[8]-678.8225099390861*fl[8])*amax+((-271.5290039756345*alpha[17])-303.5786553761646*alpha[6])*favg[19]-339.411254969543*(alpha[8]*favg[18]+favg[8]*alpha[18])-303.5786553761646*(alpha[4]*favg[17]+favg[4]*alpha[17])+((-303.5786553761646*alpha[10])-82.15838362577493*alpha[4])*favg[16]+((-271.5290039756345*alpha[13])-303.5786553761646*alpha[3]-82.15838362577493*alpha[0])*favg[15]-339.411254969543*(alpha[12]*favg[14]+favg[12]*alpha[14])-303.5786553761646*(alpha[1]*favg[13]+favg[1]*alpha[13]+alpha[10]*favg[11]+favg[10]*alpha[11])-339.411254969543*(alpha[2]*favg[10]+favg[2]*alpha[10])-303.5786553761646*(alpha[5]*(favg[9]+favg[7])+favg[5]*alpha[7])-339.411254969543*(alpha[4]*favg[6]+favg[4]*alpha[6]+alpha[0]*favg[5]+favg[0]*alpha[5]+alpha[1]*favg[3]+favg[1]*alpha[3])); 
  Ghat[6] = -5.208333333333333e-4*((1517.893276880824*fr[40]-1517.893276880824*fl[40]-1175.755076535926*(fr[18]+fl[18])+678.8225099390861*fr[9]-678.8225099390861*fl[9])*amax+((-271.5290039756345*alpha[18])-303.5786553761646*alpha[5])*favg[19]-303.5786553761646*(alpha[4]*favg[18]+favg[4]*alpha[18])-339.411254969543*(alpha[7]*favg[17]+favg[7]*alpha[17])+((-271.5290039756345*alpha[14])-303.5786553761646*alpha[3]-82.15838362577493*alpha[0])*favg[16]+((-303.5786553761646*alpha[10])-82.15838362577493*alpha[4])*favg[15]-303.5786553761646*(alpha[2]*favg[14]+favg[2]*alpha[14])-339.411254969543*(alpha[11]*favg[13]+favg[11]*alpha[13])-303.5786553761646*(alpha[10]*favg[12]+favg[10]*alpha[12])-339.411254969543*(alpha[1]*favg[10]+favg[1]*alpha[10])-303.5786553761646*(alpha[6]*(favg[9]+favg[8])+favg[6]*alpha[8])-339.411254969543*(alpha[0]*favg[6]+favg[0]*alpha[6]+alpha[4]*favg[5]+favg[4]*alpha[5]+alpha[2]*favg[3]+favg[2]*alpha[3])); 
  Ghat[7] = 0.001190476190476191*((514.3928459844675*(fr[21]+fl[21])-296.98484809835*fr[11]+296.98484809835*fl[11])*amax+132.815661727072*alpha[18]*favg[18]+(94.86832980505142*alpha[17]+148.492424049175*alpha[6])*favg[17]+148.492424049175*favg[6]*alpha[17]+(94.86832980505142*alpha[13]+148.492424049175*alpha[3])*favg[13]+148.492424049175*favg[3]*alpha[13]+132.815661727072*alpha[12]*favg[12]+(94.86832980505142*alpha[11]+148.492424049175*alpha[2])*favg[11]+148.492424049175*favg[2]*alpha[11]+132.815661727072*alpha[10]*favg[10]+(94.86832980505142*alpha[7]+148.492424049175*alpha[0])*favg[7]+148.492424049175*favg[0]*alpha[7]+132.815661727072*(alpha[5]*favg[5]+alpha[4]*favg[4]+alpha[1]*favg[1])); 
  Ghat[8] = 0.001190476190476191*((514.3928459844675*(fr[22]+fl[22])-296.98484809835*fr[12]+296.98484809835*fl[12])*amax+(94.86832980505142*alpha[18]+148.492424049175*alpha[5])*favg[18]+148.492424049175*favg[5]*alpha[18]+132.815661727072*alpha[17]*favg[17]+(94.86832980505142*alpha[14]+148.492424049175*alpha[3])*favg[14]+148.492424049175*favg[3]*alpha[14]+(94.86832980505142*alpha[12]+148.492424049175*alpha[1])*favg[12]+148.492424049175*favg[1]*alpha[12]+132.815661727072*(alpha[11]*favg[11]+alpha[10]*favg[10])+(94.86832980505142*alpha[8]+148.492424049175*alpha[0])*favg[8]+148.492424049175*favg[0]*alpha[8]+132.815661727072*(alpha[6]*favg[6]+alpha[4]*favg[4]+alpha[2]*favg[2])); 
  Ghat[9] = 0.008333333333333333*((73.48469228349536*(fr[30]+fl[30])-42.42640687119286*fr[14]+42.42640687119286*fl[14])*amax+21.21320343559643*alpha[4]*favg[19]+18.97366596101028*(alpha[18]*favg[18]+alpha[17]*favg[17])+21.21320343559643*(alpha[2]*favg[16]+alpha[1]*favg[15])+18.97366596101028*(alpha[14]*favg[14]+alpha[13]*favg[13]+alpha[10]*favg[10])+21.21320343559643*alpha[0]*favg[9]+18.97366596101028*(alpha[6]*favg[6]+alpha[5]*favg[5]+alpha[3]*favg[3])); 
  Ghat[10] = -0.002886751345948129*((273.8612787525831*fr[46]-273.8612787525831*fl[46]-212.1320343559643*(fr[31]+fl[31])+122.4744871391589*fr[16]-122.4744871391589*fl[16])*amax+((-48.98979485566359*(alpha[14]+alpha[13]))-54.77225575051663*alpha[3])*favg[19]+((-48.98979485566359*alpha[11])-54.77225575051663*alpha[2])*favg[18]+((-48.98979485566359*(favg[16]+favg[11]))-54.77225575051663*favg[2])*alpha[18]+((-48.98979485566359*alpha[12])-54.77225575051663*alpha[1])*favg[17]+((-48.98979485566359*(favg[15]+favg[12]))-54.77225575051663*favg[1])*alpha[17]-54.77225575051663*(alpha[5]*favg[16]+alpha[6]*favg[15]+alpha[4]*favg[14]+favg[4]*alpha[14]+alpha[4]*favg[13]+favg[4]*alpha[13]+alpha[6]*favg[12]+favg[6]*alpha[12]+alpha[5]*favg[11]+favg[5]*alpha[11])+((-54.77225575051663*(alpha[8]+alpha[7]))-61.23724356957945*alpha[0])*favg[10]+((-54.77225575051663*(favg[9]+favg[8]+favg[7]))-61.23724356957945*favg[0])*alpha[10]-61.23724356957945*(alpha[1]*favg[6]+favg[1]*alpha[6]+alpha[2]*favg[5]+favg[2]*alpha[5]+alpha[3]*favg[4]+favg[3]*alpha[4])); 
  Ghat[11] = 2.380952380952381e-4*((2571.964229922338*(fr[32]+fl[32])-1484.92424049175*fr[19]+1484.92424049175*fl[19])*amax+593.9696961967002*(alpha[10]*favg[18]+favg[10]*alpha[18])+(664.0783086353599*alpha[14]+474.3416490252571*alpha[13]+742.462120245875*alpha[3])*favg[17]+(664.0783086353599*favg[14]+474.3416490252571*favg[13]+742.462120245875*favg[3])*alpha[17]+742.462120245875*(alpha[6]*favg[13]+favg[6]*alpha[13])+593.9696961967002*(alpha[4]*favg[12]+favg[4]*alpha[12])+(664.0783086353599*alpha[8]+474.3416490252571*alpha[7]+742.462120245875*alpha[0])*favg[11]+(664.0783086353599*favg[8]+474.3416490252571*favg[7]+742.462120245875*favg[0])*alpha[11]+664.0783086353598*(alpha[5]*favg[10]+favg[5]*alpha[10])+742.462120245875*(alpha[2]*favg[7]+favg[2]*alpha[7])+664.0783086353598*(alpha[1]*favg[4]+favg[1]*alpha[4])); 
  Ghat[12] = 2.380952380952381e-4*((2571.964229922338*(fr[33]+fl[33])-1484.92424049175*fr[20]+1484.92424049175*fl[20])*amax+(474.3416490252571*alpha[14]+664.0783086353599*alpha[13]+742.462120245875*alpha[3])*favg[18]+(474.3416490252571*favg[14]+664.0783086353599*favg[13]+742.462120245875*favg[3])*alpha[18]+593.9696961967002*(alpha[10]*favg[17]+favg[10]*alpha[17])+742.462120245875*(alpha[5]*favg[14]+favg[5]*alpha[14])+(474.3416490252571*alpha[8]+664.0783086353599*alpha[7]+742.462120245875*alpha[0])*favg[12]+(474.3416490252571*favg[8]+664.0783086353599*favg[7]+742.462120245875*favg[0])*alpha[12]+593.9696961967002*(alpha[4]*favg[11]+favg[4]*alpha[11])+664.0783086353598*(alpha[6]*favg[10]+favg[6]*alpha[10])+742.462120245875*(alpha[1]*favg[8]+favg[1]*alpha[8])+664.0783086353598*(alpha[2]*favg[4]+favg[2]*alpha[4])); 
  Ghat[13] = 9.221388919541468e-4*((664.0783086353599*(fr[37]+fl[37])-383.4057902536164*fr[25]+383.4057902536164*fl[25])*amax+153.3623161014466*alpha[10]*favg[19]+171.4642819948225*(alpha[12]*favg[18]+favg[12]*alpha[18])+(122.474487139159*alpha[11]+191.7028951268082*alpha[2])*favg[17]+(171.4642819948225*favg[16]+122.474487139159*favg[11]+191.7028951268082*favg[2])*alpha[17]+153.3623161014466*alpha[5]*favg[15]+(122.474487139159*alpha[7]+191.7028951268082*alpha[0])*favg[13]+(171.4642819948225*favg[9]+122.474487139159*favg[7]+191.7028951268082*favg[0])*alpha[13]+191.7028951268082*(alpha[6]*favg[11]+favg[6]*alpha[11])+171.4642819948225*(alpha[4]*favg[10]+favg[4]*alpha[10])+191.7028951268082*(alpha[3]*favg[7]+favg[3]*alpha[7])+171.4642819948225*(alpha[1]*favg[5]+favg[1]*alpha[5])); 
  Ghat[14] = 9.221388919541468e-4*((664.0783086353599*(fr[38]+fl[38])-383.4057902536164*fr[26]+383.4057902536164*fl[26])*amax+153.3623161014466*alpha[10]*favg[19]+(122.474487139159*alpha[12]+191.7028951268082*alpha[1])*favg[18]+(171.4642819948225*favg[15]+122.474487139159*favg[12]+191.7028951268082*favg[1])*alpha[18]+171.4642819948225*(alpha[11]*favg[17]+favg[11]*alpha[17])+153.3623161014466*alpha[6]*favg[16]+(122.474487139159*alpha[8]+191.7028951268082*alpha[0])*favg[14]+(171.4642819948225*favg[9]+122.474487139159*favg[8]+191.7028951268082*favg[0])*alpha[14]+191.7028951268082*(alpha[5]*favg[12]+favg[5]*alpha[12])+171.4642819948225*(alpha[4]*favg[10]+favg[4]*alpha[10])+191.7028951268082*(alpha[3]*favg[8]+favg[3]*alpha[8])+171.4642819948225*(alpha[2]*favg[6]+favg[2]*alpha[6])); 
  Ghat[15] = 0.001666666666666667*((367.4234614174769*(fr[42]+fl[42])-212.1320343559643*fr[28]+212.1320343559643*fl[28])*amax+(94.86832980505142*alpha[11]+106.0660171779822*alpha[2])*favg[19]+94.86832980505142*(alpha[14]*favg[18]+favg[14]*alpha[18])+84.85281374238573*(alpha[10]*favg[17]+favg[10]*alpha[17])+106.0660171779821*alpha[4]*favg[16]+(94.86832980505142*alpha[7]+106.0660171779821*alpha[0])*favg[15]+84.85281374238573*(alpha[5]*favg[13]+favg[5]*alpha[13])+94.8683298050514*(alpha[6]*favg[10]+favg[6]*alpha[10])+106.0660171779822*alpha[1]*favg[9]+94.8683298050514*(alpha[3]*favg[5]+favg[3]*alpha[5])); 
  Ghat[16] = 0.001666666666666667*((367.4234614174769*(fr[43]+fl[43])-212.1320343559643*fr[29]+212.1320343559643*fl[29])*amax+(94.86832980505142*alpha[12]+106.0660171779822*alpha[1])*favg[19]+84.85281374238573*(alpha[10]*favg[18]+favg[10]*alpha[18])+94.86832980505142*(alpha[13]*favg[17]+favg[13]*alpha[17])+(94.86832980505142*alpha[8]+106.0660171779821*alpha[0])*favg[16]+106.0660171779821*alpha[4]*favg[15]+84.85281374238573*(alpha[6]*favg[14]+favg[6]*alpha[14])+94.8683298050514*(alpha[5]*favg[10]+favg[5]*alpha[10])+106.0660171779822*alpha[2]*favg[9]+94.8683298050514*(alpha[3]*favg[6]+favg[3]*alpha[6])); 
  Ghat[17] = 6.654964218749372e-5*((9201.738966086798*(fr[44]+fl[44])-5312.626469082881*fr[35]+5312.626469082881*fl[35])*amax+(1900.703027829441*alpha[18]+2125.050587633152*alpha[5])*favg[19]+2125.050587633152*(alpha[4]*favg[18]+favg[4]*alpha[18])+(2375.878784786801*alpha[8]+1697.056274847715*alpha[7]+2656.313234541441*alpha[0])*favg[17]+(2375.878784786801*(favg[9]+favg[8])+1697.056274847715*favg[7]+2656.313234541441*favg[0])*alpha[17]+2375.878784786801*alpha[13]*favg[16]+(2125.050587633153*alpha[10]+575.1086853804245*alpha[4])*favg[15]+2375.878784786801*(alpha[11]*favg[14]+favg[11]*alpha[14])+(1697.056274847715*alpha[11]+2656.31323454144*alpha[2])*favg[13]+(1697.056274847715*favg[11]+2656.31323454144*favg[2])*alpha[13]+2125.050587633153*(alpha[10]*favg[12]+favg[10]*alpha[12])+2656.31323454144*(alpha[3]*favg[11]+favg[3]*alpha[11])+2375.878784786801*(alpha[1]*favg[10]+favg[1]*alpha[10])+2656.313234541441*(alpha[6]*favg[7]+favg[6]*alpha[7])+2375.878784786801*(alpha[4]*favg[5]+favg[4]*alpha[5])); 
  Ghat[18] = 6.654964218749372e-5*((9201.738966086798*(fr[45]+fl[45])-5312.626469082881*fr[36]+5312.626469082881*fl[36])*amax+(1900.703027829441*alpha[17]+2125.050587633152*alpha[6])*favg[19]+(1697.056274847715*alpha[8]+2375.878784786801*alpha[7]+2656.313234541441*alpha[0])*favg[18]+(2375.878784786801*favg[9]+1697.056274847715*favg[8]+2375.878784786801*favg[7]+2656.313234541441*favg[0])*alpha[18]+2125.050587633152*(alpha[4]*favg[17]+favg[4]*alpha[17])+(2125.050587633153*alpha[10]+575.1086853804245*alpha[4])*favg[16]+2375.878784786801*alpha[14]*favg[15]+(1697.056274847715*alpha[12]+2656.31323454144*alpha[1])*favg[14]+(1697.056274847715*favg[12]+2656.31323454144*favg[1])*alpha[14]+2375.878784786801*(alpha[12]*favg[13]+favg[12]*alpha[13])+2656.31323454144*(alpha[3]*favg[12]+favg[3]*alpha[12])+2125.050587633153*(alpha[10]*favg[11]+favg[10]*alpha[11])+2375.878784786801*(alpha[2]*favg[10]+favg[2]*alpha[10])+2656.313234541441*(alpha[5]*favg[8]+favg[5]*alpha[8])+2375.878784786801*(alpha[4]*favg[6]+favg[4]*alpha[6])); 
  Ghat[19] = 0.001666666666666667*((367.4234614174769*(fr[47]+fl[47])-212.1320343559643*fr[41]+212.1320343559643*fl[41])*amax+(94.86832980505142*(alpha[8]+alpha[7])+106.0660171779821*alpha[0])*favg[19]+(75.89466384404115*alpha[17]+84.85281374238573*alpha[6])*favg[18]+(75.89466384404115*favg[17]+84.85281374238573*favg[6])*alpha[18]+84.85281374238573*(alpha[5]*favg[17]+favg[5]*alpha[17])+(94.86832980505142*alpha[12]+106.0660171779822*alpha[1])*favg[16]+(94.86832980505142*alpha[11]+106.0660171779822*alpha[2])*favg[15]+84.85281374238573*(alpha[10]*favg[14]+favg[10]*alpha[14]+alpha[10]*favg[13]+favg[10]*alpha[13])+94.86832980505142*(alpha[3]*favg[10]+favg[3]*alpha[10])+106.0660171779821*alpha[4]*favg[9]+94.86832980505142*(alpha[5]*favg[6]+favg[5]*alpha[6])); 
  incr[0] = 0.7071067811865475*Ghat[0]*dfac_v; 
  incr[1] = 0.7071067811865475*Ghat[1]*dfac_v; 
  incr[2] = 0.7071067811865475*Ghat[2]*dfac_v; 
  incr[3] = -1.224744871391589*Ghat[0]*dfac_v; 
  incr[4] = 0.7071067811865475*Ghat[3]*dfac_v; 
  incr[5] = 0.7071067811865475*Ghat[4]*dfac_v; 
  incr[6] = -1.224744871391589*Ghat[1]*dfac_v; 
  incr[7] = -1.224744871391589*Ghat[2]*dfac_v; 
  incr[8] = 0.7071067811865475*Ghat[5]*dfac_v; 
  incr[9] = 0.7071067811865475*Ghat[6]*dfac_v; 
  incr[10] = -1.224744871391589*Ghat[3]*dfac_v; 
  incr[11] = 0.7071067811865475*Ghat[7]*dfac_v; 
  incr[12] = 0.7071067811865475*Ghat[8]*dfac_v; 
  incr[13] = 1.58113883008419*Ghat[0]*dfac_v; 
  incr[14] = 0.7071067811865475*Ghat[9]*dfac_v; 
  incr[15] = -1.224744871391589*Ghat[4]*dfac_v; 
  incr[16] = 0.7071067811865475*Ghat[10]*dfac_v; 
  incr[17] = -1.224744871391589*Ghat[5]*dfac_v; 
  incr[18] = -1.224744871391589*Ghat[6]*dfac_v; 
  incr[19] = 0.7071067811865475*Ghat[11]*dfac_v; 
  incr[20] = 0.7071067811865475*Ghat[12]*dfac_v; 
  incr[21] = -1.224744871391589*Ghat[7]*dfac_v; 
  incr[22] = -1.224744871391589*Ghat[8]*dfac_v; 
  incr[23] = 1.58113883008419*Ghat[1]*dfac_v; 
  incr[24] = 1.58113883008419*Ghat[2]*dfac_v; 
  incr[25] = 0.7071067811865475*Ghat[13]*dfac_v; 
  incr[26] = 0.7071067811865475*Ghat[14]*dfac_v; 
  incr[27] = 1.58113883008419*Ghat[3]*dfac_v; 
  incr[28] = 0.7071067811865475*Ghat[15]*dfac_v; 
  incr[29] = 0.7071067811865475*Ghat[16]*dfac_v; 
  incr[30] = -1.224744871391589*Ghat[9]*dfac_v; 
  incr[31] = -1.224744871391589*Ghat[10]*dfac_v; 
  incr[32] = -1.224744871391589*Ghat[11]*dfac_v; 
  incr[33] = -1.224744871391589*Ghat[12]*dfac_v; 
  incr[34] = 1.58113883008419*Ghat[4]*dfac_v; 
  incr[35] = 0.7071067811865475*Ghat[17]*dfac_v; 
  incr[36] = 0.7071067811865475*Ghat[18]*dfac_v; 
  incr[37] = -1.224744871391589*Ghat[13]*dfac_v; 
  incr[38] = -1.224744871391589*Ghat[14]*dfac_v; 
  incr[39] = 1.58113883008419*Ghat[5]*dfac_v; 
  incr[40] = 1.58113883008419*Ghat[6]*dfac_v; 
  incr[41] = 0.7071067811865475*Ghat[19]*dfac_v; 
  incr[42] = -1.224744871391589*Ghat[15]*dfac_v; 
  incr[43] = -1.224744871391589*Ghat[16]*dfac_v; 
  incr[44] = -1.224744871391589*Ghat[17]*dfac_v; 
  incr[45] = -1.224744871391589*Ghat[18]*dfac_v; 
  incr[46] = 1.58113883008419*Ghat[10]*dfac_v; 
  incr[47] = -1.224744871391589*Ghat[19]*dfac_v; 

  outr[0] += incr[0]; 
  outr[1] += incr[1]; 
  outr[2] += incr[2]; 
  outr[3] += incr[3]; 
  outr[4] += incr[4]; 
  outr[5] += incr[5]; 
  outr[6] += incr[6]; 
  outr[7] += incr[7]; 
  outr[8] += incr[8]; 
  outr[9] += incr[9]; 
  outr[10] += incr[10]; 
  outr[11] += incr[11]; 
  outr[12] += incr[12]; 
  outr[13] += incr[13]; 
  outr[14] += incr[14]; 
  outr[15] += incr[15]; 
  outr[16] += incr[16]; 
  outr[17] += incr[17]; 
  outr[18] += incr[18]; 
  outr[19] += incr[19]; 
  outr[20] += incr[20]; 
  outr[21] += incr[21]; 
  outr[22] += incr[22]; 
  outr[23] += incr[23]; 
  outr[24] += incr[24]; 
  outr[25] += incr[25]; 
  outr[26] += incr[26]; 
  outr[27] += incr[27]; 
  outr[28] += incr[28]; 
  outr[29] += incr[29]; 
  outr[30] += incr[30]; 
  outr[31] += incr[31]; 
  outr[32] += incr[32]; 
  outr[33] += incr[33]; 
  outr[34] += incr[34]; 
  outr[35] += incr[35]; 
  outr[36] += incr[36]; 
  outr[37] += incr[37]; 
  outr[38] += incr[38]; 
  outr[39] += incr[39]; 
  outr[40] += incr[40]; 
  outr[41] += incr[41]; 
  outr[42] += incr[42]; 
  outr[43] += incr[43]; 
  outr[44] += incr[44]; 
  outr[45] += incr[45]; 
  outr[46] += incr[46]; 
  outr[47] += incr[47]; 

  outl[0] += -1.0*incr[0]; 
  outl[1] += -1.0*incr[1]; 
  outl[2] += -1.0*incr[2]; 
  outl[3] += incr[3]; 
  outl[4] += -1.0*incr[4]; 
  outl[5] += -1.0*incr[5]; 
  outl[6] += incr[6]; 
  outl[7] += incr[7]; 
  outl[8] += -1.0*incr[8]; 
  outl[9] += -1.0*incr[9]; 
  outl[10] += incr[10]; 
  outl[11] += -1.0*incr[11]; 
  outl[12] += -1.0*incr[12]; 
  outl[13] += -1.0*incr[13]; 
  outl[14] += -1.0*incr[14]; 
  outl[15] += incr[15]; 
  outl[16] += -1.0*incr[16]; 
  outl[17] += incr[17]; 
  outl[18] += incr[18]; 
  outl[19] += -1.0*incr[19]; 
  outl[20] += -1.0*incr[20]; 
  outl[21] += incr[21]; 
  outl[22] += incr[22]; 
  outl[23] += -1.0*incr[23]; 
  outl[24] += -1.0*incr[24]; 
  outl[25] += -1.0*incr[25]; 
  outl[26] += -1.0*incr[26]; 
  outl[27] += -1.0*incr[27]; 
  outl[28] += -1.0*incr[28]; 
  outl[29] += -1.0*incr[29]; 
  outl[30] += incr[30]; 
  outl[31] += incr[31]; 
  outl[32] += incr[32]; 
  outl[33] += incr[33]; 
  outl[34] += -1.0*incr[34]; 
  outl[35] += -1.0*incr[35]; 
  outl[36] += -1.0*incr[36]; 
  outl[37] += incr[37]; 
  outl[38] += incr[38]; 
  outl[39] += -1.0*incr[39]; 
  outl[40] += -1.0*incr[40]; 
  outl[41] += -1.0*incr[41]; 
  outl[42] += incr[42]; 
  outl[43] += incr[43]; 
  outl[44] += incr[44]; 
  outl[45] += incr[45]; 
  outl[46] += -1.0*incr[46]; 
  outl[47] += incr[47]; 
return std::abs(alpha0); 
} 
