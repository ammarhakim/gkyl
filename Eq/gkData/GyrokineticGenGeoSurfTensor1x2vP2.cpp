#include <GyrokineticModDecl.h>
double GyrokineticGenGeoSurf1x2vTensor_x_P2_Bvars(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *fL, const double *fR, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamilR[27]; 
  hamilR[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*(bmag[0]*wmuR+phi[0]*q_))+2.0*m_))/rdvpar2SqR; 
  hamilR[1] = 2.0*phi[1]*q_; 
  hamilR[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamilR[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamilR[7] = 2.0*phi[2]*q_; 
  hamilR[8] = (0.421637021355784*m_)/rdvpar2SqR; 

  double BstarZdBmagR[27]; 
  BstarZdBmagR[0] = 1.414213562373095*cmag[0]*jacobTotInv[0]; 

  double alphaR[9]; 
  alphaR[0] = (0.4330127018922193*BstarZdBmagR[0]*hamilR[2]*rdvpar2R)/m_; 
  alphaR[1] = (0.9682458365518543*BstarZdBmagR[0]*hamilR[8]*rdvpar2R)/m_; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = (0.1082531754730548*BstarZdBmagR[0]*hamilR[2]*rdvpar2R)/m_; 

  double incr[27]; 
#if upwindType == SURFAVG 
  if (alphaSurfAvgR>0) { 
  incr[0] = 0.08333333333333333*(6.708203932499369*alphaR[1]*fL[11]+6.708203932499369*alphaR[0]*fL[7]+5.196152422706632*(alphaR[1]*fL[4]+alphaR[0]*fL[1])+3.0*(alphaR[1]*fL[2]+alphaR[0]*fL[0])); 
  incr[1] = -0.25*(3.872983346207417*(alphaR[1]*fL[11]+alphaR[0]*fL[7])+3.0*alphaR[1]*fL[4]+1.732050807568877*(alphaR[1]*fL[2]+alphaR[0]*fL[0])+3.0*alphaR[0]*fL[1]); 
  incr[2] = 0.01666666666666667*(30.0*alphaR[1]*fL[20]+3.872983346207417*(6.0*alphaR[1]*fL[12]+8.660254037844386*alphaR[0]*fL[11])+2.23606797749979*alphaR[1]*(6.0*fL[8]+15.0*fL[7])+25.98076211353316*(alphaR[0]*fL[4]+alphaR[1]*fL[1])+15.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1])); 
  incr[3] = 0.08333333333333333*(6.708203932499369*alphaR[1]*fL[17]+6.708203932499369*alphaR[0]*fL[13]+5.196152422706632*(alphaR[1]*fL[10]+alphaR[0]*fL[5])+3.0*(alphaR[1]*fL[6]+alphaR[0]*fL[3])); 
  incr[4] = -0.05*(1.732050807568877*(10.0*alphaR[1]*fL[20]+5.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1]))+3.872983346207417*(3.464101615137754*alphaR[1]*fL[12]+5.0*alphaR[0]*fL[11]+alphaR[1]*(2.0*fL[8]+5.0*fL[7]))+15.0*(alphaR[0]*fL[4]+alphaR[1]*fL[1])); 
  incr[5] = -0.25*(3.872983346207417*(alphaR[1]*fL[17]+alphaR[0]*fL[13])+3.0*alphaR[1]*fL[10]+1.732050807568877*(alphaR[1]*fL[6]+alphaR[0]*fL[3])+3.0*alphaR[0]*fL[5]); 
  incr[6] = 0.01666666666666667*(30.0*alphaR[1]*fL[23]+2.23606797749979*(10.39230484541326*alphaR[1]*fL[18]+15.0*alphaR[0]*fL[17])+6.708203932499369*alphaR[1]*(2.0*fL[14]+5.0*fL[13])+25.98076211353316*(alphaR[0]*fL[10]+alphaR[1]*fL[5])+15.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3])); 
  incr[7] = 0.08333333333333333*(15.0*alphaR[1]*fL[11]+15.0*alphaR[0]*fL[7]+2.23606797749979*(5.196152422706632*(alphaR[1]*fL[4]+alphaR[0]*fL[1])+3.0*(alphaR[1]*fL[2]+alphaR[0]*fL[0]))); 
  incr[8] = 0.01666666666666667*(2.23606797749979*(15.0*alphaR[0]*fL[20]+alphaR[1]*(10.39230484541326*fL[4]+6.0*fL[2]))+8.660254037844387*(3.0*alphaR[0]*fL[12]+3.464101615137754*alphaR[1]*fL[11])+15.0*alphaR[0]*fL[8]); 
  incr[9] = 0.01666666666666667*(33.54101966249685*(alphaR[1]*fL[24]+alphaR[0]*fL[21])+25.98076211353316*alphaR[1]*fL[19]+8.660254037844387*(1.732050807568877*alphaR[1]*fL[16]+3.0*alphaR[0]*fL[15])+15.0*alphaR[0]*fL[9]); 
  incr[10] = -0.05*(1.732050807568877*(10.0*alphaR[1]*fL[23]+5.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3]))+2.23606797749979*(6.0*alphaR[1]*fL[18]+8.660254037844386*alphaR[0]*fL[17])+3.872983346207417*alphaR[1]*(2.0*fL[14]+5.0*fL[13])+15.0*(alphaR[0]*fL[10]+alphaR[1]*fL[5])); 
  incr[11] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(10.0*alphaR[1]*fL[20]+5.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1]))+3.872983346207417*alphaR[1]*(2.0*fL[8]+5.0*fL[7])+15.0*(alphaR[0]*fL[4]+alphaR[1]*fL[1]))+51.96152422706631*alphaR[1]*fL[12]+75.0*alphaR[0]*fL[11]); 
  incr[12] = -0.05*(3.872983346207417*(alphaR[0]*(5.0*fL[20]+2.23606797749979*fL[8])+alphaR[1]*(3.464101615137754*fL[4]+2.0*fL[2]))+15.0*alphaR[0]*fL[12]+17.32050807568877*alphaR[1]*fL[11]); 
  incr[13] = 0.08333333333333333*(3.872983346207417*(alphaR[1]*(3.872983346207417*fL[17]+3.0*fL[10])+1.732050807568877*(alphaR[1]*fL[6]+alphaR[0]*fL[3])+3.0*alphaR[0]*fL[5])+15.0*alphaR[0]*fL[13]); 
  incr[14] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(5.0*alphaR[0]*fL[23]+2.0*alphaR[1]*fL[6])+2.23606797749979*(3.0*alphaR[0]*fL[18]+3.464101615137754*alphaR[1]*fL[17])+6.0*alphaR[1]*fL[10])+15.0*alphaR[0]*fL[14]); 
  incr[15] = -0.05*(3.872983346207417*(5.0*(alphaR[1]*fL[24]+alphaR[0]*fL[21])+2.23606797749979*(1.732050807568877*alphaR[1]*fL[19]+alphaR[0]*fL[9]))+8.660254037844386*alphaR[1]*fL[16]+15.0*alphaR[0]*fL[15]); 
  incr[16] = 0.01666666666666667*(3.872983346207417*(2.23606797749979*(1.732050807568877*alphaR[1]*(2.0*fL[26]+fL[9])+3.0*alphaR[0]*fL[19])+6.0*alphaR[1]*fL[25]+1.732050807568877*(5.0*alphaR[0]*fL[24]+alphaR[1]*(2.0*fL[22]+5.0*fL[21])))+15.0*alphaR[0]*fL[16]+25.98076211353316*alphaR[1]*fL[15]); 
  incr[17] = 0.01666666666666667*(2.23606797749979*(30.0*alphaR[1]*fL[23]+25.98076211353316*(alphaR[0]*fL[10]+alphaR[1]*fL[5])+15.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3]))+51.96152422706631*alphaR[1]*fL[18]+75.0*alphaR[0]*fL[17]+15.0*alphaR[1]*(2.0*fL[14]+5.0*fL[13])); 
  incr[18] = -0.05*(2.23606797749979*(1.732050807568877*(5.0*alphaR[0]*fL[23]+2.0*alphaR[1]*fL[6])+6.0*alphaR[1]*fL[10])+15.0*alphaR[0]*fL[18]+17.32050807568877*alphaR[1]*fL[17]+8.660254037844387*alphaR[0]*fL[14]); 
  incr[19] = -0.05*(1.732050807568877*alphaR[1]*(10.0*fL[26]+5.0*fL[9])+2.23606797749979*(6.0*alphaR[1]*fL[25]+1.732050807568877*(5.0*alphaR[0]*fL[24]+alphaR[1]*(2.0*fL[22]+5.0*fL[21])))+15.0*alphaR[0]*fL[19]+8.660254037844387*(alphaR[0]*fL[16]+1.732050807568877*alphaR[1]*fL[15])); 
  incr[20] = 0.08333333333333333*(15.0*alphaR[0]*fL[20]+3.872983346207417*(3.0*alphaR[0]*fL[12]+3.464101615137754*alphaR[1]*fL[11])+6.708203932499369*alphaR[0]*fL[8]+alphaR[1]*(10.39230484541326*fL[4]+6.0*fL[2])); 
  incr[21] = 0.08333333333333333*(15.0*(alphaR[1]*fL[24]+alphaR[0]*fL[21])+2.23606797749979*(5.196152422706631*alphaR[1]*fL[19]+3.0*alphaR[0]*fL[9])+3.872983346207417*(1.732050807568877*alphaR[1]*fL[16]+3.0*alphaR[0]*fL[15])); 
  incr[22] = 0.01666666666666667*(2.23606797749979*(15.0*alphaR[0]*fL[26]+10.39230484541326*alphaR[1]*fL[19])+25.98076211353316*alphaR[0]*fL[25]+30.0*alphaR[1]*fL[24]+15.0*alphaR[0]*fL[22]+13.41640786499874*alphaR[1]*fL[16]); 
  incr[23] = 0.08333333333333333*(15.0*alphaR[0]*fL[23]+2.23606797749979*(5.196152422706631*alphaR[0]*fL[18]+6.0*alphaR[1]*fL[17])+6.708203932499369*alphaR[0]*fL[14]+alphaR[1]*(10.39230484541326*fL[10]+6.0*fL[6])); 
  incr[24] = 0.08333333333333333*(2.23606797749979*(6.0*alphaR[1]*fL[26]+5.196152422706631*alphaR[0]*fL[19]+3.0*alphaR[1]*fL[9])+10.39230484541326*alphaR[1]*fL[25]+15.0*alphaR[0]*fL[24]+alphaR[1]*(6.0*fL[22]+15.0*fL[21])+3.872983346207417*(1.732050807568877*alphaR[0]*fL[16]+3.0*alphaR[1]*fL[15])); 
  incr[25] = -0.05*(2.23606797749979*(8.660254037844386*alphaR[0]*fL[26]+6.0*alphaR[1]*fL[19])+15.0*alphaR[0]*fL[25]+1.732050807568877*(10.0*alphaR[1]*fL[24]+5.0*alphaR[0]*fL[22])+7.745966692414834*alphaR[1]*fL[16]); 
  incr[26] = 0.01666666666666667*(75.0*alphaR[0]*fL[26]+2.23606797749979*(25.98076211353316*alphaR[0]*fL[25]+30.0*alphaR[1]*fL[24]+15.0*alphaR[0]*fL[22])+alphaR[1]*(51.96152422706631*fL[19]+30.0*fL[16])); 
  } else { 
  incr[0] = 0.08333333333333333*(6.708203932499369*alphaR[1]*fR[11]+6.708203932499369*alphaR[0]*fR[7]-5.196152422706632*(alphaR[1]*fR[4]+alphaR[0]*fR[1])+3.0*(alphaR[1]*fR[2]+alphaR[0]*fR[0])); 
  incr[1] = -0.25*(3.872983346207417*(alphaR[1]*fR[11]+alphaR[0]*fR[7])-3.0*alphaR[1]*fR[4]+1.732050807568877*(alphaR[1]*fR[2]+alphaR[0]*fR[0])-3.0*alphaR[0]*fR[1]); 
  incr[2] = 0.01666666666666667*(30.0*alphaR[1]*fR[20]+3.872983346207417*(8.660254037844386*alphaR[0]*fR[11]-6.0*alphaR[1]*fR[12])+2.23606797749979*alphaR[1]*(6.0*fR[8]+15.0*fR[7])-25.98076211353316*(alphaR[0]*fR[4]+alphaR[1]*fR[1])+15.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1])); 
  incr[3] = 0.08333333333333333*(6.708203932499369*alphaR[1]*fR[17]+6.708203932499369*alphaR[0]*fR[13]-5.196152422706632*(alphaR[1]*fR[10]+alphaR[0]*fR[5])+3.0*(alphaR[1]*fR[6]+alphaR[0]*fR[3])); 
  incr[4] = 0.05*(1.732050807568877*((-10.0*alphaR[1]*fR[20])-5.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1]))+3.872983346207417*(3.464101615137754*alphaR[1]*fR[12]-5.0*alphaR[0]*fR[11]+alphaR[1]*((-2.0*fR[8])-5.0*fR[7]))+15.0*(alphaR[0]*fR[4]+alphaR[1]*fR[1])); 
  incr[5] = -0.25*(3.872983346207417*(alphaR[1]*fR[17]+alphaR[0]*fR[13])-3.0*alphaR[1]*fR[10]+1.732050807568877*(alphaR[1]*fR[6]+alphaR[0]*fR[3])-3.0*alphaR[0]*fR[5]); 
  incr[6] = 0.01666666666666667*(30.0*alphaR[1]*fR[23]+2.23606797749979*(15.0*alphaR[0]*fR[17]-10.39230484541326*alphaR[1]*fR[18])+6.708203932499369*alphaR[1]*(2.0*fR[14]+5.0*fR[13])-25.98076211353316*(alphaR[0]*fR[10]+alphaR[1]*fR[5])+15.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3])); 
  incr[7] = 0.08333333333333333*(15.0*alphaR[1]*fR[11]+15.0*alphaR[0]*fR[7]+2.23606797749979*(3.0*(alphaR[1]*fR[2]+alphaR[0]*fR[0])-5.196152422706632*(alphaR[1]*fR[4]+alphaR[0]*fR[1]))); 
  incr[8] = 0.01666666666666667*(2.23606797749979*(15.0*alphaR[0]*fR[20]+alphaR[1]*(6.0*fR[2]-10.39230484541326*fR[4]))+8.660254037844387*(3.464101615137754*alphaR[1]*fR[11]-3.0*alphaR[0]*fR[12])+15.0*alphaR[0]*fR[8]); 
  incr[9] = 0.01666666666666667*(33.54101966249685*(alphaR[1]*fR[24]+alphaR[0]*fR[21])-25.98076211353316*alphaR[1]*fR[19]+8.660254037844387*(1.732050807568877*alphaR[1]*fR[16]-3.0*alphaR[0]*fR[15])+15.0*alphaR[0]*fR[9]); 
  incr[10] = -0.05*(1.732050807568877*(10.0*alphaR[1]*fR[23]+5.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3]))+2.23606797749979*(8.660254037844386*alphaR[0]*fR[17]-6.0*alphaR[1]*fR[18])+3.872983346207417*alphaR[1]*(2.0*fR[14]+5.0*fR[13])-15.0*(alphaR[0]*fR[10]+alphaR[1]*fR[5])); 
  incr[11] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(10.0*alphaR[1]*fR[20]+5.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1]))+3.872983346207417*alphaR[1]*(2.0*fR[8]+5.0*fR[7])-15.0*(alphaR[0]*fR[4]+alphaR[1]*fR[1]))-51.96152422706631*alphaR[1]*fR[12]+75.0*alphaR[0]*fR[11]); 
  incr[12] = -0.05*(3.872983346207417*(alphaR[0]*(5.0*fR[20]+2.23606797749979*fR[8])+alphaR[1]*(2.0*fR[2]-3.464101615137754*fR[4]))-15.0*alphaR[0]*fR[12]+17.32050807568877*alphaR[1]*fR[11]); 
  incr[13] = 0.08333333333333333*(3.872983346207417*(alphaR[1]*(3.872983346207417*fR[17]-3.0*fR[10])+1.732050807568877*(alphaR[1]*fR[6]+alphaR[0]*fR[3])-3.0*alphaR[0]*fR[5])+15.0*alphaR[0]*fR[13]); 
  incr[14] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(5.0*alphaR[0]*fR[23]+2.0*alphaR[1]*fR[6])+2.23606797749979*(3.464101615137754*alphaR[1]*fR[17]-3.0*alphaR[0]*fR[18])-6.0*alphaR[1]*fR[10])+15.0*alphaR[0]*fR[14]); 
  incr[15] = 0.05*(3.872983346207417*(2.23606797749979*(1.732050807568877*alphaR[1]*fR[19]-1.0*alphaR[0]*fR[9])-5.0*(alphaR[1]*fR[24]+alphaR[0]*fR[21]))-8.660254037844386*alphaR[1]*fR[16]+15.0*alphaR[0]*fR[15]); 
  incr[16] = 0.01666666666666667*(3.872983346207417*(2.23606797749979*(1.732050807568877*alphaR[1]*(2.0*fR[26]+fR[9])-3.0*alphaR[0]*fR[19])-6.0*alphaR[1]*fR[25]+1.732050807568877*(5.0*alphaR[0]*fR[24]+alphaR[1]*(2.0*fR[22]+5.0*fR[21])))+15.0*alphaR[0]*fR[16]-25.98076211353316*alphaR[1]*fR[15]); 
  incr[17] = 0.01666666666666667*(2.23606797749979*(30.0*alphaR[1]*fR[23]-25.98076211353316*(alphaR[0]*fR[10]+alphaR[1]*fR[5])+15.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3]))-51.96152422706631*alphaR[1]*fR[18]+75.0*alphaR[0]*fR[17]+15.0*alphaR[1]*(2.0*fR[14]+5.0*fR[13])); 
  incr[18] = -0.05*(2.23606797749979*(1.732050807568877*(5.0*alphaR[0]*fR[23]+2.0*alphaR[1]*fR[6])-6.0*alphaR[1]*fR[10])-15.0*alphaR[0]*fR[18]+17.32050807568877*alphaR[1]*fR[17]+8.660254037844387*alphaR[0]*fR[14]); 
  incr[19] = 0.05*(1.732050807568877*alphaR[1]*((-10.0*fR[26])-5.0*fR[9])+2.23606797749979*(6.0*alphaR[1]*fR[25]+1.732050807568877*(alphaR[1]*((-2.0*fR[22])-5.0*fR[21])-5.0*alphaR[0]*fR[24]))+15.0*alphaR[0]*fR[19]+8.660254037844387*(1.732050807568877*alphaR[1]*fR[15]-1.0*alphaR[0]*fR[16])); 
  incr[20] = 0.08333333333333333*(15.0*alphaR[0]*fR[20]+3.872983346207417*(3.464101615137754*alphaR[1]*fR[11]-3.0*alphaR[0]*fR[12])+6.708203932499369*alphaR[0]*fR[8]+alphaR[1]*(6.0*fR[2]-10.39230484541326*fR[4])); 
  incr[21] = 0.08333333333333333*(15.0*(alphaR[1]*fR[24]+alphaR[0]*fR[21])+2.23606797749979*(3.0*alphaR[0]*fR[9]-5.196152422706631*alphaR[1]*fR[19])+3.872983346207417*(1.732050807568877*alphaR[1]*fR[16]-3.0*alphaR[0]*fR[15])); 
  incr[22] = 0.01666666666666667*(2.23606797749979*(15.0*alphaR[0]*fR[26]-10.39230484541326*alphaR[1]*fR[19])-25.98076211353316*alphaR[0]*fR[25]+30.0*alphaR[1]*fR[24]+15.0*alphaR[0]*fR[22]+13.41640786499874*alphaR[1]*fR[16]); 
  incr[23] = 0.08333333333333333*(15.0*alphaR[0]*fR[23]+2.23606797749979*(6.0*alphaR[1]*fR[17]-5.196152422706631*alphaR[0]*fR[18])+6.708203932499369*alphaR[0]*fR[14]+alphaR[1]*(6.0*fR[6]-10.39230484541326*fR[10])); 
  incr[24] = 0.08333333333333333*(2.23606797749979*(6.0*alphaR[1]*fR[26]-5.196152422706631*alphaR[0]*fR[19]+3.0*alphaR[1]*fR[9])-10.39230484541326*alphaR[1]*fR[25]+15.0*alphaR[0]*fR[24]+alphaR[1]*(6.0*fR[22]+15.0*fR[21])+3.872983346207417*(1.732050807568877*alphaR[0]*fR[16]-3.0*alphaR[1]*fR[15])); 
  incr[25] = -0.05*(2.23606797749979*(8.660254037844386*alphaR[0]*fR[26]-6.0*alphaR[1]*fR[19])-15.0*alphaR[0]*fR[25]+1.732050807568877*(10.0*alphaR[1]*fR[24]+5.0*alphaR[0]*fR[22])+7.745966692414834*alphaR[1]*fR[16]); 
  incr[26] = 0.01666666666666667*(75.0*alphaR[0]*fR[26]+2.23606797749979*((-25.98076211353316*alphaR[0]*fR[25])+30.0*alphaR[1]*fR[24]+15.0*alphaR[0]*fR[22])+alphaR[1]*(30.0*fR[16]-51.96152422706631*fR[19])); 
  }
#elif upwindType == QUAD 
  double alphaOrdR;
  double fUpOrd[9];
  alphaOrdR = 0.5*alphaR[0]-0.6708203932499369*alphaR[1]; 
  fUpOrd[0] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])+0.9486832980505122*fR[24]-0.9486832980505122*fL[24]+0.9486832980505137*fR[23]-0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])-0.7348469228349525*(fR[19]+fL[19])-0.7348469228349533*(fR[18]+fL[18])-1.42302494707577*fR[17]+1.42302494707577*fL[17]+0.4242640687119281*fR[16]-0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])+0.4242640687119285*fR[14]-0.4242640687119285*fL[14]+1.060660171779821*fR[13]-1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])+1.060660171779821*fR[11]-1.060660171779821*fL[11]+1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6363961030678926*fR[6]+0.6363961030678926*fL[6]-0.8215838362577489*(fR[5]+fL[5]+fR[4]+fL[4])+0.4743416490252568*(fR[3]+fR[2])-0.4743416490252568*(fL[3]+fL[2])+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]-0.9486832980505122*(fR[24]+fL[24])-0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])+0.7348469228349525*fR[19]-0.7348469228349525*fL[19]+0.7348469228349533*fR[18]-0.7348469228349533*fL[18]+1.42302494707577*(fR[17]+fL[17])-0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]-0.4242640687119285*(fR[14]+fL[14])-1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]-1.060660171779821*(fR[11]+fL[11])-1.10227038425243*fR[10]+1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6363961030678926*(fR[6]+fL[6])+0.8215838362577489*(fR[5]+fR[4])-0.8215838362577489*(fL[5]+fL[4])-0.4743416490252568*(fR[3]+fL[3]+fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]; 
  fUpOrd[1] = 0.5*(((-0.883883476483184*fR[23])+0.883883476483184*(fL[23]+fR[20])-0.883883476483184*fL[20]+0.6846531968814573*(fR[18]+fL[18])-0.3952847075210473*fR[14]+0.3952847075210473*fL[14]+0.7905694150420948*fR[13]-0.7905694150420948*fL[13]-0.6846531968814574*(fR[12]+fL[12])+0.3952847075210473*fR[8]-0.3952847075210473*fL[8]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6123724356957944*(fR[5]+fL[5])+0.3535533905932737*fR[3]-0.3535533905932737*fL[3]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.883883476483184*(fR[23]+fL[23])-0.883883476483184*(fR[20]+fL[20])-0.6846531968814573*fR[18]+0.6846531968814573*fL[18]+0.3952847075210473*(fR[14]+fL[14])-0.7905694150420948*(fR[13]+fL[13])+0.6846531968814574*fR[12]-0.6846531968814574*fL[12]-0.3952847075210473*(fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6123724356957944*fR[5]-0.6123724356957944*fL[5]-0.3535533905932737*(fR[3]+fL[3])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[2] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])-0.9486832980505122*fR[24]+0.9486832980505122*fL[24]+0.9486832980505137*fR[23]-0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])+0.7348469228349525*(fR[19]+fL[19])-0.7348469228349533*(fR[18]+fL[18])+1.42302494707577*fR[17]-1.42302494707577*fL[17]-0.4242640687119281*fR[16]+0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])+0.4242640687119285*fR[14]-0.4242640687119285*fL[14]+1.060660171779821*fR[13]-1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])-1.060660171779821*fR[11]+1.060660171779821*fL[11]-1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6363961030678926*fR[6]-0.6363961030678926*fL[6]-0.8215838362577489*(fR[5]+fL[5])+0.8215838362577489*(fR[4]+fL[4])+0.4743416490252568*fR[3]-0.4743416490252568*(fL[3]+fR[2])+0.4743416490252568*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]+0.9486832980505122*(fR[24]+fL[24])-0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])-0.7348469228349525*fR[19]+0.7348469228349525*fL[19]+0.7348469228349533*fR[18]-0.7348469228349533*fL[18]-1.42302494707577*(fR[17]+fL[17])+0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]-0.4242640687119285*(fR[14]+fL[14])-1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]+1.060660171779821*(fR[11]+fL[11])+1.10227038425243*fR[10]-1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6363961030678926*(fR[6]+fL[6])+0.8215838362577489*fR[5]-0.8215838362577489*(fL[5]+fR[4])+0.8215838362577489*fL[4]-0.4743416490252568*(fR[3]+fL[3])+0.4743416490252568*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.5*alphaR[1]; 
  fUpOrd[3] = 0.5*(((-0.883883476483184*fR[24])+0.883883476483184*(fL[24]+fR[21])-0.883883476483184*fL[21]+0.6846531968814573*(fR[19]+fL[19])-0.3952847075210473*fR[16]+0.3952847075210473*fL[16]-0.6846531968814574*(fR[15]+fL[15])+0.7905694150420948*fR[11]-0.7905694150420948*fL[11]+0.3952847075210473*fR[9]-0.3952847075210473*fL[9]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6123724356957944*(fR[4]+fL[4])+0.3535533905932737*fR[2]-0.3535533905932737*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.883883476483184*(fR[24]+fL[24])-0.883883476483184*(fR[21]+fL[21])-0.6846531968814573*fR[19]+0.6846531968814573*fL[19]+0.3952847075210473*(fR[16]+fL[16])+0.6846531968814574*fR[15]-0.6846531968814574*fL[15]-0.7905694150420948*(fR[11]+fL[11])-0.3952847075210473*(fR[9]+fL[9])+0.7905694150420947*(fR[7]+fL[7])+0.6123724356957944*fR[4]-0.6123724356957944*fL[4]-0.3535533905932737*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]; 
  fUpOrd[4] = 0.5*(((-0.9882117688026183*fR[26])+0.9882117688026183*fL[26]+0.7654655446197428*(fR[25]+fL[25])-0.441941738241592*fR[22]+0.441941738241592*fL[22]+0.883883476483184*(fR[21]+fR[20])-0.883883476483184*(fL[21]+fL[20])-0.6846531968814574*(fR[15]+fL[15]+fR[12]+fL[12])+0.3952847075210473*(fR[9]+fR[8])-0.3952847075210473*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.9882117688026183*(fR[26]+fL[26])-0.7654655446197428*fR[25]+0.7654655446197428*fL[25]+0.441941738241592*(fR[22]+fL[22])-0.883883476483184*(fR[21]+fL[21]+fR[20]+fL[20])+0.6846531968814574*(fR[15]+fR[12])-0.6846531968814574*(fL[15]+fL[12])-0.3952847075210473*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*(alphaR[1]+alphaR[0]); 
  fUpOrd[5] = 0.5*((0.883883476483184*(fR[24]+fR[21])-0.883883476483184*(fL[24]+fL[21])-0.6846531968814573*(fR[19]+fL[19])+0.3952847075210473*fR[16]-0.3952847075210473*fL[16]-0.6846531968814574*(fR[15]+fL[15])-0.7905694150420948*fR[11]+0.7905694150420948*fL[11]+0.3952847075210473*fR[9]-0.3952847075210473*fL[9]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[4]+fL[4])-0.3535533905932737*fR[2]+0.3535533905932737*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)-0.883883476483184*(fR[24]+fL[24]+fR[21]+fL[21])+0.6846531968814573*fR[19]-0.6846531968814573*fL[19]-0.3952847075210473*(fR[16]+fL[16])+0.6846531968814574*fR[15]-0.6846531968814574*fL[15]+0.7905694150420948*(fR[11]+fL[11])-0.3952847075210473*(fR[9]+fL[9])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[4]+0.6123724356957944*fL[4]+0.3535533905932737*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.6708203932499369*alphaR[1]; 
  fUpOrd[6] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])+0.9486832980505122*fR[24]-0.9486832980505122*fL[24]-0.9486832980505137*fR[23]+0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])-0.7348469228349525*(fR[19]+fL[19])+0.7348469228349533*(fR[18]+fL[18])+1.42302494707577*fR[17]-1.42302494707577*fL[17]+0.4242640687119281*fR[16]-0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])-0.4242640687119285*fR[14]+0.4242640687119285*fL[14]-1.060660171779821*fR[13]+1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])+1.060660171779821*fR[11]-1.060660171779821*fL[11]-1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6363961030678926*fR[6]-0.6363961030678926*fL[6]+0.8215838362577489*(fR[5]+fL[5])-0.8215838362577489*(fR[4]+fL[4])-0.4743416490252568*fR[3]+0.4743416490252568*(fL[3]+fR[2])-0.4743416490252568*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]-0.9486832980505122*(fR[24]+fL[24])+0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])+0.7348469228349525*fR[19]-0.7348469228349525*fL[19]-0.7348469228349533*fR[18]+0.7348469228349533*fL[18]-1.42302494707577*(fR[17]+fL[17])-0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]+0.4242640687119285*(fR[14]+fL[14])+1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]-1.060660171779821*(fR[11]+fL[11])+1.10227038425243*fR[10]-1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6363961030678926*(fR[6]+fL[6])-0.8215838362577489*fR[5]+0.8215838362577489*(fL[5]+fR[4])-0.8215838362577489*fL[4]+0.4743416490252568*(fR[3]+fL[3])-0.4743416490252568*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]; 
  fUpOrd[7] = 0.5*((0.883883476483184*(fR[23]+fR[20])-0.883883476483184*(fL[23]+fL[20])-0.6846531968814573*(fR[18]+fL[18])+0.3952847075210473*fR[14]-0.3952847075210473*fL[14]-0.7905694150420948*fR[13]+0.7905694150420948*fL[13]-0.6846531968814574*(fR[12]+fL[12])+0.3952847075210473*fR[8]-0.3952847075210473*fL[8]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[5]+fL[5])-0.3535533905932737*fR[3]+0.3535533905932737*fL[3]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)-0.883883476483184*(fR[23]+fL[23]+fR[20]+fL[20])+0.6846531968814573*fR[18]-0.6846531968814573*fL[18]-0.3952847075210473*(fR[14]+fL[14])+0.7905694150420948*(fR[13]+fL[13])+0.6846531968814574*fR[12]-0.6846531968814574*fL[12]-0.3952847075210473*(fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[5]+0.6123724356957944*fL[5]+0.3535533905932737*(fR[3]+fL[3])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[8] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])-0.9486832980505122*fR[24]+0.9486832980505122*fL[24]-0.9486832980505137*fR[23]+0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])+0.7348469228349525*(fR[19]+fL[19])+0.7348469228349533*(fR[18]+fL[18])-1.42302494707577*fR[17]+1.42302494707577*fL[17]-0.4242640687119281*fR[16]+0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])-0.4242640687119285*fR[14]+0.4242640687119285*fL[14]-1.060660171779821*fR[13]+1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])-1.060660171779821*fR[11]+1.060660171779821*fL[11]+1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6363961030678926*fR[6]+0.6363961030678926*fL[6]+0.8215838362577489*(fR[5]+fL[5]+fR[4]+fL[4])-0.4743416490252568*(fR[3]+fR[2])+0.4743416490252568*(fL[3]+fL[2])+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]+0.9486832980505122*(fR[24]+fL[24])+0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])-0.7348469228349525*fR[19]+0.7348469228349525*fL[19]-0.7348469228349533*fR[18]+0.7348469228349533*fL[18]+1.42302494707577*(fR[17]+fL[17])+0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]+0.4242640687119285*(fR[14]+fL[14])+1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]+1.060660171779821*(fR[11]+fL[11])-1.10227038425243*fR[10]+1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6363961030678926*(fR[6]+fL[6])-0.8215838362577489*(fR[5]+fR[4])+0.8215838362577489*(fL[5]+fL[4])+0.4743416490252568*(fR[3]+fL[3]+fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 

  double fUp[9];
  fUp[0] = 0.006172839506172839*(25.0*fUpOrd[8]+72.0*fUpOrd[7]+25.0*fUpOrd[6]+8.0*(9.0*fUpOrd[5]-8.0*fUpOrd[4]+9.0*fUpOrd[3])+25.0*fUpOrd[2]+72.0*fUpOrd[1]+25.0*fUpOrd[0]); 
  fUp[1] = 0.01851851851851852*(11.18033988749895*(fUpOrd[8]-1.0*fUpOrd[6]+fUpOrd[2]-1.0*fUpOrd[0])+24.0*(fUpOrd[5]-1.0*fUpOrd[3])); 
  fUp[2] = 0.01851851851851852*(11.18033988749895*(fUpOrd[8]+fUpOrd[6]-1.0*(fUpOrd[2]+fUpOrd[0]))+24.0*(fUpOrd[7]-1.0*fUpOrd[1])); 
  fUp[3] = 0.2777777777777778*(fUpOrd[8]-1.0*(fUpOrd[6]+fUpOrd[2])+fUpOrd[0]); 
  fUp[4] = 0.00552115549999948*(5.0*(5.0*fUpOrd[8]-18.0*fUpOrd[7]+5.0*fUpOrd[6])+8.0*(9.0*fUpOrd[5]-8.0*fUpOrd[4]+9.0*fUpOrd[3])+5.0*(5.0*fUpOrd[2]-18.0*fUpOrd[1]+5.0*fUpOrd[0])); 
  fUp[5] = 0.00552115549999948*(25.0*fUpOrd[8]+72.0*fUpOrd[7]+25.0*fUpOrd[6]-2.0*(45.0*fUpOrd[5]+32.0*fUpOrd[4])+5.0*(5.0*fUpOrd[2]-18.0*fUpOrd[3])+72.0*fUpOrd[1]+25.0*fUpOrd[0]); 
  fUp[6] = 0.08281733249999224*(2.23606797749979*(fUpOrd[8]+fUpOrd[6]-1.0*(fUpOrd[2]+fUpOrd[0]))+6.0*(fUpOrd[1]-1.0*fUpOrd[7])); 
  fUp[7] = 0.08281733249999224*(2.23606797749979*(fUpOrd[8]-1.0*fUpOrd[6]+fUpOrd[2]-1.0*fUpOrd[0])+6.0*(fUpOrd[3]-1.0*fUpOrd[5])); 
  fUp[8] = 0.02469135802469136*(5.0*fUpOrd[8]-18.0*fUpOrd[7]+5.0*fUpOrd[6]+2.0*((-9.0*fUpOrd[5])+26.0*fUpOrd[4]-9.0*fUpOrd[3])+5.0*fUpOrd[2]-18.0*fUpOrd[1]+5.0*fUpOrd[0]); 

  incr[0] = 0.3535533905932737*(alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[1] = -0.6123724356957944*(alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[2] = 0.07071067811865474*(4.47213595499958*alphaR[1]*fUp[4]+5.0*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[3] = 0.3535533905932737*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2]); 
  incr[4] = -0.07071067811865474*(7.745966692414834*alphaR[1]*fUp[4]+8.660254037844386*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[5] = -0.6123724356957944*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2]); 
  incr[6] = 0.02357022603955158*(13.41640786499874*alphaR[1]*fUp[6]+15.0*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[7] = 0.7905694150420947*(alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[8] = 0.07071067811865474*(5.0*alphaR[0]*fUp[4]+4.47213595499958*alphaR[1]*fUp[1]); 
  incr[9] = 0.02357022603955158*(15.0*alphaR[1]*fUp[7]+15.0*alphaR[0]*fUp[5]); 
  incr[10] = -0.07071067811865474*(7.745966692414834*alphaR[1]*fUp[6]+8.660254037844386*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[11] = 0.09128709291752765*(7.745966692414834*alphaR[1]*fUp[4]+8.660254037844386*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[12] = -0.273861278752583*(2.23606797749979*alphaR[0]*fUp[4]+2.0*alphaR[1]*fUp[1]); 
  incr[13] = 0.7905694150420948*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2]); 
  incr[14] = 0.02357022603955158*(15.0*alphaR[0]*fUp[6]+13.41640786499874*alphaR[1]*fUp[3]); 
  incr[15] = -0.07071067811865474*(8.660254037844386*alphaR[1]*fUp[7]+8.660254037844387*alphaR[0]*fUp[5]); 
  incr[16] = 0.02357022603955158*(3.872983346207417*alphaR[1]*(3.464101615137754*fUp[8]+3.872983346207417*fUp[5])+15.0*alphaR[0]*fUp[7]); 
  incr[17] = 0.02357022603955158*(30.0*alphaR[1]*fUp[6]+33.54101966249685*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[18] = -0.07071067811865474*(8.660254037844387*alphaR[0]*fUp[6]+7.745966692414834*alphaR[1]*fUp[3]); 
  incr[19] = -0.07071067811865474*(7.745966692414834*alphaR[1]*fUp[8]+8.660254037844387*alphaR[0]*fUp[7]+8.660254037844386*alphaR[1]*fUp[5]); 
  incr[20] = 0.3535533905932737*(2.23606797749979*alphaR[0]*fUp[4]+2.0*alphaR[1]*fUp[1]); 
  incr[21] = 0.1178511301977579*(6.708203932499369*alphaR[1]*fUp[7]+6.708203932499369*alphaR[0]*fUp[5]); 
  incr[22] = 0.02357022603955158*(15.0*alphaR[0]*fUp[8]+13.41640786499874*alphaR[1]*fUp[7]); 
  incr[23] = 0.1178511301977579*(6.708203932499369*alphaR[0]*fUp[6]+6.0*alphaR[1]*fUp[3]); 
  incr[24] = 0.1178511301977579*(6.0*alphaR[1]*fUp[8]+6.708203932499369*alphaR[0]*fUp[7]+6.708203932499369*alphaR[1]*fUp[5]); 
  incr[25] = -0.07071067811865474*(8.660254037844386*alphaR[0]*fUp[8]+7.745966692414834*alphaR[1]*fUp[7]); 
  incr[26] = 0.02357022603955158*(33.54101966249685*alphaR[0]*fUp[8]+30.0*alphaR[1]*fUp[7]); 

#endif 
  outR[0] += incr[0]*rdx2R; 
  outR[1] += incr[1]*rdx2R; 
  outR[2] += incr[2]*rdx2R; 
  outR[3] += incr[3]*rdx2R; 
  outR[4] += incr[4]*rdx2R; 
  outR[5] += incr[5]*rdx2R; 
  outR[6] += incr[6]*rdx2R; 
  outR[7] += incr[7]*rdx2R; 
  outR[8] += incr[8]*rdx2R; 
  outR[9] += incr[9]*rdx2R; 
  outR[10] += incr[10]*rdx2R; 
  outR[11] += incr[11]*rdx2R; 
  outR[12] += incr[12]*rdx2R; 
  outR[13] += incr[13]*rdx2R; 
  outR[14] += incr[14]*rdx2R; 
  outR[15] += incr[15]*rdx2R; 
  outR[16] += incr[16]*rdx2R; 
  outR[17] += incr[17]*rdx2R; 
  outR[18] += incr[18]*rdx2R; 
  outR[19] += incr[19]*rdx2R; 
  outR[20] += incr[20]*rdx2R; 
  outR[21] += incr[21]*rdx2R; 
  outR[22] += incr[22]*rdx2R; 
  outR[23] += incr[23]*rdx2R; 
  outR[24] += incr[24]*rdx2R; 
  outR[25] += incr[25]*rdx2R; 
  outR[26] += incr[26]*rdx2R; 

  outL[0] += -1.0*incr[0]*rdx2L; 
  outL[1] += incr[1]*rdx2L; 
  outL[2] += -1.0*incr[2]*rdx2L; 
  outL[3] += -1.0*incr[3]*rdx2L; 
  outL[4] += incr[4]*rdx2L; 
  outL[5] += incr[5]*rdx2L; 
  outL[6] += -1.0*incr[6]*rdx2L; 
  outL[7] += -1.0*incr[7]*rdx2L; 
  outL[8] += -1.0*incr[8]*rdx2L; 
  outL[9] += -1.0*incr[9]*rdx2L; 
  outL[10] += incr[10]*rdx2L; 
  outL[11] += -1.0*incr[11]*rdx2L; 
  outL[12] += incr[12]*rdx2L; 
  outL[13] += -1.0*incr[13]*rdx2L; 
  outL[14] += -1.0*incr[14]*rdx2L; 
  outL[15] += incr[15]*rdx2L; 
  outL[16] += -1.0*incr[16]*rdx2L; 
  outL[17] += -1.0*incr[17]*rdx2L; 
  outL[18] += incr[18]*rdx2L; 
  outL[19] += incr[19]*rdx2L; 
  outL[20] += -1.0*incr[20]*rdx2L; 
  outL[21] += -1.0*incr[21]*rdx2L; 
  outL[22] += -1.0*incr[22]*rdx2L; 
  outL[23] += -1.0*incr[23]*rdx2L; 
  outL[24] += -1.0*incr[24]*rdx2L; 
  outL[25] += incr[25]*rdx2L; 
  outL[26] += -1.0*incr[26]*rdx2L; 

  return std::abs(alphaSurfAvgR); 
} 
double GyrokineticGenGeoSurf1x2vTensor_vpar_P2_Bvars(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *fL, const double *fR, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamilR[27]; 
  hamilR[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*(bmag[0]*wmuR+phi[0]*q_))+2.0*m_))/rdvpar2SqR; 
  hamilR[1] = 2.0*phi[1]*q_; 
  hamilR[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamilR[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamilR[7] = 2.0*phi[2]*q_; 
  hamilR[8] = (0.421637021355784*m_)/rdvpar2SqR; 

  double BstarZdBmagR[27]; 
  BstarZdBmagR[0] = 1.414213562373095*cmag[0]*jacobTotInv[0]; 

  double alphaR[9]; 
  alphaR[0] = -(0.4330127018922193*BstarZdBmagR[0]*hamilR[1]*rdx2R)/m_; 
  alphaR[1] = -(0.9682458365518543*BstarZdBmagR[0]*hamilR[7]*rdx2R)/m_; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = -(0.1082531754730548*BstarZdBmagR[0]*hamilR[1]*rdx2R)/m_; 

  double incr[27]; 
  double amax = amax_in; 

  double fAvg[9]; 
  fAvg[0] = 0.7071067811865475*(2.23606797749979*(fR[8]+fL[8])+1.732050807568877*(fL[2]-1.0*fR[2])+fR[0]+fL[0]); 
  fAvg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fR[12]+fL[12])+3.0*(fL[4]-1.0*fR[4]))+3.0*(fR[1]+fL[1])); 
  fAvg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fR[14]+fL[14])+3.0*(fL[6]-1.0*fR[6]))+3.0*(fR[3]+fL[3])); 
  fAvg[3] = 0.7071067811865475*(2.23606797749979*(fR[18]+fL[18])+1.732050807568877*(fL[10]-1.0*fR[10])+fR[5]+fL[5]); 
  fAvg[4] = 0.1414213562373095*(2.23606797749979*(5.0*(fR[20]+fL[20])-3.872983346207417*(fR[11]-1.0*fL[11]))+5.0*(fR[7]+fL[7])); 
  fAvg[5] = 0.1414213562373095*(2.23606797749979*(5.0*(fR[22]+fL[22])-3.872983346207417*(fR[16]-1.0*fL[16]))+5.0*(fR[9]+fL[9])); 
  fAvg[6] = -0.04714045207910316*(3.872983346207417*(6.708203932499369*(fR[17]-1.0*fL[17])-8.660254037844386*(fR[23]+fL[23]))-15.0*(fR[13]+fL[13])); 
  fAvg[7] = -0.04714045207910316*(3.872983346207417*(6.708203932499369*(fR[19]-1.0*fL[19])-8.660254037844386*(fR[25]+fL[25]))-15.0*(fR[15]+fL[15])); 
  fAvg[8] = 0.7071067811865475*(2.23606797749979*(fR[26]+fL[26])+1.732050807568877*(fL[24]-1.0*fR[24])+fR[21]+fL[21]); 

  double Ghat[9]; 
  Ghat[0] = -0.1767766952966368*((2.23606797749979*(2.0*fR[8]-2.0*fL[8])-3.464101615137754*(fR[2]+fL[2])+2.0*fR[0]-2.0*fL[0])*amax-1.414213562373095*(alphaR[1]*fAvg[1]+alphaR[0]*fAvg[0])); 
  Ghat[1] = -0.01178511301977579*((6.708203932499369*(10.0*fR[12]-10.0*fL[12])-51.96152422706631*(fR[4]+fL[4])+30.0*fR[1]-30.0*fL[1])*amax-18.97366596101028*alphaR[1]*fAvg[4]-21.21320343559643*(alphaR[0]*fAvg[1]+fAvg[0]*alphaR[1])); 
  Ghat[2] = -0.05892556509887893*((6.708203932499369*(2.0*fR[14]-2.0*fL[14])-10.39230484541326*(fR[6]+fL[6])+6.0*fR[3]-6.0*fL[3])*amax-4.242640687119286*(alphaR[1]*fAvg[3]+alphaR[0]*fAvg[2])); 
  Ghat[3] = 0.01178511301977579*((2.23606797749979*(30.0*fL[18]-30.0*fR[18])+51.96152422706631*(fR[10]+fL[10])-30.0*fR[5]+30.0*fL[5])*amax+18.97366596101028*alphaR[1]*fAvg[6]+21.21320343559643*(alphaR[0]*fAvg[3]+alphaR[1]*fAvg[2])); 
  Ghat[4] = 0.03535533905932736*(2.23606797749979*((10.0*fL[20]-10.0*fR[20])*amax+2.828427124746191*alphaR[1]*fAvg[1])+(17.32050807568877*(fR[11]+fL[11])-10.0*fR[7]+10.0*fL[7])*amax+7.071067811865476*alphaR[0]*fAvg[4]); 
  Ghat[5] = 0.01178511301977579*(8.660254037844387*(6.0*(fR[16]+fL[16])*amax+2.449489742783178*alphaR[1]*fAvg[7])+(2.23606797749979*(30.0*fL[22]-30.0*fR[22])-30.0*fR[9]+30.0*fL[9])*amax+21.21320343559643*alphaR[0]*fAvg[5]); 
  Ghat[6] = 0.01178511301977579*(3.872983346207417*(1.732050807568877*((10.0*fL[23]-10.0*fR[23])*amax+2.828427124746191*alphaR[1]*fAvg[3])+13.41640786499874*(fR[17]+fL[17])*amax)+(30.0*fL[13]-30.0*fR[13])*amax+21.21320343559643*alphaR[0]*fAvg[6]); 
  Ghat[7] = 0.01178511301977579*(3.872983346207417*(1.732050807568877*((10.0*fL[25]-10.0*fR[25])*amax+2.828427124746191*alphaR[1]*fAvg[8])+2.23606797749979*(6.0*(fR[19]+fL[19])*amax+2.449489742783178*alphaR[1]*fAvg[5]))+(30.0*fL[15]-30.0*fR[15])*amax+21.21320343559643*alphaR[0]*fAvg[7]); 
  Ghat[8] = 0.01178511301977579*((2.23606797749979*(30.0*fL[26]-30.0*fR[26])+51.96152422706631*(fR[24]+fL[24])-30.0*fR[21]+30.0*fL[21])*amax+21.21320343559643*alphaR[0]*fAvg[8]+18.97366596101028*alphaR[1]*fAvg[7]); 

  incr[0] = 0.7071067811865475*Ghat[0]; 
  incr[1] = 0.7071067811865475*Ghat[1]; 
  incr[2] = -1.224744871391589*Ghat[0]; 
  incr[3] = 0.7071067811865475*Ghat[2]; 
  incr[4] = -1.224744871391589*Ghat[1]; 
  incr[5] = 0.7071067811865475*Ghat[3]; 
  incr[6] = -1.224744871391589*Ghat[2]; 
  incr[7] = 0.7071067811865475*Ghat[4]; 
  incr[8] = 1.58113883008419*Ghat[0]; 
  incr[9] = 0.7071067811865475*Ghat[5]; 
  incr[10] = -1.224744871391589*Ghat[3]; 
  incr[11] = -1.224744871391589*Ghat[4]; 
  incr[12] = 1.58113883008419*Ghat[1]; 
  incr[13] = 0.7071067811865475*Ghat[6]; 
  incr[14] = 1.58113883008419*Ghat[2]; 
  incr[15] = 0.7071067811865475*Ghat[7]; 
  incr[16] = -1.224744871391589*Ghat[5]; 
  incr[17] = -1.224744871391589*Ghat[6]; 
  incr[18] = 1.58113883008419*Ghat[3]; 
  incr[19] = -1.224744871391589*Ghat[7]; 
  incr[20] = 1.58113883008419*Ghat[4]; 
  incr[21] = 0.7071067811865475*Ghat[8]; 
  incr[22] = 1.58113883008419*Ghat[5]; 
  incr[23] = 1.58113883008419*Ghat[6]; 
  incr[24] = -1.224744871391589*Ghat[8]; 
  incr[25] = 1.58113883008419*Ghat[7]; 
  incr[26] = 1.58113883008419*Ghat[8]; 

  outR[0] += incr[0]*rdvpar2R; 
  outR[1] += incr[1]*rdvpar2R; 
  outR[2] += incr[2]*rdvpar2R; 
  outR[3] += incr[3]*rdvpar2R; 
  outR[4] += incr[4]*rdvpar2R; 
  outR[5] += incr[5]*rdvpar2R; 
  outR[6] += incr[6]*rdvpar2R; 
  outR[7] += incr[7]*rdvpar2R; 
  outR[8] += incr[8]*rdvpar2R; 
  outR[9] += incr[9]*rdvpar2R; 
  outR[10] += incr[10]*rdvpar2R; 
  outR[11] += incr[11]*rdvpar2R; 
  outR[12] += incr[12]*rdvpar2R; 
  outR[13] += incr[13]*rdvpar2R; 
  outR[14] += incr[14]*rdvpar2R; 
  outR[15] += incr[15]*rdvpar2R; 
  outR[16] += incr[16]*rdvpar2R; 
  outR[17] += incr[17]*rdvpar2R; 
  outR[18] += incr[18]*rdvpar2R; 
  outR[19] += incr[19]*rdvpar2R; 
  outR[20] += incr[20]*rdvpar2R; 
  outR[21] += incr[21]*rdvpar2R; 
  outR[22] += incr[22]*rdvpar2R; 
  outR[23] += incr[23]*rdvpar2R; 
  outR[24] += incr[24]*rdvpar2R; 
  outR[25] += incr[25]*rdvpar2R; 
  outR[26] += incr[26]*rdvpar2R; 

  outL[0] += -1.0*incr[0]*rdvpar2L; 
  outL[1] += -1.0*incr[1]*rdvpar2L; 
  outL[2] += incr[2]*rdvpar2L; 
  outL[3] += -1.0*incr[3]*rdvpar2L; 
  outL[4] += incr[4]*rdvpar2L; 
  outL[5] += -1.0*incr[5]*rdvpar2L; 
  outL[6] += incr[6]*rdvpar2L; 
  outL[7] += -1.0*incr[7]*rdvpar2L; 
  outL[8] += -1.0*incr[8]*rdvpar2L; 
  outL[9] += -1.0*incr[9]*rdvpar2L; 
  outL[10] += incr[10]*rdvpar2L; 
  outL[11] += incr[11]*rdvpar2L; 
  outL[12] += -1.0*incr[12]*rdvpar2L; 
  outL[13] += -1.0*incr[13]*rdvpar2L; 
  outL[14] += -1.0*incr[14]*rdvpar2L; 
  outL[15] += -1.0*incr[15]*rdvpar2L; 
  outL[16] += incr[16]*rdvpar2L; 
  outL[17] += incr[17]*rdvpar2L; 
  outL[18] += -1.0*incr[18]*rdvpar2L; 
  outL[19] += incr[19]*rdvpar2L; 
  outL[20] += -1.0*incr[20]*rdvpar2L; 
  outL[21] += -1.0*incr[21]*rdvpar2L; 
  outL[22] += -1.0*incr[22]*rdvpar2L; 
  outL[23] += -1.0*incr[23]*rdvpar2L; 
  outL[24] += incr[24]*rdvpar2L; 
  outL[25] += -1.0*incr[25]*rdvpar2L; 
  outL[26] += -1.0*incr[26]*rdvpar2L; 
return std::abs(alphaSurfAvgR); 
} 
double GyrokineticGenGeoSurf1x2vTensor_x_P2_Bvarsx(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *fL, const double *fR, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamilR[27]; 
  hamilR[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*(bmag[0]*wmuR+phi[0]*q_))+2.0*m_))/rdvpar2SqR; 
  hamilR[1] = 2.0*(bmag[1]*wmuR+phi[1]*q_); 
  hamilR[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamilR[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamilR[5] = (1.154700538379252*bmag[1])/rdmu2R; 
  hamilR[7] = 2.0*(bmag[2]*wmuR+phi[2]*q_); 
  hamilR[8] = (0.421637021355784*m_)/rdvpar2SqR; 
  hamilR[13] = (1.154700538379251*bmag[2])/rdmu2R; 

  double BstarZdBmagR[27]; 
  BstarZdBmagR[0] = (1.414213562373095*(1.732050807568877*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R*wvparR+(cmag[2]*jacobTotInv[2]+cmag[1]*jacobTotInv[1]+cmag[0]*jacobTotInv[0])*q_))/q_; 
  BstarZdBmagR[1] = (0.2828427124746191*(5.0*(1.732050807568877*(2.0*b_y[2]*jacobTotInv[2]+b_y[1]*jacobTotInv[1])*m_*rdx2R*wvparR+(cmag[0]*jacobTotInv[1]+jacobTotInv[0]*cmag[1])*q_)+2.23606797749979*(8.660254037844386*jacobTotInv[0]*b_y[2]*m_*rdx2R*wvparR+2.0*(cmag[1]*jacobTotInv[2]+jacobTotInv[1]*cmag[2])*q_)))/q_; 
  BstarZdBmagR[2] = (1.414213562373095*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[4] = (1.414213562373095*(b_y[2]*(2.0*jacobTotInv[2]+2.23606797749979*jacobTotInv[0])+b_y[1]*jacobTotInv[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[7] = (0.04040610178208843*(60.6217782649107*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R*wvparR+(4.47213595499958*(5.0*cmag[2]*jacobTotInv[2]+7.0*cmag[1]*jacobTotInv[1])+35.0*(cmag[0]*jacobTotInv[2]+jacobTotInv[0]*cmag[2]))*q_))/q_; 
  BstarZdBmagR[11] = (1.414213562373095*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R)/(q_*rdvpar2R); 

  double alphaR[9]; 
  alphaR[0] = (0.25*(8.660254037844387*hamilR[8]*BstarZdBmagR[11]+2.23606797749979*(1.732050807568877*(BstarZdBmagR[2]*hamilR[8]+hamilR[2]*BstarZdBmagR[7])-3.0*BstarZdBmagR[4]*hamilR[8])+(1.732050807568877*BstarZdBmagR[0]-3.0*BstarZdBmagR[1])*hamilR[2])*rdvpar2R)/m_; 
  alphaR[1] = (0.25*(3.872983346207417*hamilR[2]*BstarZdBmagR[11]+1.732050807568877*(5.0*BstarZdBmagR[7]*hamilR[8]+BstarZdBmagR[2]*hamilR[2])+2.23606797749979*(1.732050807568877*BstarZdBmagR[0]-3.0*BstarZdBmagR[1])*hamilR[8]-3.0*hamilR[2]*BstarZdBmagR[4])*rdvpar2R)/m_; 
  alphaR[4] = (0.5*hamilR[8]*(3.872983346207417*BstarZdBmagR[11]-3.0*BstarZdBmagR[4]+1.732050807568877*BstarZdBmagR[2])*rdvpar2R)/m_; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = (0.0625*(2.23606797749979*(1.732050807568877*(BstarZdBmagR[2]*hamilR[8]+hamilR[2]*BstarZdBmagR[7])*rdvpar2R-3.0*BstarZdBmagR[4]*hamilR[8]*rdvpar2R)+8.660254037844387*hamilR[8]*BstarZdBmagR[11]*rdvpar2R-3.0*BstarZdBmagR[1]*hamilR[2]*rdvpar2R+1.732050807568877*BstarZdBmagR[0]*hamilR[2]*rdvpar2R))/m_; 

  double incr[27]; 
#if upwindType == SURFAVG 
  if (alphaSurfAvgR>0) { 
  incr[0] = 0.01666666666666667*(33.54101966249685*(alphaR[4]*fL[20]+alphaR[0]*fL[7])+3.872983346207417*(6.708203932499369*alphaR[4]*fL[12]+8.660254037844386*alphaR[1]*fL[11])+15.0*alphaR[4]*fL[8]+25.98076211353316*(alphaR[1]*fL[4]+alphaR[0]*fL[1])+15.0*(alphaR[1]*fL[2]+alphaR[0]*fL[0])); 
  incr[1] = -0.05*(19.36491673103708*(alphaR[4]*fL[20]+alphaR[0]*fL[7])+3.872983346207417*(3.872983346207417*alphaR[4]*fL[12]+5.0*alphaR[1]*fL[11])+8.660254037844386*(alphaR[4]*fL[8]+alphaR[1]*fL[2]+alphaR[0]*fL[0])+15.0*(alphaR[1]*fL[4]+alphaR[0]*fL[1])); 
  incr[2] = 0.01666666666666667*(30.0*alphaR[1]*fL[20]+3.872983346207417*(6.0*alphaR[1]*fL[12]+(7.745966692414834*alphaR[4]+8.660254037844386*alphaR[0])*fL[11])+2.23606797749979*(alphaR[1]*(6.0*fL[8]+15.0*fL[7])+alphaR[4]*(10.39230484541326*fL[4]+6.0*fL[2]))+25.98076211353316*(alphaR[0]*fL[4]+alphaR[1]*fL[1])+15.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1])); 
  incr[3] = 0.01666666666666667*(33.54101966249685*(alphaR[4]*fL[23]+alphaR[1]*fL[17])+25.98076211353316*(alphaR[4]*fL[18]+alphaR[1]*fL[10]+alphaR[0]*fL[5])+3.872983346207417*(3.872983346207417*alphaR[4]*fL[14]+8.660254037844386*alphaR[0]*fL[13])+15.0*(alphaR[1]*fL[6]+alphaR[0]*fL[3])); 
  incr[4] = -0.05*(1.732050807568877*(10.0*alphaR[1]*fL[20]+5.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1]))+3.872983346207417*(3.464101615137754*alphaR[1]*fL[12]+(4.47213595499958*alphaR[4]+5.0*alphaR[0])*fL[11])+2.23606797749979*(1.732050807568877*(alphaR[1]*(2.0*fL[8]+5.0*fL[7])+2.0*fL[2]*alphaR[4])+6.0*alphaR[4]*fL[4])+15.0*(alphaR[0]*fL[4]+alphaR[1]*fL[1])); 
  incr[5] = -0.05*(19.36491673103708*(alphaR[4]*fL[23]+alphaR[1]*fL[17])+15.0*alphaR[4]*fL[18]+3.872983346207417*(2.23606797749979*alphaR[4]*fL[14]+5.0*alphaR[0]*fL[13])+15.0*alphaR[1]*fL[10]+8.660254037844386*(alphaR[1]*fL[6]+alphaR[0]*fL[3])+15.0*alphaR[0]*fL[5]); 
  incr[6] = 0.01666666666666667*(30.0*alphaR[1]*fL[23]+2.23606797749979*(10.39230484541326*(alphaR[1]*fL[18]+alphaR[4]*fL[10])+15.0*alphaR[0]*fL[17]+6.0*alphaR[4]*fL[6])+30.0*alphaR[4]*fL[17]+6.708203932499369*alphaR[1]*(2.0*fL[14]+5.0*fL[13])+25.98076211353316*(alphaR[0]*fL[10]+alphaR[1]*fL[5])+15.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3])); 
  incr[7] = 0.08333333333333333*(15.0*alphaR[4]*fL[20]+3.872983346207417*(3.0*alphaR[4]*fL[12]+3.872983346207417*alphaR[1]*fL[11])+2.23606797749979*(3.0*alphaR[4]*fL[8]+5.196152422706632*(alphaR[1]*fL[4]+alphaR[0]*fL[1])+3.0*(alphaR[1]*fL[2]+alphaR[0]*fL[0]))+15.0*alphaR[0]*fL[7]); 
  incr[8] = 0.002380952380952381*(2.23606797749979*(105.0*alphaR[0]*fL[20]+alphaR[4]*(30.0*fL[8]+105.0*fL[7])+alphaR[1]*(72.74613391789283*fL[4]+42.0*fL[2]))+150.0*alphaR[4]*fL[20]+3.872983346207417*(2.23606797749979*(21.0*alphaR[0]*fL[12]+24.24871130596428*alphaR[1]*fL[11])+30.0*alphaR[4]*fL[12])+105.0*alphaR[0]*fL[8]+(181.8653347947321*fL[1]+105.0*fL[0])*alphaR[4]); 
  incr[9] = 0.01666666666666667*(33.54101966249685*(alphaR[4]*fL[26]+alphaR[1]*fL[24]+alphaR[0]*fL[21])+25.98076211353316*(alphaR[4]*fL[25]+alphaR[1]*fL[19])+15.0*alphaR[4]*fL[22]+8.660254037844387*(1.732050807568877*alphaR[1]*fL[16]+3.0*alphaR[0]*fL[15])+15.0*alphaR[0]*fL[9]); 
  incr[10] = -0.05*(1.732050807568877*(10.0*(alphaR[1]*fL[23]+alphaR[4]*fL[17])+5.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3]))+2.23606797749979*(6.0*alphaR[1]*fL[18]+1.732050807568877*(5.0*alphaR[0]*fL[17]+2.0*alphaR[4]*fL[6])+6.0*alphaR[4]*fL[10])+3.872983346207417*alphaR[1]*(2.0*fL[14]+5.0*fL[13])+15.0*(alphaR[0]*fL[10]+alphaR[1]*fL[5])); 
  incr[11] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(10.0*alphaR[1]*fL[20]+5.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1]))+2.23606797749979*(1.732050807568877*(alphaR[1]*(2.0*fL[8]+5.0*fL[7])+2.0*fL[2]*alphaR[4])+6.0*alphaR[4]*fL[4])+15.0*(alphaR[0]*fL[4]+alphaR[1]*fL[1]))+51.96152422706631*alphaR[1]*fL[12]+(67.0820393249937*alphaR[4]+75.0*alphaR[0])*fL[11]); 
  incr[12] = -0.007142857142857143*(3.872983346207417*(2.23606797749979*(10.0*alphaR[4]*fL[20]+7.0*alphaR[0]*fL[8]+(12.12435565298214*fL[1]+7.0*fL[0])*alphaR[4])+35.0*alphaR[0]*fL[20]+alphaR[4]*(10.0*fL[8]+35.0*fL[7])+alphaR[1]*(24.24871130596428*fL[4]+14.0*fL[2]))+(67.0820393249937*alphaR[4]+105.0*alphaR[0])*fL[12]+121.2435565298214*alphaR[1]*fL[11]); 
  incr[13] = 0.08333333333333333*(3.872983346207417*(3.872983346207417*(alphaR[4]*fL[23]+alphaR[1]*fL[17])+3.0*(alphaR[4]*fL[18]+alphaR[1]*fL[10])+1.732050807568877*(alphaR[1]*fL[6]+alphaR[0]*fL[3])+3.0*alphaR[0]*fL[5])+6.708203932499369*alphaR[4]*fL[14]+15.0*alphaR[0]*fL[13]); 
  incr[14] = 0.002380952380952381*(3.872983346207417*(2.23606797749979*(1.732050807568877*(10.0*alphaR[4]*fL[23]+14.0*alphaR[1]*fL[17]+7.0*fL[3]*alphaR[4])+21.0*(alphaR[0]*fL[18]+alphaR[4]*fL[5]))+1.732050807568877*(35.0*alphaR[0]*fL[23]+14.0*alphaR[1]*fL[6])+30.0*alphaR[4]*fL[18]+42.0*alphaR[1]*fL[10])+2.23606797749979*alphaR[4]*(30.0*fL[14]+105.0*fL[13])+105.0*alphaR[0]*fL[14]); 
  incr[15] = -0.05*(3.872983346207417*(5.0*alphaR[4]*fL[26]+2.23606797749979*(1.732050807568877*(alphaR[4]*fL[25]+alphaR[1]*fL[19])+alphaR[4]*fL[22]+alphaR[0]*fL[9])+5.0*(alphaR[1]*fL[24]+alphaR[0]*fL[21]))+8.660254037844386*alphaR[1]*fL[16]+15.0*alphaR[0]*fL[15]); 
  incr[16] = 0.01666666666666667*(3.872983346207417*(2.23606797749979*(1.732050807568877*(2.0*(alphaR[1]*fL[26]+alphaR[4]*fL[24])+alphaR[1]*fL[9])+3.0*alphaR[0]*fL[19])+6.0*alphaR[1]*fL[25]+1.732050807568877*(5.0*alphaR[0]*fL[24]+alphaR[1]*(2.0*fL[22]+5.0*fL[21]))+6.0*alphaR[4]*fL[19])+(13.41640786499874*alphaR[4]+15.0*alphaR[0])*fL[16]+25.98076211353316*alphaR[1]*fL[15]); 
  incr[17] = 0.01666666666666667*(2.23606797749979*(30.0*(alphaR[1]*fL[23]+alphaR[4]*fL[17])+25.98076211353316*(alphaR[0]*fL[10]+alphaR[1]*fL[5])+15.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3]))+51.96152422706631*(alphaR[1]*fL[18]+alphaR[4]*fL[10])+75.0*alphaR[0]*fL[17]+15.0*alphaR[1]*(2.0*fL[14]+5.0*fL[13])+30.0*alphaR[4]*fL[6]); 
  incr[18] = -0.007142857142857143*(2.23606797749979*(1.732050807568877*(35.0*alphaR[0]*fL[23]+14.0*alphaR[1]*fL[6])+30.0*alphaR[4]*fL[18]+42.0*alphaR[1]*fL[10])+1.732050807568877*(50.0*alphaR[4]*fL[23]+70.0*alphaR[1]*fL[17]+35.0*fL[3]*alphaR[4])+105.0*alphaR[0]*fL[18]+3.872983346207417*((10.0*alphaR[4]+15.65247584249853*alphaR[0])*fL[14]+35.0*alphaR[4]*fL[13])+105.0*alphaR[4]*fL[5]); 
  incr[19] = -0.05*(1.732050807568877*(10.0*(alphaR[1]*fL[26]+alphaR[4]*fL[24])+5.0*alphaR[1]*fL[9])+2.23606797749979*(6.0*alphaR[1]*fL[25]+1.732050807568877*(5.0*alphaR[0]*fL[24]+alphaR[1]*(2.0*fL[22]+5.0*fL[21]))+6.0*alphaR[4]*fL[19])+15.0*alphaR[0]*fL[19]+3.872983346207417*(2.23606797749979*(alphaR[0]*fL[16]+1.732050807568877*alphaR[1]*fL[15])+2.0*alphaR[4]*fL[16])); 
  incr[20] = 0.0119047619047619*(2.23606797749979*(30.0*alphaR[4]*fL[20]+21.0*alphaR[0]*fL[8]+(36.37306695894642*fL[1]+21.0*fL[0])*alphaR[4])+105.0*alphaR[0]*fL[20]+3.872983346207417*((13.41640786499874*alphaR[4]+21.0*alphaR[0])*fL[12]+24.24871130596428*alphaR[1]*fL[11])+alphaR[4]*(30.0*fL[8]+105.0*fL[7])+alphaR[1]*(72.74613391789283*fL[4]+42.0*fL[2])); 
  incr[21] = 0.08333333333333333*(15.0*alphaR[4]*fL[26]+2.23606797749979*(5.196152422706632*(alphaR[4]*fL[25]+alphaR[1]*fL[19])+3.0*(alphaR[4]*fL[22]+alphaR[0]*fL[9]))+15.0*(alphaR[1]*fL[24]+alphaR[0]*fL[21])+3.872983346207417*(1.732050807568877*alphaR[1]*fL[16]+3.0*alphaR[0]*fL[15])); 
  incr[22] = 0.002380952380952381*(2.23606797749979*(105.0*alphaR[0]*fL[26]+1.732050807568877*(30.0*alphaR[4]*fL[25]+42.0*alphaR[1]*fL[19])+alphaR[4]*(30.0*fL[22]+105.0*fL[21]))+150.0*alphaR[4]*fL[26]+181.8653347947321*alphaR[0]*fL[25]+210.0*alphaR[1]*fL[24]+105.0*alphaR[0]*fL[22]+3.872983346207417*(24.24871130596428*alphaR[1]*fL[16]+46.95742752749558*alphaR[4]*fL[15])+105.0*alphaR[4]*fL[9]); 
  incr[23] = 0.0119047619047619*(2.23606797749979*(30.0*alphaR[4]*fL[23]+36.37306695894642*(alphaR[0]*fL[18]+alphaR[4]*fL[5])+42.0*alphaR[1]*fL[17]+21.0*fL[3]*alphaR[4])+105.0*alphaR[0]*fL[23]+1.732050807568877*(30.0*alphaR[4]*fL[18]+42.0*alphaR[1]*fL[10])+3.872983346207417*(3.872983346207417*alphaR[4]*(2.0*fL[14]+7.0*fL[13])+12.12435565298214*alphaR[0]*fL[14])+42.0*alphaR[1]*fL[6]); 
  incr[24] = 0.01666666666666667*(2.23606797749979*(30.0*(alphaR[1]*fL[26]+alphaR[4]*fL[24])+25.98076211353316*alphaR[0]*fL[19]+15.0*alphaR[1]*fL[9])+51.96152422706631*(alphaR[1]*fL[25]+alphaR[4]*fL[19])+75.0*alphaR[0]*fL[24]+alphaR[1]*(30.0*fL[22]+75.0*fL[21])+3.872983346207417*((7.745966692414834*alphaR[4]+8.660254037844386*alphaR[0])*fL[16]+15.0*alphaR[1]*fL[15])); 
  incr[25] = -0.007142857142857143*(2.23606797749979*(1.732050807568877*(35.0*alphaR[0]*fL[26]+alphaR[4]*(10.0*fL[22]+35.0*fL[21]))+30.0*alphaR[4]*fL[25]+42.0*alphaR[1]*fL[19])+1.732050807568877*(50.0*alphaR[4]*fL[26]+70.0*alphaR[1]*fL[24]+35.0*(alphaR[0]*fL[22]+alphaR[4]*fL[9]))+105.0*alphaR[0]*fL[25]+3.872983346207417*(14.0*alphaR[1]*fL[16]+27.11088342345192*alphaR[4]*fL[15])); 
  incr[26] = 0.002380952380952381*(2.23606797749979*(150.0*alphaR[4]*fL[26]+181.8653347947321*alphaR[0]*fL[25]+210.0*alphaR[1]*fL[24]+105.0*(alphaR[0]*fL[22]+alphaR[4]*fL[9]))+525.0*alphaR[0]*fL[26]+1.732050807568877*(150.0*alphaR[4]*fL[25]+210.0*alphaR[1]*fL[19])+alphaR[4]*(150.0*fL[22]+525.0*fL[21])+3.872983346207417*(54.22176684690384*alphaR[1]*fL[16]+105.0*alphaR[4]*fL[15])); 
  } else { 
  incr[0] = -0.01666666666666667*((-33.54101966249685*(alphaR[4]*fR[20]+alphaR[0]*fR[7]))+3.872983346207417*(6.708203932499369*alphaR[4]*fR[12]-8.660254037844386*alphaR[1]*fR[11])-15.0*alphaR[4]*fR[8]+25.98076211353316*(alphaR[1]*fR[4]+alphaR[0]*fR[1])-15.0*(alphaR[1]*fR[2]+alphaR[0]*fR[0])); 
  incr[1] = 0.05*((-19.36491673103708*(alphaR[4]*fR[20]+alphaR[0]*fR[7]))+3.872983346207417*(3.872983346207417*alphaR[4]*fR[12]-5.0*alphaR[1]*fR[11])-8.660254037844386*(alphaR[4]*fR[8]+alphaR[1]*fR[2]+alphaR[0]*fR[0])+15.0*(alphaR[1]*fR[4]+alphaR[0]*fR[1])); 
  incr[2] = 0.01666666666666667*(30.0*alphaR[1]*fR[20]+3.872983346207417*((7.745966692414834*alphaR[4]+8.660254037844386*alphaR[0])*fR[11]-6.0*alphaR[1]*fR[12])+2.23606797749979*(alphaR[1]*(6.0*fR[8]+15.0*fR[7])+alphaR[4]*(6.0*fR[2]-10.39230484541326*fR[4]))-25.98076211353316*(alphaR[0]*fR[4]+alphaR[1]*fR[1])+15.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1])); 
  incr[3] = 0.01666666666666667*(33.54101966249685*(alphaR[4]*fR[23]+alphaR[1]*fR[17])-25.98076211353316*(alphaR[4]*fR[18]+alphaR[1]*fR[10]+alphaR[0]*fR[5])+3.872983346207417*(3.872983346207417*alphaR[4]*fR[14]+8.660254037844386*alphaR[0]*fR[13])+15.0*(alphaR[1]*fR[6]+alphaR[0]*fR[3])); 
  incr[4] = -0.05*(1.732050807568877*(10.0*alphaR[1]*fR[20]+5.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1]))+3.872983346207417*((4.47213595499958*alphaR[4]+5.0*alphaR[0])*fR[11]-3.464101615137754*alphaR[1]*fR[12])+2.23606797749979*(1.732050807568877*(alphaR[1]*(2.0*fR[8]+5.0*fR[7])+2.0*fR[2]*alphaR[4])-6.0*alphaR[4]*fR[4])-15.0*(alphaR[0]*fR[4]+alphaR[1]*fR[1])); 
  incr[5] = -0.05*(19.36491673103708*(alphaR[4]*fR[23]+alphaR[1]*fR[17])-15.0*alphaR[4]*fR[18]+3.872983346207417*(2.23606797749979*alphaR[4]*fR[14]+5.0*alphaR[0]*fR[13])-15.0*alphaR[1]*fR[10]+8.660254037844386*(alphaR[1]*fR[6]+alphaR[0]*fR[3])-15.0*alphaR[0]*fR[5]); 
  incr[6] = 0.01666666666666667*(30.0*alphaR[1]*fR[23]+2.23606797749979*((-10.39230484541326*(alphaR[1]*fR[18]+alphaR[4]*fR[10]))+15.0*alphaR[0]*fR[17]+6.0*alphaR[4]*fR[6])+30.0*alphaR[4]*fR[17]+6.708203932499369*alphaR[1]*(2.0*fR[14]+5.0*fR[13])-25.98076211353316*(alphaR[0]*fR[10]+alphaR[1]*fR[5])+15.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3])); 
  incr[7] = 0.08333333333333333*(15.0*alphaR[4]*fR[20]+3.872983346207417*(3.872983346207417*alphaR[1]*fR[11]-3.0*alphaR[4]*fR[12])+2.23606797749979*(3.0*alphaR[4]*fR[8]-5.196152422706632*(alphaR[1]*fR[4]+alphaR[0]*fR[1])+3.0*(alphaR[1]*fR[2]+alphaR[0]*fR[0]))+15.0*alphaR[0]*fR[7]); 
  incr[8] = 0.002380952380952381*(2.23606797749979*(105.0*alphaR[0]*fR[20]+alphaR[4]*(30.0*fR[8]+105.0*fR[7])+alphaR[1]*(42.0*fR[2]-72.74613391789283*fR[4]))+150.0*alphaR[4]*fR[20]+3.872983346207417*(2.23606797749979*(24.24871130596428*alphaR[1]*fR[11]-21.0*alphaR[0]*fR[12])-30.0*alphaR[4]*fR[12])+105.0*alphaR[0]*fR[8]+(105.0*fR[0]-181.8653347947321*fR[1])*alphaR[4]); 
  incr[9] = 0.01666666666666667*(33.54101966249685*(alphaR[4]*fR[26]+alphaR[1]*fR[24]+alphaR[0]*fR[21])-25.98076211353316*(alphaR[4]*fR[25]+alphaR[1]*fR[19])+15.0*alphaR[4]*fR[22]+8.660254037844387*(1.732050807568877*alphaR[1]*fR[16]-3.0*alphaR[0]*fR[15])+15.0*alphaR[0]*fR[9]); 
  incr[10] = -0.05*(1.732050807568877*(10.0*(alphaR[1]*fR[23]+alphaR[4]*fR[17])+5.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3]))+2.23606797749979*((-6.0*alphaR[1]*fR[18])+1.732050807568877*(5.0*alphaR[0]*fR[17]+2.0*alphaR[4]*fR[6])-6.0*alphaR[4]*fR[10])+3.872983346207417*alphaR[1]*(2.0*fR[14]+5.0*fR[13])-15.0*(alphaR[0]*fR[10]+alphaR[1]*fR[5])); 
  incr[11] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(10.0*alphaR[1]*fR[20]+5.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1]))+2.23606797749979*(1.732050807568877*(alphaR[1]*(2.0*fR[8]+5.0*fR[7])+2.0*fR[2]*alphaR[4])-6.0*alphaR[4]*fR[4])-15.0*(alphaR[0]*fR[4]+alphaR[1]*fR[1]))-51.96152422706631*alphaR[1]*fR[12]+(67.0820393249937*alphaR[4]+75.0*alphaR[0])*fR[11]); 
  incr[12] = 0.007142857142857143*(3.872983346207417*(2.23606797749979*((-10.0*alphaR[4]*fR[20])-7.0*alphaR[0]*fR[8]+(12.12435565298214*fR[1]-7.0*fR[0])*alphaR[4])-35.0*alphaR[0]*fR[20]+alphaR[4]*((-10.0*fR[8])-35.0*fR[7])+alphaR[1]*(24.24871130596428*fR[4]-14.0*fR[2]))+(67.0820393249937*alphaR[4]+105.0*alphaR[0])*fR[12]-121.2435565298214*alphaR[1]*fR[11]); 
  incr[13] = 0.08333333333333333*(3.872983346207417*(3.872983346207417*(alphaR[4]*fR[23]+alphaR[1]*fR[17])-3.0*(alphaR[4]*fR[18]+alphaR[1]*fR[10])+1.732050807568877*(alphaR[1]*fR[6]+alphaR[0]*fR[3])-3.0*alphaR[0]*fR[5])+6.708203932499369*alphaR[4]*fR[14]+15.0*alphaR[0]*fR[13]); 
  incr[14] = 0.002380952380952381*(3.872983346207417*(2.23606797749979*(1.732050807568877*(10.0*alphaR[4]*fR[23]+14.0*alphaR[1]*fR[17]+7.0*fR[3]*alphaR[4])-21.0*(alphaR[0]*fR[18]+alphaR[4]*fR[5]))+1.732050807568877*(35.0*alphaR[0]*fR[23]+14.0*alphaR[1]*fR[6])-30.0*alphaR[4]*fR[18]-42.0*alphaR[1]*fR[10])+2.23606797749979*alphaR[4]*(30.0*fR[14]+105.0*fR[13])+105.0*alphaR[0]*fR[14]); 
  incr[15] = 0.05*(3.872983346207417*((-5.0*alphaR[4]*fR[26])+2.23606797749979*(1.732050807568877*(alphaR[4]*fR[25]+alphaR[1]*fR[19])-1.0*(alphaR[4]*fR[22]+alphaR[0]*fR[9]))-5.0*(alphaR[1]*fR[24]+alphaR[0]*fR[21]))-8.660254037844386*alphaR[1]*fR[16]+15.0*alphaR[0]*fR[15]); 
  incr[16] = 0.01666666666666667*(3.872983346207417*(2.23606797749979*(1.732050807568877*(2.0*(alphaR[1]*fR[26]+alphaR[4]*fR[24])+alphaR[1]*fR[9])-3.0*alphaR[0]*fR[19])-6.0*alphaR[1]*fR[25]+1.732050807568877*(5.0*alphaR[0]*fR[24]+alphaR[1]*(2.0*fR[22]+5.0*fR[21]))-6.0*alphaR[4]*fR[19])+(13.41640786499874*alphaR[4]+15.0*alphaR[0])*fR[16]-25.98076211353316*alphaR[1]*fR[15]); 
  incr[17] = 0.01666666666666667*(2.23606797749979*(30.0*(alphaR[1]*fR[23]+alphaR[4]*fR[17])-25.98076211353316*(alphaR[0]*fR[10]+alphaR[1]*fR[5])+15.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3]))-51.96152422706631*(alphaR[1]*fR[18]+alphaR[4]*fR[10])+75.0*alphaR[0]*fR[17]+15.0*alphaR[1]*(2.0*fR[14]+5.0*fR[13])+30.0*alphaR[4]*fR[6]); 
  incr[18] = -0.007142857142857143*(2.23606797749979*(1.732050807568877*(35.0*alphaR[0]*fR[23]+14.0*alphaR[1]*fR[6])-30.0*alphaR[4]*fR[18]-42.0*alphaR[1]*fR[10])+1.732050807568877*(50.0*alphaR[4]*fR[23]+70.0*alphaR[1]*fR[17]+35.0*fR[3]*alphaR[4])-105.0*alphaR[0]*fR[18]+3.872983346207417*((10.0*alphaR[4]+15.65247584249853*alphaR[0])*fR[14]+35.0*alphaR[4]*fR[13])-105.0*alphaR[4]*fR[5]); 
  incr[19] = 0.05*(1.732050807568877*((-10.0*(alphaR[1]*fR[26]+alphaR[4]*fR[24]))-5.0*alphaR[1]*fR[9])+2.23606797749979*(6.0*alphaR[1]*fR[25]+1.732050807568877*(alphaR[1]*((-2.0*fR[22])-5.0*fR[21])-5.0*alphaR[0]*fR[24])+6.0*alphaR[4]*fR[19])+15.0*alphaR[0]*fR[19]+3.872983346207417*(2.23606797749979*(1.732050807568877*alphaR[1]*fR[15]-1.0*alphaR[0]*fR[16])-2.0*alphaR[4]*fR[16])); 
  incr[20] = -0.0119047619047619*(2.23606797749979*((-30.0*alphaR[4]*fR[20])-21.0*alphaR[0]*fR[8]+(36.37306695894642*fR[1]-21.0*fR[0])*alphaR[4])-105.0*alphaR[0]*fR[20]+3.872983346207417*((13.41640786499874*alphaR[4]+21.0*alphaR[0])*fR[12]-24.24871130596428*alphaR[1]*fR[11])+alphaR[4]*((-30.0*fR[8])-105.0*fR[7])+alphaR[1]*(72.74613391789283*fR[4]-42.0*fR[2])); 
  incr[21] = 0.08333333333333333*(15.0*alphaR[4]*fR[26]+2.23606797749979*(3.0*(alphaR[4]*fR[22]+alphaR[0]*fR[9])-5.196152422706632*(alphaR[4]*fR[25]+alphaR[1]*fR[19]))+15.0*(alphaR[1]*fR[24]+alphaR[0]*fR[21])+3.872983346207417*(1.732050807568877*alphaR[1]*fR[16]-3.0*alphaR[0]*fR[15])); 
  incr[22] = -0.002380952380952381*(2.23606797749979*((-105.0*alphaR[0]*fR[26])+1.732050807568877*(30.0*alphaR[4]*fR[25]+42.0*alphaR[1]*fR[19])+alphaR[4]*((-30.0*fR[22])-105.0*fR[21]))-150.0*alphaR[4]*fR[26]+181.8653347947321*alphaR[0]*fR[25]-210.0*alphaR[1]*fR[24]-105.0*alphaR[0]*fR[22]+3.872983346207417*(46.95742752749558*alphaR[4]*fR[15]-24.24871130596428*alphaR[1]*fR[16])-105.0*alphaR[4]*fR[9]); 
  incr[23] = 0.0119047619047619*(2.23606797749979*(30.0*alphaR[4]*fR[23]-36.37306695894642*(alphaR[0]*fR[18]+alphaR[4]*fR[5])+42.0*alphaR[1]*fR[17]+21.0*fR[3]*alphaR[4])+105.0*alphaR[0]*fR[23]+1.732050807568877*((-30.0*alphaR[4]*fR[18])-42.0*alphaR[1]*fR[10])+3.872983346207417*(3.872983346207417*alphaR[4]*(2.0*fR[14]+7.0*fR[13])+12.12435565298214*alphaR[0]*fR[14])+42.0*alphaR[1]*fR[6]); 
  incr[24] = 0.01666666666666667*(2.23606797749979*(30.0*(alphaR[1]*fR[26]+alphaR[4]*fR[24])-25.98076211353316*alphaR[0]*fR[19]+15.0*alphaR[1]*fR[9])-51.96152422706631*(alphaR[1]*fR[25]+alphaR[4]*fR[19])+75.0*alphaR[0]*fR[24]+alphaR[1]*(30.0*fR[22]+75.0*fR[21])+3.872983346207417*((7.745966692414834*alphaR[4]+8.660254037844386*alphaR[0])*fR[16]-15.0*alphaR[1]*fR[15])); 
  incr[25] = 0.007142857142857143*(2.23606797749979*(1.732050807568877*(alphaR[4]*((-10.0*fR[22])-35.0*fR[21])-35.0*alphaR[0]*fR[26])+30.0*alphaR[4]*fR[25]+42.0*alphaR[1]*fR[19])+1.732050807568877*((-50.0*alphaR[4]*fR[26])-70.0*alphaR[1]*fR[24]-35.0*(alphaR[0]*fR[22]+alphaR[4]*fR[9]))+105.0*alphaR[0]*fR[25]+3.872983346207417*(27.11088342345192*alphaR[4]*fR[15]-14.0*alphaR[1]*fR[16])); 
  incr[26] = 0.002380952380952381*(2.23606797749979*(150.0*alphaR[4]*fR[26]-181.8653347947321*alphaR[0]*fR[25]+210.0*alphaR[1]*fR[24]+105.0*(alphaR[0]*fR[22]+alphaR[4]*fR[9]))+525.0*alphaR[0]*fR[26]+1.732050807568877*((-150.0*alphaR[4]*fR[25])-210.0*alphaR[1]*fR[19])+alphaR[4]*(150.0*fR[22]+525.0*fR[21])+3.872983346207417*(54.22176684690384*alphaR[1]*fR[16]-105.0*alphaR[4]*fR[15])); 
  }
#elif upwindType == QUAD 
  double alphaOrdR;
  double fUpOrd[9];
  alphaOrdR = 0.4472135954999579*alphaR[4]-0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[0] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])+0.9486832980505122*fR[24]-0.9486832980505122*fL[24]+0.9486832980505137*fR[23]-0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])-0.7348469228349525*(fR[19]+fL[19])-0.7348469228349533*(fR[18]+fL[18])-1.42302494707577*fR[17]+1.42302494707577*fL[17]+0.4242640687119281*fR[16]-0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])+0.4242640687119285*fR[14]-0.4242640687119285*fL[14]+1.060660171779821*fR[13]-1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])+1.060660171779821*fR[11]-1.060660171779821*fL[11]+1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6363961030678926*fR[6]+0.6363961030678926*fL[6]-0.8215838362577489*(fR[5]+fL[5]+fR[4]+fL[4])+0.4743416490252568*(fR[3]+fR[2])-0.4743416490252568*(fL[3]+fL[2])+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]-0.9486832980505122*(fR[24]+fL[24])-0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])+0.7348469228349525*fR[19]-0.7348469228349525*fL[19]+0.7348469228349533*fR[18]-0.7348469228349533*fL[18]+1.42302494707577*(fR[17]+fL[17])-0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]-0.4242640687119285*(fR[14]+fL[14])-1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]-1.060660171779821*(fR[11]+fL[11])-1.10227038425243*fR[10]+1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6363961030678926*(fR[6]+fL[6])+0.8215838362577489*(fR[5]+fR[4])-0.8215838362577489*(fL[5]+fL[4])-0.4743416490252568*(fR[3]+fL[3]+fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.5590169943749475*alphaR[4]; 
  fUpOrd[1] = 0.5*(((-0.883883476483184*fR[23])+0.883883476483184*(fL[23]+fR[20])-0.883883476483184*fL[20]+0.6846531968814573*(fR[18]+fL[18])-0.3952847075210473*fR[14]+0.3952847075210473*fL[14]+0.7905694150420948*fR[13]-0.7905694150420948*fL[13]-0.6846531968814574*(fR[12]+fL[12])+0.3952847075210473*fR[8]-0.3952847075210473*fL[8]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6123724356957944*(fR[5]+fL[5])+0.3535533905932737*fR[3]-0.3535533905932737*fL[3]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.883883476483184*(fR[23]+fL[23])-0.883883476483184*(fR[20]+fL[20])-0.6846531968814573*fR[18]+0.6846531968814573*fL[18]+0.3952847075210473*(fR[14]+fL[14])-0.7905694150420948*(fR[13]+fL[13])+0.6846531968814574*fR[12]-0.6846531968814574*fL[12]-0.3952847075210473*(fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6123724356957944*fR[5]-0.6123724356957944*fL[5]-0.3535533905932737*(fR[3]+fL[3])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.4472135954999579*alphaR[4]+0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[2] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])-0.9486832980505122*fR[24]+0.9486832980505122*fL[24]+0.9486832980505137*fR[23]-0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])+0.7348469228349525*(fR[19]+fL[19])-0.7348469228349533*(fR[18]+fL[18])+1.42302494707577*fR[17]-1.42302494707577*fL[17]-0.4242640687119281*fR[16]+0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])+0.4242640687119285*fR[14]-0.4242640687119285*fL[14]+1.060660171779821*fR[13]-1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])-1.060660171779821*fR[11]+1.060660171779821*fL[11]-1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6363961030678926*fR[6]-0.6363961030678926*fL[6]-0.8215838362577489*(fR[5]+fL[5])+0.8215838362577489*(fR[4]+fL[4])+0.4743416490252568*fR[3]-0.4743416490252568*(fL[3]+fR[2])+0.4743416490252568*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]+0.9486832980505122*(fR[24]+fL[24])-0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])-0.7348469228349525*fR[19]+0.7348469228349525*fL[19]+0.7348469228349533*fR[18]-0.7348469228349533*fL[18]-1.42302494707577*(fR[17]+fL[17])+0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]-0.4242640687119285*(fR[14]+fL[14])-1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]+1.060660171779821*(fR[11]+fL[11])+1.10227038425243*fR[10]-1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6363961030678926*(fR[6]+fL[6])+0.8215838362577489*fR[5]-0.8215838362577489*(fL[5]+fR[4])+0.8215838362577489*fL[4]-0.4743416490252568*(fR[3]+fL[3])+0.4743416490252568*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.5*alphaR[1]; 
  fUpOrd[3] = 0.5*(((-0.883883476483184*fR[24])+0.883883476483184*(fL[24]+fR[21])-0.883883476483184*fL[21]+0.6846531968814573*(fR[19]+fL[19])-0.3952847075210473*fR[16]+0.3952847075210473*fL[16]-0.6846531968814574*(fR[15]+fL[15])+0.7905694150420948*fR[11]-0.7905694150420948*fL[11]+0.3952847075210473*fR[9]-0.3952847075210473*fL[9]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6123724356957944*(fR[4]+fL[4])+0.3535533905932737*fR[2]-0.3535533905932737*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.883883476483184*(fR[24]+fL[24])-0.883883476483184*(fR[21]+fL[21])-0.6846531968814573*fR[19]+0.6846531968814573*fL[19]+0.3952847075210473*(fR[16]+fL[16])+0.6846531968814574*fR[15]-0.6846531968814574*fL[15]-0.7905694150420948*(fR[11]+fL[11])-0.3952847075210473*(fR[9]+fL[9])+0.7905694150420947*(fR[7]+fL[7])+0.6123724356957944*fR[4]-0.6123724356957944*fL[4]-0.3535533905932737*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.5590169943749475*alphaR[4]; 
  fUpOrd[4] = 0.5*(((-0.9882117688026183*fR[26])+0.9882117688026183*fL[26]+0.7654655446197428*(fR[25]+fL[25])-0.441941738241592*fR[22]+0.441941738241592*fL[22]+0.883883476483184*(fR[21]+fR[20])-0.883883476483184*(fL[21]+fL[20])-0.6846531968814574*(fR[15]+fL[15]+fR[12]+fL[12])+0.3952847075210473*(fR[9]+fR[8])-0.3952847075210473*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.9882117688026183*(fR[26]+fL[26])-0.7654655446197428*fR[25]+0.7654655446197428*fL[25]+0.441941738241592*(fR[22]+fL[22])-0.883883476483184*(fR[21]+fL[21]+fR[20]+fL[20])+0.6846531968814574*(fR[15]+fR[12])-0.6846531968814574*(fL[15]+fL[12])-0.3952847075210473*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*(alphaR[1]+alphaR[0]); 
  fUpOrd[5] = 0.5*((0.883883476483184*(fR[24]+fR[21])-0.883883476483184*(fL[24]+fL[21])-0.6846531968814573*(fR[19]+fL[19])+0.3952847075210473*fR[16]-0.3952847075210473*fL[16]-0.6846531968814574*(fR[15]+fL[15])-0.7905694150420948*fR[11]+0.7905694150420948*fL[11]+0.3952847075210473*fR[9]-0.3952847075210473*fL[9]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[4]+fL[4])-0.3535533905932737*fR[2]+0.3535533905932737*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)-0.883883476483184*(fR[24]+fL[24]+fR[21]+fL[21])+0.6846531968814573*fR[19]-0.6846531968814573*fL[19]-0.3952847075210473*(fR[16]+fL[16])+0.6846531968814574*fR[15]-0.6846531968814574*fL[15]+0.7905694150420948*(fR[11]+fL[11])-0.3952847075210473*(fR[9]+fL[9])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[4]+0.6123724356957944*fL[4]+0.3535533905932737*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.4472135954999579*alphaR[4]-0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[6] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])+0.9486832980505122*fR[24]-0.9486832980505122*fL[24]-0.9486832980505137*fR[23]+0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])-0.7348469228349525*(fR[19]+fL[19])+0.7348469228349533*(fR[18]+fL[18])+1.42302494707577*fR[17]-1.42302494707577*fL[17]+0.4242640687119281*fR[16]-0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])-0.4242640687119285*fR[14]+0.4242640687119285*fL[14]-1.060660171779821*fR[13]+1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])+1.060660171779821*fR[11]-1.060660171779821*fL[11]-1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6363961030678926*fR[6]-0.6363961030678926*fL[6]+0.8215838362577489*(fR[5]+fL[5])-0.8215838362577489*(fR[4]+fL[4])-0.4743416490252568*fR[3]+0.4743416490252568*(fL[3]+fR[2])-0.4743416490252568*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]-0.9486832980505122*(fR[24]+fL[24])+0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])+0.7348469228349525*fR[19]-0.7348469228349525*fL[19]-0.7348469228349533*fR[18]+0.7348469228349533*fL[18]-1.42302494707577*(fR[17]+fL[17])-0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]+0.4242640687119285*(fR[14]+fL[14])+1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]-1.060660171779821*(fR[11]+fL[11])+1.10227038425243*fR[10]-1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6363961030678926*(fR[6]+fL[6])-0.8215838362577489*fR[5]+0.8215838362577489*(fL[5]+fR[4])-0.8215838362577489*fL[4]+0.4743416490252568*(fR[3]+fL[3])-0.4743416490252568*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.5590169943749475*alphaR[4]; 
  fUpOrd[7] = 0.5*((0.883883476483184*(fR[23]+fR[20])-0.883883476483184*(fL[23]+fL[20])-0.6846531968814573*(fR[18]+fL[18])+0.3952847075210473*fR[14]-0.3952847075210473*fL[14]-0.7905694150420948*fR[13]+0.7905694150420948*fL[13]-0.6846531968814574*(fR[12]+fL[12])+0.3952847075210473*fR[8]-0.3952847075210473*fL[8]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[5]+fL[5])-0.3535533905932737*fR[3]+0.3535533905932737*fL[3]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)-0.883883476483184*(fR[23]+fL[23]+fR[20]+fL[20])+0.6846531968814573*fR[18]-0.6846531968814573*fL[18]-0.3952847075210473*(fR[14]+fL[14])+0.7905694150420948*(fR[13]+fL[13])+0.6846531968814574*fR[12]-0.6846531968814574*fL[12]-0.3952847075210473*(fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[5]+0.6123724356957944*fL[5]+0.3535533905932737*(fR[3]+fL[3])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.4472135954999579*alphaR[4]+0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[8] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])-0.9486832980505122*fR[24]+0.9486832980505122*fL[24]-0.9486832980505137*fR[23]+0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])+0.7348469228349525*(fR[19]+fL[19])+0.7348469228349533*(fR[18]+fL[18])-1.42302494707577*fR[17]+1.42302494707577*fL[17]-0.4242640687119281*fR[16]+0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])-0.4242640687119285*fR[14]+0.4242640687119285*fL[14]-1.060660171779821*fR[13]+1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])-1.060660171779821*fR[11]+1.060660171779821*fL[11]+1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6363961030678926*fR[6]+0.6363961030678926*fL[6]+0.8215838362577489*(fR[5]+fL[5]+fR[4]+fL[4])-0.4743416490252568*(fR[3]+fR[2])+0.4743416490252568*(fL[3]+fL[2])+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]+0.9486832980505122*(fR[24]+fL[24])+0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])-0.7348469228349525*fR[19]+0.7348469228349525*fL[19]-0.7348469228349533*fR[18]+0.7348469228349533*fL[18]+1.42302494707577*(fR[17]+fL[17])+0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]+0.4242640687119285*(fR[14]+fL[14])+1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]+1.060660171779821*(fR[11]+fL[11])-1.10227038425243*fR[10]+1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6363961030678926*(fR[6]+fL[6])-0.8215838362577489*(fR[5]+fR[4])+0.8215838362577489*(fL[5]+fL[4])+0.4743416490252568*(fR[3]+fL[3]+fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 

  double fUp[9];
  fUp[0] = 0.006172839506172839*(25.0*fUpOrd[8]+72.0*fUpOrd[7]+25.0*fUpOrd[6]+8.0*(9.0*fUpOrd[5]-8.0*fUpOrd[4]+9.0*fUpOrd[3])+25.0*fUpOrd[2]+72.0*fUpOrd[1]+25.0*fUpOrd[0]); 
  fUp[1] = 0.01851851851851852*(11.18033988749895*(fUpOrd[8]-1.0*fUpOrd[6]+fUpOrd[2]-1.0*fUpOrd[0])+24.0*(fUpOrd[5]-1.0*fUpOrd[3])); 
  fUp[2] = 0.01851851851851852*(11.18033988749895*(fUpOrd[8]+fUpOrd[6]-1.0*(fUpOrd[2]+fUpOrd[0]))+24.0*(fUpOrd[7]-1.0*fUpOrd[1])); 
  fUp[3] = 0.2777777777777778*(fUpOrd[8]-1.0*(fUpOrd[6]+fUpOrd[2])+fUpOrd[0]); 
  fUp[4] = 0.00552115549999948*(5.0*(5.0*fUpOrd[8]-18.0*fUpOrd[7]+5.0*fUpOrd[6])+8.0*(9.0*fUpOrd[5]-8.0*fUpOrd[4]+9.0*fUpOrd[3])+5.0*(5.0*fUpOrd[2]-18.0*fUpOrd[1]+5.0*fUpOrd[0])); 
  fUp[5] = 0.00552115549999948*(25.0*fUpOrd[8]+72.0*fUpOrd[7]+25.0*fUpOrd[6]-2.0*(45.0*fUpOrd[5]+32.0*fUpOrd[4])+5.0*(5.0*fUpOrd[2]-18.0*fUpOrd[3])+72.0*fUpOrd[1]+25.0*fUpOrd[0]); 
  fUp[6] = 0.08281733249999224*(2.23606797749979*(fUpOrd[8]+fUpOrd[6]-1.0*(fUpOrd[2]+fUpOrd[0]))+6.0*(fUpOrd[1]-1.0*fUpOrd[7])); 
  fUp[7] = 0.08281733249999224*(2.23606797749979*(fUpOrd[8]-1.0*fUpOrd[6]+fUpOrd[2]-1.0*fUpOrd[0])+6.0*(fUpOrd[3]-1.0*fUpOrd[5])); 
  fUp[8] = 0.02469135802469136*(5.0*fUpOrd[8]-18.0*fUpOrd[7]+5.0*fUpOrd[6]+2.0*((-9.0*fUpOrd[5])+26.0*fUpOrd[4]-9.0*fUpOrd[3])+5.0*fUpOrd[2]-18.0*fUpOrd[1]+5.0*fUpOrd[0]); 

  incr[0] = 0.3535533905932737*(alphaR[4]*fUp[4]+alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[1] = -0.6123724356957944*(alphaR[4]*fUp[4]+alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[2] = 0.07071067811865474*(4.47213595499958*(alphaR[1]*fUp[4]+fUp[1]*alphaR[4])+5.0*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[3] = 0.02357022603955158*(15.0*alphaR[4]*fUp[6]+15.0*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2])); 
  incr[4] = -0.07071067811865474*(7.745966692414834*(alphaR[1]*fUp[4]+fUp[1]*alphaR[4])+8.660254037844386*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[5] = -0.07071067811865474*(8.660254037844387*alphaR[4]*fUp[6]+8.660254037844386*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2])); 
  incr[6] = 0.02357022603955158*(13.41640786499874*alphaR[1]*fUp[6]+13.41640786499874*fUp[3]*alphaR[4]+15.0*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[7] = 0.7905694150420947*(alphaR[4]*fUp[4]+alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[8] = 0.01010152544552211*(2.23606797749979*(10.0*alphaR[4]*fUp[4]+14.0*alphaR[1]*fUp[1])+35.0*(alphaR[0]*fUp[4]+fUp[0]*alphaR[4])); 
  incr[9] = 0.02357022603955158*(15.0*alphaR[4]*fUp[8]+15.0*alphaR[1]*fUp[7]+15.0*alphaR[0]*fUp[5]); 
  incr[10] = -0.07071067811865474*(7.745966692414834*(alphaR[1]*fUp[6]+fUp[3]*alphaR[4])+8.660254037844386*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[11] = 0.09128709291752765*(7.745966692414834*(alphaR[1]*fUp[4]+fUp[1]*alphaR[4])+8.660254037844386*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[12] = -0.03912303982179757*(15.65247584249853*(alphaR[0]*fUp[4]+fUp[0]*alphaR[4])+10.0*alphaR[4]*fUp[4]+14.0*alphaR[1]*fUp[1]); 
  incr[13] = 0.1178511301977579*(6.708203932499369*alphaR[4]*fUp[6]+6.708203932499369*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2])); 
  incr[14] = 0.003367175148507369*((67.0820393249937*alphaR[4]+105.0*alphaR[0])*fUp[6]+3.872983346207417*(27.11088342345192*fUp[2]*alphaR[4]+24.24871130596428*alphaR[1]*fUp[3])); 
  incr[15] = -0.07071067811865474*(8.660254037844387*(alphaR[4]*fUp[8]+alphaR[0]*fUp[5])+8.660254037844386*alphaR[1]*fUp[7]); 
  incr[16] = 0.02357022603955158*(3.872983346207417*alphaR[1]*(3.464101615137754*fUp[8]+3.872983346207417*fUp[5])+(13.41640786499874*alphaR[4]+15.0*alphaR[0])*fUp[7]); 
  incr[17] = 0.02357022603955158*(30.0*alphaR[1]*fUp[6]+30.0*fUp[3]*alphaR[4]+33.54101966249685*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[18] = -0.01010152544552211*(3.872983346207417*(10.0*alphaR[4]+15.65247584249853*alphaR[0])*fUp[6]+60.6217782649107*fUp[2]*alphaR[4]+54.22176684690384*alphaR[1]*fUp[3]); 
  incr[19] = -0.07071067811865474*(7.745966692414834*alphaR[1]*fUp[8]+3.872983346207417*(2.0*alphaR[4]+2.23606797749979*alphaR[0])*fUp[7]+8.660254037844386*alphaR[1]*fUp[5]); 
  incr[20] = 0.05050762722761052*(15.65247584249853*(alphaR[0]*fUp[4]+fUp[0]*alphaR[4])+10.0*alphaR[4]*fUp[4]+14.0*alphaR[1]*fUp[1]); 
  incr[21] = 0.1178511301977579*(6.708203932499369*(alphaR[4]*fUp[8]+alphaR[0]*fUp[5])+6.708203932499369*alphaR[1]*fUp[7]); 
  incr[22] = 0.003367175148507369*((67.0820393249937*alphaR[4]+105.0*alphaR[0])*fUp[8]+93.91485505499116*alphaR[1]*fUp[7]+105.0*alphaR[4]*fUp[5]); 
  incr[23] = 0.01683587574253684*(3.872983346207417*(7.745966692414834*alphaR[4]+12.12435565298214*alphaR[0])*fUp[6]+46.95742752749558*fUp[2]*alphaR[4]+42.0*alphaR[1]*fUp[3]); 
  incr[24] = 0.02357022603955158*(30.0*alphaR[1]*fUp[8]+3.872983346207417*(7.745966692414834*alphaR[4]+8.660254037844386*alphaR[0])*fUp[7]+33.54101966249685*alphaR[1]*fUp[5]); 
  incr[25] = -0.01010152544552211*(60.6217782649107*(alphaR[0]*fUp[8]+alphaR[4]*fUp[5])+38.72983346207418*alphaR[4]*fUp[8]+54.22176684690384*alphaR[1]*fUp[7]); 
  incr[26] = 0.003367175148507369*(234.7871376374779*(alphaR[0]*fUp[8]+alphaR[4]*fUp[5])+150.0*alphaR[4]*fUp[8]+210.0*alphaR[1]*fUp[7]); 

#endif 
  outR[0] += incr[0]*rdx2R; 
  outR[1] += incr[1]*rdx2R; 
  outR[2] += incr[2]*rdx2R; 
  outR[3] += incr[3]*rdx2R; 
  outR[4] += incr[4]*rdx2R; 
  outR[5] += incr[5]*rdx2R; 
  outR[6] += incr[6]*rdx2R; 
  outR[7] += incr[7]*rdx2R; 
  outR[8] += incr[8]*rdx2R; 
  outR[9] += incr[9]*rdx2R; 
  outR[10] += incr[10]*rdx2R; 
  outR[11] += incr[11]*rdx2R; 
  outR[12] += incr[12]*rdx2R; 
  outR[13] += incr[13]*rdx2R; 
  outR[14] += incr[14]*rdx2R; 
  outR[15] += incr[15]*rdx2R; 
  outR[16] += incr[16]*rdx2R; 
  outR[17] += incr[17]*rdx2R; 
  outR[18] += incr[18]*rdx2R; 
  outR[19] += incr[19]*rdx2R; 
  outR[20] += incr[20]*rdx2R; 
  outR[21] += incr[21]*rdx2R; 
  outR[22] += incr[22]*rdx2R; 
  outR[23] += incr[23]*rdx2R; 
  outR[24] += incr[24]*rdx2R; 
  outR[25] += incr[25]*rdx2R; 
  outR[26] += incr[26]*rdx2R; 

  outL[0] += -1.0*incr[0]*rdx2L; 
  outL[1] += incr[1]*rdx2L; 
  outL[2] += -1.0*incr[2]*rdx2L; 
  outL[3] += -1.0*incr[3]*rdx2L; 
  outL[4] += incr[4]*rdx2L; 
  outL[5] += incr[5]*rdx2L; 
  outL[6] += -1.0*incr[6]*rdx2L; 
  outL[7] += -1.0*incr[7]*rdx2L; 
  outL[8] += -1.0*incr[8]*rdx2L; 
  outL[9] += -1.0*incr[9]*rdx2L; 
  outL[10] += incr[10]*rdx2L; 
  outL[11] += -1.0*incr[11]*rdx2L; 
  outL[12] += incr[12]*rdx2L; 
  outL[13] += -1.0*incr[13]*rdx2L; 
  outL[14] += -1.0*incr[14]*rdx2L; 
  outL[15] += incr[15]*rdx2L; 
  outL[16] += -1.0*incr[16]*rdx2L; 
  outL[17] += -1.0*incr[17]*rdx2L; 
  outL[18] += incr[18]*rdx2L; 
  outL[19] += incr[19]*rdx2L; 
  outL[20] += -1.0*incr[20]*rdx2L; 
  outL[21] += -1.0*incr[21]*rdx2L; 
  outL[22] += -1.0*incr[22]*rdx2L; 
  outL[23] += -1.0*incr[23]*rdx2L; 
  outL[24] += -1.0*incr[24]*rdx2L; 
  outL[25] += incr[25]*rdx2L; 
  outL[26] += -1.0*incr[26]*rdx2L; 

  return std::abs(alphaSurfAvgR); 
} 
double GyrokineticGenGeoSurf1x2vTensor_vpar_P2_Bvarsx(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *fL, const double *fR, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamilR[27]; 
  hamilR[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*(bmag[0]*wmuR+phi[0]*q_))+2.0*m_))/rdvpar2SqR; 
  hamilR[1] = 2.0*(bmag[1]*wmuR+phi[1]*q_); 
  hamilR[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamilR[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamilR[5] = (1.154700538379252*bmag[1])/rdmu2R; 
  hamilR[7] = 2.0*(bmag[2]*wmuR+phi[2]*q_); 
  hamilR[8] = (0.421637021355784*m_)/rdvpar2SqR; 
  hamilR[13] = (1.154700538379251*bmag[2])/rdmu2R; 

  double BstarZdBmagR[27]; 
  BstarZdBmagR[0] = (1.414213562373095*(1.732050807568877*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R*wvparR+(cmag[2]*jacobTotInv[2]+cmag[1]*jacobTotInv[1]+cmag[0]*jacobTotInv[0])*q_))/q_; 
  BstarZdBmagR[1] = (0.2828427124746191*(5.0*(1.732050807568877*(2.0*b_y[2]*jacobTotInv[2]+b_y[1]*jacobTotInv[1])*m_*rdx2R*wvparR+(cmag[0]*jacobTotInv[1]+jacobTotInv[0]*cmag[1])*q_)+2.23606797749979*(8.660254037844386*jacobTotInv[0]*b_y[2]*m_*rdx2R*wvparR+2.0*(cmag[1]*jacobTotInv[2]+jacobTotInv[1]*cmag[2])*q_)))/q_; 
  BstarZdBmagR[2] = (1.414213562373095*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[4] = (1.414213562373095*(b_y[2]*(2.0*jacobTotInv[2]+2.23606797749979*jacobTotInv[0])+b_y[1]*jacobTotInv[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[7] = (0.04040610178208843*(60.6217782649107*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R*wvparR+(4.47213595499958*(5.0*cmag[2]*jacobTotInv[2]+7.0*cmag[1]*jacobTotInv[1])+35.0*(cmag[0]*jacobTotInv[2]+jacobTotInv[0]*cmag[2]))*q_))/q_; 
  BstarZdBmagR[11] = (1.414213562373095*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R)/(q_*rdvpar2R); 

  double alphaR[9]; 
  alphaR[0] = -(0.25*(2.23606797749979*(1.732050807568877*BstarZdBmagR[1]-3.0*BstarZdBmagR[4])*hamilR[7]+hamilR[1]*(1.732050807568877*BstarZdBmagR[0]-3.0*BstarZdBmagR[2]))*rdx2R)/m_; 
  alphaR[1] = (0.05*(30.0*hamilR[7]*BstarZdBmagR[11]+1.732050807568877*((-10.0*BstarZdBmagR[7]*hamilR[7])-5.0*BstarZdBmagR[1]*hamilR[1])+2.23606797749979*(15.0*BstarZdBmagR[2]-8.660254037844386*BstarZdBmagR[0])*hamilR[7]+15.0*hamilR[1]*BstarZdBmagR[4])*rdx2R)/m_; 
  alphaR[2] = (0.25*(3.872983346207417*(1.732050807568877*BstarZdBmagR[4]-1.0*BstarZdBmagR[1])*hamilR[13]+(3.0*BstarZdBmagR[2]-1.732050807568877*BstarZdBmagR[0])*hamilR[5])*rdx2R)/m_; 
  alphaR[3] = -(0.05*((3.872983346207417*(4.47213595499958*BstarZdBmagR[7]-8.660254037844386*BstarZdBmagR[2]+5.0*BstarZdBmagR[0])-30.0*BstarZdBmagR[11])*hamilR[13]+(8.660254037844386*BstarZdBmagR[1]-15.0*BstarZdBmagR[4])*hamilR[5])*rdx2R)/m_; 
  alphaR[4] = (0.05*(15.0*hamilR[1]*BstarZdBmagR[11]+1.732050807568877*((-10.0*BstarZdBmagR[1]*hamilR[7])-5.0*hamilR[1]*BstarZdBmagR[7])+30.0*BstarZdBmagR[4]*hamilR[7])*rdx2R)/m_; 
  alphaR[6] = -(0.05*((17.32050807568877*BstarZdBmagR[1]-30.0*BstarZdBmagR[4])*hamilR[13]+hamilR[5]*(8.660254037844387*BstarZdBmagR[7]-15.0*BstarZdBmagR[11]))*rdx2R)/m_; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = -(0.0625*(2.23606797749979*(1.732050807568877*BstarZdBmagR[1]*hamilR[7]*rdx2R-3.0*BstarZdBmagR[4]*hamilR[7]*rdx2R)-3.0*hamilR[1]*BstarZdBmagR[2]*rdx2R+1.732050807568877*BstarZdBmagR[0]*hamilR[1]*rdx2R))/m_; 

  double incr[27]; 
  double amax = amax_in; 

  double fAvg[9]; 
  fAvg[0] = 0.7071067811865475*(2.23606797749979*(fR[8]+fL[8])+1.732050807568877*(fL[2]-1.0*fR[2])+fR[0]+fL[0]); 
  fAvg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fR[12]+fL[12])+3.0*(fL[4]-1.0*fR[4]))+3.0*(fR[1]+fL[1])); 
  fAvg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fR[14]+fL[14])+3.0*(fL[6]-1.0*fR[6]))+3.0*(fR[3]+fL[3])); 
  fAvg[3] = 0.7071067811865475*(2.23606797749979*(fR[18]+fL[18])+1.732050807568877*(fL[10]-1.0*fR[10])+fR[5]+fL[5]); 
  fAvg[4] = 0.1414213562373095*(2.23606797749979*(5.0*(fR[20]+fL[20])-3.872983346207417*(fR[11]-1.0*fL[11]))+5.0*(fR[7]+fL[7])); 
  fAvg[5] = 0.1414213562373095*(2.23606797749979*(5.0*(fR[22]+fL[22])-3.872983346207417*(fR[16]-1.0*fL[16]))+5.0*(fR[9]+fL[9])); 
  fAvg[6] = -0.04714045207910316*(3.872983346207417*(6.708203932499369*(fR[17]-1.0*fL[17])-8.660254037844386*(fR[23]+fL[23]))-15.0*(fR[13]+fL[13])); 
  fAvg[7] = -0.04714045207910316*(3.872983346207417*(6.708203932499369*(fR[19]-1.0*fL[19])-8.660254037844386*(fR[25]+fL[25]))-15.0*(fR[15]+fL[15])); 
  fAvg[8] = 0.7071067811865475*(2.23606797749979*(fR[26]+fL[26])+1.732050807568877*(fL[24]-1.0*fR[24])+fR[21]+fL[21]); 

  double Ghat[9]; 
  Ghat[0] = -0.1767766952966368*((2.23606797749979*(2.0*fR[8]-2.0*fL[8])-3.464101615137754*(fR[2]+fL[2])+2.0*fR[0]-2.0*fL[0])*amax-1.414213562373095*(alphaR[6]*fAvg[6]+alphaR[4]*fAvg[4]+alphaR[3]*fAvg[3]+alphaR[2]*fAvg[2]+alphaR[1]*fAvg[1]+alphaR[0]*fAvg[0])); 
  Ghat[1] = -0.01178511301977579*(6.708203932499369*((10.0*fR[12]-10.0*fL[12])*amax-2.828427124746191*(alphaR[3]*fAvg[6]+fAvg[3]*alphaR[6]))+((-51.96152422706631*(fR[4]+fL[4]))+30.0*fR[1]-30.0*fL[1])*amax-18.97366596101028*(alphaR[1]*fAvg[4]+fAvg[1]*alphaR[4])-21.21320343559643*(alphaR[2]*fAvg[3]+fAvg[2]*alphaR[3]+alphaR[0]*fAvg[1]+fAvg[0]*alphaR[1])); 
  Ghat[2] = 0.01178511301977579*(3.872983346207417*(1.732050807568877*((10.0*fL[14]-10.0*fR[14])*amax+2.828427124746191*(alphaR[6]*fAvg[8]+alphaR[3]*fAvg[7]))+5.477225575051662*(alphaR[4]*fAvg[6]+fAvg[4]*alphaR[6]))+(51.96152422706631*(fR[6]+fL[6])-30.0*fR[3]+30.0*fL[3])*amax+18.97366596101028*alphaR[2]*fAvg[5]+21.21320343559643*(alphaR[1]*fAvg[3]+fAvg[1]*alphaR[3]+alphaR[0]*fAvg[2]+fAvg[0]*alphaR[2])); 
  Ghat[3] = 0.01178511301977579*(2.23606797749979*((30.0*fL[18]-30.0*fR[18])*amax+8.485281374238571*(alphaR[3]*(fAvg[5]+fAvg[4])+fAvg[3]*alphaR[4]))+(51.96152422706631*(fR[10]+fL[10])-30.0*fR[5]+30.0*fL[5])*amax+16.97056274847715*alphaR[3]*fAvg[8]+18.97366596101028*(alphaR[2]*fAvg[7]+alphaR[1]*fAvg[6]+fAvg[1]*alphaR[6])+16.97056274847715*alphaR[6]*fAvg[7]+21.21320343559643*(alphaR[0]*fAvg[3]+fAvg[0]*alphaR[3]+alphaR[1]*fAvg[2]+fAvg[1]*alphaR[2])); 
  Ghat[4] = 0.001683587574253684*(2.23606797749979*((210.0*fL[20]-210.0*fR[20])*amax+42.42640687119286*(alphaR[6]*fAvg[6]+alphaR[4]*fAvg[4])+59.39696961967*(alphaR[3]*fAvg[3]+alphaR[1]*fAvg[1]))+8.660254037844387*(42.0*(fR[11]+fL[11])*amax+17.14642819948224*(alphaR[2]*fAvg[6]+fAvg[2]*alphaR[6]))+(210.0*fL[7]-210.0*fR[7])*amax+148.492424049175*(alphaR[0]*fAvg[4]+fAvg[0]*alphaR[4])); 
  Ghat[5] = 0.01178511301977579*(2.23606797749979*((30.0*fL[22]-30.0*fR[22])*amax+8.485281374238571*(alphaR[6]*fAvg[6]+alphaR[3]*fAvg[3]+alphaR[2]*fAvg[2]))+8.660254037844387*(6.0*(fR[16]+fL[16])*amax+2.449489742783178*alphaR[1]*fAvg[7])+(30.0*fL[9]-30.0*fR[9])*amax+21.21320343559643*(alphaR[4]*fAvg[8]+alphaR[0]*fAvg[5])); 
  Ghat[6] = 0.001683587574253684*(3.872983346207417*(1.732050807568877*((70.0*fL[23]-70.0*fR[23])*amax+19.79898987322333*(alphaR[2]*fAvg[8]+alphaR[1]*fAvg[3]+fAvg[1]*alphaR[3]))+2.23606797749979*(42.0*(fR[17]+fL[17])*amax+17.14642819948224*(alphaR[2]*fAvg[4]+fAvg[2]*alphaR[4])))+(210.0*fL[13]-210.0*fR[13])*amax+84.85281374238573*alphaR[6]*fAvg[8]+118.79393923934*alphaR[3]*fAvg[7]+2.23606797749979*(42.42640687119286*alphaR[4]*fAvg[6]+(59.39696961967*fAvg[5]+42.42640687119286*fAvg[4])*alphaR[6])+148.492424049175*(alphaR[0]*fAvg[6]+fAvg[0]*alphaR[6])); 
  Ghat[7] = 0.01178511301977579*(3.872983346207417*(1.732050807568877*((10.0*fL[25]-10.0*fR[25])*amax+2.828427124746191*(alphaR[1]*fAvg[8]+alphaR[2]*fAvg[3]+fAvg[2]*alphaR[3]))+2.23606797749979*(6.0*(fR[19]+fL[19])*amax+2.449489742783178*alphaR[1]*fAvg[5]))+(30.0*fL[15]-30.0*fR[15])*amax+(18.97366596101028*alphaR[4]+21.21320343559643*alphaR[0])*fAvg[7]+16.97056274847715*(alphaR[3]*fAvg[6]+fAvg[3]*alphaR[6])); 
  Ghat[8] = 0.001683587574253684*(2.23606797749979*((210.0*fL[26]-210.0*fR[26])*amax+42.42640687119286*alphaR[4]*fAvg[8])+(363.7306695894642*(fR[24]+fL[24])-210.0*fR[21]+210.0*fL[21])*amax+148.492424049175*alphaR[0]*fAvg[8]+132.815661727072*(alphaR[1]*fAvg[7]+alphaR[2]*fAvg[6]+fAvg[2]*alphaR[6])+84.85281374238573*alphaR[6]*fAvg[6]+148.492424049175*alphaR[4]*fAvg[5]+118.79393923934*alphaR[3]*fAvg[3]); 

  incr[0] = 0.7071067811865475*Ghat[0]; 
  incr[1] = 0.7071067811865475*Ghat[1]; 
  incr[2] = -1.224744871391589*Ghat[0]; 
  incr[3] = 0.7071067811865475*Ghat[2]; 
  incr[4] = -1.224744871391589*Ghat[1]; 
  incr[5] = 0.7071067811865475*Ghat[3]; 
  incr[6] = -1.224744871391589*Ghat[2]; 
  incr[7] = 0.7071067811865475*Ghat[4]; 
  incr[8] = 1.58113883008419*Ghat[0]; 
  incr[9] = 0.7071067811865475*Ghat[5]; 
  incr[10] = -1.224744871391589*Ghat[3]; 
  incr[11] = -1.224744871391589*Ghat[4]; 
  incr[12] = 1.58113883008419*Ghat[1]; 
  incr[13] = 0.7071067811865475*Ghat[6]; 
  incr[14] = 1.58113883008419*Ghat[2]; 
  incr[15] = 0.7071067811865475*Ghat[7]; 
  incr[16] = -1.224744871391589*Ghat[5]; 
  incr[17] = -1.224744871391589*Ghat[6]; 
  incr[18] = 1.58113883008419*Ghat[3]; 
  incr[19] = -1.224744871391589*Ghat[7]; 
  incr[20] = 1.58113883008419*Ghat[4]; 
  incr[21] = 0.7071067811865475*Ghat[8]; 
  incr[22] = 1.58113883008419*Ghat[5]; 
  incr[23] = 1.58113883008419*Ghat[6]; 
  incr[24] = -1.224744871391589*Ghat[8]; 
  incr[25] = 1.58113883008419*Ghat[7]; 
  incr[26] = 1.58113883008419*Ghat[8]; 

  outR[0] += incr[0]*rdvpar2R; 
  outR[1] += incr[1]*rdvpar2R; 
  outR[2] += incr[2]*rdvpar2R; 
  outR[3] += incr[3]*rdvpar2R; 
  outR[4] += incr[4]*rdvpar2R; 
  outR[5] += incr[5]*rdvpar2R; 
  outR[6] += incr[6]*rdvpar2R; 
  outR[7] += incr[7]*rdvpar2R; 
  outR[8] += incr[8]*rdvpar2R; 
  outR[9] += incr[9]*rdvpar2R; 
  outR[10] += incr[10]*rdvpar2R; 
  outR[11] += incr[11]*rdvpar2R; 
  outR[12] += incr[12]*rdvpar2R; 
  outR[13] += incr[13]*rdvpar2R; 
  outR[14] += incr[14]*rdvpar2R; 
  outR[15] += incr[15]*rdvpar2R; 
  outR[16] += incr[16]*rdvpar2R; 
  outR[17] += incr[17]*rdvpar2R; 
  outR[18] += incr[18]*rdvpar2R; 
  outR[19] += incr[19]*rdvpar2R; 
  outR[20] += incr[20]*rdvpar2R; 
  outR[21] += incr[21]*rdvpar2R; 
  outR[22] += incr[22]*rdvpar2R; 
  outR[23] += incr[23]*rdvpar2R; 
  outR[24] += incr[24]*rdvpar2R; 
  outR[25] += incr[25]*rdvpar2R; 
  outR[26] += incr[26]*rdvpar2R; 

  outL[0] += -1.0*incr[0]*rdvpar2L; 
  outL[1] += -1.0*incr[1]*rdvpar2L; 
  outL[2] += incr[2]*rdvpar2L; 
  outL[3] += -1.0*incr[3]*rdvpar2L; 
  outL[4] += incr[4]*rdvpar2L; 
  outL[5] += -1.0*incr[5]*rdvpar2L; 
  outL[6] += incr[6]*rdvpar2L; 
  outL[7] += -1.0*incr[7]*rdvpar2L; 
  outL[8] += -1.0*incr[8]*rdvpar2L; 
  outL[9] += -1.0*incr[9]*rdvpar2L; 
  outL[10] += incr[10]*rdvpar2L; 
  outL[11] += incr[11]*rdvpar2L; 
  outL[12] += -1.0*incr[12]*rdvpar2L; 
  outL[13] += -1.0*incr[13]*rdvpar2L; 
  outL[14] += -1.0*incr[14]*rdvpar2L; 
  outL[15] += -1.0*incr[15]*rdvpar2L; 
  outL[16] += incr[16]*rdvpar2L; 
  outL[17] += incr[17]*rdvpar2L; 
  outL[18] += -1.0*incr[18]*rdvpar2L; 
  outL[19] += incr[19]*rdvpar2L; 
  outL[20] += -1.0*incr[20]*rdvpar2L; 
  outL[21] += -1.0*incr[21]*rdvpar2L; 
  outL[22] += -1.0*incr[22]*rdvpar2L; 
  outL[23] += -1.0*incr[23]*rdvpar2L; 
  outL[24] += incr[24]*rdvpar2L; 
  outL[25] += -1.0*incr[25]*rdvpar2L; 
  outL[26] += -1.0*incr[26]*rdvpar2L; 
return std::abs(alphaSurfAvgR); 
} 
double GyrokineticGenGeoSurf1x2vTensor_x_P2_Bvarsz(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *fL, const double *fR, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamilR[27]; 
  hamilR[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*(bmag[0]*wmuR+phi[0]*q_))+2.0*m_))/rdvpar2SqR; 
  hamilR[1] = 2.0*phi[1]*q_; 
  hamilR[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamilR[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamilR[7] = 2.0*phi[2]*q_; 
  hamilR[8] = (0.421637021355784*m_)/rdvpar2SqR; 

  double BstarZdBmagR[27]; 
  BstarZdBmagR[0] = 1.414213562373095*cmag[0]*jacobTotInv[0]; 

  double alphaR[9]; 
  alphaR[0] = (0.4330127018922193*BstarZdBmagR[0]*hamilR[2]*rdvpar2R)/m_; 
  alphaR[1] = (0.9682458365518543*BstarZdBmagR[0]*hamilR[8]*rdvpar2R)/m_; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = (0.1082531754730548*BstarZdBmagR[0]*hamilR[2]*rdvpar2R)/m_; 

  double incr[27]; 
#if upwindType == SURFAVG 
  if (alphaSurfAvgR>0) { 
  incr[0] = 0.08333333333333333*(6.708203932499369*alphaR[1]*fL[11]+6.708203932499369*alphaR[0]*fL[7]+5.196152422706632*(alphaR[1]*fL[4]+alphaR[0]*fL[1])+3.0*(alphaR[1]*fL[2]+alphaR[0]*fL[0])); 
  incr[1] = -0.25*(3.872983346207417*(alphaR[1]*fL[11]+alphaR[0]*fL[7])+3.0*alphaR[1]*fL[4]+1.732050807568877*(alphaR[1]*fL[2]+alphaR[0]*fL[0])+3.0*alphaR[0]*fL[1]); 
  incr[2] = 0.01666666666666667*(30.0*alphaR[1]*fL[20]+3.872983346207417*(6.0*alphaR[1]*fL[12]+8.660254037844386*alphaR[0]*fL[11])+2.23606797749979*alphaR[1]*(6.0*fL[8]+15.0*fL[7])+25.98076211353316*(alphaR[0]*fL[4]+alphaR[1]*fL[1])+15.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1])); 
  incr[3] = 0.08333333333333333*(6.708203932499369*alphaR[1]*fL[17]+6.708203932499369*alphaR[0]*fL[13]+5.196152422706632*(alphaR[1]*fL[10]+alphaR[0]*fL[5])+3.0*(alphaR[1]*fL[6]+alphaR[0]*fL[3])); 
  incr[4] = -0.05*(1.732050807568877*(10.0*alphaR[1]*fL[20]+5.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1]))+3.872983346207417*(3.464101615137754*alphaR[1]*fL[12]+5.0*alphaR[0]*fL[11]+alphaR[1]*(2.0*fL[8]+5.0*fL[7]))+15.0*(alphaR[0]*fL[4]+alphaR[1]*fL[1])); 
  incr[5] = -0.25*(3.872983346207417*(alphaR[1]*fL[17]+alphaR[0]*fL[13])+3.0*alphaR[1]*fL[10]+1.732050807568877*(alphaR[1]*fL[6]+alphaR[0]*fL[3])+3.0*alphaR[0]*fL[5]); 
  incr[6] = 0.01666666666666667*(30.0*alphaR[1]*fL[23]+2.23606797749979*(10.39230484541326*alphaR[1]*fL[18]+15.0*alphaR[0]*fL[17])+6.708203932499369*alphaR[1]*(2.0*fL[14]+5.0*fL[13])+25.98076211353316*(alphaR[0]*fL[10]+alphaR[1]*fL[5])+15.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3])); 
  incr[7] = 0.08333333333333333*(15.0*alphaR[1]*fL[11]+15.0*alphaR[0]*fL[7]+2.23606797749979*(5.196152422706632*(alphaR[1]*fL[4]+alphaR[0]*fL[1])+3.0*(alphaR[1]*fL[2]+alphaR[0]*fL[0]))); 
  incr[8] = 0.01666666666666667*(2.23606797749979*(15.0*alphaR[0]*fL[20]+alphaR[1]*(10.39230484541326*fL[4]+6.0*fL[2]))+8.660254037844387*(3.0*alphaR[0]*fL[12]+3.464101615137754*alphaR[1]*fL[11])+15.0*alphaR[0]*fL[8]); 
  incr[9] = 0.01666666666666667*(33.54101966249685*(alphaR[1]*fL[24]+alphaR[0]*fL[21])+25.98076211353316*alphaR[1]*fL[19]+8.660254037844387*(1.732050807568877*alphaR[1]*fL[16]+3.0*alphaR[0]*fL[15])+15.0*alphaR[0]*fL[9]); 
  incr[10] = -0.05*(1.732050807568877*(10.0*alphaR[1]*fL[23]+5.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3]))+2.23606797749979*(6.0*alphaR[1]*fL[18]+8.660254037844386*alphaR[0]*fL[17])+3.872983346207417*alphaR[1]*(2.0*fL[14]+5.0*fL[13])+15.0*(alphaR[0]*fL[10]+alphaR[1]*fL[5])); 
  incr[11] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(10.0*alphaR[1]*fL[20]+5.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1]))+3.872983346207417*alphaR[1]*(2.0*fL[8]+5.0*fL[7])+15.0*(alphaR[0]*fL[4]+alphaR[1]*fL[1]))+51.96152422706631*alphaR[1]*fL[12]+75.0*alphaR[0]*fL[11]); 
  incr[12] = -0.05*(3.872983346207417*(alphaR[0]*(5.0*fL[20]+2.23606797749979*fL[8])+alphaR[1]*(3.464101615137754*fL[4]+2.0*fL[2]))+15.0*alphaR[0]*fL[12]+17.32050807568877*alphaR[1]*fL[11]); 
  incr[13] = 0.08333333333333333*(3.872983346207417*(alphaR[1]*(3.872983346207417*fL[17]+3.0*fL[10])+1.732050807568877*(alphaR[1]*fL[6]+alphaR[0]*fL[3])+3.0*alphaR[0]*fL[5])+15.0*alphaR[0]*fL[13]); 
  incr[14] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(5.0*alphaR[0]*fL[23]+2.0*alphaR[1]*fL[6])+2.23606797749979*(3.0*alphaR[0]*fL[18]+3.464101615137754*alphaR[1]*fL[17])+6.0*alphaR[1]*fL[10])+15.0*alphaR[0]*fL[14]); 
  incr[15] = -0.05*(3.872983346207417*(5.0*(alphaR[1]*fL[24]+alphaR[0]*fL[21])+2.23606797749979*(1.732050807568877*alphaR[1]*fL[19]+alphaR[0]*fL[9]))+8.660254037844386*alphaR[1]*fL[16]+15.0*alphaR[0]*fL[15]); 
  incr[16] = 0.01666666666666667*(3.872983346207417*(2.23606797749979*(1.732050807568877*alphaR[1]*(2.0*fL[26]+fL[9])+3.0*alphaR[0]*fL[19])+6.0*alphaR[1]*fL[25]+1.732050807568877*(5.0*alphaR[0]*fL[24]+alphaR[1]*(2.0*fL[22]+5.0*fL[21])))+15.0*alphaR[0]*fL[16]+25.98076211353316*alphaR[1]*fL[15]); 
  incr[17] = 0.01666666666666667*(2.23606797749979*(30.0*alphaR[1]*fL[23]+25.98076211353316*(alphaR[0]*fL[10]+alphaR[1]*fL[5])+15.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3]))+51.96152422706631*alphaR[1]*fL[18]+75.0*alphaR[0]*fL[17]+15.0*alphaR[1]*(2.0*fL[14]+5.0*fL[13])); 
  incr[18] = -0.05*(2.23606797749979*(1.732050807568877*(5.0*alphaR[0]*fL[23]+2.0*alphaR[1]*fL[6])+6.0*alphaR[1]*fL[10])+15.0*alphaR[0]*fL[18]+17.32050807568877*alphaR[1]*fL[17]+8.660254037844387*alphaR[0]*fL[14]); 
  incr[19] = -0.05*(1.732050807568877*alphaR[1]*(10.0*fL[26]+5.0*fL[9])+2.23606797749979*(6.0*alphaR[1]*fL[25]+1.732050807568877*(5.0*alphaR[0]*fL[24]+alphaR[1]*(2.0*fL[22]+5.0*fL[21])))+15.0*alphaR[0]*fL[19]+8.660254037844387*(alphaR[0]*fL[16]+1.732050807568877*alphaR[1]*fL[15])); 
  incr[20] = 0.08333333333333333*(15.0*alphaR[0]*fL[20]+3.872983346207417*(3.0*alphaR[0]*fL[12]+3.464101615137754*alphaR[1]*fL[11])+6.708203932499369*alphaR[0]*fL[8]+alphaR[1]*(10.39230484541326*fL[4]+6.0*fL[2])); 
  incr[21] = 0.08333333333333333*(15.0*(alphaR[1]*fL[24]+alphaR[0]*fL[21])+2.23606797749979*(5.196152422706631*alphaR[1]*fL[19]+3.0*alphaR[0]*fL[9])+3.872983346207417*(1.732050807568877*alphaR[1]*fL[16]+3.0*alphaR[0]*fL[15])); 
  incr[22] = 0.01666666666666667*(2.23606797749979*(15.0*alphaR[0]*fL[26]+10.39230484541326*alphaR[1]*fL[19])+25.98076211353316*alphaR[0]*fL[25]+30.0*alphaR[1]*fL[24]+15.0*alphaR[0]*fL[22]+13.41640786499874*alphaR[1]*fL[16]); 
  incr[23] = 0.08333333333333333*(15.0*alphaR[0]*fL[23]+2.23606797749979*(5.196152422706631*alphaR[0]*fL[18]+6.0*alphaR[1]*fL[17])+6.708203932499369*alphaR[0]*fL[14]+alphaR[1]*(10.39230484541326*fL[10]+6.0*fL[6])); 
  incr[24] = 0.08333333333333333*(2.23606797749979*(6.0*alphaR[1]*fL[26]+5.196152422706631*alphaR[0]*fL[19]+3.0*alphaR[1]*fL[9])+10.39230484541326*alphaR[1]*fL[25]+15.0*alphaR[0]*fL[24]+alphaR[1]*(6.0*fL[22]+15.0*fL[21])+3.872983346207417*(1.732050807568877*alphaR[0]*fL[16]+3.0*alphaR[1]*fL[15])); 
  incr[25] = -0.05*(2.23606797749979*(8.660254037844386*alphaR[0]*fL[26]+6.0*alphaR[1]*fL[19])+15.0*alphaR[0]*fL[25]+1.732050807568877*(10.0*alphaR[1]*fL[24]+5.0*alphaR[0]*fL[22])+7.745966692414834*alphaR[1]*fL[16]); 
  incr[26] = 0.01666666666666667*(75.0*alphaR[0]*fL[26]+2.23606797749979*(25.98076211353316*alphaR[0]*fL[25]+30.0*alphaR[1]*fL[24]+15.0*alphaR[0]*fL[22])+alphaR[1]*(51.96152422706631*fL[19]+30.0*fL[16])); 
  } else { 
  incr[0] = 0.08333333333333333*(6.708203932499369*alphaR[1]*fR[11]+6.708203932499369*alphaR[0]*fR[7]-5.196152422706632*(alphaR[1]*fR[4]+alphaR[0]*fR[1])+3.0*(alphaR[1]*fR[2]+alphaR[0]*fR[0])); 
  incr[1] = -0.25*(3.872983346207417*(alphaR[1]*fR[11]+alphaR[0]*fR[7])-3.0*alphaR[1]*fR[4]+1.732050807568877*(alphaR[1]*fR[2]+alphaR[0]*fR[0])-3.0*alphaR[0]*fR[1]); 
  incr[2] = 0.01666666666666667*(30.0*alphaR[1]*fR[20]+3.872983346207417*(8.660254037844386*alphaR[0]*fR[11]-6.0*alphaR[1]*fR[12])+2.23606797749979*alphaR[1]*(6.0*fR[8]+15.0*fR[7])-25.98076211353316*(alphaR[0]*fR[4]+alphaR[1]*fR[1])+15.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1])); 
  incr[3] = 0.08333333333333333*(6.708203932499369*alphaR[1]*fR[17]+6.708203932499369*alphaR[0]*fR[13]-5.196152422706632*(alphaR[1]*fR[10]+alphaR[0]*fR[5])+3.0*(alphaR[1]*fR[6]+alphaR[0]*fR[3])); 
  incr[4] = 0.05*(1.732050807568877*((-10.0*alphaR[1]*fR[20])-5.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1]))+3.872983346207417*(3.464101615137754*alphaR[1]*fR[12]-5.0*alphaR[0]*fR[11]+alphaR[1]*((-2.0*fR[8])-5.0*fR[7]))+15.0*(alphaR[0]*fR[4]+alphaR[1]*fR[1])); 
  incr[5] = -0.25*(3.872983346207417*(alphaR[1]*fR[17]+alphaR[0]*fR[13])-3.0*alphaR[1]*fR[10]+1.732050807568877*(alphaR[1]*fR[6]+alphaR[0]*fR[3])-3.0*alphaR[0]*fR[5]); 
  incr[6] = 0.01666666666666667*(30.0*alphaR[1]*fR[23]+2.23606797749979*(15.0*alphaR[0]*fR[17]-10.39230484541326*alphaR[1]*fR[18])+6.708203932499369*alphaR[1]*(2.0*fR[14]+5.0*fR[13])-25.98076211353316*(alphaR[0]*fR[10]+alphaR[1]*fR[5])+15.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3])); 
  incr[7] = 0.08333333333333333*(15.0*alphaR[1]*fR[11]+15.0*alphaR[0]*fR[7]+2.23606797749979*(3.0*(alphaR[1]*fR[2]+alphaR[0]*fR[0])-5.196152422706632*(alphaR[1]*fR[4]+alphaR[0]*fR[1]))); 
  incr[8] = 0.01666666666666667*(2.23606797749979*(15.0*alphaR[0]*fR[20]+alphaR[1]*(6.0*fR[2]-10.39230484541326*fR[4]))+8.660254037844387*(3.464101615137754*alphaR[1]*fR[11]-3.0*alphaR[0]*fR[12])+15.0*alphaR[0]*fR[8]); 
  incr[9] = 0.01666666666666667*(33.54101966249685*(alphaR[1]*fR[24]+alphaR[0]*fR[21])-25.98076211353316*alphaR[1]*fR[19]+8.660254037844387*(1.732050807568877*alphaR[1]*fR[16]-3.0*alphaR[0]*fR[15])+15.0*alphaR[0]*fR[9]); 
  incr[10] = -0.05*(1.732050807568877*(10.0*alphaR[1]*fR[23]+5.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3]))+2.23606797749979*(8.660254037844386*alphaR[0]*fR[17]-6.0*alphaR[1]*fR[18])+3.872983346207417*alphaR[1]*(2.0*fR[14]+5.0*fR[13])-15.0*(alphaR[0]*fR[10]+alphaR[1]*fR[5])); 
  incr[11] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(10.0*alphaR[1]*fR[20]+5.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1]))+3.872983346207417*alphaR[1]*(2.0*fR[8]+5.0*fR[7])-15.0*(alphaR[0]*fR[4]+alphaR[1]*fR[1]))-51.96152422706631*alphaR[1]*fR[12]+75.0*alphaR[0]*fR[11]); 
  incr[12] = -0.05*(3.872983346207417*(alphaR[0]*(5.0*fR[20]+2.23606797749979*fR[8])+alphaR[1]*(2.0*fR[2]-3.464101615137754*fR[4]))-15.0*alphaR[0]*fR[12]+17.32050807568877*alphaR[1]*fR[11]); 
  incr[13] = 0.08333333333333333*(3.872983346207417*(alphaR[1]*(3.872983346207417*fR[17]-3.0*fR[10])+1.732050807568877*(alphaR[1]*fR[6]+alphaR[0]*fR[3])-3.0*alphaR[0]*fR[5])+15.0*alphaR[0]*fR[13]); 
  incr[14] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(5.0*alphaR[0]*fR[23]+2.0*alphaR[1]*fR[6])+2.23606797749979*(3.464101615137754*alphaR[1]*fR[17]-3.0*alphaR[0]*fR[18])-6.0*alphaR[1]*fR[10])+15.0*alphaR[0]*fR[14]); 
  incr[15] = 0.05*(3.872983346207417*(2.23606797749979*(1.732050807568877*alphaR[1]*fR[19]-1.0*alphaR[0]*fR[9])-5.0*(alphaR[1]*fR[24]+alphaR[0]*fR[21]))-8.660254037844386*alphaR[1]*fR[16]+15.0*alphaR[0]*fR[15]); 
  incr[16] = 0.01666666666666667*(3.872983346207417*(2.23606797749979*(1.732050807568877*alphaR[1]*(2.0*fR[26]+fR[9])-3.0*alphaR[0]*fR[19])-6.0*alphaR[1]*fR[25]+1.732050807568877*(5.0*alphaR[0]*fR[24]+alphaR[1]*(2.0*fR[22]+5.0*fR[21])))+15.0*alphaR[0]*fR[16]-25.98076211353316*alphaR[1]*fR[15]); 
  incr[17] = 0.01666666666666667*(2.23606797749979*(30.0*alphaR[1]*fR[23]-25.98076211353316*(alphaR[0]*fR[10]+alphaR[1]*fR[5])+15.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3]))-51.96152422706631*alphaR[1]*fR[18]+75.0*alphaR[0]*fR[17]+15.0*alphaR[1]*(2.0*fR[14]+5.0*fR[13])); 
  incr[18] = -0.05*(2.23606797749979*(1.732050807568877*(5.0*alphaR[0]*fR[23]+2.0*alphaR[1]*fR[6])-6.0*alphaR[1]*fR[10])-15.0*alphaR[0]*fR[18]+17.32050807568877*alphaR[1]*fR[17]+8.660254037844387*alphaR[0]*fR[14]); 
  incr[19] = 0.05*(1.732050807568877*alphaR[1]*((-10.0*fR[26])-5.0*fR[9])+2.23606797749979*(6.0*alphaR[1]*fR[25]+1.732050807568877*(alphaR[1]*((-2.0*fR[22])-5.0*fR[21])-5.0*alphaR[0]*fR[24]))+15.0*alphaR[0]*fR[19]+8.660254037844387*(1.732050807568877*alphaR[1]*fR[15]-1.0*alphaR[0]*fR[16])); 
  incr[20] = 0.08333333333333333*(15.0*alphaR[0]*fR[20]+3.872983346207417*(3.464101615137754*alphaR[1]*fR[11]-3.0*alphaR[0]*fR[12])+6.708203932499369*alphaR[0]*fR[8]+alphaR[1]*(6.0*fR[2]-10.39230484541326*fR[4])); 
  incr[21] = 0.08333333333333333*(15.0*(alphaR[1]*fR[24]+alphaR[0]*fR[21])+2.23606797749979*(3.0*alphaR[0]*fR[9]-5.196152422706631*alphaR[1]*fR[19])+3.872983346207417*(1.732050807568877*alphaR[1]*fR[16]-3.0*alphaR[0]*fR[15])); 
  incr[22] = 0.01666666666666667*(2.23606797749979*(15.0*alphaR[0]*fR[26]-10.39230484541326*alphaR[1]*fR[19])-25.98076211353316*alphaR[0]*fR[25]+30.0*alphaR[1]*fR[24]+15.0*alphaR[0]*fR[22]+13.41640786499874*alphaR[1]*fR[16]); 
  incr[23] = 0.08333333333333333*(15.0*alphaR[0]*fR[23]+2.23606797749979*(6.0*alphaR[1]*fR[17]-5.196152422706631*alphaR[0]*fR[18])+6.708203932499369*alphaR[0]*fR[14]+alphaR[1]*(6.0*fR[6]-10.39230484541326*fR[10])); 
  incr[24] = 0.08333333333333333*(2.23606797749979*(6.0*alphaR[1]*fR[26]-5.196152422706631*alphaR[0]*fR[19]+3.0*alphaR[1]*fR[9])-10.39230484541326*alphaR[1]*fR[25]+15.0*alphaR[0]*fR[24]+alphaR[1]*(6.0*fR[22]+15.0*fR[21])+3.872983346207417*(1.732050807568877*alphaR[0]*fR[16]-3.0*alphaR[1]*fR[15])); 
  incr[25] = -0.05*(2.23606797749979*(8.660254037844386*alphaR[0]*fR[26]-6.0*alphaR[1]*fR[19])-15.0*alphaR[0]*fR[25]+1.732050807568877*(10.0*alphaR[1]*fR[24]+5.0*alphaR[0]*fR[22])+7.745966692414834*alphaR[1]*fR[16]); 
  incr[26] = 0.01666666666666667*(75.0*alphaR[0]*fR[26]+2.23606797749979*((-25.98076211353316*alphaR[0]*fR[25])+30.0*alphaR[1]*fR[24]+15.0*alphaR[0]*fR[22])+alphaR[1]*(30.0*fR[16]-51.96152422706631*fR[19])); 
  }
#elif upwindType == QUAD 
  double alphaOrdR;
  double fUpOrd[9];
  alphaOrdR = 0.5*alphaR[0]-0.6708203932499369*alphaR[1]; 
  fUpOrd[0] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])+0.9486832980505122*fR[24]-0.9486832980505122*fL[24]+0.9486832980505137*fR[23]-0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])-0.7348469228349525*(fR[19]+fL[19])-0.7348469228349533*(fR[18]+fL[18])-1.42302494707577*fR[17]+1.42302494707577*fL[17]+0.4242640687119281*fR[16]-0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])+0.4242640687119285*fR[14]-0.4242640687119285*fL[14]+1.060660171779821*fR[13]-1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])+1.060660171779821*fR[11]-1.060660171779821*fL[11]+1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6363961030678926*fR[6]+0.6363961030678926*fL[6]-0.8215838362577489*(fR[5]+fL[5]+fR[4]+fL[4])+0.4743416490252568*(fR[3]+fR[2])-0.4743416490252568*(fL[3]+fL[2])+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]-0.9486832980505122*(fR[24]+fL[24])-0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])+0.7348469228349525*fR[19]-0.7348469228349525*fL[19]+0.7348469228349533*fR[18]-0.7348469228349533*fL[18]+1.42302494707577*(fR[17]+fL[17])-0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]-0.4242640687119285*(fR[14]+fL[14])-1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]-1.060660171779821*(fR[11]+fL[11])-1.10227038425243*fR[10]+1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6363961030678926*(fR[6]+fL[6])+0.8215838362577489*(fR[5]+fR[4])-0.8215838362577489*(fL[5]+fL[4])-0.4743416490252568*(fR[3]+fL[3]+fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]; 
  fUpOrd[1] = 0.5*(((-0.883883476483184*fR[23])+0.883883476483184*(fL[23]+fR[20])-0.883883476483184*fL[20]+0.6846531968814573*(fR[18]+fL[18])-0.3952847075210473*fR[14]+0.3952847075210473*fL[14]+0.7905694150420948*fR[13]-0.7905694150420948*fL[13]-0.6846531968814574*(fR[12]+fL[12])+0.3952847075210473*fR[8]-0.3952847075210473*fL[8]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6123724356957944*(fR[5]+fL[5])+0.3535533905932737*fR[3]-0.3535533905932737*fL[3]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.883883476483184*(fR[23]+fL[23])-0.883883476483184*(fR[20]+fL[20])-0.6846531968814573*fR[18]+0.6846531968814573*fL[18]+0.3952847075210473*(fR[14]+fL[14])-0.7905694150420948*(fR[13]+fL[13])+0.6846531968814574*fR[12]-0.6846531968814574*fL[12]-0.3952847075210473*(fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6123724356957944*fR[5]-0.6123724356957944*fL[5]-0.3535533905932737*(fR[3]+fL[3])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[2] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])-0.9486832980505122*fR[24]+0.9486832980505122*fL[24]+0.9486832980505137*fR[23]-0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])+0.7348469228349525*(fR[19]+fL[19])-0.7348469228349533*(fR[18]+fL[18])+1.42302494707577*fR[17]-1.42302494707577*fL[17]-0.4242640687119281*fR[16]+0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])+0.4242640687119285*fR[14]-0.4242640687119285*fL[14]+1.060660171779821*fR[13]-1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])-1.060660171779821*fR[11]+1.060660171779821*fL[11]-1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6363961030678926*fR[6]-0.6363961030678926*fL[6]-0.8215838362577489*(fR[5]+fL[5])+0.8215838362577489*(fR[4]+fL[4])+0.4743416490252568*fR[3]-0.4743416490252568*(fL[3]+fR[2])+0.4743416490252568*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]+0.9486832980505122*(fR[24]+fL[24])-0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])-0.7348469228349525*fR[19]+0.7348469228349525*fL[19]+0.7348469228349533*fR[18]-0.7348469228349533*fL[18]-1.42302494707577*(fR[17]+fL[17])+0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]-0.4242640687119285*(fR[14]+fL[14])-1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]+1.060660171779821*(fR[11]+fL[11])+1.10227038425243*fR[10]-1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6363961030678926*(fR[6]+fL[6])+0.8215838362577489*fR[5]-0.8215838362577489*(fL[5]+fR[4])+0.8215838362577489*fL[4]-0.4743416490252568*(fR[3]+fL[3])+0.4743416490252568*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.5*alphaR[1]; 
  fUpOrd[3] = 0.5*(((-0.883883476483184*fR[24])+0.883883476483184*(fL[24]+fR[21])-0.883883476483184*fL[21]+0.6846531968814573*(fR[19]+fL[19])-0.3952847075210473*fR[16]+0.3952847075210473*fL[16]-0.6846531968814574*(fR[15]+fL[15])+0.7905694150420948*fR[11]-0.7905694150420948*fL[11]+0.3952847075210473*fR[9]-0.3952847075210473*fL[9]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6123724356957944*(fR[4]+fL[4])+0.3535533905932737*fR[2]-0.3535533905932737*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.883883476483184*(fR[24]+fL[24])-0.883883476483184*(fR[21]+fL[21])-0.6846531968814573*fR[19]+0.6846531968814573*fL[19]+0.3952847075210473*(fR[16]+fL[16])+0.6846531968814574*fR[15]-0.6846531968814574*fL[15]-0.7905694150420948*(fR[11]+fL[11])-0.3952847075210473*(fR[9]+fL[9])+0.7905694150420947*(fR[7]+fL[7])+0.6123724356957944*fR[4]-0.6123724356957944*fL[4]-0.3535533905932737*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]; 
  fUpOrd[4] = 0.5*(((-0.9882117688026183*fR[26])+0.9882117688026183*fL[26]+0.7654655446197428*(fR[25]+fL[25])-0.441941738241592*fR[22]+0.441941738241592*fL[22]+0.883883476483184*(fR[21]+fR[20])-0.883883476483184*(fL[21]+fL[20])-0.6846531968814574*(fR[15]+fL[15]+fR[12]+fL[12])+0.3952847075210473*(fR[9]+fR[8])-0.3952847075210473*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.9882117688026183*(fR[26]+fL[26])-0.7654655446197428*fR[25]+0.7654655446197428*fL[25]+0.441941738241592*(fR[22]+fL[22])-0.883883476483184*(fR[21]+fL[21]+fR[20]+fL[20])+0.6846531968814574*(fR[15]+fR[12])-0.6846531968814574*(fL[15]+fL[12])-0.3952847075210473*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*(alphaR[1]+alphaR[0]); 
  fUpOrd[5] = 0.5*((0.883883476483184*(fR[24]+fR[21])-0.883883476483184*(fL[24]+fL[21])-0.6846531968814573*(fR[19]+fL[19])+0.3952847075210473*fR[16]-0.3952847075210473*fL[16]-0.6846531968814574*(fR[15]+fL[15])-0.7905694150420948*fR[11]+0.7905694150420948*fL[11]+0.3952847075210473*fR[9]-0.3952847075210473*fL[9]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[4]+fL[4])-0.3535533905932737*fR[2]+0.3535533905932737*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)-0.883883476483184*(fR[24]+fL[24]+fR[21]+fL[21])+0.6846531968814573*fR[19]-0.6846531968814573*fL[19]-0.3952847075210473*(fR[16]+fL[16])+0.6846531968814574*fR[15]-0.6846531968814574*fL[15]+0.7905694150420948*(fR[11]+fL[11])-0.3952847075210473*(fR[9]+fL[9])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[4]+0.6123724356957944*fL[4]+0.3535533905932737*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.6708203932499369*alphaR[1]; 
  fUpOrd[6] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])+0.9486832980505122*fR[24]-0.9486832980505122*fL[24]-0.9486832980505137*fR[23]+0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])-0.7348469228349525*(fR[19]+fL[19])+0.7348469228349533*(fR[18]+fL[18])+1.42302494707577*fR[17]-1.42302494707577*fL[17]+0.4242640687119281*fR[16]-0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])-0.4242640687119285*fR[14]+0.4242640687119285*fL[14]-1.060660171779821*fR[13]+1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])+1.060660171779821*fR[11]-1.060660171779821*fL[11]-1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6363961030678926*fR[6]-0.6363961030678926*fL[6]+0.8215838362577489*(fR[5]+fL[5])-0.8215838362577489*(fR[4]+fL[4])-0.4743416490252568*fR[3]+0.4743416490252568*(fL[3]+fR[2])-0.4743416490252568*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]-0.9486832980505122*(fR[24]+fL[24])+0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])+0.7348469228349525*fR[19]-0.7348469228349525*fL[19]-0.7348469228349533*fR[18]+0.7348469228349533*fL[18]-1.42302494707577*(fR[17]+fL[17])-0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]+0.4242640687119285*(fR[14]+fL[14])+1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]-1.060660171779821*(fR[11]+fL[11])+1.10227038425243*fR[10]-1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6363961030678926*(fR[6]+fL[6])-0.8215838362577489*fR[5]+0.8215838362577489*(fL[5]+fR[4])-0.8215838362577489*fL[4]+0.4743416490252568*(fR[3]+fL[3])-0.4743416490252568*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]; 
  fUpOrd[7] = 0.5*((0.883883476483184*(fR[23]+fR[20])-0.883883476483184*(fL[23]+fL[20])-0.6846531968814573*(fR[18]+fL[18])+0.3952847075210473*fR[14]-0.3952847075210473*fL[14]-0.7905694150420948*fR[13]+0.7905694150420948*fL[13]-0.6846531968814574*(fR[12]+fL[12])+0.3952847075210473*fR[8]-0.3952847075210473*fL[8]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[5]+fL[5])-0.3535533905932737*fR[3]+0.3535533905932737*fL[3]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)-0.883883476483184*(fR[23]+fL[23]+fR[20]+fL[20])+0.6846531968814573*fR[18]-0.6846531968814573*fL[18]-0.3952847075210473*(fR[14]+fL[14])+0.7905694150420948*(fR[13]+fL[13])+0.6846531968814574*fR[12]-0.6846531968814574*fL[12]-0.3952847075210473*(fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[5]+0.6123724356957944*fL[5]+0.3535533905932737*(fR[3]+fL[3])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[8] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])-0.9486832980505122*fR[24]+0.9486832980505122*fL[24]-0.9486832980505137*fR[23]+0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])+0.7348469228349525*(fR[19]+fL[19])+0.7348469228349533*(fR[18]+fL[18])-1.42302494707577*fR[17]+1.42302494707577*fL[17]-0.4242640687119281*fR[16]+0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])-0.4242640687119285*fR[14]+0.4242640687119285*fL[14]-1.060660171779821*fR[13]+1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])-1.060660171779821*fR[11]+1.060660171779821*fL[11]+1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6363961030678926*fR[6]+0.6363961030678926*fL[6]+0.8215838362577489*(fR[5]+fL[5]+fR[4]+fL[4])-0.4743416490252568*(fR[3]+fR[2])+0.4743416490252568*(fL[3]+fL[2])+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]+0.9486832980505122*(fR[24]+fL[24])+0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])-0.7348469228349525*fR[19]+0.7348469228349525*fL[19]-0.7348469228349533*fR[18]+0.7348469228349533*fL[18]+1.42302494707577*(fR[17]+fL[17])+0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]+0.4242640687119285*(fR[14]+fL[14])+1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]+1.060660171779821*(fR[11]+fL[11])-1.10227038425243*fR[10]+1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6363961030678926*(fR[6]+fL[6])-0.8215838362577489*(fR[5]+fR[4])+0.8215838362577489*(fL[5]+fL[4])+0.4743416490252568*(fR[3]+fL[3]+fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 

  double fUp[9];
  fUp[0] = 0.006172839506172839*(25.0*fUpOrd[8]+72.0*fUpOrd[7]+25.0*fUpOrd[6]+8.0*(9.0*fUpOrd[5]-8.0*fUpOrd[4]+9.0*fUpOrd[3])+25.0*fUpOrd[2]+72.0*fUpOrd[1]+25.0*fUpOrd[0]); 
  fUp[1] = 0.01851851851851852*(11.18033988749895*(fUpOrd[8]-1.0*fUpOrd[6]+fUpOrd[2]-1.0*fUpOrd[0])+24.0*(fUpOrd[5]-1.0*fUpOrd[3])); 
  fUp[2] = 0.01851851851851852*(11.18033988749895*(fUpOrd[8]+fUpOrd[6]-1.0*(fUpOrd[2]+fUpOrd[0]))+24.0*(fUpOrd[7]-1.0*fUpOrd[1])); 
  fUp[3] = 0.2777777777777778*(fUpOrd[8]-1.0*(fUpOrd[6]+fUpOrd[2])+fUpOrd[0]); 
  fUp[4] = 0.00552115549999948*(5.0*(5.0*fUpOrd[8]-18.0*fUpOrd[7]+5.0*fUpOrd[6])+8.0*(9.0*fUpOrd[5]-8.0*fUpOrd[4]+9.0*fUpOrd[3])+5.0*(5.0*fUpOrd[2]-18.0*fUpOrd[1]+5.0*fUpOrd[0])); 
  fUp[5] = 0.00552115549999948*(25.0*fUpOrd[8]+72.0*fUpOrd[7]+25.0*fUpOrd[6]-2.0*(45.0*fUpOrd[5]+32.0*fUpOrd[4])+5.0*(5.0*fUpOrd[2]-18.0*fUpOrd[3])+72.0*fUpOrd[1]+25.0*fUpOrd[0]); 
  fUp[6] = 0.08281733249999224*(2.23606797749979*(fUpOrd[8]+fUpOrd[6]-1.0*(fUpOrd[2]+fUpOrd[0]))+6.0*(fUpOrd[1]-1.0*fUpOrd[7])); 
  fUp[7] = 0.08281733249999224*(2.23606797749979*(fUpOrd[8]-1.0*fUpOrd[6]+fUpOrd[2]-1.0*fUpOrd[0])+6.0*(fUpOrd[3]-1.0*fUpOrd[5])); 
  fUp[8] = 0.02469135802469136*(5.0*fUpOrd[8]-18.0*fUpOrd[7]+5.0*fUpOrd[6]+2.0*((-9.0*fUpOrd[5])+26.0*fUpOrd[4]-9.0*fUpOrd[3])+5.0*fUpOrd[2]-18.0*fUpOrd[1]+5.0*fUpOrd[0]); 

  incr[0] = 0.3535533905932737*(alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[1] = -0.6123724356957944*(alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[2] = 0.07071067811865474*(4.47213595499958*alphaR[1]*fUp[4]+5.0*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[3] = 0.3535533905932737*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2]); 
  incr[4] = -0.07071067811865474*(7.745966692414834*alphaR[1]*fUp[4]+8.660254037844386*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[5] = -0.6123724356957944*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2]); 
  incr[6] = 0.02357022603955158*(13.41640786499874*alphaR[1]*fUp[6]+15.0*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[7] = 0.7905694150420947*(alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[8] = 0.07071067811865474*(5.0*alphaR[0]*fUp[4]+4.47213595499958*alphaR[1]*fUp[1]); 
  incr[9] = 0.02357022603955158*(15.0*alphaR[1]*fUp[7]+15.0*alphaR[0]*fUp[5]); 
  incr[10] = -0.07071067811865474*(7.745966692414834*alphaR[1]*fUp[6]+8.660254037844386*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[11] = 0.09128709291752765*(7.745966692414834*alphaR[1]*fUp[4]+8.660254037844386*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[12] = -0.273861278752583*(2.23606797749979*alphaR[0]*fUp[4]+2.0*alphaR[1]*fUp[1]); 
  incr[13] = 0.7905694150420948*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2]); 
  incr[14] = 0.02357022603955158*(15.0*alphaR[0]*fUp[6]+13.41640786499874*alphaR[1]*fUp[3]); 
  incr[15] = -0.07071067811865474*(8.660254037844386*alphaR[1]*fUp[7]+8.660254037844387*alphaR[0]*fUp[5]); 
  incr[16] = 0.02357022603955158*(3.872983346207417*alphaR[1]*(3.464101615137754*fUp[8]+3.872983346207417*fUp[5])+15.0*alphaR[0]*fUp[7]); 
  incr[17] = 0.02357022603955158*(30.0*alphaR[1]*fUp[6]+33.54101966249685*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[18] = -0.07071067811865474*(8.660254037844387*alphaR[0]*fUp[6]+7.745966692414834*alphaR[1]*fUp[3]); 
  incr[19] = -0.07071067811865474*(7.745966692414834*alphaR[1]*fUp[8]+8.660254037844387*alphaR[0]*fUp[7]+8.660254037844386*alphaR[1]*fUp[5]); 
  incr[20] = 0.3535533905932737*(2.23606797749979*alphaR[0]*fUp[4]+2.0*alphaR[1]*fUp[1]); 
  incr[21] = 0.1178511301977579*(6.708203932499369*alphaR[1]*fUp[7]+6.708203932499369*alphaR[0]*fUp[5]); 
  incr[22] = 0.02357022603955158*(15.0*alphaR[0]*fUp[8]+13.41640786499874*alphaR[1]*fUp[7]); 
  incr[23] = 0.1178511301977579*(6.708203932499369*alphaR[0]*fUp[6]+6.0*alphaR[1]*fUp[3]); 
  incr[24] = 0.1178511301977579*(6.0*alphaR[1]*fUp[8]+6.708203932499369*alphaR[0]*fUp[7]+6.708203932499369*alphaR[1]*fUp[5]); 
  incr[25] = -0.07071067811865474*(8.660254037844386*alphaR[0]*fUp[8]+7.745966692414834*alphaR[1]*fUp[7]); 
  incr[26] = 0.02357022603955158*(33.54101966249685*alphaR[0]*fUp[8]+30.0*alphaR[1]*fUp[7]); 

#endif 
  outR[0] += incr[0]*rdx2R; 
  outR[1] += incr[1]*rdx2R; 
  outR[2] += incr[2]*rdx2R; 
  outR[3] += incr[3]*rdx2R; 
  outR[4] += incr[4]*rdx2R; 
  outR[5] += incr[5]*rdx2R; 
  outR[6] += incr[6]*rdx2R; 
  outR[7] += incr[7]*rdx2R; 
  outR[8] += incr[8]*rdx2R; 
  outR[9] += incr[9]*rdx2R; 
  outR[10] += incr[10]*rdx2R; 
  outR[11] += incr[11]*rdx2R; 
  outR[12] += incr[12]*rdx2R; 
  outR[13] += incr[13]*rdx2R; 
  outR[14] += incr[14]*rdx2R; 
  outR[15] += incr[15]*rdx2R; 
  outR[16] += incr[16]*rdx2R; 
  outR[17] += incr[17]*rdx2R; 
  outR[18] += incr[18]*rdx2R; 
  outR[19] += incr[19]*rdx2R; 
  outR[20] += incr[20]*rdx2R; 
  outR[21] += incr[21]*rdx2R; 
  outR[22] += incr[22]*rdx2R; 
  outR[23] += incr[23]*rdx2R; 
  outR[24] += incr[24]*rdx2R; 
  outR[25] += incr[25]*rdx2R; 
  outR[26] += incr[26]*rdx2R; 

  outL[0] += -1.0*incr[0]*rdx2L; 
  outL[1] += incr[1]*rdx2L; 
  outL[2] += -1.0*incr[2]*rdx2L; 
  outL[3] += -1.0*incr[3]*rdx2L; 
  outL[4] += incr[4]*rdx2L; 
  outL[5] += incr[5]*rdx2L; 
  outL[6] += -1.0*incr[6]*rdx2L; 
  outL[7] += -1.0*incr[7]*rdx2L; 
  outL[8] += -1.0*incr[8]*rdx2L; 
  outL[9] += -1.0*incr[9]*rdx2L; 
  outL[10] += incr[10]*rdx2L; 
  outL[11] += -1.0*incr[11]*rdx2L; 
  outL[12] += incr[12]*rdx2L; 
  outL[13] += -1.0*incr[13]*rdx2L; 
  outL[14] += -1.0*incr[14]*rdx2L; 
  outL[15] += incr[15]*rdx2L; 
  outL[16] += -1.0*incr[16]*rdx2L; 
  outL[17] += -1.0*incr[17]*rdx2L; 
  outL[18] += incr[18]*rdx2L; 
  outL[19] += incr[19]*rdx2L; 
  outL[20] += -1.0*incr[20]*rdx2L; 
  outL[21] += -1.0*incr[21]*rdx2L; 
  outL[22] += -1.0*incr[22]*rdx2L; 
  outL[23] += -1.0*incr[23]*rdx2L; 
  outL[24] += -1.0*incr[24]*rdx2L; 
  outL[25] += incr[25]*rdx2L; 
  outL[26] += -1.0*incr[26]*rdx2L; 

  return std::abs(alphaSurfAvgR); 
} 
double GyrokineticGenGeoSurf1x2vTensor_vpar_P2_Bvarsz(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *fL, const double *fR, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamilR[27]; 
  hamilR[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*(bmag[0]*wmuR+phi[0]*q_))+2.0*m_))/rdvpar2SqR; 
  hamilR[1] = 2.0*phi[1]*q_; 
  hamilR[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamilR[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamilR[7] = 2.0*phi[2]*q_; 
  hamilR[8] = (0.421637021355784*m_)/rdvpar2SqR; 

  double BstarZdBmagR[27]; 
  BstarZdBmagR[0] = 1.414213562373095*cmag[0]*jacobTotInv[0]; 

  double alphaR[9]; 
  alphaR[0] = -(0.4330127018922193*BstarZdBmagR[0]*hamilR[1]*rdx2R)/m_; 
  alphaR[1] = -(0.9682458365518543*BstarZdBmagR[0]*hamilR[7]*rdx2R)/m_; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = -(0.1082531754730548*BstarZdBmagR[0]*hamilR[1]*rdx2R)/m_; 

  double incr[27]; 
  double amax = amax_in; 

  double fAvg[9]; 
  fAvg[0] = 0.7071067811865475*(2.23606797749979*(fR[8]+fL[8])+1.732050807568877*(fL[2]-1.0*fR[2])+fR[0]+fL[0]); 
  fAvg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fR[12]+fL[12])+3.0*(fL[4]-1.0*fR[4]))+3.0*(fR[1]+fL[1])); 
  fAvg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fR[14]+fL[14])+3.0*(fL[6]-1.0*fR[6]))+3.0*(fR[3]+fL[3])); 
  fAvg[3] = 0.7071067811865475*(2.23606797749979*(fR[18]+fL[18])+1.732050807568877*(fL[10]-1.0*fR[10])+fR[5]+fL[5]); 
  fAvg[4] = 0.1414213562373095*(2.23606797749979*(5.0*(fR[20]+fL[20])-3.872983346207417*(fR[11]-1.0*fL[11]))+5.0*(fR[7]+fL[7])); 
  fAvg[5] = 0.1414213562373095*(2.23606797749979*(5.0*(fR[22]+fL[22])-3.872983346207417*(fR[16]-1.0*fL[16]))+5.0*(fR[9]+fL[9])); 
  fAvg[6] = -0.04714045207910316*(3.872983346207417*(6.708203932499369*(fR[17]-1.0*fL[17])-8.660254037844386*(fR[23]+fL[23]))-15.0*(fR[13]+fL[13])); 
  fAvg[7] = -0.04714045207910316*(3.872983346207417*(6.708203932499369*(fR[19]-1.0*fL[19])-8.660254037844386*(fR[25]+fL[25]))-15.0*(fR[15]+fL[15])); 
  fAvg[8] = 0.7071067811865475*(2.23606797749979*(fR[26]+fL[26])+1.732050807568877*(fL[24]-1.0*fR[24])+fR[21]+fL[21]); 

  double Ghat[9]; 
  Ghat[0] = -0.1767766952966368*((2.23606797749979*(2.0*fR[8]-2.0*fL[8])-3.464101615137754*(fR[2]+fL[2])+2.0*fR[0]-2.0*fL[0])*amax-1.414213562373095*(alphaR[1]*fAvg[1]+alphaR[0]*fAvg[0])); 
  Ghat[1] = -0.01178511301977579*((6.708203932499369*(10.0*fR[12]-10.0*fL[12])-51.96152422706631*(fR[4]+fL[4])+30.0*fR[1]-30.0*fL[1])*amax-18.97366596101028*alphaR[1]*fAvg[4]-21.21320343559643*(alphaR[0]*fAvg[1]+fAvg[0]*alphaR[1])); 
  Ghat[2] = -0.05892556509887893*((6.708203932499369*(2.0*fR[14]-2.0*fL[14])-10.39230484541326*(fR[6]+fL[6])+6.0*fR[3]-6.0*fL[3])*amax-4.242640687119286*(alphaR[1]*fAvg[3]+alphaR[0]*fAvg[2])); 
  Ghat[3] = 0.01178511301977579*((2.23606797749979*(30.0*fL[18]-30.0*fR[18])+51.96152422706631*(fR[10]+fL[10])-30.0*fR[5]+30.0*fL[5])*amax+18.97366596101028*alphaR[1]*fAvg[6]+21.21320343559643*(alphaR[0]*fAvg[3]+alphaR[1]*fAvg[2])); 
  Ghat[4] = 0.03535533905932736*(2.23606797749979*((10.0*fL[20]-10.0*fR[20])*amax+2.828427124746191*alphaR[1]*fAvg[1])+(17.32050807568877*(fR[11]+fL[11])-10.0*fR[7]+10.0*fL[7])*amax+7.071067811865476*alphaR[0]*fAvg[4]); 
  Ghat[5] = 0.01178511301977579*(8.660254037844387*(6.0*(fR[16]+fL[16])*amax+2.449489742783178*alphaR[1]*fAvg[7])+(2.23606797749979*(30.0*fL[22]-30.0*fR[22])-30.0*fR[9]+30.0*fL[9])*amax+21.21320343559643*alphaR[0]*fAvg[5]); 
  Ghat[6] = 0.01178511301977579*(3.872983346207417*(1.732050807568877*((10.0*fL[23]-10.0*fR[23])*amax+2.828427124746191*alphaR[1]*fAvg[3])+13.41640786499874*(fR[17]+fL[17])*amax)+(30.0*fL[13]-30.0*fR[13])*amax+21.21320343559643*alphaR[0]*fAvg[6]); 
  Ghat[7] = 0.01178511301977579*(3.872983346207417*(1.732050807568877*((10.0*fL[25]-10.0*fR[25])*amax+2.828427124746191*alphaR[1]*fAvg[8])+2.23606797749979*(6.0*(fR[19]+fL[19])*amax+2.449489742783178*alphaR[1]*fAvg[5]))+(30.0*fL[15]-30.0*fR[15])*amax+21.21320343559643*alphaR[0]*fAvg[7]); 
  Ghat[8] = 0.01178511301977579*((2.23606797749979*(30.0*fL[26]-30.0*fR[26])+51.96152422706631*(fR[24]+fL[24])-30.0*fR[21]+30.0*fL[21])*amax+21.21320343559643*alphaR[0]*fAvg[8]+18.97366596101028*alphaR[1]*fAvg[7]); 

  incr[0] = 0.7071067811865475*Ghat[0]; 
  incr[1] = 0.7071067811865475*Ghat[1]; 
  incr[2] = -1.224744871391589*Ghat[0]; 
  incr[3] = 0.7071067811865475*Ghat[2]; 
  incr[4] = -1.224744871391589*Ghat[1]; 
  incr[5] = 0.7071067811865475*Ghat[3]; 
  incr[6] = -1.224744871391589*Ghat[2]; 
  incr[7] = 0.7071067811865475*Ghat[4]; 
  incr[8] = 1.58113883008419*Ghat[0]; 
  incr[9] = 0.7071067811865475*Ghat[5]; 
  incr[10] = -1.224744871391589*Ghat[3]; 
  incr[11] = -1.224744871391589*Ghat[4]; 
  incr[12] = 1.58113883008419*Ghat[1]; 
  incr[13] = 0.7071067811865475*Ghat[6]; 
  incr[14] = 1.58113883008419*Ghat[2]; 
  incr[15] = 0.7071067811865475*Ghat[7]; 
  incr[16] = -1.224744871391589*Ghat[5]; 
  incr[17] = -1.224744871391589*Ghat[6]; 
  incr[18] = 1.58113883008419*Ghat[3]; 
  incr[19] = -1.224744871391589*Ghat[7]; 
  incr[20] = 1.58113883008419*Ghat[4]; 
  incr[21] = 0.7071067811865475*Ghat[8]; 
  incr[22] = 1.58113883008419*Ghat[5]; 
  incr[23] = 1.58113883008419*Ghat[6]; 
  incr[24] = -1.224744871391589*Ghat[8]; 
  incr[25] = 1.58113883008419*Ghat[7]; 
  incr[26] = 1.58113883008419*Ghat[8]; 

  outR[0] += incr[0]*rdvpar2R; 
  outR[1] += incr[1]*rdvpar2R; 
  outR[2] += incr[2]*rdvpar2R; 
  outR[3] += incr[3]*rdvpar2R; 
  outR[4] += incr[4]*rdvpar2R; 
  outR[5] += incr[5]*rdvpar2R; 
  outR[6] += incr[6]*rdvpar2R; 
  outR[7] += incr[7]*rdvpar2R; 
  outR[8] += incr[8]*rdvpar2R; 
  outR[9] += incr[9]*rdvpar2R; 
  outR[10] += incr[10]*rdvpar2R; 
  outR[11] += incr[11]*rdvpar2R; 
  outR[12] += incr[12]*rdvpar2R; 
  outR[13] += incr[13]*rdvpar2R; 
  outR[14] += incr[14]*rdvpar2R; 
  outR[15] += incr[15]*rdvpar2R; 
  outR[16] += incr[16]*rdvpar2R; 
  outR[17] += incr[17]*rdvpar2R; 
  outR[18] += incr[18]*rdvpar2R; 
  outR[19] += incr[19]*rdvpar2R; 
  outR[20] += incr[20]*rdvpar2R; 
  outR[21] += incr[21]*rdvpar2R; 
  outR[22] += incr[22]*rdvpar2R; 
  outR[23] += incr[23]*rdvpar2R; 
  outR[24] += incr[24]*rdvpar2R; 
  outR[25] += incr[25]*rdvpar2R; 
  outR[26] += incr[26]*rdvpar2R; 

  outL[0] += -1.0*incr[0]*rdvpar2L; 
  outL[1] += -1.0*incr[1]*rdvpar2L; 
  outL[2] += incr[2]*rdvpar2L; 
  outL[3] += -1.0*incr[3]*rdvpar2L; 
  outL[4] += incr[4]*rdvpar2L; 
  outL[5] += -1.0*incr[5]*rdvpar2L; 
  outL[6] += incr[6]*rdvpar2L; 
  outL[7] += -1.0*incr[7]*rdvpar2L; 
  outL[8] += -1.0*incr[8]*rdvpar2L; 
  outL[9] += -1.0*incr[9]*rdvpar2L; 
  outL[10] += incr[10]*rdvpar2L; 
  outL[11] += incr[11]*rdvpar2L; 
  outL[12] += -1.0*incr[12]*rdvpar2L; 
  outL[13] += -1.0*incr[13]*rdvpar2L; 
  outL[14] += -1.0*incr[14]*rdvpar2L; 
  outL[15] += -1.0*incr[15]*rdvpar2L; 
  outL[16] += incr[16]*rdvpar2L; 
  outL[17] += incr[17]*rdvpar2L; 
  outL[18] += -1.0*incr[18]*rdvpar2L; 
  outL[19] += incr[19]*rdvpar2L; 
  outL[20] += -1.0*incr[20]*rdvpar2L; 
  outL[21] += -1.0*incr[21]*rdvpar2L; 
  outL[22] += -1.0*incr[22]*rdvpar2L; 
  outL[23] += -1.0*incr[23]*rdvpar2L; 
  outL[24] += incr[24]*rdvpar2L; 
  outL[25] += -1.0*incr[25]*rdvpar2L; 
  outL[26] += -1.0*incr[26]*rdvpar2L; 
return std::abs(alphaSurfAvgR); 
} 
double GyrokineticGenGeoSurf1x2vTensor_x_P2_Bvarsxz(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *fL, const double *fR, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamilR[27]; 
  hamilR[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*(bmag[0]*wmuR+phi[0]*q_))+2.0*m_))/rdvpar2SqR; 
  hamilR[1] = 2.0*(bmag[1]*wmuR+phi[1]*q_); 
  hamilR[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamilR[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamilR[5] = (1.154700538379252*bmag[1])/rdmu2R; 
  hamilR[7] = 2.0*(bmag[2]*wmuR+phi[2]*q_); 
  hamilR[8] = (0.421637021355784*m_)/rdvpar2SqR; 
  hamilR[13] = (1.154700538379251*bmag[2])/rdmu2R; 

  double BstarZdBmagR[27]; 
  BstarZdBmagR[0] = (1.414213562373095*(1.732050807568877*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R*wvparR+(cmag[2]*jacobTotInv[2]+cmag[1]*jacobTotInv[1]+cmag[0]*jacobTotInv[0])*q_))/q_; 
  BstarZdBmagR[1] = (0.2828427124746191*(5.0*(1.732050807568877*(2.0*b_y[2]*jacobTotInv[2]+b_y[1]*jacobTotInv[1])*m_*rdx2R*wvparR+(cmag[0]*jacobTotInv[1]+jacobTotInv[0]*cmag[1])*q_)+2.23606797749979*(8.660254037844386*jacobTotInv[0]*b_y[2]*m_*rdx2R*wvparR+2.0*(cmag[1]*jacobTotInv[2]+jacobTotInv[1]*cmag[2])*q_)))/q_; 
  BstarZdBmagR[2] = (1.414213562373095*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[4] = (1.414213562373095*(b_y[2]*(2.0*jacobTotInv[2]+2.23606797749979*jacobTotInv[0])+b_y[1]*jacobTotInv[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[7] = (0.04040610178208843*(60.6217782649107*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R*wvparR+(4.47213595499958*(5.0*cmag[2]*jacobTotInv[2]+7.0*cmag[1]*jacobTotInv[1])+35.0*(cmag[0]*jacobTotInv[2]+jacobTotInv[0]*cmag[2]))*q_))/q_; 
  BstarZdBmagR[11] = (1.414213562373095*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R)/(q_*rdvpar2R); 

  double alphaR[9]; 
  alphaR[0] = (0.25*(8.660254037844387*hamilR[8]*BstarZdBmagR[11]+2.23606797749979*(1.732050807568877*(BstarZdBmagR[2]*hamilR[8]+hamilR[2]*BstarZdBmagR[7])-3.0*BstarZdBmagR[4]*hamilR[8])+(1.732050807568877*BstarZdBmagR[0]-3.0*BstarZdBmagR[1])*hamilR[2])*rdvpar2R)/m_; 
  alphaR[1] = (0.25*(3.872983346207417*hamilR[2]*BstarZdBmagR[11]+1.732050807568877*(5.0*BstarZdBmagR[7]*hamilR[8]+BstarZdBmagR[2]*hamilR[2])+2.23606797749979*(1.732050807568877*BstarZdBmagR[0]-3.0*BstarZdBmagR[1])*hamilR[8]-3.0*hamilR[2]*BstarZdBmagR[4])*rdvpar2R)/m_; 
  alphaR[4] = (0.5*hamilR[8]*(3.872983346207417*BstarZdBmagR[11]-3.0*BstarZdBmagR[4]+1.732050807568877*BstarZdBmagR[2])*rdvpar2R)/m_; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = (0.0625*(2.23606797749979*(1.732050807568877*(BstarZdBmagR[2]*hamilR[8]+hamilR[2]*BstarZdBmagR[7])*rdvpar2R-3.0*BstarZdBmagR[4]*hamilR[8]*rdvpar2R)+8.660254037844387*hamilR[8]*BstarZdBmagR[11]*rdvpar2R-3.0*BstarZdBmagR[1]*hamilR[2]*rdvpar2R+1.732050807568877*BstarZdBmagR[0]*hamilR[2]*rdvpar2R))/m_; 

  double incr[27]; 
#if upwindType == SURFAVG 
  if (alphaSurfAvgR>0) { 
  incr[0] = 0.01666666666666667*(33.54101966249685*(alphaR[4]*fL[20]+alphaR[0]*fL[7])+3.872983346207417*(6.708203932499369*alphaR[4]*fL[12]+8.660254037844386*alphaR[1]*fL[11])+15.0*alphaR[4]*fL[8]+25.98076211353316*(alphaR[1]*fL[4]+alphaR[0]*fL[1])+15.0*(alphaR[1]*fL[2]+alphaR[0]*fL[0])); 
  incr[1] = -0.05*(19.36491673103708*(alphaR[4]*fL[20]+alphaR[0]*fL[7])+3.872983346207417*(3.872983346207417*alphaR[4]*fL[12]+5.0*alphaR[1]*fL[11])+8.660254037844386*(alphaR[4]*fL[8]+alphaR[1]*fL[2]+alphaR[0]*fL[0])+15.0*(alphaR[1]*fL[4]+alphaR[0]*fL[1])); 
  incr[2] = 0.01666666666666667*(30.0*alphaR[1]*fL[20]+3.872983346207417*(6.0*alphaR[1]*fL[12]+(7.745966692414834*alphaR[4]+8.660254037844386*alphaR[0])*fL[11])+2.23606797749979*(alphaR[1]*(6.0*fL[8]+15.0*fL[7])+alphaR[4]*(10.39230484541326*fL[4]+6.0*fL[2]))+25.98076211353316*(alphaR[0]*fL[4]+alphaR[1]*fL[1])+15.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1])); 
  incr[3] = 0.01666666666666667*(33.54101966249685*(alphaR[4]*fL[23]+alphaR[1]*fL[17])+25.98076211353316*(alphaR[4]*fL[18]+alphaR[1]*fL[10]+alphaR[0]*fL[5])+3.872983346207417*(3.872983346207417*alphaR[4]*fL[14]+8.660254037844386*alphaR[0]*fL[13])+15.0*(alphaR[1]*fL[6]+alphaR[0]*fL[3])); 
  incr[4] = -0.05*(1.732050807568877*(10.0*alphaR[1]*fL[20]+5.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1]))+3.872983346207417*(3.464101615137754*alphaR[1]*fL[12]+(4.47213595499958*alphaR[4]+5.0*alphaR[0])*fL[11])+2.23606797749979*(1.732050807568877*(alphaR[1]*(2.0*fL[8]+5.0*fL[7])+2.0*fL[2]*alphaR[4])+6.0*alphaR[4]*fL[4])+15.0*(alphaR[0]*fL[4]+alphaR[1]*fL[1])); 
  incr[5] = -0.05*(19.36491673103708*(alphaR[4]*fL[23]+alphaR[1]*fL[17])+15.0*alphaR[4]*fL[18]+3.872983346207417*(2.23606797749979*alphaR[4]*fL[14]+5.0*alphaR[0]*fL[13])+15.0*alphaR[1]*fL[10]+8.660254037844386*(alphaR[1]*fL[6]+alphaR[0]*fL[3])+15.0*alphaR[0]*fL[5]); 
  incr[6] = 0.01666666666666667*(30.0*alphaR[1]*fL[23]+2.23606797749979*(10.39230484541326*(alphaR[1]*fL[18]+alphaR[4]*fL[10])+15.0*alphaR[0]*fL[17]+6.0*alphaR[4]*fL[6])+30.0*alphaR[4]*fL[17]+6.708203932499369*alphaR[1]*(2.0*fL[14]+5.0*fL[13])+25.98076211353316*(alphaR[0]*fL[10]+alphaR[1]*fL[5])+15.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3])); 
  incr[7] = 0.08333333333333333*(15.0*alphaR[4]*fL[20]+3.872983346207417*(3.0*alphaR[4]*fL[12]+3.872983346207417*alphaR[1]*fL[11])+2.23606797749979*(3.0*alphaR[4]*fL[8]+5.196152422706632*(alphaR[1]*fL[4]+alphaR[0]*fL[1])+3.0*(alphaR[1]*fL[2]+alphaR[0]*fL[0]))+15.0*alphaR[0]*fL[7]); 
  incr[8] = 0.002380952380952381*(2.23606797749979*(105.0*alphaR[0]*fL[20]+alphaR[4]*(30.0*fL[8]+105.0*fL[7])+alphaR[1]*(72.74613391789283*fL[4]+42.0*fL[2]))+150.0*alphaR[4]*fL[20]+3.872983346207417*(2.23606797749979*(21.0*alphaR[0]*fL[12]+24.24871130596428*alphaR[1]*fL[11])+30.0*alphaR[4]*fL[12])+105.0*alphaR[0]*fL[8]+(181.8653347947321*fL[1]+105.0*fL[0])*alphaR[4]); 
  incr[9] = 0.01666666666666667*(33.54101966249685*(alphaR[4]*fL[26]+alphaR[1]*fL[24]+alphaR[0]*fL[21])+25.98076211353316*(alphaR[4]*fL[25]+alphaR[1]*fL[19])+15.0*alphaR[4]*fL[22]+8.660254037844387*(1.732050807568877*alphaR[1]*fL[16]+3.0*alphaR[0]*fL[15])+15.0*alphaR[0]*fL[9]); 
  incr[10] = -0.05*(1.732050807568877*(10.0*(alphaR[1]*fL[23]+alphaR[4]*fL[17])+5.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3]))+2.23606797749979*(6.0*alphaR[1]*fL[18]+1.732050807568877*(5.0*alphaR[0]*fL[17]+2.0*alphaR[4]*fL[6])+6.0*alphaR[4]*fL[10])+3.872983346207417*alphaR[1]*(2.0*fL[14]+5.0*fL[13])+15.0*(alphaR[0]*fL[10]+alphaR[1]*fL[5])); 
  incr[11] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(10.0*alphaR[1]*fL[20]+5.0*(alphaR[0]*fL[2]+fL[0]*alphaR[1]))+2.23606797749979*(1.732050807568877*(alphaR[1]*(2.0*fL[8]+5.0*fL[7])+2.0*fL[2]*alphaR[4])+6.0*alphaR[4]*fL[4])+15.0*(alphaR[0]*fL[4]+alphaR[1]*fL[1]))+51.96152422706631*alphaR[1]*fL[12]+(67.0820393249937*alphaR[4]+75.0*alphaR[0])*fL[11]); 
  incr[12] = -0.007142857142857143*(3.872983346207417*(2.23606797749979*(10.0*alphaR[4]*fL[20]+7.0*alphaR[0]*fL[8]+(12.12435565298214*fL[1]+7.0*fL[0])*alphaR[4])+35.0*alphaR[0]*fL[20]+alphaR[4]*(10.0*fL[8]+35.0*fL[7])+alphaR[1]*(24.24871130596428*fL[4]+14.0*fL[2]))+(67.0820393249937*alphaR[4]+105.0*alphaR[0])*fL[12]+121.2435565298214*alphaR[1]*fL[11]); 
  incr[13] = 0.08333333333333333*(3.872983346207417*(3.872983346207417*(alphaR[4]*fL[23]+alphaR[1]*fL[17])+3.0*(alphaR[4]*fL[18]+alphaR[1]*fL[10])+1.732050807568877*(alphaR[1]*fL[6]+alphaR[0]*fL[3])+3.0*alphaR[0]*fL[5])+6.708203932499369*alphaR[4]*fL[14]+15.0*alphaR[0]*fL[13]); 
  incr[14] = 0.002380952380952381*(3.872983346207417*(2.23606797749979*(1.732050807568877*(10.0*alphaR[4]*fL[23]+14.0*alphaR[1]*fL[17]+7.0*fL[3]*alphaR[4])+21.0*(alphaR[0]*fL[18]+alphaR[4]*fL[5]))+1.732050807568877*(35.0*alphaR[0]*fL[23]+14.0*alphaR[1]*fL[6])+30.0*alphaR[4]*fL[18]+42.0*alphaR[1]*fL[10])+2.23606797749979*alphaR[4]*(30.0*fL[14]+105.0*fL[13])+105.0*alphaR[0]*fL[14]); 
  incr[15] = -0.05*(3.872983346207417*(5.0*alphaR[4]*fL[26]+2.23606797749979*(1.732050807568877*(alphaR[4]*fL[25]+alphaR[1]*fL[19])+alphaR[4]*fL[22]+alphaR[0]*fL[9])+5.0*(alphaR[1]*fL[24]+alphaR[0]*fL[21]))+8.660254037844386*alphaR[1]*fL[16]+15.0*alphaR[0]*fL[15]); 
  incr[16] = 0.01666666666666667*(3.872983346207417*(2.23606797749979*(1.732050807568877*(2.0*(alphaR[1]*fL[26]+alphaR[4]*fL[24])+alphaR[1]*fL[9])+3.0*alphaR[0]*fL[19])+6.0*alphaR[1]*fL[25]+1.732050807568877*(5.0*alphaR[0]*fL[24]+alphaR[1]*(2.0*fL[22]+5.0*fL[21]))+6.0*alphaR[4]*fL[19])+(13.41640786499874*alphaR[4]+15.0*alphaR[0])*fL[16]+25.98076211353316*alphaR[1]*fL[15]); 
  incr[17] = 0.01666666666666667*(2.23606797749979*(30.0*(alphaR[1]*fL[23]+alphaR[4]*fL[17])+25.98076211353316*(alphaR[0]*fL[10]+alphaR[1]*fL[5])+15.0*(alphaR[0]*fL[6]+alphaR[1]*fL[3]))+51.96152422706631*(alphaR[1]*fL[18]+alphaR[4]*fL[10])+75.0*alphaR[0]*fL[17]+15.0*alphaR[1]*(2.0*fL[14]+5.0*fL[13])+30.0*alphaR[4]*fL[6]); 
  incr[18] = -0.007142857142857143*(2.23606797749979*(1.732050807568877*(35.0*alphaR[0]*fL[23]+14.0*alphaR[1]*fL[6])+30.0*alphaR[4]*fL[18]+42.0*alphaR[1]*fL[10])+1.732050807568877*(50.0*alphaR[4]*fL[23]+70.0*alphaR[1]*fL[17]+35.0*fL[3]*alphaR[4])+105.0*alphaR[0]*fL[18]+3.872983346207417*((10.0*alphaR[4]+15.65247584249853*alphaR[0])*fL[14]+35.0*alphaR[4]*fL[13])+105.0*alphaR[4]*fL[5]); 
  incr[19] = -0.05*(1.732050807568877*(10.0*(alphaR[1]*fL[26]+alphaR[4]*fL[24])+5.0*alphaR[1]*fL[9])+2.23606797749979*(6.0*alphaR[1]*fL[25]+1.732050807568877*(5.0*alphaR[0]*fL[24]+alphaR[1]*(2.0*fL[22]+5.0*fL[21]))+6.0*alphaR[4]*fL[19])+15.0*alphaR[0]*fL[19]+3.872983346207417*(2.23606797749979*(alphaR[0]*fL[16]+1.732050807568877*alphaR[1]*fL[15])+2.0*alphaR[4]*fL[16])); 
  incr[20] = 0.0119047619047619*(2.23606797749979*(30.0*alphaR[4]*fL[20]+21.0*alphaR[0]*fL[8]+(36.37306695894642*fL[1]+21.0*fL[0])*alphaR[4])+105.0*alphaR[0]*fL[20]+3.872983346207417*((13.41640786499874*alphaR[4]+21.0*alphaR[0])*fL[12]+24.24871130596428*alphaR[1]*fL[11])+alphaR[4]*(30.0*fL[8]+105.0*fL[7])+alphaR[1]*(72.74613391789283*fL[4]+42.0*fL[2])); 
  incr[21] = 0.08333333333333333*(15.0*alphaR[4]*fL[26]+2.23606797749979*(5.196152422706632*(alphaR[4]*fL[25]+alphaR[1]*fL[19])+3.0*(alphaR[4]*fL[22]+alphaR[0]*fL[9]))+15.0*(alphaR[1]*fL[24]+alphaR[0]*fL[21])+3.872983346207417*(1.732050807568877*alphaR[1]*fL[16]+3.0*alphaR[0]*fL[15])); 
  incr[22] = 0.002380952380952381*(2.23606797749979*(105.0*alphaR[0]*fL[26]+1.732050807568877*(30.0*alphaR[4]*fL[25]+42.0*alphaR[1]*fL[19])+alphaR[4]*(30.0*fL[22]+105.0*fL[21]))+150.0*alphaR[4]*fL[26]+181.8653347947321*alphaR[0]*fL[25]+210.0*alphaR[1]*fL[24]+105.0*alphaR[0]*fL[22]+3.872983346207417*(24.24871130596428*alphaR[1]*fL[16]+46.95742752749558*alphaR[4]*fL[15])+105.0*alphaR[4]*fL[9]); 
  incr[23] = 0.0119047619047619*(2.23606797749979*(30.0*alphaR[4]*fL[23]+36.37306695894642*(alphaR[0]*fL[18]+alphaR[4]*fL[5])+42.0*alphaR[1]*fL[17]+21.0*fL[3]*alphaR[4])+105.0*alphaR[0]*fL[23]+1.732050807568877*(30.0*alphaR[4]*fL[18]+42.0*alphaR[1]*fL[10])+3.872983346207417*(3.872983346207417*alphaR[4]*(2.0*fL[14]+7.0*fL[13])+12.12435565298214*alphaR[0]*fL[14])+42.0*alphaR[1]*fL[6]); 
  incr[24] = 0.01666666666666667*(2.23606797749979*(30.0*(alphaR[1]*fL[26]+alphaR[4]*fL[24])+25.98076211353316*alphaR[0]*fL[19]+15.0*alphaR[1]*fL[9])+51.96152422706631*(alphaR[1]*fL[25]+alphaR[4]*fL[19])+75.0*alphaR[0]*fL[24]+alphaR[1]*(30.0*fL[22]+75.0*fL[21])+3.872983346207417*((7.745966692414834*alphaR[4]+8.660254037844386*alphaR[0])*fL[16]+15.0*alphaR[1]*fL[15])); 
  incr[25] = -0.007142857142857143*(2.23606797749979*(1.732050807568877*(35.0*alphaR[0]*fL[26]+alphaR[4]*(10.0*fL[22]+35.0*fL[21]))+30.0*alphaR[4]*fL[25]+42.0*alphaR[1]*fL[19])+1.732050807568877*(50.0*alphaR[4]*fL[26]+70.0*alphaR[1]*fL[24]+35.0*(alphaR[0]*fL[22]+alphaR[4]*fL[9]))+105.0*alphaR[0]*fL[25]+3.872983346207417*(14.0*alphaR[1]*fL[16]+27.11088342345192*alphaR[4]*fL[15])); 
  incr[26] = 0.002380952380952381*(2.23606797749979*(150.0*alphaR[4]*fL[26]+181.8653347947321*alphaR[0]*fL[25]+210.0*alphaR[1]*fL[24]+105.0*(alphaR[0]*fL[22]+alphaR[4]*fL[9]))+525.0*alphaR[0]*fL[26]+1.732050807568877*(150.0*alphaR[4]*fL[25]+210.0*alphaR[1]*fL[19])+alphaR[4]*(150.0*fL[22]+525.0*fL[21])+3.872983346207417*(54.22176684690384*alphaR[1]*fL[16]+105.0*alphaR[4]*fL[15])); 
  } else { 
  incr[0] = -0.01666666666666667*((-33.54101966249685*(alphaR[4]*fR[20]+alphaR[0]*fR[7]))+3.872983346207417*(6.708203932499369*alphaR[4]*fR[12]-8.660254037844386*alphaR[1]*fR[11])-15.0*alphaR[4]*fR[8]+25.98076211353316*(alphaR[1]*fR[4]+alphaR[0]*fR[1])-15.0*(alphaR[1]*fR[2]+alphaR[0]*fR[0])); 
  incr[1] = 0.05*((-19.36491673103708*(alphaR[4]*fR[20]+alphaR[0]*fR[7]))+3.872983346207417*(3.872983346207417*alphaR[4]*fR[12]-5.0*alphaR[1]*fR[11])-8.660254037844386*(alphaR[4]*fR[8]+alphaR[1]*fR[2]+alphaR[0]*fR[0])+15.0*(alphaR[1]*fR[4]+alphaR[0]*fR[1])); 
  incr[2] = 0.01666666666666667*(30.0*alphaR[1]*fR[20]+3.872983346207417*((7.745966692414834*alphaR[4]+8.660254037844386*alphaR[0])*fR[11]-6.0*alphaR[1]*fR[12])+2.23606797749979*(alphaR[1]*(6.0*fR[8]+15.0*fR[7])+alphaR[4]*(6.0*fR[2]-10.39230484541326*fR[4]))-25.98076211353316*(alphaR[0]*fR[4]+alphaR[1]*fR[1])+15.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1])); 
  incr[3] = 0.01666666666666667*(33.54101966249685*(alphaR[4]*fR[23]+alphaR[1]*fR[17])-25.98076211353316*(alphaR[4]*fR[18]+alphaR[1]*fR[10]+alphaR[0]*fR[5])+3.872983346207417*(3.872983346207417*alphaR[4]*fR[14]+8.660254037844386*alphaR[0]*fR[13])+15.0*(alphaR[1]*fR[6]+alphaR[0]*fR[3])); 
  incr[4] = -0.05*(1.732050807568877*(10.0*alphaR[1]*fR[20]+5.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1]))+3.872983346207417*((4.47213595499958*alphaR[4]+5.0*alphaR[0])*fR[11]-3.464101615137754*alphaR[1]*fR[12])+2.23606797749979*(1.732050807568877*(alphaR[1]*(2.0*fR[8]+5.0*fR[7])+2.0*fR[2]*alphaR[4])-6.0*alphaR[4]*fR[4])-15.0*(alphaR[0]*fR[4]+alphaR[1]*fR[1])); 
  incr[5] = -0.05*(19.36491673103708*(alphaR[4]*fR[23]+alphaR[1]*fR[17])-15.0*alphaR[4]*fR[18]+3.872983346207417*(2.23606797749979*alphaR[4]*fR[14]+5.0*alphaR[0]*fR[13])-15.0*alphaR[1]*fR[10]+8.660254037844386*(alphaR[1]*fR[6]+alphaR[0]*fR[3])-15.0*alphaR[0]*fR[5]); 
  incr[6] = 0.01666666666666667*(30.0*alphaR[1]*fR[23]+2.23606797749979*((-10.39230484541326*(alphaR[1]*fR[18]+alphaR[4]*fR[10]))+15.0*alphaR[0]*fR[17]+6.0*alphaR[4]*fR[6])+30.0*alphaR[4]*fR[17]+6.708203932499369*alphaR[1]*(2.0*fR[14]+5.0*fR[13])-25.98076211353316*(alphaR[0]*fR[10]+alphaR[1]*fR[5])+15.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3])); 
  incr[7] = 0.08333333333333333*(15.0*alphaR[4]*fR[20]+3.872983346207417*(3.872983346207417*alphaR[1]*fR[11]-3.0*alphaR[4]*fR[12])+2.23606797749979*(3.0*alphaR[4]*fR[8]-5.196152422706632*(alphaR[1]*fR[4]+alphaR[0]*fR[1])+3.0*(alphaR[1]*fR[2]+alphaR[0]*fR[0]))+15.0*alphaR[0]*fR[7]); 
  incr[8] = 0.002380952380952381*(2.23606797749979*(105.0*alphaR[0]*fR[20]+alphaR[4]*(30.0*fR[8]+105.0*fR[7])+alphaR[1]*(42.0*fR[2]-72.74613391789283*fR[4]))+150.0*alphaR[4]*fR[20]+3.872983346207417*(2.23606797749979*(24.24871130596428*alphaR[1]*fR[11]-21.0*alphaR[0]*fR[12])-30.0*alphaR[4]*fR[12])+105.0*alphaR[0]*fR[8]+(105.0*fR[0]-181.8653347947321*fR[1])*alphaR[4]); 
  incr[9] = 0.01666666666666667*(33.54101966249685*(alphaR[4]*fR[26]+alphaR[1]*fR[24]+alphaR[0]*fR[21])-25.98076211353316*(alphaR[4]*fR[25]+alphaR[1]*fR[19])+15.0*alphaR[4]*fR[22]+8.660254037844387*(1.732050807568877*alphaR[1]*fR[16]-3.0*alphaR[0]*fR[15])+15.0*alphaR[0]*fR[9]); 
  incr[10] = -0.05*(1.732050807568877*(10.0*(alphaR[1]*fR[23]+alphaR[4]*fR[17])+5.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3]))+2.23606797749979*((-6.0*alphaR[1]*fR[18])+1.732050807568877*(5.0*alphaR[0]*fR[17]+2.0*alphaR[4]*fR[6])-6.0*alphaR[4]*fR[10])+3.872983346207417*alphaR[1]*(2.0*fR[14]+5.0*fR[13])-15.0*(alphaR[0]*fR[10]+alphaR[1]*fR[5])); 
  incr[11] = 0.01666666666666667*(3.872983346207417*(1.732050807568877*(10.0*alphaR[1]*fR[20]+5.0*(alphaR[0]*fR[2]+fR[0]*alphaR[1]))+2.23606797749979*(1.732050807568877*(alphaR[1]*(2.0*fR[8]+5.0*fR[7])+2.0*fR[2]*alphaR[4])-6.0*alphaR[4]*fR[4])-15.0*(alphaR[0]*fR[4]+alphaR[1]*fR[1]))-51.96152422706631*alphaR[1]*fR[12]+(67.0820393249937*alphaR[4]+75.0*alphaR[0])*fR[11]); 
  incr[12] = 0.007142857142857143*(3.872983346207417*(2.23606797749979*((-10.0*alphaR[4]*fR[20])-7.0*alphaR[0]*fR[8]+(12.12435565298214*fR[1]-7.0*fR[0])*alphaR[4])-35.0*alphaR[0]*fR[20]+alphaR[4]*((-10.0*fR[8])-35.0*fR[7])+alphaR[1]*(24.24871130596428*fR[4]-14.0*fR[2]))+(67.0820393249937*alphaR[4]+105.0*alphaR[0])*fR[12]-121.2435565298214*alphaR[1]*fR[11]); 
  incr[13] = 0.08333333333333333*(3.872983346207417*(3.872983346207417*(alphaR[4]*fR[23]+alphaR[1]*fR[17])-3.0*(alphaR[4]*fR[18]+alphaR[1]*fR[10])+1.732050807568877*(alphaR[1]*fR[6]+alphaR[0]*fR[3])-3.0*alphaR[0]*fR[5])+6.708203932499369*alphaR[4]*fR[14]+15.0*alphaR[0]*fR[13]); 
  incr[14] = 0.002380952380952381*(3.872983346207417*(2.23606797749979*(1.732050807568877*(10.0*alphaR[4]*fR[23]+14.0*alphaR[1]*fR[17]+7.0*fR[3]*alphaR[4])-21.0*(alphaR[0]*fR[18]+alphaR[4]*fR[5]))+1.732050807568877*(35.0*alphaR[0]*fR[23]+14.0*alphaR[1]*fR[6])-30.0*alphaR[4]*fR[18]-42.0*alphaR[1]*fR[10])+2.23606797749979*alphaR[4]*(30.0*fR[14]+105.0*fR[13])+105.0*alphaR[0]*fR[14]); 
  incr[15] = 0.05*(3.872983346207417*((-5.0*alphaR[4]*fR[26])+2.23606797749979*(1.732050807568877*(alphaR[4]*fR[25]+alphaR[1]*fR[19])-1.0*(alphaR[4]*fR[22]+alphaR[0]*fR[9]))-5.0*(alphaR[1]*fR[24]+alphaR[0]*fR[21]))-8.660254037844386*alphaR[1]*fR[16]+15.0*alphaR[0]*fR[15]); 
  incr[16] = 0.01666666666666667*(3.872983346207417*(2.23606797749979*(1.732050807568877*(2.0*(alphaR[1]*fR[26]+alphaR[4]*fR[24])+alphaR[1]*fR[9])-3.0*alphaR[0]*fR[19])-6.0*alphaR[1]*fR[25]+1.732050807568877*(5.0*alphaR[0]*fR[24]+alphaR[1]*(2.0*fR[22]+5.0*fR[21]))-6.0*alphaR[4]*fR[19])+(13.41640786499874*alphaR[4]+15.0*alphaR[0])*fR[16]-25.98076211353316*alphaR[1]*fR[15]); 
  incr[17] = 0.01666666666666667*(2.23606797749979*(30.0*(alphaR[1]*fR[23]+alphaR[4]*fR[17])-25.98076211353316*(alphaR[0]*fR[10]+alphaR[1]*fR[5])+15.0*(alphaR[0]*fR[6]+alphaR[1]*fR[3]))-51.96152422706631*(alphaR[1]*fR[18]+alphaR[4]*fR[10])+75.0*alphaR[0]*fR[17]+15.0*alphaR[1]*(2.0*fR[14]+5.0*fR[13])+30.0*alphaR[4]*fR[6]); 
  incr[18] = -0.007142857142857143*(2.23606797749979*(1.732050807568877*(35.0*alphaR[0]*fR[23]+14.0*alphaR[1]*fR[6])-30.0*alphaR[4]*fR[18]-42.0*alphaR[1]*fR[10])+1.732050807568877*(50.0*alphaR[4]*fR[23]+70.0*alphaR[1]*fR[17]+35.0*fR[3]*alphaR[4])-105.0*alphaR[0]*fR[18]+3.872983346207417*((10.0*alphaR[4]+15.65247584249853*alphaR[0])*fR[14]+35.0*alphaR[4]*fR[13])-105.0*alphaR[4]*fR[5]); 
  incr[19] = 0.05*(1.732050807568877*((-10.0*(alphaR[1]*fR[26]+alphaR[4]*fR[24]))-5.0*alphaR[1]*fR[9])+2.23606797749979*(6.0*alphaR[1]*fR[25]+1.732050807568877*(alphaR[1]*((-2.0*fR[22])-5.0*fR[21])-5.0*alphaR[0]*fR[24])+6.0*alphaR[4]*fR[19])+15.0*alphaR[0]*fR[19]+3.872983346207417*(2.23606797749979*(1.732050807568877*alphaR[1]*fR[15]-1.0*alphaR[0]*fR[16])-2.0*alphaR[4]*fR[16])); 
  incr[20] = -0.0119047619047619*(2.23606797749979*((-30.0*alphaR[4]*fR[20])-21.0*alphaR[0]*fR[8]+(36.37306695894642*fR[1]-21.0*fR[0])*alphaR[4])-105.0*alphaR[0]*fR[20]+3.872983346207417*((13.41640786499874*alphaR[4]+21.0*alphaR[0])*fR[12]-24.24871130596428*alphaR[1]*fR[11])+alphaR[4]*((-30.0*fR[8])-105.0*fR[7])+alphaR[1]*(72.74613391789283*fR[4]-42.0*fR[2])); 
  incr[21] = 0.08333333333333333*(15.0*alphaR[4]*fR[26]+2.23606797749979*(3.0*(alphaR[4]*fR[22]+alphaR[0]*fR[9])-5.196152422706632*(alphaR[4]*fR[25]+alphaR[1]*fR[19]))+15.0*(alphaR[1]*fR[24]+alphaR[0]*fR[21])+3.872983346207417*(1.732050807568877*alphaR[1]*fR[16]-3.0*alphaR[0]*fR[15])); 
  incr[22] = -0.002380952380952381*(2.23606797749979*((-105.0*alphaR[0]*fR[26])+1.732050807568877*(30.0*alphaR[4]*fR[25]+42.0*alphaR[1]*fR[19])+alphaR[4]*((-30.0*fR[22])-105.0*fR[21]))-150.0*alphaR[4]*fR[26]+181.8653347947321*alphaR[0]*fR[25]-210.0*alphaR[1]*fR[24]-105.0*alphaR[0]*fR[22]+3.872983346207417*(46.95742752749558*alphaR[4]*fR[15]-24.24871130596428*alphaR[1]*fR[16])-105.0*alphaR[4]*fR[9]); 
  incr[23] = 0.0119047619047619*(2.23606797749979*(30.0*alphaR[4]*fR[23]-36.37306695894642*(alphaR[0]*fR[18]+alphaR[4]*fR[5])+42.0*alphaR[1]*fR[17]+21.0*fR[3]*alphaR[4])+105.0*alphaR[0]*fR[23]+1.732050807568877*((-30.0*alphaR[4]*fR[18])-42.0*alphaR[1]*fR[10])+3.872983346207417*(3.872983346207417*alphaR[4]*(2.0*fR[14]+7.0*fR[13])+12.12435565298214*alphaR[0]*fR[14])+42.0*alphaR[1]*fR[6]); 
  incr[24] = 0.01666666666666667*(2.23606797749979*(30.0*(alphaR[1]*fR[26]+alphaR[4]*fR[24])-25.98076211353316*alphaR[0]*fR[19]+15.0*alphaR[1]*fR[9])-51.96152422706631*(alphaR[1]*fR[25]+alphaR[4]*fR[19])+75.0*alphaR[0]*fR[24]+alphaR[1]*(30.0*fR[22]+75.0*fR[21])+3.872983346207417*((7.745966692414834*alphaR[4]+8.660254037844386*alphaR[0])*fR[16]-15.0*alphaR[1]*fR[15])); 
  incr[25] = 0.007142857142857143*(2.23606797749979*(1.732050807568877*(alphaR[4]*((-10.0*fR[22])-35.0*fR[21])-35.0*alphaR[0]*fR[26])+30.0*alphaR[4]*fR[25]+42.0*alphaR[1]*fR[19])+1.732050807568877*((-50.0*alphaR[4]*fR[26])-70.0*alphaR[1]*fR[24]-35.0*(alphaR[0]*fR[22]+alphaR[4]*fR[9]))+105.0*alphaR[0]*fR[25]+3.872983346207417*(27.11088342345192*alphaR[4]*fR[15]-14.0*alphaR[1]*fR[16])); 
  incr[26] = 0.002380952380952381*(2.23606797749979*(150.0*alphaR[4]*fR[26]-181.8653347947321*alphaR[0]*fR[25]+210.0*alphaR[1]*fR[24]+105.0*(alphaR[0]*fR[22]+alphaR[4]*fR[9]))+525.0*alphaR[0]*fR[26]+1.732050807568877*((-150.0*alphaR[4]*fR[25])-210.0*alphaR[1]*fR[19])+alphaR[4]*(150.0*fR[22]+525.0*fR[21])+3.872983346207417*(54.22176684690384*alphaR[1]*fR[16]-105.0*alphaR[4]*fR[15])); 
  }
#elif upwindType == QUAD 
  double alphaOrdR;
  double fUpOrd[9];
  alphaOrdR = 0.4472135954999579*alphaR[4]-0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[0] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])+0.9486832980505122*fR[24]-0.9486832980505122*fL[24]+0.9486832980505137*fR[23]-0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])-0.7348469228349525*(fR[19]+fL[19])-0.7348469228349533*(fR[18]+fL[18])-1.42302494707577*fR[17]+1.42302494707577*fL[17]+0.4242640687119281*fR[16]-0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])+0.4242640687119285*fR[14]-0.4242640687119285*fL[14]+1.060660171779821*fR[13]-1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])+1.060660171779821*fR[11]-1.060660171779821*fL[11]+1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6363961030678926*fR[6]+0.6363961030678926*fL[6]-0.8215838362577489*(fR[5]+fL[5]+fR[4]+fL[4])+0.4743416490252568*(fR[3]+fR[2])-0.4743416490252568*(fL[3]+fL[2])+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]-0.9486832980505122*(fR[24]+fL[24])-0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])+0.7348469228349525*fR[19]-0.7348469228349525*fL[19]+0.7348469228349533*fR[18]-0.7348469228349533*fL[18]+1.42302494707577*(fR[17]+fL[17])-0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]-0.4242640687119285*(fR[14]+fL[14])-1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]-1.060660171779821*(fR[11]+fL[11])-1.10227038425243*fR[10]+1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6363961030678926*(fR[6]+fL[6])+0.8215838362577489*(fR[5]+fR[4])-0.8215838362577489*(fL[5]+fL[4])-0.4743416490252568*(fR[3]+fL[3]+fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.5590169943749475*alphaR[4]; 
  fUpOrd[1] = 0.5*(((-0.883883476483184*fR[23])+0.883883476483184*(fL[23]+fR[20])-0.883883476483184*fL[20]+0.6846531968814573*(fR[18]+fL[18])-0.3952847075210473*fR[14]+0.3952847075210473*fL[14]+0.7905694150420948*fR[13]-0.7905694150420948*fL[13]-0.6846531968814574*(fR[12]+fL[12])+0.3952847075210473*fR[8]-0.3952847075210473*fL[8]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6123724356957944*(fR[5]+fL[5])+0.3535533905932737*fR[3]-0.3535533905932737*fL[3]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.883883476483184*(fR[23]+fL[23])-0.883883476483184*(fR[20]+fL[20])-0.6846531968814573*fR[18]+0.6846531968814573*fL[18]+0.3952847075210473*(fR[14]+fL[14])-0.7905694150420948*(fR[13]+fL[13])+0.6846531968814574*fR[12]-0.6846531968814574*fL[12]-0.3952847075210473*(fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6123724356957944*fR[5]-0.6123724356957944*fL[5]-0.3535533905932737*(fR[3]+fL[3])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.4472135954999579*alphaR[4]+0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[2] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])-0.9486832980505122*fR[24]+0.9486832980505122*fL[24]+0.9486832980505137*fR[23]-0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])+0.7348469228349525*(fR[19]+fL[19])-0.7348469228349533*(fR[18]+fL[18])+1.42302494707577*fR[17]-1.42302494707577*fL[17]-0.4242640687119281*fR[16]+0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])+0.4242640687119285*fR[14]-0.4242640687119285*fL[14]+1.060660171779821*fR[13]-1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])-1.060660171779821*fR[11]+1.060660171779821*fL[11]-1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6363961030678926*fR[6]-0.6363961030678926*fL[6]-0.8215838362577489*(fR[5]+fL[5])+0.8215838362577489*(fR[4]+fL[4])+0.4743416490252568*fR[3]-0.4743416490252568*(fL[3]+fR[2])+0.4743416490252568*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]+0.9486832980505122*(fR[24]+fL[24])-0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])-0.7348469228349525*fR[19]+0.7348469228349525*fL[19]+0.7348469228349533*fR[18]-0.7348469228349533*fL[18]-1.42302494707577*(fR[17]+fL[17])+0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]-0.4242640687119285*(fR[14]+fL[14])-1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]+1.060660171779821*(fR[11]+fL[11])+1.10227038425243*fR[10]-1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6363961030678926*(fR[6]+fL[6])+0.8215838362577489*fR[5]-0.8215838362577489*(fL[5]+fR[4])+0.8215838362577489*fL[4]-0.4743416490252568*(fR[3]+fL[3])+0.4743416490252568*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.5*alphaR[1]; 
  fUpOrd[3] = 0.5*(((-0.883883476483184*fR[24])+0.883883476483184*(fL[24]+fR[21])-0.883883476483184*fL[21]+0.6846531968814573*(fR[19]+fL[19])-0.3952847075210473*fR[16]+0.3952847075210473*fL[16]-0.6846531968814574*(fR[15]+fL[15])+0.7905694150420948*fR[11]-0.7905694150420948*fL[11]+0.3952847075210473*fR[9]-0.3952847075210473*fL[9]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6123724356957944*(fR[4]+fL[4])+0.3535533905932737*fR[2]-0.3535533905932737*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.883883476483184*(fR[24]+fL[24])-0.883883476483184*(fR[21]+fL[21])-0.6846531968814573*fR[19]+0.6846531968814573*fL[19]+0.3952847075210473*(fR[16]+fL[16])+0.6846531968814574*fR[15]-0.6846531968814574*fL[15]-0.7905694150420948*(fR[11]+fL[11])-0.3952847075210473*(fR[9]+fL[9])+0.7905694150420947*(fR[7]+fL[7])+0.6123724356957944*fR[4]-0.6123724356957944*fL[4]-0.3535533905932737*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.5590169943749475*alphaR[4]; 
  fUpOrd[4] = 0.5*(((-0.9882117688026183*fR[26])+0.9882117688026183*fL[26]+0.7654655446197428*(fR[25]+fL[25])-0.441941738241592*fR[22]+0.441941738241592*fL[22]+0.883883476483184*(fR[21]+fR[20])-0.883883476483184*(fL[21]+fL[20])-0.6846531968814574*(fR[15]+fL[15]+fR[12]+fL[12])+0.3952847075210473*(fR[9]+fR[8])-0.3952847075210473*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.9882117688026183*(fR[26]+fL[26])-0.7654655446197428*fR[25]+0.7654655446197428*fL[25]+0.441941738241592*(fR[22]+fL[22])-0.883883476483184*(fR[21]+fL[21]+fR[20]+fL[20])+0.6846531968814574*(fR[15]+fR[12])-0.6846531968814574*(fL[15]+fL[12])-0.3952847075210473*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*(alphaR[1]+alphaR[0]); 
  fUpOrd[5] = 0.5*((0.883883476483184*(fR[24]+fR[21])-0.883883476483184*(fL[24]+fL[21])-0.6846531968814573*(fR[19]+fL[19])+0.3952847075210473*fR[16]-0.3952847075210473*fL[16]-0.6846531968814574*(fR[15]+fL[15])-0.7905694150420948*fR[11]+0.7905694150420948*fL[11]+0.3952847075210473*fR[9]-0.3952847075210473*fL[9]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[4]+fL[4])-0.3535533905932737*fR[2]+0.3535533905932737*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)-0.883883476483184*(fR[24]+fL[24]+fR[21]+fL[21])+0.6846531968814573*fR[19]-0.6846531968814573*fL[19]-0.3952847075210473*(fR[16]+fL[16])+0.6846531968814574*fR[15]-0.6846531968814574*fL[15]+0.7905694150420948*(fR[11]+fL[11])-0.3952847075210473*(fR[9]+fL[9])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[4]+0.6123724356957944*fL[4]+0.3535533905932737*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.4472135954999579*alphaR[4]-0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[6] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])+0.9486832980505122*fR[24]-0.9486832980505122*fL[24]-0.9486832980505137*fR[23]+0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])-0.7348469228349525*(fR[19]+fL[19])+0.7348469228349533*(fR[18]+fL[18])+1.42302494707577*fR[17]-1.42302494707577*fL[17]+0.4242640687119281*fR[16]-0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])-0.4242640687119285*fR[14]+0.4242640687119285*fL[14]-1.060660171779821*fR[13]+1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])+1.060660171779821*fR[11]-1.060660171779821*fL[11]-1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6363961030678926*fR[6]-0.6363961030678926*fL[6]+0.8215838362577489*(fR[5]+fL[5])-0.8215838362577489*(fR[4]+fL[4])-0.4743416490252568*fR[3]+0.4743416490252568*(fL[3]+fR[2])-0.4743416490252568*fL[2]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]-0.9486832980505122*(fR[24]+fL[24])+0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])+0.7348469228349525*fR[19]-0.7348469228349525*fL[19]-0.7348469228349533*fR[18]+0.7348469228349533*fL[18]-1.42302494707577*(fR[17]+fL[17])-0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]+0.4242640687119285*(fR[14]+fL[14])+1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]-1.060660171779821*(fR[11]+fL[11])+1.10227038425243*fR[10]-1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6363961030678926*(fR[6]+fL[6])-0.8215838362577489*fR[5]+0.8215838362577489*(fL[5]+fR[4])-0.8215838362577489*fL[4]+0.4743416490252568*(fR[3]+fL[3])-0.4743416490252568*(fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.5*alphaR[0]-0.5590169943749475*alphaR[4]; 
  fUpOrd[7] = 0.5*((0.883883476483184*(fR[23]+fR[20])-0.883883476483184*(fL[23]+fL[20])-0.6846531968814573*(fR[18]+fL[18])+0.3952847075210473*fR[14]-0.3952847075210473*fL[14]-0.7905694150420948*fR[13]+0.7905694150420948*fL[13]-0.6846531968814574*(fR[12]+fL[12])+0.3952847075210473*fR[8]-0.3952847075210473*fL[8]-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]+0.6123724356957944*(fR[5]+fL[5])-0.3535533905932737*fR[3]+0.3535533905932737*fL[3]+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)-0.883883476483184*(fR[23]+fL[23]+fR[20]+fL[20])+0.6846531968814573*fR[18]-0.6846531968814573*fL[18]-0.3952847075210473*(fR[14]+fL[14])+0.7905694150420948*(fR[13]+fL[13])+0.6846531968814574*fR[12]-0.6846531968814574*fL[12]-0.3952847075210473*(fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])-0.6123724356957944*fR[5]+0.6123724356957944*fL[5]+0.3535533905932737*(fR[3]+fL[3])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 
  alphaOrdR = 0.4472135954999579*alphaR[4]+0.6708203932499369*alphaR[1]+0.5*alphaR[0]; 
  fUpOrd[8] = 0.5*(((-0.6324555320336759*fR[26])+0.6324555320336759*fL[26]+0.4898979485566357*(fR[25]+fL[25])-0.9486832980505122*fR[24]+0.9486832980505122*fL[24]-0.9486832980505137*fR[23]+0.9486832980505137*fL[23]-0.2828427124746191*fR[22]+0.2828427124746191*fL[22]-0.7071067811865475*(fR[21]+fR[20])+0.7071067811865475*(fL[21]+fL[20])+0.7348469228349525*(fR[19]+fL[19])+0.7348469228349533*(fR[18]+fL[18])-1.42302494707577*fR[17]+1.42302494707577*fL[17]-0.4242640687119281*fR[16]+0.4242640687119281*fL[16]+0.5477225575051661*(fR[15]+fL[15])-0.4242640687119285*fR[14]+0.4242640687119285*fL[14]-1.060660171779821*fR[13]+1.060660171779821*fL[13]+0.5477225575051661*(fR[12]+fL[12])-1.060660171779821*fR[11]+1.060660171779821*fL[11]+1.10227038425243*(fR[10]+fL[10])-0.3162277660168379*(fR[9]+fR[8])+0.3162277660168379*(fL[9]+fL[8])-0.7905694150420947*fR[7]+0.7905694150420947*fL[7]-0.6363961030678926*fR[6]+0.6363961030678926*fL[6]+0.8215838362577489*(fR[5]+fL[5]+fR[4]+fL[4])-0.4743416490252568*(fR[3]+fR[2])+0.4743416490252568*(fL[3]+fL[2])+0.6123724356957944*(fR[1]+fL[1])-0.3535533905932737*fR[0]+0.3535533905932737*fL[0])*sgn(alphaOrdR)+0.6324555320336759*(fR[26]+fL[26])-0.4898979485566357*fR[25]+0.4898979485566357*fL[25]+0.9486832980505122*(fR[24]+fL[24])+0.9486832980505137*(fR[23]+fL[23])+0.2828427124746191*(fR[22]+fL[22])+0.7071067811865475*(fR[21]+fL[21]+fR[20]+fL[20])-0.7348469228349525*fR[19]+0.7348469228349525*fL[19]-0.7348469228349533*fR[18]+0.7348469228349533*fL[18]+1.42302494707577*(fR[17]+fL[17])+0.4242640687119281*(fR[16]+fL[16])-0.5477225575051661*fR[15]+0.5477225575051661*fL[15]+0.4242640687119285*(fR[14]+fL[14])+1.060660171779821*(fR[13]+fL[13])-0.5477225575051661*fR[12]+0.5477225575051661*fL[12]+1.060660171779821*(fR[11]+fL[11])-1.10227038425243*fR[10]+1.10227038425243*fL[10]+0.3162277660168379*(fR[9]+fL[9]+fR[8]+fL[8])+0.7905694150420947*(fR[7]+fL[7])+0.6363961030678926*(fR[6]+fL[6])-0.8215838362577489*(fR[5]+fR[4])+0.8215838362577489*(fL[5]+fL[4])+0.4743416490252568*(fR[3]+fL[3]+fR[2]+fL[2])-0.6123724356957944*fR[1]+0.6123724356957944*fL[1]+0.3535533905932737*(fR[0]+fL[0])); 

  double fUp[9];
  fUp[0] = 0.006172839506172839*(25.0*fUpOrd[8]+72.0*fUpOrd[7]+25.0*fUpOrd[6]+8.0*(9.0*fUpOrd[5]-8.0*fUpOrd[4]+9.0*fUpOrd[3])+25.0*fUpOrd[2]+72.0*fUpOrd[1]+25.0*fUpOrd[0]); 
  fUp[1] = 0.01851851851851852*(11.18033988749895*(fUpOrd[8]-1.0*fUpOrd[6]+fUpOrd[2]-1.0*fUpOrd[0])+24.0*(fUpOrd[5]-1.0*fUpOrd[3])); 
  fUp[2] = 0.01851851851851852*(11.18033988749895*(fUpOrd[8]+fUpOrd[6]-1.0*(fUpOrd[2]+fUpOrd[0]))+24.0*(fUpOrd[7]-1.0*fUpOrd[1])); 
  fUp[3] = 0.2777777777777778*(fUpOrd[8]-1.0*(fUpOrd[6]+fUpOrd[2])+fUpOrd[0]); 
  fUp[4] = 0.00552115549999948*(5.0*(5.0*fUpOrd[8]-18.0*fUpOrd[7]+5.0*fUpOrd[6])+8.0*(9.0*fUpOrd[5]-8.0*fUpOrd[4]+9.0*fUpOrd[3])+5.0*(5.0*fUpOrd[2]-18.0*fUpOrd[1]+5.0*fUpOrd[0])); 
  fUp[5] = 0.00552115549999948*(25.0*fUpOrd[8]+72.0*fUpOrd[7]+25.0*fUpOrd[6]-2.0*(45.0*fUpOrd[5]+32.0*fUpOrd[4])+5.0*(5.0*fUpOrd[2]-18.0*fUpOrd[3])+72.0*fUpOrd[1]+25.0*fUpOrd[0]); 
  fUp[6] = 0.08281733249999224*(2.23606797749979*(fUpOrd[8]+fUpOrd[6]-1.0*(fUpOrd[2]+fUpOrd[0]))+6.0*(fUpOrd[1]-1.0*fUpOrd[7])); 
  fUp[7] = 0.08281733249999224*(2.23606797749979*(fUpOrd[8]-1.0*fUpOrd[6]+fUpOrd[2]-1.0*fUpOrd[0])+6.0*(fUpOrd[3]-1.0*fUpOrd[5])); 
  fUp[8] = 0.02469135802469136*(5.0*fUpOrd[8]-18.0*fUpOrd[7]+5.0*fUpOrd[6]+2.0*((-9.0*fUpOrd[5])+26.0*fUpOrd[4]-9.0*fUpOrd[3])+5.0*fUpOrd[2]-18.0*fUpOrd[1]+5.0*fUpOrd[0]); 

  incr[0] = 0.3535533905932737*(alphaR[4]*fUp[4]+alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[1] = -0.6123724356957944*(alphaR[4]*fUp[4]+alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[2] = 0.07071067811865474*(4.47213595499958*(alphaR[1]*fUp[4]+fUp[1]*alphaR[4])+5.0*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[3] = 0.02357022603955158*(15.0*alphaR[4]*fUp[6]+15.0*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2])); 
  incr[4] = -0.07071067811865474*(7.745966692414834*(alphaR[1]*fUp[4]+fUp[1]*alphaR[4])+8.660254037844386*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[5] = -0.07071067811865474*(8.660254037844387*alphaR[4]*fUp[6]+8.660254037844386*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2])); 
  incr[6] = 0.02357022603955158*(13.41640786499874*alphaR[1]*fUp[6]+13.41640786499874*fUp[3]*alphaR[4]+15.0*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[7] = 0.7905694150420947*(alphaR[4]*fUp[4]+alphaR[1]*fUp[1]+alphaR[0]*fUp[0]); 
  incr[8] = 0.01010152544552211*(2.23606797749979*(10.0*alphaR[4]*fUp[4]+14.0*alphaR[1]*fUp[1])+35.0*(alphaR[0]*fUp[4]+fUp[0]*alphaR[4])); 
  incr[9] = 0.02357022603955158*(15.0*alphaR[4]*fUp[8]+15.0*alphaR[1]*fUp[7]+15.0*alphaR[0]*fUp[5]); 
  incr[10] = -0.07071067811865474*(7.745966692414834*(alphaR[1]*fUp[6]+fUp[3]*alphaR[4])+8.660254037844386*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[11] = 0.09128709291752765*(7.745966692414834*(alphaR[1]*fUp[4]+fUp[1]*alphaR[4])+8.660254037844386*(alphaR[0]*fUp[1]+fUp[0]*alphaR[1])); 
  incr[12] = -0.03912303982179757*(15.65247584249853*(alphaR[0]*fUp[4]+fUp[0]*alphaR[4])+10.0*alphaR[4]*fUp[4]+14.0*alphaR[1]*fUp[1]); 
  incr[13] = 0.1178511301977579*(6.708203932499369*alphaR[4]*fUp[6]+6.708203932499369*(alphaR[1]*fUp[3]+alphaR[0]*fUp[2])); 
  incr[14] = 0.003367175148507369*((67.0820393249937*alphaR[4]+105.0*alphaR[0])*fUp[6]+3.872983346207417*(27.11088342345192*fUp[2]*alphaR[4]+24.24871130596428*alphaR[1]*fUp[3])); 
  incr[15] = -0.07071067811865474*(8.660254037844387*(alphaR[4]*fUp[8]+alphaR[0]*fUp[5])+8.660254037844386*alphaR[1]*fUp[7]); 
  incr[16] = 0.02357022603955158*(3.872983346207417*alphaR[1]*(3.464101615137754*fUp[8]+3.872983346207417*fUp[5])+(13.41640786499874*alphaR[4]+15.0*alphaR[0])*fUp[7]); 
  incr[17] = 0.02357022603955158*(30.0*alphaR[1]*fUp[6]+30.0*fUp[3]*alphaR[4]+33.54101966249685*(alphaR[0]*fUp[3]+alphaR[1]*fUp[2])); 
  incr[18] = -0.01010152544552211*(3.872983346207417*(10.0*alphaR[4]+15.65247584249853*alphaR[0])*fUp[6]+60.6217782649107*fUp[2]*alphaR[4]+54.22176684690384*alphaR[1]*fUp[3]); 
  incr[19] = -0.07071067811865474*(7.745966692414834*alphaR[1]*fUp[8]+3.872983346207417*(2.0*alphaR[4]+2.23606797749979*alphaR[0])*fUp[7]+8.660254037844386*alphaR[1]*fUp[5]); 
  incr[20] = 0.05050762722761052*(15.65247584249853*(alphaR[0]*fUp[4]+fUp[0]*alphaR[4])+10.0*alphaR[4]*fUp[4]+14.0*alphaR[1]*fUp[1]); 
  incr[21] = 0.1178511301977579*(6.708203932499369*(alphaR[4]*fUp[8]+alphaR[0]*fUp[5])+6.708203932499369*alphaR[1]*fUp[7]); 
  incr[22] = 0.003367175148507369*((67.0820393249937*alphaR[4]+105.0*alphaR[0])*fUp[8]+93.91485505499116*alphaR[1]*fUp[7]+105.0*alphaR[4]*fUp[5]); 
  incr[23] = 0.01683587574253684*(3.872983346207417*(7.745966692414834*alphaR[4]+12.12435565298214*alphaR[0])*fUp[6]+46.95742752749558*fUp[2]*alphaR[4]+42.0*alphaR[1]*fUp[3]); 
  incr[24] = 0.02357022603955158*(30.0*alphaR[1]*fUp[8]+3.872983346207417*(7.745966692414834*alphaR[4]+8.660254037844386*alphaR[0])*fUp[7]+33.54101966249685*alphaR[1]*fUp[5]); 
  incr[25] = -0.01010152544552211*(60.6217782649107*(alphaR[0]*fUp[8]+alphaR[4]*fUp[5])+38.72983346207418*alphaR[4]*fUp[8]+54.22176684690384*alphaR[1]*fUp[7]); 
  incr[26] = 0.003367175148507369*(234.7871376374779*(alphaR[0]*fUp[8]+alphaR[4]*fUp[5])+150.0*alphaR[4]*fUp[8]+210.0*alphaR[1]*fUp[7]); 

#endif 
  outR[0] += incr[0]*rdx2R; 
  outR[1] += incr[1]*rdx2R; 
  outR[2] += incr[2]*rdx2R; 
  outR[3] += incr[3]*rdx2R; 
  outR[4] += incr[4]*rdx2R; 
  outR[5] += incr[5]*rdx2R; 
  outR[6] += incr[6]*rdx2R; 
  outR[7] += incr[7]*rdx2R; 
  outR[8] += incr[8]*rdx2R; 
  outR[9] += incr[9]*rdx2R; 
  outR[10] += incr[10]*rdx2R; 
  outR[11] += incr[11]*rdx2R; 
  outR[12] += incr[12]*rdx2R; 
  outR[13] += incr[13]*rdx2R; 
  outR[14] += incr[14]*rdx2R; 
  outR[15] += incr[15]*rdx2R; 
  outR[16] += incr[16]*rdx2R; 
  outR[17] += incr[17]*rdx2R; 
  outR[18] += incr[18]*rdx2R; 
  outR[19] += incr[19]*rdx2R; 
  outR[20] += incr[20]*rdx2R; 
  outR[21] += incr[21]*rdx2R; 
  outR[22] += incr[22]*rdx2R; 
  outR[23] += incr[23]*rdx2R; 
  outR[24] += incr[24]*rdx2R; 
  outR[25] += incr[25]*rdx2R; 
  outR[26] += incr[26]*rdx2R; 

  outL[0] += -1.0*incr[0]*rdx2L; 
  outL[1] += incr[1]*rdx2L; 
  outL[2] += -1.0*incr[2]*rdx2L; 
  outL[3] += -1.0*incr[3]*rdx2L; 
  outL[4] += incr[4]*rdx2L; 
  outL[5] += incr[5]*rdx2L; 
  outL[6] += -1.0*incr[6]*rdx2L; 
  outL[7] += -1.0*incr[7]*rdx2L; 
  outL[8] += -1.0*incr[8]*rdx2L; 
  outL[9] += -1.0*incr[9]*rdx2L; 
  outL[10] += incr[10]*rdx2L; 
  outL[11] += -1.0*incr[11]*rdx2L; 
  outL[12] += incr[12]*rdx2L; 
  outL[13] += -1.0*incr[13]*rdx2L; 
  outL[14] += -1.0*incr[14]*rdx2L; 
  outL[15] += incr[15]*rdx2L; 
  outL[16] += -1.0*incr[16]*rdx2L; 
  outL[17] += -1.0*incr[17]*rdx2L; 
  outL[18] += incr[18]*rdx2L; 
  outL[19] += incr[19]*rdx2L; 
  outL[20] += -1.0*incr[20]*rdx2L; 
  outL[21] += -1.0*incr[21]*rdx2L; 
  outL[22] += -1.0*incr[22]*rdx2L; 
  outL[23] += -1.0*incr[23]*rdx2L; 
  outL[24] += -1.0*incr[24]*rdx2L; 
  outL[25] += incr[25]*rdx2L; 
  outL[26] += -1.0*incr[26]*rdx2L; 

  return std::abs(alphaSurfAvgR); 
} 
double GyrokineticGenGeoSurf1x2vTensor_vpar_P2_Bvarsxz(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *fL, const double *fR, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamilR[27]; 
  hamilR[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*(bmag[0]*wmuR+phi[0]*q_))+2.0*m_))/rdvpar2SqR; 
  hamilR[1] = 2.0*(bmag[1]*wmuR+phi[1]*q_); 
  hamilR[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamilR[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamilR[5] = (1.154700538379252*bmag[1])/rdmu2R; 
  hamilR[7] = 2.0*(bmag[2]*wmuR+phi[2]*q_); 
  hamilR[8] = (0.421637021355784*m_)/rdvpar2SqR; 
  hamilR[13] = (1.154700538379251*bmag[2])/rdmu2R; 

  double BstarZdBmagR[27]; 
  BstarZdBmagR[0] = (1.414213562373095*(1.732050807568877*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R*wvparR+(cmag[2]*jacobTotInv[2]+cmag[1]*jacobTotInv[1]+cmag[0]*jacobTotInv[0])*q_))/q_; 
  BstarZdBmagR[1] = (0.2828427124746191*(5.0*(1.732050807568877*(2.0*b_y[2]*jacobTotInv[2]+b_y[1]*jacobTotInv[1])*m_*rdx2R*wvparR+(cmag[0]*jacobTotInv[1]+jacobTotInv[0]*cmag[1])*q_)+2.23606797749979*(8.660254037844386*jacobTotInv[0]*b_y[2]*m_*rdx2R*wvparR+2.0*(cmag[1]*jacobTotInv[2]+jacobTotInv[1]*cmag[2])*q_)))/q_; 
  BstarZdBmagR[2] = (1.414213562373095*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[4] = (1.414213562373095*(b_y[2]*(2.0*jacobTotInv[2]+2.23606797749979*jacobTotInv[0])+b_y[1]*jacobTotInv[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[7] = (0.04040610178208843*(60.6217782649107*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R*wvparR+(4.47213595499958*(5.0*cmag[2]*jacobTotInv[2]+7.0*cmag[1]*jacobTotInv[1])+35.0*(cmag[0]*jacobTotInv[2]+jacobTotInv[0]*cmag[2]))*q_))/q_; 
  BstarZdBmagR[11] = (1.414213562373095*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R)/(q_*rdvpar2R); 

  double alphaR[9]; 
  alphaR[0] = -(0.25*(2.23606797749979*(1.732050807568877*BstarZdBmagR[1]-3.0*BstarZdBmagR[4])*hamilR[7]+hamilR[1]*(1.732050807568877*BstarZdBmagR[0]-3.0*BstarZdBmagR[2]))*rdx2R)/m_; 
  alphaR[1] = (0.05*(30.0*hamilR[7]*BstarZdBmagR[11]+1.732050807568877*((-10.0*BstarZdBmagR[7]*hamilR[7])-5.0*BstarZdBmagR[1]*hamilR[1])+2.23606797749979*(15.0*BstarZdBmagR[2]-8.660254037844386*BstarZdBmagR[0])*hamilR[7]+15.0*hamilR[1]*BstarZdBmagR[4])*rdx2R)/m_; 
  alphaR[2] = (0.25*(3.872983346207417*(1.732050807568877*BstarZdBmagR[4]-1.0*BstarZdBmagR[1])*hamilR[13]+(3.0*BstarZdBmagR[2]-1.732050807568877*BstarZdBmagR[0])*hamilR[5])*rdx2R)/m_; 
  alphaR[3] = -(0.05*((3.872983346207417*(4.47213595499958*BstarZdBmagR[7]-8.660254037844386*BstarZdBmagR[2]+5.0*BstarZdBmagR[0])-30.0*BstarZdBmagR[11])*hamilR[13]+(8.660254037844386*BstarZdBmagR[1]-15.0*BstarZdBmagR[4])*hamilR[5])*rdx2R)/m_; 
  alphaR[4] = (0.05*(15.0*hamilR[1]*BstarZdBmagR[11]+1.732050807568877*((-10.0*BstarZdBmagR[1]*hamilR[7])-5.0*hamilR[1]*BstarZdBmagR[7])+30.0*BstarZdBmagR[4]*hamilR[7])*rdx2R)/m_; 
  alphaR[6] = -(0.05*((17.32050807568877*BstarZdBmagR[1]-30.0*BstarZdBmagR[4])*hamilR[13]+hamilR[5]*(8.660254037844387*BstarZdBmagR[7]-15.0*BstarZdBmagR[11]))*rdx2R)/m_; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = -(0.0625*(2.23606797749979*(1.732050807568877*BstarZdBmagR[1]*hamilR[7]*rdx2R-3.0*BstarZdBmagR[4]*hamilR[7]*rdx2R)-3.0*hamilR[1]*BstarZdBmagR[2]*rdx2R+1.732050807568877*BstarZdBmagR[0]*hamilR[1]*rdx2R))/m_; 

  double incr[27]; 
  double amax = amax_in; 

  double fAvg[9]; 
  fAvg[0] = 0.7071067811865475*(2.23606797749979*(fR[8]+fL[8])+1.732050807568877*(fL[2]-1.0*fR[2])+fR[0]+fL[0]); 
  fAvg[1] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fR[12]+fL[12])+3.0*(fL[4]-1.0*fR[4]))+3.0*(fR[1]+fL[1])); 
  fAvg[2] = 0.2357022603955158*(1.732050807568877*(3.872983346207417*(fR[14]+fL[14])+3.0*(fL[6]-1.0*fR[6]))+3.0*(fR[3]+fL[3])); 
  fAvg[3] = 0.7071067811865475*(2.23606797749979*(fR[18]+fL[18])+1.732050807568877*(fL[10]-1.0*fR[10])+fR[5]+fL[5]); 
  fAvg[4] = 0.1414213562373095*(2.23606797749979*(5.0*(fR[20]+fL[20])-3.872983346207417*(fR[11]-1.0*fL[11]))+5.0*(fR[7]+fL[7])); 
  fAvg[5] = 0.1414213562373095*(2.23606797749979*(5.0*(fR[22]+fL[22])-3.872983346207417*(fR[16]-1.0*fL[16]))+5.0*(fR[9]+fL[9])); 
  fAvg[6] = -0.04714045207910316*(3.872983346207417*(6.708203932499369*(fR[17]-1.0*fL[17])-8.660254037844386*(fR[23]+fL[23]))-15.0*(fR[13]+fL[13])); 
  fAvg[7] = -0.04714045207910316*(3.872983346207417*(6.708203932499369*(fR[19]-1.0*fL[19])-8.660254037844386*(fR[25]+fL[25]))-15.0*(fR[15]+fL[15])); 
  fAvg[8] = 0.7071067811865475*(2.23606797749979*(fR[26]+fL[26])+1.732050807568877*(fL[24]-1.0*fR[24])+fR[21]+fL[21]); 

  double Ghat[9]; 
  Ghat[0] = -0.1767766952966368*((2.23606797749979*(2.0*fR[8]-2.0*fL[8])-3.464101615137754*(fR[2]+fL[2])+2.0*fR[0]-2.0*fL[0])*amax-1.414213562373095*(alphaR[6]*fAvg[6]+alphaR[4]*fAvg[4]+alphaR[3]*fAvg[3]+alphaR[2]*fAvg[2]+alphaR[1]*fAvg[1]+alphaR[0]*fAvg[0])); 
  Ghat[1] = -0.01178511301977579*(6.708203932499369*((10.0*fR[12]-10.0*fL[12])*amax-2.828427124746191*(alphaR[3]*fAvg[6]+fAvg[3]*alphaR[6]))+((-51.96152422706631*(fR[4]+fL[4]))+30.0*fR[1]-30.0*fL[1])*amax-18.97366596101028*(alphaR[1]*fAvg[4]+fAvg[1]*alphaR[4])-21.21320343559643*(alphaR[2]*fAvg[3]+fAvg[2]*alphaR[3]+alphaR[0]*fAvg[1]+fAvg[0]*alphaR[1])); 
  Ghat[2] = 0.01178511301977579*(3.872983346207417*(1.732050807568877*((10.0*fL[14]-10.0*fR[14])*amax+2.828427124746191*(alphaR[6]*fAvg[8]+alphaR[3]*fAvg[7]))+5.477225575051662*(alphaR[4]*fAvg[6]+fAvg[4]*alphaR[6]))+(51.96152422706631*(fR[6]+fL[6])-30.0*fR[3]+30.0*fL[3])*amax+18.97366596101028*alphaR[2]*fAvg[5]+21.21320343559643*(alphaR[1]*fAvg[3]+fAvg[1]*alphaR[3]+alphaR[0]*fAvg[2]+fAvg[0]*alphaR[2])); 
  Ghat[3] = 0.01178511301977579*(2.23606797749979*((30.0*fL[18]-30.0*fR[18])*amax+8.485281374238571*(alphaR[3]*(fAvg[5]+fAvg[4])+fAvg[3]*alphaR[4]))+(51.96152422706631*(fR[10]+fL[10])-30.0*fR[5]+30.0*fL[5])*amax+16.97056274847715*alphaR[3]*fAvg[8]+18.97366596101028*(alphaR[2]*fAvg[7]+alphaR[1]*fAvg[6]+fAvg[1]*alphaR[6])+16.97056274847715*alphaR[6]*fAvg[7]+21.21320343559643*(alphaR[0]*fAvg[3]+fAvg[0]*alphaR[3]+alphaR[1]*fAvg[2]+fAvg[1]*alphaR[2])); 
  Ghat[4] = 0.001683587574253684*(2.23606797749979*((210.0*fL[20]-210.0*fR[20])*amax+42.42640687119286*(alphaR[6]*fAvg[6]+alphaR[4]*fAvg[4])+59.39696961967*(alphaR[3]*fAvg[3]+alphaR[1]*fAvg[1]))+8.660254037844387*(42.0*(fR[11]+fL[11])*amax+17.14642819948224*(alphaR[2]*fAvg[6]+fAvg[2]*alphaR[6]))+(210.0*fL[7]-210.0*fR[7])*amax+148.492424049175*(alphaR[0]*fAvg[4]+fAvg[0]*alphaR[4])); 
  Ghat[5] = 0.01178511301977579*(2.23606797749979*((30.0*fL[22]-30.0*fR[22])*amax+8.485281374238571*(alphaR[6]*fAvg[6]+alphaR[3]*fAvg[3]+alphaR[2]*fAvg[2]))+8.660254037844387*(6.0*(fR[16]+fL[16])*amax+2.449489742783178*alphaR[1]*fAvg[7])+(30.0*fL[9]-30.0*fR[9])*amax+21.21320343559643*(alphaR[4]*fAvg[8]+alphaR[0]*fAvg[5])); 
  Ghat[6] = 0.001683587574253684*(3.872983346207417*(1.732050807568877*((70.0*fL[23]-70.0*fR[23])*amax+19.79898987322333*(alphaR[2]*fAvg[8]+alphaR[1]*fAvg[3]+fAvg[1]*alphaR[3]))+2.23606797749979*(42.0*(fR[17]+fL[17])*amax+17.14642819948224*(alphaR[2]*fAvg[4]+fAvg[2]*alphaR[4])))+(210.0*fL[13]-210.0*fR[13])*amax+84.85281374238573*alphaR[6]*fAvg[8]+118.79393923934*alphaR[3]*fAvg[7]+2.23606797749979*(42.42640687119286*alphaR[4]*fAvg[6]+(59.39696961967*fAvg[5]+42.42640687119286*fAvg[4])*alphaR[6])+148.492424049175*(alphaR[0]*fAvg[6]+fAvg[0]*alphaR[6])); 
  Ghat[7] = 0.01178511301977579*(3.872983346207417*(1.732050807568877*((10.0*fL[25]-10.0*fR[25])*amax+2.828427124746191*(alphaR[1]*fAvg[8]+alphaR[2]*fAvg[3]+fAvg[2]*alphaR[3]))+2.23606797749979*(6.0*(fR[19]+fL[19])*amax+2.449489742783178*alphaR[1]*fAvg[5]))+(30.0*fL[15]-30.0*fR[15])*amax+(18.97366596101028*alphaR[4]+21.21320343559643*alphaR[0])*fAvg[7]+16.97056274847715*(alphaR[3]*fAvg[6]+fAvg[3]*alphaR[6])); 
  Ghat[8] = 0.001683587574253684*(2.23606797749979*((210.0*fL[26]-210.0*fR[26])*amax+42.42640687119286*alphaR[4]*fAvg[8])+(363.7306695894642*(fR[24]+fL[24])-210.0*fR[21]+210.0*fL[21])*amax+148.492424049175*alphaR[0]*fAvg[8]+132.815661727072*(alphaR[1]*fAvg[7]+alphaR[2]*fAvg[6]+fAvg[2]*alphaR[6])+84.85281374238573*alphaR[6]*fAvg[6]+148.492424049175*alphaR[4]*fAvg[5]+118.79393923934*alphaR[3]*fAvg[3]); 

  incr[0] = 0.7071067811865475*Ghat[0]; 
  incr[1] = 0.7071067811865475*Ghat[1]; 
  incr[2] = -1.224744871391589*Ghat[0]; 
  incr[3] = 0.7071067811865475*Ghat[2]; 
  incr[4] = -1.224744871391589*Ghat[1]; 
  incr[5] = 0.7071067811865475*Ghat[3]; 
  incr[6] = -1.224744871391589*Ghat[2]; 
  incr[7] = 0.7071067811865475*Ghat[4]; 
  incr[8] = 1.58113883008419*Ghat[0]; 
  incr[9] = 0.7071067811865475*Ghat[5]; 
  incr[10] = -1.224744871391589*Ghat[3]; 
  incr[11] = -1.224744871391589*Ghat[4]; 
  incr[12] = 1.58113883008419*Ghat[1]; 
  incr[13] = 0.7071067811865475*Ghat[6]; 
  incr[14] = 1.58113883008419*Ghat[2]; 
  incr[15] = 0.7071067811865475*Ghat[7]; 
  incr[16] = -1.224744871391589*Ghat[5]; 
  incr[17] = -1.224744871391589*Ghat[6]; 
  incr[18] = 1.58113883008419*Ghat[3]; 
  incr[19] = -1.224744871391589*Ghat[7]; 
  incr[20] = 1.58113883008419*Ghat[4]; 
  incr[21] = 0.7071067811865475*Ghat[8]; 
  incr[22] = 1.58113883008419*Ghat[5]; 
  incr[23] = 1.58113883008419*Ghat[6]; 
  incr[24] = -1.224744871391589*Ghat[8]; 
  incr[25] = 1.58113883008419*Ghat[7]; 
  incr[26] = 1.58113883008419*Ghat[8]; 

  outR[0] += incr[0]*rdvpar2R; 
  outR[1] += incr[1]*rdvpar2R; 
  outR[2] += incr[2]*rdvpar2R; 
  outR[3] += incr[3]*rdvpar2R; 
  outR[4] += incr[4]*rdvpar2R; 
  outR[5] += incr[5]*rdvpar2R; 
  outR[6] += incr[6]*rdvpar2R; 
  outR[7] += incr[7]*rdvpar2R; 
  outR[8] += incr[8]*rdvpar2R; 
  outR[9] += incr[9]*rdvpar2R; 
  outR[10] += incr[10]*rdvpar2R; 
  outR[11] += incr[11]*rdvpar2R; 
  outR[12] += incr[12]*rdvpar2R; 
  outR[13] += incr[13]*rdvpar2R; 
  outR[14] += incr[14]*rdvpar2R; 
  outR[15] += incr[15]*rdvpar2R; 
  outR[16] += incr[16]*rdvpar2R; 
  outR[17] += incr[17]*rdvpar2R; 
  outR[18] += incr[18]*rdvpar2R; 
  outR[19] += incr[19]*rdvpar2R; 
  outR[20] += incr[20]*rdvpar2R; 
  outR[21] += incr[21]*rdvpar2R; 
  outR[22] += incr[22]*rdvpar2R; 
  outR[23] += incr[23]*rdvpar2R; 
  outR[24] += incr[24]*rdvpar2R; 
  outR[25] += incr[25]*rdvpar2R; 
  outR[26] += incr[26]*rdvpar2R; 

  outL[0] += -1.0*incr[0]*rdvpar2L; 
  outL[1] += -1.0*incr[1]*rdvpar2L; 
  outL[2] += incr[2]*rdvpar2L; 
  outL[3] += -1.0*incr[3]*rdvpar2L; 
  outL[4] += incr[4]*rdvpar2L; 
  outL[5] += -1.0*incr[5]*rdvpar2L; 
  outL[6] += incr[6]*rdvpar2L; 
  outL[7] += -1.0*incr[7]*rdvpar2L; 
  outL[8] += -1.0*incr[8]*rdvpar2L; 
  outL[9] += -1.0*incr[9]*rdvpar2L; 
  outL[10] += incr[10]*rdvpar2L; 
  outL[11] += incr[11]*rdvpar2L; 
  outL[12] += -1.0*incr[12]*rdvpar2L; 
  outL[13] += -1.0*incr[13]*rdvpar2L; 
  outL[14] += -1.0*incr[14]*rdvpar2L; 
  outL[15] += -1.0*incr[15]*rdvpar2L; 
  outL[16] += incr[16]*rdvpar2L; 
  outL[17] += incr[17]*rdvpar2L; 
  outL[18] += -1.0*incr[18]*rdvpar2L; 
  outL[19] += incr[19]*rdvpar2L; 
  outL[20] += -1.0*incr[20]*rdvpar2L; 
  outL[21] += -1.0*incr[21]*rdvpar2L; 
  outL[22] += -1.0*incr[22]*rdvpar2L; 
  outL[23] += -1.0*incr[23]*rdvpar2L; 
  outL[24] += incr[24]*rdvpar2L; 
  outL[25] += -1.0*incr[25]*rdvpar2L; 
  outL[26] += -1.0*incr[26]*rdvpar2L; 
return std::abs(alphaSurfAvgR); 
} 
