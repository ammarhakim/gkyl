#include <GyrokineticModDecl.h> 
double GyrokineticVol2x2vSerP1_Bvars_0(const double q_, const double m_, const double *w, const double *dxv, const double *Bmag, const double *BmagInv, const double *BdriftX, const double *BdriftY, const double *Phi, const double *f, double *out) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dxInv = 1.0/dxv[0]; 
  double dyInv = 1.0/dxv[1]; 
  double dvInv = 1.0/dxv[2]; 
  double dmInv = 1.0/dxv[3]; 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double m2 = m_*m_; 
  out[1] += (0.25*(3.464101615137754*BdriftX[0]*f[0]*dfac_v*dfac_x*m_*wv2+2.0*BdriftX[0]*f[3]*dfac_x*m_*wv-3.0*BmagInv[0]*(f[1]*Phi[3]+f[0]*Phi[2])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[2] += (0.25*(3.464101615137754*BdriftY[0]*f[0]*dfac_v*dfac_y*m_*wv2+2.0*BdriftY[0]*f[3]*dfac_y*m_*wv+3.0*BmagInv[0]*(f[2]*Phi[3]+f[0]*Phi[1])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[3] += -0.25*(3.0*BdriftY[0]*(f[1]*Phi[3]+f[0]*Phi[2])*dfac_v*dfac_y*wv+3.0*BdriftX[0]*(f[2]*Phi[3]+f[0]*Phi[1])*dfac_v*dfac_x*wv+1.732050807568877*BdriftY[0]*(Phi[3]*f[6]+Phi[2]*f[3])*dfac_y+1.732050807568877*BdriftX[0]*(Phi[3]*f[7]+Phi[1]*f[3])*dfac_x); 
  out[5] += (0.25*(3.464101615137754*BdriftY[0]*f[1]*dfac_v*dfac_y*m_*wv2+3.464101615137754*BdriftX[0]*f[2]*dfac_v*dfac_x*m_*wv2+2.0*BdriftY[0]*f[6]*dfac_y*m_*wv+2.0*BdriftX[0]*f[7]*dfac_x*m_*wv-3.0*BmagInv[0]*(Phi[2]*f[2]-1.0*Phi[1]*f[1])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[6] += (0.25*(1.732050807568877*BdriftX[0]*dfac_v*dfac_x*(2.0*f[3]*m_*wv2-1.0*Phi[3]*f[11]*q_-1.0*Phi[1]*f[6]*q_)-3.0*BdriftY[0]*(f[0]*Phi[3]+f[1]*Phi[2])*dfac_v2*dfac_y*q_*wv-3.0*BdriftX[0]*(Phi[3]*f[5]+Phi[1]*f[1])*dfac_v2*dfac_x*q_*wv+2.0*BdriftX[0]*f[0]*dfac_x*m_*wv-3.0*BmagInv[0]*(Phi[3]*f[6]+Phi[2]*f[3])*dfac_v*dfac_x*dfac_y*q_-1.732050807568877*BdriftY[0]*(Phi[2]*f[6]+Phi[3]*f[3])*dfac_v*dfac_y*q_))/(dfac_v*q_); 
  out[7] += (0.25*(1.732050807568877*BdriftY[0]*dfac_v*dfac_y*(2.0*f[3]*m_*wv2-1.0*Phi[3]*f[11]*q_-1.0*Phi[2]*f[7]*q_)-3.0*BdriftY[0]*(Phi[3]*f[5]+Phi[2]*f[2])*dfac_v2*dfac_y*q_*wv-3.0*BdriftX[0]*(f[0]*Phi[3]+Phi[1]*f[2])*dfac_v2*dfac_x*q_*wv+2.0*BdriftY[0]*f[0]*dfac_y*m_*wv+3.0*BmagInv[0]*(Phi[3]*f[7]+Phi[1]*f[3])*dfac_v*dfac_x*dfac_y*q_-1.732050807568877*BdriftX[0]*(Phi[1]*f[7]+Phi[3]*f[3])*dfac_v*dfac_x*q_))/(dfac_v*q_); 
  out[8] += (0.25*(3.464101615137754*BdriftX[0]*f[4]*dfac_v*dfac_x*m_*wv2+2.0*BdriftX[0]*f[10]*dfac_x*m_*wv-3.0*BmagInv[0]*(Phi[3]*f[8]+Phi[2]*f[4])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[9] += (0.25*(3.464101615137754*BdriftY[0]*f[4]*dfac_v*dfac_y*m_*wv2+2.0*BdriftY[0]*f[10]*dfac_y*m_*wv+3.0*BmagInv[0]*(Phi[3]*f[9]+Phi[1]*f[4])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[10] += -0.25*(3.0*BdriftY[0]*(Phi[3]*f[8]+Phi[2]*f[4])*dfac_v*dfac_y*wv+3.0*BdriftX[0]*(Phi[3]*f[9]+Phi[1]*f[4])*dfac_v*dfac_x*wv+1.732050807568877*BdriftY[0]*(Phi[3]*f[13]+Phi[2]*f[10])*dfac_y+1.732050807568877*BdriftX[0]*(Phi[3]*f[14]+Phi[1]*f[10])*dfac_x); 
  out[11] += (0.25*(1.732050807568877*BdriftX[0]*dfac_v*dfac_x*(2.0*f[7]*m_*wv2-1.0*Phi[1]*f[11]*q_-1.0*Phi[3]*f[6]*q_)+1.732050807568877*BdriftY[0]*dfac_v*dfac_y*(2.0*f[6]*m_*wv2-1.0*Phi[2]*f[11]*q_-1.0*Phi[3]*f[7]*q_)-3.0*BdriftY[0]*(Phi[2]*f[5]+f[2]*Phi[3])*dfac_v2*dfac_y*q_*wv-3.0*BdriftX[0]*(Phi[1]*f[5]+f[1]*Phi[3])*dfac_v2*dfac_x*q_*wv+2.0*BdriftY[0]*f[1]*dfac_y*m_*wv+2.0*BdriftX[0]*f[2]*dfac_x*m_*wv-3.0*BmagInv[0]*(Phi[2]*f[7]-1.0*Phi[1]*f[6])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[12] += (0.25*(3.464101615137754*BdriftY[0]*f[8]*dfac_v*dfac_y*m_*wv2+3.464101615137754*BdriftX[0]*f[9]*dfac_v*dfac_x*m_*wv2+2.0*BdriftY[0]*f[13]*dfac_y*m_*wv+2.0*BdriftX[0]*f[14]*dfac_x*m_*wv-3.0*BmagInv[0]*(Phi[2]*f[9]-1.0*Phi[1]*f[8])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[13] += (0.25*(1.732050807568877*BdriftX[0]*dfac_v*dfac_x*(2.0*f[10]*m_*wv2-1.0*Phi[3]*f[15]*q_-1.0*Phi[1]*f[13]*q_)-3.0*BdriftY[0]*(Phi[2]*f[8]+Phi[3]*f[4])*dfac_v2*dfac_y*q_*wv-3.0*BdriftX[0]*(Phi[3]*f[12]+Phi[1]*f[8])*dfac_v2*dfac_x*q_*wv+2.0*BdriftX[0]*f[4]*dfac_x*m_*wv-3.0*BmagInv[0]*(Phi[3]*f[13]+Phi[2]*f[10])*dfac_v*dfac_x*dfac_y*q_-1.732050807568877*BdriftY[0]*(Phi[2]*f[13]+Phi[3]*f[10])*dfac_v*dfac_y*q_))/(dfac_v*q_); 
  out[14] += (0.25*(1.732050807568877*BdriftY[0]*dfac_v*dfac_y*(2.0*f[10]*m_*wv2-1.0*Phi[3]*f[15]*q_-1.0*Phi[2]*f[14]*q_)-3.0*BdriftY[0]*(Phi[3]*f[12]+Phi[2]*f[9])*dfac_v2*dfac_y*q_*wv-3.0*BdriftX[0]*(Phi[1]*f[9]+Phi[3]*f[4])*dfac_v2*dfac_x*q_*wv+2.0*BdriftY[0]*f[4]*dfac_y*m_*wv+3.0*BmagInv[0]*(Phi[3]*f[14]+Phi[1]*f[10])*dfac_v*dfac_x*dfac_y*q_-1.732050807568877*BdriftX[0]*(Phi[1]*f[14]+Phi[3]*f[10])*dfac_v*dfac_x*q_))/(dfac_v*q_); 
  out[15] += (0.25*(1.732050807568877*BdriftX[0]*dfac_v*dfac_x*(2.0*f[14]*m_*wv2-1.0*Phi[1]*f[15]*q_-1.0*Phi[3]*f[13]*q_)+1.732050807568877*BdriftY[0]*dfac_v*dfac_y*(2.0*f[13]*m_*wv2-1.0*Phi[2]*f[15]*q_-1.0*Phi[3]*f[14]*q_)-3.0*BdriftY[0]*(Phi[2]*f[12]+Phi[3]*f[9])*dfac_v2*dfac_y*q_*wv-3.0*BdriftX[0]*(Phi[1]*f[12]+Phi[3]*f[8])*dfac_v2*dfac_x*q_*wv+2.0*BdriftY[0]*f[8]*dfac_y*m_*wv+2.0*BdriftX[0]*f[9]*dfac_x*m_*wv-3.0*BmagInv[0]*(Phi[2]*f[14]-1.0*Phi[1]*f[13])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  double cflFreq = 0.0; 
  cflFreq += fabs(0.5*Bmag[0]*((0.5*BdriftX[0]*m_*wv2)/q_-0.4330127018922193*BmagInv[0]*Phi[2]*dfac_y))*dxInv; 
  cflFreq += fabs(0.5*Bmag[0]*((0.5*BdriftY[0]*m_*wv2)/q_+0.4330127018922193*BmagInv[0]*Phi[1]*dfac_x))*dyInv; 
  cflFreq += fabs((0.5*Bmag[0]*((-0.4330127018922193*BdriftY[0]*Phi[2]*dfac_y*m_*wv)-0.4330127018922193*BdriftX[0]*Phi[1]*dfac_x*m_*wv))/m_)*dvInv; 
  return cflFreq; 
} 
double GyrokineticVol2x2vSerP1_Bvars_1(const double q_, const double m_, const double *w, const double *dxv, const double *Bmag, const double *BmagInv, const double *BdriftX, const double *BdriftY, const double *Phi, const double *f, double *out) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dxInv = 1.0/dxv[0]; 
  double dyInv = 1.0/dxv[1]; 
  double dvInv = 1.0/dxv[2]; 
  double dmInv = 1.0/dxv[3]; 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double m2 = m_*m_; 
  out[1] += (0.25*(3.464101615137754*(BdriftX[1]*f[1]+BdriftX[0]*f[0])*dfac_v*dfac_x*m_*wv2+2.0*(BdriftX[1]*f[6]+BdriftX[0]*f[3])*dfac_x*m_*wv-3.0*(BmagInv[0]*f[1]*Phi[3]+f[0]*BmagInv[1]*Phi[3]+BmagInv[1]*f[1]*Phi[2]+BmagInv[0]*f[0]*Phi[2])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[2] += (0.25*(3.464101615137754*(BdriftY[1]*f[1]+BdriftY[0]*f[0])*dfac_m*dfac_v*dfac_y*m_*wv2+2.0*(BdriftY[1]*f[6]+BdriftY[0]*f[3])*dfac_m*dfac_y*m_*wv+3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[1]*f[1]*wm+BmagInv[0]*f[0]*Bmag[1]*wm+BmagInv[1]*Phi[3]*f[5]*q_+BmagInv[0]*f[2]*Phi[3]*q_+BmagInv[1]*Phi[1]*f[1]*q_+BmagInv[0]*f[0]*Phi[1]*q_)+1.732050807568877*Bmag[1]*(BmagInv[1]*f[8]+BmagInv[0]*f[4])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[3] += -(0.25*(3.0*dfac_m*dfac_v*dfac_x*(BdriftX[1]*Bmag[1]*f[1]*wm+BdriftX[0]*f[0]*Bmag[1]*wm+BdriftX[1]*Phi[3]*f[5]*q_+BdriftX[0]*f[2]*Phi[3]*q_+BdriftX[1]*Phi[1]*f[1]*q_+BdriftX[0]*f[0]*Phi[1]*q_)*wv+3.0*(BdriftY[0]*f[1]*Phi[3]+f[0]*BdriftY[1]*Phi[3]+BdriftY[1]*f[1]*Phi[2]+BdriftY[0]*f[0]*Phi[2])*dfac_m*dfac_v*dfac_y*q_*wv+1.732050807568877*Bmag[1]*(BdriftX[1]*f[8]+BdriftX[0]*f[4])*dfac_v*dfac_x*wv+1.732050807568877*dfac_m*dfac_x*(BdriftX[1]*Bmag[1]*f[6]*wm+BdriftX[0]*Bmag[1]*f[3]*wm+BdriftX[1]*Phi[3]*f[11]*q_+BdriftX[0]*Phi[3]*f[7]*q_+BdriftX[1]*Phi[1]*f[6]*q_+BdriftX[0]*Phi[1]*f[3]*q_)+1.732050807568877*(BdriftY[0]*Phi[3]*f[6]+BdriftY[1]*Phi[2]*f[6]+BdriftY[1]*Phi[3]*f[3]+BdriftY[0]*Phi[2]*f[3])*dfac_m*dfac_y*q_+Bmag[1]*(BdriftX[1]*f[13]+BdriftX[0]*f[10])*dfac_x))/(dfac_m*q_); 
  out[5] += (0.25*(3.464101615137754*(BdriftY[0]*f[1]+f[0]*BdriftY[1])*dfac_m*dfac_v*dfac_y*m_*wv2+3.464101615137754*(BdriftX[1]*f[5]+BdriftX[0]*f[2])*dfac_m*dfac_v*dfac_x*m_*wv2+2.0*(BdriftY[0]*f[6]+BdriftY[1]*f[3])*dfac_m*dfac_y*m_*wv+2.0*(BdriftX[1]*f[11]+BdriftX[0]*f[7])*dfac_m*dfac_x*m_*wv+3.0*dfac_m*dfac_v*dfac_x*dfac_y*(BmagInv[0]*Bmag[1]*f[1]*wm+f[0]*Bmag[1]*BmagInv[1]*wm-1.0*BmagInv[1]*Phi[2]*f[5]*q_-1.0*BmagInv[0]*Phi[2]*f[2]*q_+BmagInv[0]*Phi[1]*f[1]*q_+f[0]*BmagInv[1]*Phi[1]*q_)+1.732050807568877*Bmag[1]*(BmagInv[0]*f[8]+BmagInv[1]*f[4])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[6] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_x*(2.0*BdriftX[1]*f[6]*m_*wv2+2.0*BdriftX[0]*f[3]*m_*wv2-1.0*BdriftX[0]*Bmag[1]*f[6]*wm-1.0*BdriftX[1]*Bmag[1]*f[3]*wm-1.0*BdriftX[0]*Phi[3]*f[11]*q_-1.0*BdriftX[1]*Phi[3]*f[7]*q_-1.0*BdriftX[0]*Phi[1]*f[6]*q_-1.0*BdriftX[1]*Phi[1]*f[3]*q_)-15.0*dfac_m*dfac_v2*dfac_x*(BdriftX[0]*Bmag[1]*f[1]*wm+f[0]*BdriftX[1]*Bmag[1]*wm+BdriftX[0]*Phi[3]*f[5]*q_+BdriftX[1]*f[2]*Phi[3]*q_+BdriftX[0]*Phi[1]*f[1]*q_+f[0]*BdriftX[1]*Phi[1]*q_)*wv-3.0*(9.0*BdriftY[1]*f[1]*Phi[3]+5.0*BdriftY[0]*f[0]*Phi[3]+5.0*BdriftY[0]*f[1]*Phi[2]+5.0*f[0]*BdriftY[1]*Phi[2])*dfac_m*dfac_v2*dfac_y*q_*wv+10.0*(BdriftX[1]*f[1]+BdriftX[0]*f[0])*dfac_m*dfac_x*m_*wv-8.660254037844386*Bmag[1]*(BdriftX[0]*f[8]+BdriftX[1]*f[4])*dfac_v2*dfac_x*wv-15.0*(BmagInv[0]*Phi[3]*f[6]+BmagInv[1]*Phi[2]*f[6]+BmagInv[1]*Phi[3]*f[3]+BmagInv[0]*Phi[2]*f[3])*dfac_m*dfac_v*dfac_x*dfac_y*q_-1.732050807568877*(9.0*BdriftY[1]*Phi[3]*f[6]+5.0*BdriftY[0]*Phi[2]*f[6]+5.0*BdriftY[0]*Phi[3]*f[3]+5.0*BdriftY[1]*Phi[2]*f[3])*dfac_m*dfac_v*dfac_y*q_-5.0*Bmag[1]*(BdriftX[0]*f[13]+BdriftX[1]*f[10])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  out[7] += (0.25*(1.732050807568877*dfac_m*dfac_v*dfac_y*(2.0*BdriftY[1]*f[6]*m_*wv2+2.0*BdriftY[0]*f[3]*m_*wv2-1.0*BdriftY[0]*Phi[3]*f[11]*q_-1.0*BdriftY[1]*Phi[2]*f[11]*q_-1.0*BdriftY[1]*Phi[3]*f[7]*q_-1.0*BdriftY[0]*Phi[2]*f[7]*q_)-3.0*dfac_m*dfac_v2*dfac_x*(BdriftX[1]*Bmag[1]*f[5]*wm+BdriftX[0]*Bmag[1]*f[2]*wm+BdriftX[1]*Phi[1]*f[5]*q_+BdriftX[1]*f[1]*Phi[3]*q_+BdriftX[0]*f[0]*Phi[3]*q_+BdriftX[0]*Phi[1]*f[2]*q_)*wv-3.0*(BdriftY[0]*Phi[3]*f[5]+BdriftY[1]*Phi[2]*f[5]+BdriftY[1]*f[2]*Phi[3]+BdriftY[0]*Phi[2]*f[2])*dfac_m*dfac_v2*dfac_y*q_*wv+2.0*(BdriftY[1]*f[1]+BdriftY[0]*f[0])*dfac_m*dfac_y*m_*wv-1.732050807568877*Bmag[1]*(BdriftX[1]*f[12]+BdriftX[0]*f[9])*dfac_v2*dfac_x*wv-1.732050807568877*dfac_m*dfac_v*dfac_x*(BdriftX[1]*Bmag[1]*f[11]*wm+BdriftX[0]*Bmag[1]*f[7]*wm+BdriftX[1]*Phi[1]*f[11]*q_+BdriftX[0]*Phi[1]*f[7]*q_+BdriftX[1]*Phi[3]*f[6]*q_+BdriftX[0]*Phi[3]*f[3]*q_)+3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[1]*f[6]*wm+BmagInv[0]*Bmag[1]*f[3]*wm+BmagInv[1]*Phi[3]*f[11]*q_+BmagInv[0]*Phi[3]*f[7]*q_+BmagInv[1]*Phi[1]*f[6]*q_+BmagInv[0]*Phi[1]*f[3]*q_)+1.732050807568877*Bmag[1]*(BmagInv[1]*f[13]+BmagInv[0]*f[10])*dfac_v*dfac_x*dfac_y-1.0*Bmag[1]*(BdriftX[1]*f[15]+BdriftX[0]*f[14])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  out[8] += (0.25*(3.464101615137754*(BdriftX[1]*f[8]+BdriftX[0]*f[4])*dfac_v*dfac_x*m_*wv2+2.0*(BdriftX[1]*f[13]+BdriftX[0]*f[10])*dfac_x*m_*wv-3.0*(BmagInv[0]*Phi[3]*f[8]+BmagInv[1]*Phi[2]*f[8]+BmagInv[1]*Phi[3]*f[4]+BmagInv[0]*Phi[2]*f[4])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[9] += (0.25*(3.464101615137754*(BdriftY[1]*f[8]+BdriftY[0]*f[4])*dfac_m*dfac_v*dfac_y*m_*wv2+2.0*(BdriftY[1]*f[13]+BdriftY[0]*f[10])*dfac_m*dfac_y*m_*wv+3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[1]*f[8]*wm+BmagInv[0]*Bmag[1]*f[4]*wm+BmagInv[1]*Phi[3]*f[12]*q_+BmagInv[0]*Phi[3]*f[9]*q_+BmagInv[1]*Phi[1]*f[8]*q_+BmagInv[0]*Phi[1]*f[4]*q_)+1.732050807568877*Bmag[1]*(BmagInv[1]*f[1]+BmagInv[0]*f[0])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[10] += -(0.25*(3.0*dfac_m*dfac_v*dfac_x*(BdriftX[1]*Bmag[1]*f[8]*wm+BdriftX[0]*Bmag[1]*f[4]*wm+BdriftX[1]*Phi[3]*f[12]*q_+BdriftX[0]*Phi[3]*f[9]*q_+BdriftX[1]*Phi[1]*f[8]*q_+BdriftX[0]*Phi[1]*f[4]*q_)*wv+3.0*(BdriftY[0]*Phi[3]*f[8]+BdriftY[1]*Phi[2]*f[8]+BdriftY[1]*Phi[3]*f[4]+BdriftY[0]*Phi[2]*f[4])*dfac_m*dfac_v*dfac_y*q_*wv+1.732050807568877*Bmag[1]*(BdriftX[1]*f[1]+BdriftX[0]*f[0])*dfac_v*dfac_x*wv+1.732050807568877*dfac_m*dfac_x*(BdriftX[1]*Bmag[1]*f[13]*wm+BdriftX[0]*Bmag[1]*f[10]*wm+BdriftX[1]*Phi[3]*f[15]*q_+BdriftX[0]*Phi[3]*f[14]*q_+BdriftX[1]*Phi[1]*f[13]*q_+BdriftX[0]*Phi[1]*f[10]*q_)+1.732050807568877*(BdriftY[0]*Phi[3]*f[13]+BdriftY[1]*Phi[2]*f[13]+BdriftY[1]*Phi[3]*f[10]+BdriftY[0]*Phi[2]*f[10])*dfac_m*dfac_y*q_+Bmag[1]*(BdriftX[1]*f[6]+BdriftX[0]*f[3])*dfac_x))/(dfac_m*q_); 
  out[11] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_x*(2.0*BdriftX[1]*f[11]*m_*wv2+2.0*BdriftX[0]*f[7]*m_*wv2-1.0*BdriftX[0]*Bmag[1]*f[11]*wm-1.0*BdriftX[1]*Bmag[1]*f[7]*wm-1.0*BdriftX[0]*Phi[1]*f[11]*q_-1.0*BdriftX[1]*Phi[1]*f[7]*q_-1.0*BdriftX[0]*Phi[3]*f[6]*q_-1.0*BdriftX[1]*Phi[3]*f[3]*q_)+1.732050807568877*dfac_m*dfac_v*dfac_y*(10.0*BdriftY[0]*f[6]*m_*wv2+10.0*BdriftY[1]*f[3]*m_*wv2-9.0*BdriftY[1]*Phi[3]*f[11]*q_-5.0*BdriftY[0]*Phi[2]*f[11]*q_-5.0*BdriftY[0]*Phi[3]*f[7]*q_-5.0*BdriftY[1]*Phi[2]*f[7]*q_)-15.0*dfac_m*dfac_v2*dfac_x*(BdriftX[0]*Bmag[1]*f[5]*wm+BdriftX[1]*Bmag[1]*f[2]*wm+BdriftX[0]*Phi[1]*f[5]*q_+BdriftX[0]*f[1]*Phi[3]*q_+f[0]*BdriftX[1]*Phi[3]*q_+BdriftX[1]*Phi[1]*f[2]*q_)*wv-3.0*(9.0*BdriftY[1]*Phi[3]*f[5]+5.0*BdriftY[0]*Phi[2]*f[5]+5.0*BdriftY[0]*f[2]*Phi[3]+5.0*BdriftY[1]*Phi[2]*f[2])*dfac_m*dfac_v2*dfac_y*q_*wv+10.0*(BdriftY[0]*f[1]+f[0]*BdriftY[1])*dfac_m*dfac_y*m_*wv+10.0*(BdriftX[1]*f[5]+BdriftX[0]*f[2])*dfac_m*dfac_x*m_*wv-8.660254037844386*Bmag[1]*(BdriftX[0]*f[12]+BdriftX[1]*f[9])*dfac_v2*dfac_x*wv+15.0*dfac_m*dfac_v*dfac_x*dfac_y*(BmagInv[0]*Bmag[1]*f[6]*wm+Bmag[1]*BmagInv[1]*f[3]*wm-1.0*BmagInv[1]*Phi[2]*f[11]*q_-1.0*BmagInv[0]*Phi[2]*f[7]*q_+BmagInv[0]*Phi[1]*f[6]*q_+BmagInv[1]*Phi[1]*f[3]*q_)+8.660254037844386*Bmag[1]*(BmagInv[0]*f[13]+BmagInv[1]*f[10])*dfac_v*dfac_x*dfac_y-5.0*Bmag[1]*(BdriftX[0]*f[15]+BdriftX[1]*f[14])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  out[12] += (0.25*(3.464101615137754*(BdriftY[0]*f[8]+BdriftY[1]*f[4])*dfac_m*dfac_v*dfac_y*m_*wv2+3.464101615137754*(BdriftX[1]*f[12]+BdriftX[0]*f[9])*dfac_m*dfac_v*dfac_x*m_*wv2+2.0*(BdriftY[0]*f[13]+BdriftY[1]*f[10])*dfac_m*dfac_y*m_*wv+2.0*(BdriftX[1]*f[15]+BdriftX[0]*f[14])*dfac_m*dfac_x*m_*wv+3.0*dfac_m*dfac_v*dfac_x*dfac_y*(BmagInv[0]*Bmag[1]*f[8]*wm+Bmag[1]*BmagInv[1]*f[4]*wm-1.0*BmagInv[1]*Phi[2]*f[12]*q_-1.0*BmagInv[0]*Phi[2]*f[9]*q_+BmagInv[0]*Phi[1]*f[8]*q_+BmagInv[1]*Phi[1]*f[4]*q_)+1.732050807568877*Bmag[1]*(BmagInv[0]*f[1]+f[0]*BmagInv[1])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[13] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_x*(2.0*BdriftX[1]*f[13]*m_*wv2+2.0*BdriftX[0]*f[10]*m_*wv2-1.0*BdriftX[0]*Bmag[1]*f[13]*wm-1.0*BdriftX[1]*Bmag[1]*f[10]*wm-1.0*BdriftX[0]*Phi[3]*f[15]*q_-1.0*BdriftX[1]*Phi[3]*f[14]*q_-1.0*BdriftX[0]*Phi[1]*f[13]*q_-1.0*BdriftX[1]*Phi[1]*f[10]*q_)-15.0*dfac_m*dfac_v2*dfac_x*(BdriftX[0]*Bmag[1]*f[8]*wm+BdriftX[1]*Bmag[1]*f[4]*wm+BdriftX[0]*Phi[3]*f[12]*q_+BdriftX[1]*Phi[3]*f[9]*q_+BdriftX[0]*Phi[1]*f[8]*q_+BdriftX[1]*Phi[1]*f[4]*q_)*wv-3.0*(9.0*BdriftY[1]*Phi[3]*f[8]+5.0*BdriftY[0]*Phi[2]*f[8]+5.0*BdriftY[0]*Phi[3]*f[4]+5.0*BdriftY[1]*Phi[2]*f[4])*dfac_m*dfac_v2*dfac_y*q_*wv+10.0*(BdriftX[1]*f[8]+BdriftX[0]*f[4])*dfac_m*dfac_x*m_*wv-8.660254037844386*Bmag[1]*(BdriftX[0]*f[1]+f[0]*BdriftX[1])*dfac_v2*dfac_x*wv-15.0*(BmagInv[0]*Phi[3]*f[13]+BmagInv[1]*Phi[2]*f[13]+BmagInv[1]*Phi[3]*f[10]+BmagInv[0]*Phi[2]*f[10])*dfac_m*dfac_v*dfac_x*dfac_y*q_-1.732050807568877*(9.0*BdriftY[1]*Phi[3]*f[13]+5.0*BdriftY[0]*Phi[2]*f[13]+5.0*BdriftY[0]*Phi[3]*f[10]+5.0*BdriftY[1]*Phi[2]*f[10])*dfac_m*dfac_v*dfac_y*q_-5.0*Bmag[1]*(BdriftX[0]*f[6]+BdriftX[1]*f[3])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  out[14] += (0.25*(1.732050807568877*dfac_m*dfac_v*dfac_y*(2.0*BdriftY[1]*f[13]*m_*wv2+2.0*BdriftY[0]*f[10]*m_*wv2-1.0*BdriftY[0]*Phi[3]*f[15]*q_-1.0*BdriftY[1]*Phi[2]*f[15]*q_-1.0*BdriftY[1]*Phi[3]*f[14]*q_-1.0*BdriftY[0]*Phi[2]*f[14]*q_)-3.0*dfac_m*dfac_v2*dfac_x*(BdriftX[1]*Bmag[1]*f[12]*wm+BdriftX[0]*Bmag[1]*f[9]*wm+BdriftX[1]*Phi[1]*f[12]*q_+BdriftX[0]*Phi[1]*f[9]*q_+BdriftX[1]*Phi[3]*f[8]*q_+BdriftX[0]*Phi[3]*f[4]*q_)*wv-3.0*(BdriftY[0]*Phi[3]*f[12]+BdriftY[1]*Phi[2]*f[12]+BdriftY[1]*Phi[3]*f[9]+BdriftY[0]*Phi[2]*f[9])*dfac_m*dfac_v2*dfac_y*q_*wv+2.0*(BdriftY[1]*f[8]+BdriftY[0]*f[4])*dfac_m*dfac_y*m_*wv-1.732050807568877*Bmag[1]*(BdriftX[1]*f[5]+BdriftX[0]*f[2])*dfac_v2*dfac_x*wv-1.732050807568877*dfac_m*dfac_v*dfac_x*(BdriftX[1]*Bmag[1]*f[15]*wm+BdriftX[0]*Bmag[1]*f[14]*wm+BdriftX[1]*Phi[1]*f[15]*q_+BdriftX[0]*Phi[1]*f[14]*q_+BdriftX[1]*Phi[3]*f[13]*q_+BdriftX[0]*Phi[3]*f[10]*q_)+3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[1]*f[13]*wm+BmagInv[0]*Bmag[1]*f[10]*wm+BmagInv[1]*Phi[3]*f[15]*q_+BmagInv[0]*Phi[3]*f[14]*q_+BmagInv[1]*Phi[1]*f[13]*q_+BmagInv[0]*Phi[1]*f[10]*q_)+1.732050807568877*Bmag[1]*(BmagInv[1]*f[6]+BmagInv[0]*f[3])*dfac_v*dfac_x*dfac_y-1.0*Bmag[1]*(BdriftX[1]*f[11]+BdriftX[0]*f[7])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  out[15] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_x*(2.0*BdriftX[1]*f[15]*m_*wv2+2.0*BdriftX[0]*f[14]*m_*wv2-1.0*BdriftX[0]*Bmag[1]*f[15]*wm-1.0*BdriftX[1]*Bmag[1]*f[14]*wm-1.0*BdriftX[0]*Phi[1]*f[15]*q_-1.0*BdriftX[1]*Phi[1]*f[14]*q_-1.0*BdriftX[0]*Phi[3]*f[13]*q_-1.0*BdriftX[1]*Phi[3]*f[10]*q_)+1.732050807568877*dfac_m*dfac_v*dfac_y*(10.0*BdriftY[0]*f[13]*m_*wv2+10.0*BdriftY[1]*f[10]*m_*wv2-9.0*BdriftY[1]*Phi[3]*f[15]*q_-5.0*BdriftY[0]*Phi[2]*f[15]*q_-5.0*BdriftY[0]*Phi[3]*f[14]*q_-5.0*BdriftY[1]*Phi[2]*f[14]*q_)-15.0*dfac_m*dfac_v2*dfac_x*(BdriftX[0]*Bmag[1]*f[12]*wm+BdriftX[1]*Bmag[1]*f[9]*wm+BdriftX[0]*Phi[1]*f[12]*q_+BdriftX[1]*Phi[1]*f[9]*q_+BdriftX[0]*Phi[3]*f[8]*q_+BdriftX[1]*Phi[3]*f[4]*q_)*wv-3.0*(9.0*BdriftY[1]*Phi[3]*f[12]+5.0*BdriftY[0]*Phi[2]*f[12]+5.0*BdriftY[0]*Phi[3]*f[9]+5.0*BdriftY[1]*Phi[2]*f[9])*dfac_m*dfac_v2*dfac_y*q_*wv+10.0*(BdriftY[0]*f[8]+BdriftY[1]*f[4])*dfac_m*dfac_y*m_*wv+10.0*(BdriftX[1]*f[12]+BdriftX[0]*f[9])*dfac_m*dfac_x*m_*wv-8.660254037844386*Bmag[1]*(BdriftX[0]*f[5]+BdriftX[1]*f[2])*dfac_v2*dfac_x*wv+15.0*dfac_m*dfac_v*dfac_x*dfac_y*(BmagInv[0]*Bmag[1]*f[13]*wm+Bmag[1]*BmagInv[1]*f[10]*wm-1.0*BmagInv[1]*Phi[2]*f[15]*q_-1.0*BmagInv[0]*Phi[2]*f[14]*q_+BmagInv[0]*Phi[1]*f[13]*q_+BmagInv[1]*Phi[1]*f[10]*q_)+8.660254037844386*Bmag[1]*(BmagInv[0]*f[6]+BmagInv[1]*f[3])*dfac_v*dfac_x*dfac_y-5.0*Bmag[1]*(BdriftX[0]*f[11]+BdriftX[1]*f[7])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  double cflFreq = 0.0; 
  cflFreq += fabs(0.5*Bmag[0]*((0.5*BdriftX[0]*m_*wv2)/q_-0.4330127018922193*BmagInv[0]*Phi[2]*dfac_y))*dxInv; 
  cflFreq += fabs(0.5*Bmag[0]*((0.5*BdriftY[0]*m_*wv2)/q_+(0.2165063509461096*BmagInv[0]*dfac_x*(2.0*Bmag[1]*wm+2.0*Phi[1]*q_))/q_))*dyInv; 
  cflFreq += fabs((0.5*Bmag[0]*((-(0.2165063509461096*BdriftX[0]*dfac_x*m_*(2.0*Bmag[1]*wm+2.0*Phi[1]*q_)*wv)/q_)-0.4330127018922193*BdriftY[0]*Phi[2]*dfac_y*m_*wv))/m_)*dvInv; 
  return cflFreq; 
} 
double GyrokineticVol2x2vSerP1_Bvars_2(const double q_, const double m_, const double *w, const double *dxv, const double *Bmag, const double *BmagInv, const double *BdriftX, const double *BdriftY, const double *Phi, const double *f, double *out) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dxInv = 1.0/dxv[0]; 
  double dyInv = 1.0/dxv[1]; 
  double dvInv = 1.0/dxv[2]; 
  double dmInv = 1.0/dxv[3]; 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double m2 = m_*m_; 
  out[1] += (0.25*(3.464101615137754*(BdriftX[2]*f[2]+BdriftX[0]*f[0])*dfac_m*dfac_v*dfac_x*m_*wv2+2.0*(BdriftX[2]*f[7]+BdriftX[0]*f[3])*dfac_m*dfac_x*m_*wv-3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[2]*BmagInv[2]*f[2]*wm+BmagInv[0]*f[0]*Bmag[2]*wm+BmagInv[2]*Phi[3]*f[5]*q_+BmagInv[0]*f[1]*Phi[3]*q_+BmagInv[2]*Phi[2]*f[2]*q_+BmagInv[0]*f[0]*Phi[2]*q_)-1.732050807568877*Bmag[2]*(BmagInv[2]*f[9]+BmagInv[0]*f[4])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[2] += (0.25*(3.464101615137754*(BdriftY[2]*f[2]+BdriftY[0]*f[0])*dfac_v*dfac_y*m_*wv2+2.0*(BdriftY[2]*f[7]+BdriftY[0]*f[3])*dfac_y*m_*wv+3.0*(BmagInv[0]*f[2]*Phi[3]+f[0]*BmagInv[2]*Phi[3]+Phi[1]*BmagInv[2]*f[2]+BmagInv[0]*f[0]*Phi[1])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[3] += -(0.25*(3.0*dfac_m*dfac_v*dfac_y*(BdriftY[2]*Bmag[2]*f[2]*wm+BdriftY[0]*f[0]*Bmag[2]*wm+BdriftY[2]*Phi[3]*f[5]*q_+BdriftY[0]*f[1]*Phi[3]*q_+BdriftY[2]*Phi[2]*f[2]*q_+BdriftY[0]*f[0]*Phi[2]*q_)*wv+3.0*(BdriftX[0]*f[2]*Phi[3]+f[0]*BdriftX[2]*Phi[3]+Phi[1]*BdriftX[2]*f[2]+BdriftX[0]*f[0]*Phi[1])*dfac_m*dfac_v*dfac_x*q_*wv+1.732050807568877*Bmag[2]*(BdriftY[2]*f[9]+BdriftY[0]*f[4])*dfac_v*dfac_y*wv+1.732050807568877*dfac_m*dfac_y*(BdriftY[2]*Bmag[2]*f[7]*wm+BdriftY[0]*Bmag[2]*f[3]*wm+BdriftY[2]*Phi[3]*f[11]*q_+BdriftY[2]*Phi[2]*f[7]*q_+BdriftY[0]*Phi[3]*f[6]*q_+BdriftY[0]*Phi[2]*f[3]*q_)+1.732050807568877*(BdriftX[0]*Phi[3]*f[7]+Phi[1]*BdriftX[2]*f[7]+BdriftX[2]*Phi[3]*f[3]+BdriftX[0]*Phi[1]*f[3])*dfac_m*dfac_x*q_+Bmag[2]*(BdriftY[2]*f[14]+BdriftY[0]*f[10])*dfac_y))/(dfac_m*q_); 
  out[5] += (0.25*(3.464101615137754*(BdriftY[2]*f[5]+BdriftY[0]*f[1])*dfac_m*dfac_v*dfac_y*m_*wv2+3.464101615137754*(BdriftX[0]*f[2]+f[0]*BdriftX[2])*dfac_m*dfac_v*dfac_x*m_*wv2+2.0*(BdriftY[2]*f[11]+BdriftY[0]*f[6])*dfac_m*dfac_y*m_*wv+2.0*(BdriftX[0]*f[7]+BdriftX[2]*f[3])*dfac_m*dfac_x*m_*wv-3.0*dfac_m*dfac_v*dfac_x*dfac_y*(BmagInv[0]*Bmag[2]*f[2]*wm+f[0]*Bmag[2]*BmagInv[2]*wm-1.0*Phi[1]*BmagInv[2]*f[5]*q_+BmagInv[0]*Phi[2]*f[2]*q_+f[0]*BmagInv[2]*Phi[2]*q_-1.0*BmagInv[0]*Phi[1]*f[1]*q_)-1.732050807568877*Bmag[2]*(BmagInv[0]*f[9]+BmagInv[2]*f[4])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[6] += (0.25*(1.732050807568877*dfac_m*dfac_v*dfac_x*(2.0*BdriftX[2]*f[7]*m_*wv2+2.0*BdriftX[0]*f[3]*m_*wv2-1.0*BdriftX[0]*Phi[3]*f[11]*q_-1.0*Phi[1]*BdriftX[2]*f[11]*q_-1.0*BdriftX[2]*Phi[3]*f[6]*q_-1.0*BdriftX[0]*Phi[1]*f[6]*q_)-3.0*dfac_m*dfac_v2*dfac_y*(BdriftY[2]*Bmag[2]*f[5]*wm+BdriftY[0]*f[1]*Bmag[2]*wm+BdriftY[2]*Phi[2]*f[5]*q_+BdriftY[2]*f[2]*Phi[3]*q_+BdriftY[0]*f[0]*Phi[3]*q_+BdriftY[0]*f[1]*Phi[2]*q_)*wv-3.0*(BdriftX[0]*Phi[3]*f[5]+Phi[1]*BdriftX[2]*f[5]+f[1]*BdriftX[2]*Phi[3]+BdriftX[0]*Phi[1]*f[1])*dfac_m*dfac_v2*dfac_x*q_*wv+2.0*(BdriftX[2]*f[2]+BdriftX[0]*f[0])*dfac_m*dfac_x*m_*wv-1.732050807568877*Bmag[2]*(BdriftY[2]*f[12]+BdriftY[0]*f[8])*dfac_v2*dfac_y*wv-1.732050807568877*dfac_m*dfac_v*dfac_y*(BdriftY[2]*Bmag[2]*f[11]*wm+BdriftY[0]*Bmag[2]*f[6]*wm+BdriftY[2]*Phi[2]*f[11]*q_+BdriftY[2]*Phi[3]*f[7]*q_+BdriftY[0]*Phi[2]*f[6]*q_+BdriftY[0]*Phi[3]*f[3]*q_)-3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[2]*BmagInv[2]*f[7]*wm+BmagInv[0]*Bmag[2]*f[3]*wm+BmagInv[2]*Phi[3]*f[11]*q_+BmagInv[2]*Phi[2]*f[7]*q_+BmagInv[0]*Phi[3]*f[6]*q_+BmagInv[0]*Phi[2]*f[3]*q_)-1.732050807568877*Bmag[2]*(BmagInv[2]*f[14]+BmagInv[0]*f[10])*dfac_v*dfac_x*dfac_y-1.0*Bmag[2]*(BdriftY[2]*f[15]+BdriftY[0]*f[13])*dfac_v*dfac_y))/(dfac_m*dfac_v*q_); 
  out[7] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_y*(2.0*BdriftY[2]*f[7]*m_*wv2+2.0*BdriftY[0]*f[3]*m_*wv2-1.0*BdriftY[0]*Bmag[2]*f[7]*wm-1.0*BdriftY[2]*Bmag[2]*f[3]*wm-1.0*BdriftY[0]*Phi[3]*f[11]*q_-1.0*BdriftY[0]*Phi[2]*f[7]*q_-1.0*BdriftY[2]*Phi[3]*f[6]*q_-1.0*BdriftY[2]*Phi[2]*f[3]*q_)-15.0*dfac_m*dfac_v2*dfac_y*(BdriftY[0]*Bmag[2]*f[2]*wm+f[0]*BdriftY[2]*Bmag[2]*wm+BdriftY[0]*Phi[3]*f[5]*q_+f[1]*BdriftY[2]*Phi[3]*q_+BdriftY[0]*Phi[2]*f[2]*q_+f[0]*BdriftY[2]*Phi[2]*q_)*wv-3.0*(9.0*BdriftX[2]*f[2]*Phi[3]+5.0*BdriftX[0]*f[0]*Phi[3]+5.0*BdriftX[0]*Phi[1]*f[2]+5.0*f[0]*Phi[1]*BdriftX[2])*dfac_m*dfac_v2*dfac_x*q_*wv+10.0*(BdriftY[2]*f[2]+BdriftY[0]*f[0])*dfac_m*dfac_y*m_*wv-8.660254037844386*Bmag[2]*(BdriftY[0]*f[9]+BdriftY[2]*f[4])*dfac_v2*dfac_y*wv+15.0*(BmagInv[0]*Phi[3]*f[7]+Phi[1]*BmagInv[2]*f[7]+BmagInv[2]*Phi[3]*f[3]+BmagInv[0]*Phi[1]*f[3])*dfac_m*dfac_v*dfac_x*dfac_y*q_-1.732050807568877*(9.0*BdriftX[2]*Phi[3]*f[7]+5.0*BdriftX[0]*Phi[1]*f[7]+5.0*BdriftX[0]*Phi[3]*f[3]+5.0*Phi[1]*BdriftX[2]*f[3])*dfac_m*dfac_v*dfac_x*q_-5.0*Bmag[2]*(BdriftY[0]*f[14]+BdriftY[2]*f[10])*dfac_v*dfac_y))/(dfac_m*dfac_v*q_); 
  out[8] += (0.25*(3.464101615137754*(BdriftX[2]*f[9]+BdriftX[0]*f[4])*dfac_m*dfac_v*dfac_x*m_*wv2+2.0*(BdriftX[2]*f[14]+BdriftX[0]*f[10])*dfac_m*dfac_x*m_*wv-3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[2]*BmagInv[2]*f[9]*wm+BmagInv[0]*Bmag[2]*f[4]*wm+BmagInv[2]*Phi[3]*f[12]*q_+BmagInv[2]*Phi[2]*f[9]*q_+BmagInv[0]*Phi[3]*f[8]*q_+BmagInv[0]*Phi[2]*f[4]*q_)-1.732050807568877*Bmag[2]*(BmagInv[2]*f[2]+BmagInv[0]*f[0])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[9] += (0.25*(3.464101615137754*(BdriftY[2]*f[9]+BdriftY[0]*f[4])*dfac_v*dfac_y*m_*wv2+2.0*(BdriftY[2]*f[14]+BdriftY[0]*f[10])*dfac_y*m_*wv+3.0*(BmagInv[0]*Phi[3]*f[9]+Phi[1]*BmagInv[2]*f[9]+BmagInv[2]*Phi[3]*f[4]+BmagInv[0]*Phi[1]*f[4])*dfac_v*dfac_x*dfac_y*q_))/(dfac_v*q_); 
  out[10] += -(0.25*(3.0*dfac_m*dfac_v*dfac_y*(BdriftY[2]*Bmag[2]*f[9]*wm+BdriftY[0]*Bmag[2]*f[4]*wm+BdriftY[2]*Phi[3]*f[12]*q_+BdriftY[2]*Phi[2]*f[9]*q_+BdriftY[0]*Phi[3]*f[8]*q_+BdriftY[0]*Phi[2]*f[4]*q_)*wv+3.0*(BdriftX[0]*Phi[3]*f[9]+Phi[1]*BdriftX[2]*f[9]+BdriftX[2]*Phi[3]*f[4]+BdriftX[0]*Phi[1]*f[4])*dfac_m*dfac_v*dfac_x*q_*wv+1.732050807568877*Bmag[2]*(BdriftY[2]*f[2]+BdriftY[0]*f[0])*dfac_v*dfac_y*wv+1.732050807568877*dfac_m*dfac_y*(BdriftY[2]*Bmag[2]*f[14]*wm+BdriftY[0]*Bmag[2]*f[10]*wm+BdriftY[2]*Phi[3]*f[15]*q_+BdriftY[2]*Phi[2]*f[14]*q_+BdriftY[0]*Phi[3]*f[13]*q_+BdriftY[0]*Phi[2]*f[10]*q_)+1.732050807568877*(BdriftX[0]*Phi[3]*f[14]+Phi[1]*BdriftX[2]*f[14]+BdriftX[2]*Phi[3]*f[10]+BdriftX[0]*Phi[1]*f[10])*dfac_m*dfac_x*q_+Bmag[2]*(BdriftY[2]*f[7]+BdriftY[0]*f[3])*dfac_y))/(dfac_m*q_); 
  out[11] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_y*(2.0*BdriftY[2]*f[11]*m_*wv2+2.0*BdriftY[0]*f[6]*m_*wv2-1.0*BdriftY[0]*Bmag[2]*f[11]*wm-1.0*BdriftY[2]*Bmag[2]*f[6]*wm-1.0*BdriftY[0]*Phi[2]*f[11]*q_-1.0*BdriftY[0]*Phi[3]*f[7]*q_-1.0*BdriftY[2]*Phi[2]*f[6]*q_-1.0*BdriftY[2]*Phi[3]*f[3]*q_)+1.732050807568877*dfac_m*dfac_v*dfac_x*(10.0*BdriftX[0]*f[7]*m_*wv2+10.0*BdriftX[2]*f[3]*m_*wv2-9.0*BdriftX[2]*Phi[3]*f[11]*q_-5.0*BdriftX[0]*Phi[1]*f[11]*q_-5.0*BdriftX[0]*Phi[3]*f[6]*q_-5.0*Phi[1]*BdriftX[2]*f[6]*q_)-15.0*dfac_m*dfac_v2*dfac_y*(BdriftY[0]*Bmag[2]*f[5]*wm+f[1]*BdriftY[2]*Bmag[2]*wm+BdriftY[0]*Phi[2]*f[5]*q_+BdriftY[0]*f[2]*Phi[3]*q_+f[0]*BdriftY[2]*Phi[3]*q_+f[1]*BdriftY[2]*Phi[2]*q_)*wv-3.0*(9.0*BdriftX[2]*Phi[3]*f[5]+5.0*BdriftX[0]*Phi[1]*f[5]+5.0*BdriftX[0]*f[1]*Phi[3]+5.0*Phi[1]*f[1]*BdriftX[2])*dfac_m*dfac_v2*dfac_x*q_*wv+10.0*(BdriftY[2]*f[5]+BdriftY[0]*f[1])*dfac_m*dfac_y*m_*wv+10.0*(BdriftX[0]*f[2]+f[0]*BdriftX[2])*dfac_m*dfac_x*m_*wv-8.660254037844386*Bmag[2]*(BdriftY[0]*f[12]+BdriftY[2]*f[8])*dfac_v2*dfac_y*wv-15.0*dfac_m*dfac_v*dfac_x*dfac_y*(BmagInv[0]*Bmag[2]*f[7]*wm+Bmag[2]*BmagInv[2]*f[3]*wm-1.0*Phi[1]*BmagInv[2]*f[11]*q_+BmagInv[0]*Phi[2]*f[7]*q_-1.0*BmagInv[0]*Phi[1]*f[6]*q_+BmagInv[2]*Phi[2]*f[3]*q_)-8.660254037844386*Bmag[2]*(BmagInv[0]*f[14]+BmagInv[2]*f[10])*dfac_v*dfac_x*dfac_y-5.0*Bmag[2]*(BdriftY[0]*f[15]+BdriftY[2]*f[13])*dfac_v*dfac_y))/(dfac_m*dfac_v*q_); 
  out[12] += (0.25*(3.464101615137754*(BdriftY[2]*f[12]+BdriftY[0]*f[8])*dfac_m*dfac_v*dfac_y*m_*wv2+3.464101615137754*(BdriftX[0]*f[9]+BdriftX[2]*f[4])*dfac_m*dfac_v*dfac_x*m_*wv2+2.0*(BdriftY[2]*f[15]+BdriftY[0]*f[13])*dfac_m*dfac_y*m_*wv+2.0*(BdriftX[0]*f[14]+BdriftX[2]*f[10])*dfac_m*dfac_x*m_*wv-3.0*dfac_m*dfac_v*dfac_x*dfac_y*(BmagInv[0]*Bmag[2]*f[9]*wm+Bmag[2]*BmagInv[2]*f[4]*wm-1.0*Phi[1]*BmagInv[2]*f[12]*q_+BmagInv[0]*Phi[2]*f[9]*q_-1.0*BmagInv[0]*Phi[1]*f[8]*q_+BmagInv[2]*Phi[2]*f[4]*q_)-1.732050807568877*Bmag[2]*(BmagInv[0]*f[2]+f[0]*BmagInv[2])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[13] += (0.25*(1.732050807568877*dfac_m*dfac_v*dfac_x*(2.0*BdriftX[2]*f[14]*m_*wv2+2.0*BdriftX[0]*f[10]*m_*wv2-1.0*BdriftX[0]*Phi[3]*f[15]*q_-1.0*Phi[1]*BdriftX[2]*f[15]*q_-1.0*BdriftX[2]*Phi[3]*f[13]*q_-1.0*BdriftX[0]*Phi[1]*f[13]*q_)-3.0*dfac_m*dfac_v2*dfac_y*(BdriftY[2]*Bmag[2]*f[12]*wm+BdriftY[0]*Bmag[2]*f[8]*wm+BdriftY[2]*Phi[2]*f[12]*q_+BdriftY[2]*Phi[3]*f[9]*q_+BdriftY[0]*Phi[2]*f[8]*q_+BdriftY[0]*Phi[3]*f[4]*q_)*wv-3.0*(BdriftX[0]*Phi[3]*f[12]+Phi[1]*BdriftX[2]*f[12]+BdriftX[2]*Phi[3]*f[8]+BdriftX[0]*Phi[1]*f[8])*dfac_m*dfac_v2*dfac_x*q_*wv+2.0*(BdriftX[2]*f[9]+BdriftX[0]*f[4])*dfac_m*dfac_x*m_*wv-1.732050807568877*Bmag[2]*(BdriftY[2]*f[5]+BdriftY[0]*f[1])*dfac_v2*dfac_y*wv-1.732050807568877*dfac_m*dfac_v*dfac_y*(BdriftY[2]*Bmag[2]*f[15]*wm+BdriftY[0]*Bmag[2]*f[13]*wm+BdriftY[2]*Phi[2]*f[15]*q_+BdriftY[2]*Phi[3]*f[14]*q_+BdriftY[0]*Phi[2]*f[13]*q_+BdriftY[0]*Phi[3]*f[10]*q_)-3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[2]*BmagInv[2]*f[14]*wm+BmagInv[0]*Bmag[2]*f[10]*wm+BmagInv[2]*Phi[3]*f[15]*q_+BmagInv[2]*Phi[2]*f[14]*q_+BmagInv[0]*Phi[3]*f[13]*q_+BmagInv[0]*Phi[2]*f[10]*q_)-1.732050807568877*Bmag[2]*(BmagInv[2]*f[7]+BmagInv[0]*f[3])*dfac_v*dfac_x*dfac_y-1.0*Bmag[2]*(BdriftY[2]*f[11]+BdriftY[0]*f[6])*dfac_v*dfac_y))/(dfac_m*dfac_v*q_); 
  out[14] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_y*(2.0*BdriftY[2]*f[14]*m_*wv2+2.0*BdriftY[0]*f[10]*m_*wv2-1.0*BdriftY[0]*Bmag[2]*f[14]*wm-1.0*BdriftY[2]*Bmag[2]*f[10]*wm-1.0*BdriftY[0]*Phi[3]*f[15]*q_-1.0*BdriftY[0]*Phi[2]*f[14]*q_-1.0*BdriftY[2]*Phi[3]*f[13]*q_-1.0*BdriftY[2]*Phi[2]*f[10]*q_)-15.0*dfac_m*dfac_v2*dfac_y*(BdriftY[0]*Bmag[2]*f[9]*wm+BdriftY[2]*Bmag[2]*f[4]*wm+BdriftY[0]*Phi[3]*f[12]*q_+BdriftY[0]*Phi[2]*f[9]*q_+BdriftY[2]*Phi[3]*f[8]*q_+BdriftY[2]*Phi[2]*f[4]*q_)*wv-3.0*(9.0*BdriftX[2]*Phi[3]*f[9]+5.0*BdriftX[0]*Phi[1]*f[9]+5.0*BdriftX[0]*Phi[3]*f[4]+5.0*Phi[1]*BdriftX[2]*f[4])*dfac_m*dfac_v2*dfac_x*q_*wv+10.0*(BdriftY[2]*f[9]+BdriftY[0]*f[4])*dfac_m*dfac_y*m_*wv-8.660254037844386*Bmag[2]*(BdriftY[0]*f[2]+f[0]*BdriftY[2])*dfac_v2*dfac_y*wv+15.0*(BmagInv[0]*Phi[3]*f[14]+Phi[1]*BmagInv[2]*f[14]+BmagInv[2]*Phi[3]*f[10]+BmagInv[0]*Phi[1]*f[10])*dfac_m*dfac_v*dfac_x*dfac_y*q_-1.732050807568877*(9.0*BdriftX[2]*Phi[3]*f[14]+5.0*BdriftX[0]*Phi[1]*f[14]+5.0*BdriftX[0]*Phi[3]*f[10]+5.0*Phi[1]*BdriftX[2]*f[10])*dfac_m*dfac_v*dfac_x*q_-5.0*Bmag[2]*(BdriftY[0]*f[7]+BdriftY[2]*f[3])*dfac_v*dfac_y))/(dfac_m*dfac_v*q_); 
  out[15] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_y*(2.0*BdriftY[2]*f[15]*m_*wv2+2.0*BdriftY[0]*f[13]*m_*wv2-1.0*BdriftY[0]*Bmag[2]*f[15]*wm-1.0*BdriftY[2]*Bmag[2]*f[13]*wm-1.0*BdriftY[0]*Phi[2]*f[15]*q_-1.0*BdriftY[0]*Phi[3]*f[14]*q_-1.0*BdriftY[2]*Phi[2]*f[13]*q_-1.0*BdriftY[2]*Phi[3]*f[10]*q_)+1.732050807568877*dfac_m*dfac_v*dfac_x*(10.0*BdriftX[0]*f[14]*m_*wv2+10.0*BdriftX[2]*f[10]*m_*wv2-9.0*BdriftX[2]*Phi[3]*f[15]*q_-5.0*BdriftX[0]*Phi[1]*f[15]*q_-5.0*BdriftX[0]*Phi[3]*f[13]*q_-5.0*Phi[1]*BdriftX[2]*f[13]*q_)-15.0*dfac_m*dfac_v2*dfac_y*(BdriftY[0]*Bmag[2]*f[12]*wm+BdriftY[2]*Bmag[2]*f[8]*wm+BdriftY[0]*Phi[2]*f[12]*q_+BdriftY[0]*Phi[3]*f[9]*q_+BdriftY[2]*Phi[2]*f[8]*q_+BdriftY[2]*Phi[3]*f[4]*q_)*wv-3.0*(9.0*BdriftX[2]*Phi[3]*f[12]+5.0*BdriftX[0]*Phi[1]*f[12]+5.0*BdriftX[0]*Phi[3]*f[8]+5.0*Phi[1]*BdriftX[2]*f[8])*dfac_m*dfac_v2*dfac_x*q_*wv+10.0*(BdriftY[2]*f[12]+BdriftY[0]*f[8])*dfac_m*dfac_y*m_*wv+10.0*(BdriftX[0]*f[9]+BdriftX[2]*f[4])*dfac_m*dfac_x*m_*wv-8.660254037844386*Bmag[2]*(BdriftY[0]*f[5]+f[1]*BdriftY[2])*dfac_v2*dfac_y*wv-15.0*dfac_m*dfac_v*dfac_x*dfac_y*(BmagInv[0]*Bmag[2]*f[14]*wm+Bmag[2]*BmagInv[2]*f[10]*wm-1.0*Phi[1]*BmagInv[2]*f[15]*q_+BmagInv[0]*Phi[2]*f[14]*q_-1.0*BmagInv[0]*Phi[1]*f[13]*q_+BmagInv[2]*Phi[2]*f[10]*q_)-8.660254037844386*Bmag[2]*(BmagInv[0]*f[7]+BmagInv[2]*f[3])*dfac_v*dfac_x*dfac_y-5.0*Bmag[2]*(BdriftY[0]*f[11]+BdriftY[2]*f[6])*dfac_v*dfac_y))/(dfac_m*dfac_v*q_); 
  double cflFreq = 0.0; 
  cflFreq += fabs(0.5*Bmag[0]*((0.5*BdriftX[0]*m_*wv2)/q_-(0.2165063509461096*BmagInv[0]*dfac_y*(2.0*Bmag[2]*wm+2.0*Phi[2]*q_))/q_))*dxInv; 
  cflFreq += fabs(0.5*Bmag[0]*((0.5*BdriftY[0]*m_*wv2)/q_+0.4330127018922193*BmagInv[0]*Phi[1]*dfac_x))*dyInv; 
  cflFreq += fabs((0.5*Bmag[0]*((-(0.2165063509461096*BdriftY[0]*dfac_y*m_*(2.0*Bmag[2]*wm+2.0*Phi[2]*q_)*wv)/q_)-0.4330127018922193*BdriftX[0]*Phi[1]*dfac_x*m_*wv))/m_)*dvInv; 
  return cflFreq; 
} 
double GyrokineticVol2x2vSerP1_Bvars_1_2(const double q_, const double m_, const double *w, const double *dxv, const double *Bmag, const double *BmagInv, const double *BdriftX, const double *BdriftY, const double *Phi, const double *f, double *out) 
{ 
// w[NDIM]: Cell-center coordinates. dxv[NDIM]: Cell spacing. H/f: Input Hamiltonian/distribution function. out: Incremented output 
  double dxInv = 1.0/dxv[0]; 
  double dyInv = 1.0/dxv[1]; 
  double dvInv = 1.0/dxv[2]; 
  double dmInv = 1.0/dxv[3]; 
  double dfac_x = 2.0/dxv[0]; 
  double dfac_y = 2.0/dxv[1]; 
  double dfac_v = 2.0/dxv[2]; 
  double dfac_m = 2.0/dxv[3]; 
  double wx = w[0]; 
  double wy = w[1]; 
  double wv = w[2]; 
  double wm = w[3]; 
  double wv2 = wv*wv; 
  double dfac_v2 = dfac_v*dfac_v; 
  double q2 = q_*q_; 
  double m2 = m_*m_; 
  out[1] += (0.25*(3.464101615137754*(BdriftX[3]*f[5]+BdriftX[2]*f[2]+BdriftX[1]*f[1]+BdriftX[0]*f[0])*dfac_m*dfac_v*dfac_x*m_*wv2+2.0*(BdriftX[3]*f[11]+BdriftX[2]*f[7]+BdriftX[1]*f[6]+BdriftX[0]*f[3])*dfac_m*dfac_x*m_*wv-3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[2]*BmagInv[3]*f[5]*wm+BmagInv[2]*Bmag[3]*f[5]*wm+f[2]*Bmag[3]*BmagInv[3]*wm+BmagInv[0]*f[1]*Bmag[3]*wm+f[0]*BmagInv[1]*Bmag[3]*wm+Bmag[2]*BmagInv[2]*f[2]*wm+BmagInv[1]*f[1]*Bmag[2]*wm+BmagInv[0]*f[0]*Bmag[2]*wm+BmagInv[2]*Phi[3]*f[5]*q_+Phi[2]*BmagInv[3]*f[5]*q_+f[2]*BmagInv[3]*Phi[3]*q_+BmagInv[0]*f[1]*Phi[3]*q_+f[0]*BmagInv[1]*Phi[3]*q_+BmagInv[2]*Phi[2]*f[2]*q_+BmagInv[1]*f[1]*Phi[2]*q_+BmagInv[0]*f[0]*Phi[2]*q_)-1.732050807568877*(Bmag[2]*BmagInv[3]*f[12]+BmagInv[2]*Bmag[3]*f[12]+Bmag[3]*BmagInv[3]*f[9]+Bmag[2]*BmagInv[2]*f[9]+BmagInv[0]*Bmag[3]*f[8]+BmagInv[1]*Bmag[2]*f[8]+BmagInv[1]*Bmag[3]*f[4]+BmagInv[0]*Bmag[2]*f[4])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[2] += (0.25*(3.464101615137754*(BdriftY[3]*f[5]+BdriftY[2]*f[2]+BdriftY[1]*f[1]+BdriftY[0]*f[0])*dfac_m*dfac_v*dfac_y*m_*wv2+2.0*(BdriftY[3]*f[11]+BdriftY[2]*f[7]+BdriftY[1]*f[6]+BdriftY[0]*f[3])*dfac_m*dfac_y*m_*wv+3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[3]*f[5]*wm+BmagInv[1]*Bmag[3]*f[5]*wm+f[1]*Bmag[3]*BmagInv[3]*wm+BmagInv[0]*f[2]*Bmag[3]*wm+f[0]*BmagInv[2]*Bmag[3]*wm+Bmag[1]*BmagInv[2]*f[2]*wm+Bmag[1]*BmagInv[1]*f[1]*wm+BmagInv[0]*f[0]*Bmag[1]*wm+BmagInv[1]*Phi[3]*f[5]*q_+Phi[1]*BmagInv[3]*f[5]*q_+f[1]*BmagInv[3]*Phi[3]*q_+BmagInv[0]*f[2]*Phi[3]*q_+f[0]*BmagInv[2]*Phi[3]*q_+Phi[1]*BmagInv[2]*f[2]*q_+BmagInv[1]*Phi[1]*f[1]*q_+BmagInv[0]*f[0]*Phi[1]*q_)+1.732050807568877*(Bmag[1]*BmagInv[3]*f[12]+BmagInv[1]*Bmag[3]*f[12]+BmagInv[0]*Bmag[3]*f[9]+Bmag[1]*BmagInv[2]*f[9]+Bmag[3]*BmagInv[3]*f[8]+Bmag[1]*BmagInv[1]*f[8]+BmagInv[2]*Bmag[3]*f[4]+BmagInv[0]*Bmag[1]*f[4])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[3] += -(0.25*(3.0*dfac_m*dfac_v*dfac_y*(BdriftY[2]*Bmag[3]*f[5]*wm+Bmag[2]*BdriftY[3]*f[5]*wm+f[2]*BdriftY[3]*Bmag[3]*wm+BdriftY[0]*f[1]*Bmag[3]*wm+f[0]*BdriftY[1]*Bmag[3]*wm+BdriftY[2]*Bmag[2]*f[2]*wm+BdriftY[1]*f[1]*Bmag[2]*wm+BdriftY[0]*f[0]*Bmag[2]*wm+BdriftY[2]*Phi[3]*f[5]*q_+Phi[2]*BdriftY[3]*f[5]*q_+f[2]*BdriftY[3]*Phi[3]*q_+BdriftY[0]*f[1]*Phi[3]*q_+f[0]*BdriftY[1]*Phi[3]*q_+BdriftY[2]*Phi[2]*f[2]*q_+BdriftY[1]*f[1]*Phi[2]*q_+BdriftY[0]*f[0]*Phi[2]*q_)*wv+3.0*dfac_m*dfac_v*dfac_x*(BdriftX[1]*Bmag[3]*f[5]*wm+Bmag[1]*BdriftX[3]*f[5]*wm+f[1]*BdriftX[3]*Bmag[3]*wm+BdriftX[0]*f[2]*Bmag[3]*wm+f[0]*BdriftX[2]*Bmag[3]*wm+Bmag[1]*BdriftX[2]*f[2]*wm+BdriftX[1]*Bmag[1]*f[1]*wm+BdriftX[0]*f[0]*Bmag[1]*wm+BdriftX[1]*Phi[3]*f[5]*q_+Phi[1]*BdriftX[3]*f[5]*q_+f[1]*BdriftX[3]*Phi[3]*q_+BdriftX[0]*f[2]*Phi[3]*q_+f[0]*BdriftX[2]*Phi[3]*q_+Phi[1]*BdriftX[2]*f[2]*q_+BdriftX[1]*Phi[1]*f[1]*q_+BdriftX[0]*f[0]*Phi[1]*q_)*wv+1.732050807568877*(BdriftY[2]*Bmag[3]*f[12]+Bmag[2]*BdriftY[3]*f[12]+BdriftY[3]*Bmag[3]*f[9]+BdriftY[2]*Bmag[2]*f[9]+BdriftY[0]*Bmag[3]*f[8]+BdriftY[1]*Bmag[2]*f[8]+BdriftY[1]*Bmag[3]*f[4]+BdriftY[0]*Bmag[2]*f[4])*dfac_v*dfac_y*wv+1.732050807568877*(BdriftX[1]*Bmag[3]*f[12]+Bmag[1]*BdriftX[3]*f[12]+BdriftX[0]*Bmag[3]*f[9]+Bmag[1]*BdriftX[2]*f[9]+BdriftX[3]*Bmag[3]*f[8]+BdriftX[1]*Bmag[1]*f[8]+BdriftX[2]*Bmag[3]*f[4]+BdriftX[0]*Bmag[1]*f[4])*dfac_v*dfac_x*wv+1.732050807568877*dfac_m*dfac_y*(BdriftY[2]*Bmag[3]*f[11]*wm+Bmag[2]*BdriftY[3]*f[11]*wm+BdriftY[3]*Bmag[3]*f[7]*wm+BdriftY[2]*Bmag[2]*f[7]*wm+BdriftY[0]*Bmag[3]*f[6]*wm+BdriftY[1]*Bmag[2]*f[6]*wm+BdriftY[1]*Bmag[3]*f[3]*wm+BdriftY[0]*Bmag[2]*f[3]*wm+BdriftY[2]*Phi[3]*f[11]*q_+Phi[2]*BdriftY[3]*f[11]*q_+BdriftY[3]*Phi[3]*f[7]*q_+BdriftY[2]*Phi[2]*f[7]*q_+BdriftY[0]*Phi[3]*f[6]*q_+BdriftY[1]*Phi[2]*f[6]*q_+BdriftY[1]*Phi[3]*f[3]*q_+BdriftY[0]*Phi[2]*f[3]*q_)+1.732050807568877*dfac_m*dfac_x*(BdriftX[1]*Bmag[3]*f[11]*wm+Bmag[1]*BdriftX[3]*f[11]*wm+BdriftX[0]*Bmag[3]*f[7]*wm+Bmag[1]*BdriftX[2]*f[7]*wm+BdriftX[3]*Bmag[3]*f[6]*wm+BdriftX[1]*Bmag[1]*f[6]*wm+BdriftX[2]*Bmag[3]*f[3]*wm+BdriftX[0]*Bmag[1]*f[3]*wm+BdriftX[1]*Phi[3]*f[11]*q_+Phi[1]*BdriftX[3]*f[11]*q_+BdriftX[0]*Phi[3]*f[7]*q_+Phi[1]*BdriftX[2]*f[7]*q_+BdriftX[3]*Phi[3]*f[6]*q_+BdriftX[1]*Phi[1]*f[6]*q_+BdriftX[2]*Phi[3]*f[3]*q_+BdriftX[0]*Phi[1]*f[3]*q_)+(BdriftY[2]*Bmag[3]*f[15]+Bmag[2]*BdriftY[3]*f[15]+BdriftY[3]*Bmag[3]*f[14]+BdriftY[2]*Bmag[2]*f[14]+BdriftY[0]*Bmag[3]*f[13]+BdriftY[1]*Bmag[2]*f[13]+BdriftY[1]*Bmag[3]*f[10]+BdriftY[0]*Bmag[2]*f[10])*dfac_y+(BdriftX[1]*Bmag[3]*f[15]+Bmag[1]*BdriftX[3]*f[15]+BdriftX[0]*Bmag[3]*f[14]+Bmag[1]*BdriftX[2]*f[14]+BdriftX[3]*Bmag[3]*f[13]+BdriftX[1]*Bmag[1]*f[13]+BdriftX[2]*Bmag[3]*f[10]+BdriftX[0]*Bmag[1]*f[10])*dfac_x))/(dfac_m*q_); 
  out[5] += (0.25*(3.464101615137754*(BdriftY[2]*f[5]+f[2]*BdriftY[3]+BdriftY[0]*f[1]+f[0]*BdriftY[1])*dfac_m*dfac_v*dfac_y*m_*wv2+3.464101615137754*(BdriftX[1]*f[5]+f[1]*BdriftX[3]+BdriftX[0]*f[2]+f[0]*BdriftX[2])*dfac_m*dfac_v*dfac_x*m_*wv2+2.0*(BdriftY[2]*f[11]+BdriftY[3]*f[7]+BdriftY[0]*f[6]+BdriftY[1]*f[3])*dfac_m*dfac_y*m_*wv+2.0*(BdriftX[1]*f[11]+BdriftX[0]*f[7]+BdriftX[3]*f[6]+BdriftX[2]*f[3])*dfac_m*dfac_x*m_*wv+3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[2]*f[5]*wm-1.0*BmagInv[1]*Bmag[2]*f[5]*wm+Bmag[1]*f[2]*BmagInv[3]*wm-1.0*f[1]*Bmag[2]*BmagInv[3]*wm-1.0*BmagInv[0]*Bmag[2]*f[2]*wm-1.0*f[0]*Bmag[2]*BmagInv[2]*wm+BmagInv[0]*Bmag[1]*f[1]*wm+f[0]*Bmag[1]*BmagInv[1]*wm-1.0*BmagInv[1]*Phi[2]*f[5]*q_+Phi[1]*BmagInv[2]*f[5]*q_+Phi[1]*f[2]*BmagInv[3]*q_-1.0*f[1]*Phi[2]*BmagInv[3]*q_-1.0*BmagInv[0]*Phi[2]*f[2]*q_-1.0*f[0]*BmagInv[2]*Phi[2]*q_+BmagInv[0]*Phi[1]*f[1]*q_+f[0]*BmagInv[1]*Phi[1]*q_)+1.732050807568877*(Bmag[1]*BmagInv[2]*f[12]-1.0*BmagInv[1]*Bmag[2]*f[12]+Bmag[1]*BmagInv[3]*f[9]-1.0*BmagInv[0]*Bmag[2]*f[9]-1.0*Bmag[2]*BmagInv[3]*f[8]+BmagInv[0]*Bmag[1]*f[8]-1.0*Bmag[2]*BmagInv[2]*f[4]+Bmag[1]*BmagInv[1]*f[4])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[6] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_x*(2.0*BdriftX[3]*f[11]*m_*wv2+2.0*BdriftX[2]*f[7]*m_*wv2+2.0*BdriftX[1]*f[6]*m_*wv2+2.0*BdriftX[0]*f[3]*m_*wv2-1.0*BdriftX[0]*Bmag[3]*f[11]*wm-1.0*Bmag[1]*BdriftX[2]*f[11]*wm-1.0*BdriftX[1]*Bmag[3]*f[7]*wm-1.0*Bmag[1]*BdriftX[3]*f[7]*wm-1.0*BdriftX[2]*Bmag[3]*f[6]*wm-1.0*BdriftX[0]*Bmag[1]*f[6]*wm-1.0*BdriftX[3]*Bmag[3]*f[3]*wm-1.0*BdriftX[1]*Bmag[1]*f[3]*wm-1.0*BdriftX[0]*Phi[3]*f[11]*q_-1.0*Phi[1]*BdriftX[2]*f[11]*q_-1.0*BdriftX[1]*Phi[3]*f[7]*q_-1.0*Phi[1]*BdriftX[3]*f[7]*q_-1.0*BdriftX[2]*Phi[3]*f[6]*q_-1.0*BdriftX[0]*Phi[1]*f[6]*q_-1.0*BdriftX[3]*Phi[3]*f[3]*q_-1.0*BdriftX[1]*Phi[1]*f[3]*q_)-3.0*dfac_m*dfac_v2*dfac_y*(9.0*BdriftY[3]*Bmag[3]*f[5]*wm+5.0*BdriftY[2]*Bmag[2]*f[5]*wm+5.0*BdriftY[2]*f[2]*Bmag[3]*wm+9.0*BdriftY[1]*f[1]*Bmag[3]*wm+5.0*BdriftY[0]*f[0]*Bmag[3]*wm+5.0*Bmag[2]*f[2]*BdriftY[3]*wm+5.0*BdriftY[0]*f[1]*Bmag[2]*wm+5.0*f[0]*BdriftY[1]*Bmag[2]*wm+9.0*BdriftY[3]*Phi[3]*f[5]*q_+5.0*BdriftY[2]*Phi[2]*f[5]*q_+5.0*BdriftY[2]*f[2]*Phi[3]*q_+9.0*BdriftY[1]*f[1]*Phi[3]*q_+5.0*BdriftY[0]*f[0]*Phi[3]*q_+5.0*Phi[2]*f[2]*BdriftY[3]*q_+5.0*BdriftY[0]*f[1]*Phi[2]*q_+5.0*f[0]*BdriftY[1]*Phi[2]*q_)*wv-15.0*dfac_m*dfac_v2*dfac_x*(BdriftX[0]*Bmag[3]*f[5]*wm+Bmag[1]*BdriftX[2]*f[5]*wm+f[0]*BdriftX[3]*Bmag[3]*wm+BdriftX[1]*f[2]*Bmag[3]*wm+f[1]*BdriftX[2]*Bmag[3]*wm+Bmag[1]*f[2]*BdriftX[3]*wm+BdriftX[0]*Bmag[1]*f[1]*wm+f[0]*BdriftX[1]*Bmag[1]*wm+BdriftX[0]*Phi[3]*f[5]*q_+Phi[1]*BdriftX[2]*f[5]*q_+f[0]*BdriftX[3]*Phi[3]*q_+BdriftX[1]*f[2]*Phi[3]*q_+f[1]*BdriftX[2]*Phi[3]*q_+Phi[1]*f[2]*BdriftX[3]*q_+BdriftX[0]*Phi[1]*f[1]*q_+f[0]*BdriftX[1]*Phi[1]*q_)*wv+10.0*(BdriftX[3]*f[5]+BdriftX[2]*f[2]+BdriftX[1]*f[1]+BdriftX[0]*f[0])*dfac_m*dfac_x*m_*wv-1.732050807568877*(9.0*BdriftY[3]*Bmag[3]*f[12]+5.0*BdriftY[2]*Bmag[2]*f[12]+5.0*BdriftY[2]*Bmag[3]*f[9]+5.0*Bmag[2]*BdriftY[3]*f[9]+9.0*BdriftY[1]*Bmag[3]*f[8]+5.0*BdriftY[0]*Bmag[2]*f[8]+5.0*BdriftY[0]*Bmag[3]*f[4]+5.0*BdriftY[1]*Bmag[2]*f[4])*dfac_v2*dfac_y*wv-8.660254037844386*(BdriftX[0]*Bmag[3]*f[12]+Bmag[1]*BdriftX[2]*f[12]+BdriftX[1]*Bmag[3]*f[9]+Bmag[1]*BdriftX[3]*f[9]+BdriftX[2]*Bmag[3]*f[8]+BdriftX[0]*Bmag[1]*f[8]+BdriftX[3]*Bmag[3]*f[4]+BdriftX[1]*Bmag[1]*f[4])*dfac_v2*dfac_x*wv-15.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[2]*BmagInv[3]*f[11]*wm+BmagInv[2]*Bmag[3]*f[11]*wm+Bmag[3]*BmagInv[3]*f[7]*wm+Bmag[2]*BmagInv[2]*f[7]*wm+BmagInv[0]*Bmag[3]*f[6]*wm+BmagInv[1]*Bmag[2]*f[6]*wm+BmagInv[1]*Bmag[3]*f[3]*wm+BmagInv[0]*Bmag[2]*f[3]*wm+BmagInv[2]*Phi[3]*f[11]*q_+Phi[2]*BmagInv[3]*f[11]*q_+BmagInv[3]*Phi[3]*f[7]*q_+BmagInv[2]*Phi[2]*f[7]*q_+BmagInv[0]*Phi[3]*f[6]*q_+BmagInv[1]*Phi[2]*f[6]*q_+BmagInv[1]*Phi[3]*f[3]*q_+BmagInv[0]*Phi[2]*f[3]*q_)-1.732050807568877*dfac_m*dfac_v*dfac_y*(9.0*BdriftY[3]*Bmag[3]*f[11]*wm+5.0*BdriftY[2]*Bmag[2]*f[11]*wm+5.0*BdriftY[2]*Bmag[3]*f[7]*wm+5.0*Bmag[2]*BdriftY[3]*f[7]*wm+9.0*BdriftY[1]*Bmag[3]*f[6]*wm+5.0*BdriftY[0]*Bmag[2]*f[6]*wm+5.0*BdriftY[0]*Bmag[3]*f[3]*wm+5.0*BdriftY[1]*Bmag[2]*f[3]*wm+9.0*BdriftY[3]*Phi[3]*f[11]*q_+5.0*BdriftY[2]*Phi[2]*f[11]*q_+5.0*BdriftY[2]*Phi[3]*f[7]*q_+5.0*Phi[2]*BdriftY[3]*f[7]*q_+9.0*BdriftY[1]*Phi[3]*f[6]*q_+5.0*BdriftY[0]*Phi[2]*f[6]*q_+5.0*BdriftY[0]*Phi[3]*f[3]*q_+5.0*BdriftY[1]*Phi[2]*f[3]*q_)-8.660254037844386*(Bmag[2]*BmagInv[3]*f[15]+BmagInv[2]*Bmag[3]*f[15]+Bmag[3]*BmagInv[3]*f[14]+Bmag[2]*BmagInv[2]*f[14]+BmagInv[0]*Bmag[3]*f[13]+BmagInv[1]*Bmag[2]*f[13]+BmagInv[1]*Bmag[3]*f[10]+BmagInv[0]*Bmag[2]*f[10])*dfac_v*dfac_x*dfac_y-1.0*(9.0*BdriftY[3]*Bmag[3]*f[15]+5.0*BdriftY[2]*Bmag[2]*f[15]+5.0*BdriftY[2]*Bmag[3]*f[14]+5.0*Bmag[2]*BdriftY[3]*f[14]+9.0*BdriftY[1]*Bmag[3]*f[13]+5.0*BdriftY[0]*Bmag[2]*f[13]+5.0*BdriftY[0]*Bmag[3]*f[10]+5.0*BdriftY[1]*Bmag[2]*f[10])*dfac_v*dfac_y-5.0*(BdriftX[0]*Bmag[3]*f[15]+Bmag[1]*BdriftX[2]*f[15]+BdriftX[1]*Bmag[3]*f[14]+Bmag[1]*BdriftX[3]*f[14]+BdriftX[2]*Bmag[3]*f[13]+BdriftX[0]*Bmag[1]*f[13]+BdriftX[3]*Bmag[3]*f[10]+BdriftX[1]*Bmag[1]*f[10])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  out[7] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_y*(2.0*BdriftY[3]*f[11]*m_*wv2+2.0*BdriftY[2]*f[7]*m_*wv2+2.0*BdriftY[1]*f[6]*m_*wv2+2.0*BdriftY[0]*f[3]*m_*wv2-1.0*BdriftY[0]*Bmag[3]*f[11]*wm-1.0*BdriftY[1]*Bmag[2]*f[11]*wm-1.0*BdriftY[1]*Bmag[3]*f[7]*wm-1.0*BdriftY[0]*Bmag[2]*f[7]*wm-1.0*BdriftY[2]*Bmag[3]*f[6]*wm-1.0*Bmag[2]*BdriftY[3]*f[6]*wm-1.0*BdriftY[3]*Bmag[3]*f[3]*wm-1.0*BdriftY[2]*Bmag[2]*f[3]*wm-1.0*BdriftY[0]*Phi[3]*f[11]*q_-1.0*BdriftY[1]*Phi[2]*f[11]*q_-1.0*BdriftY[1]*Phi[3]*f[7]*q_-1.0*BdriftY[0]*Phi[2]*f[7]*q_-1.0*BdriftY[2]*Phi[3]*f[6]*q_-1.0*Phi[2]*BdriftY[3]*f[6]*q_-1.0*BdriftY[3]*Phi[3]*f[3]*q_-1.0*BdriftY[2]*Phi[2]*f[3]*q_)-3.0*dfac_m*dfac_v2*dfac_x*(9.0*BdriftX[3]*Bmag[3]*f[5]*wm+5.0*BdriftX[1]*Bmag[1]*f[5]*wm+9.0*BdriftX[2]*f[2]*Bmag[3]*wm+5.0*BdriftX[1]*f[1]*Bmag[3]*wm+5.0*BdriftX[0]*f[0]*Bmag[3]*wm+5.0*Bmag[1]*f[1]*BdriftX[3]*wm+5.0*BdriftX[0]*Bmag[1]*f[2]*wm+5.0*f[0]*Bmag[1]*BdriftX[2]*wm+9.0*BdriftX[3]*Phi[3]*f[5]*q_+5.0*BdriftX[1]*Phi[1]*f[5]*q_+9.0*BdriftX[2]*f[2]*Phi[3]*q_+5.0*BdriftX[1]*f[1]*Phi[3]*q_+5.0*BdriftX[0]*f[0]*Phi[3]*q_+5.0*Phi[1]*f[1]*BdriftX[3]*q_+5.0*BdriftX[0]*Phi[1]*f[2]*q_+5.0*f[0]*Phi[1]*BdriftX[2]*q_)*wv-15.0*dfac_m*dfac_v2*dfac_y*(BdriftY[0]*Bmag[3]*f[5]*wm+BdriftY[1]*Bmag[2]*f[5]*wm+f[0]*BdriftY[3]*Bmag[3]*wm+BdriftY[1]*f[2]*Bmag[3]*wm+f[1]*BdriftY[2]*Bmag[3]*wm+f[1]*Bmag[2]*BdriftY[3]*wm+BdriftY[0]*Bmag[2]*f[2]*wm+f[0]*BdriftY[2]*Bmag[2]*wm+BdriftY[0]*Phi[3]*f[5]*q_+BdriftY[1]*Phi[2]*f[5]*q_+f[0]*BdriftY[3]*Phi[3]*q_+BdriftY[1]*f[2]*Phi[3]*q_+f[1]*BdriftY[2]*Phi[3]*q_+f[1]*Phi[2]*BdriftY[3]*q_+BdriftY[0]*Phi[2]*f[2]*q_+f[0]*BdriftY[2]*Phi[2]*q_)*wv+10.0*(BdriftY[3]*f[5]+BdriftY[2]*f[2]+BdriftY[1]*f[1]+BdriftY[0]*f[0])*dfac_m*dfac_y*m_*wv-8.660254037844386*(BdriftY[0]*Bmag[3]*f[12]+BdriftY[1]*Bmag[2]*f[12]+BdriftY[1]*Bmag[3]*f[9]+BdriftY[0]*Bmag[2]*f[9]+BdriftY[2]*Bmag[3]*f[8]+Bmag[2]*BdriftY[3]*f[8]+BdriftY[3]*Bmag[3]*f[4]+BdriftY[2]*Bmag[2]*f[4])*dfac_v2*dfac_y*wv-1.732050807568877*(9.0*BdriftX[3]*Bmag[3]*f[12]+5.0*BdriftX[1]*Bmag[1]*f[12]+9.0*BdriftX[2]*Bmag[3]*f[9]+5.0*BdriftX[0]*Bmag[1]*f[9]+5.0*BdriftX[1]*Bmag[3]*f[8]+5.0*Bmag[1]*BdriftX[3]*f[8]+5.0*BdriftX[0]*Bmag[3]*f[4]+5.0*Bmag[1]*BdriftX[2]*f[4])*dfac_v2*dfac_x*wv+15.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[3]*f[11]*wm+BmagInv[1]*Bmag[3]*f[11]*wm+BmagInv[0]*Bmag[3]*f[7]*wm+Bmag[1]*BmagInv[2]*f[7]*wm+Bmag[3]*BmagInv[3]*f[6]*wm+Bmag[1]*BmagInv[1]*f[6]*wm+BmagInv[2]*Bmag[3]*f[3]*wm+BmagInv[0]*Bmag[1]*f[3]*wm+BmagInv[1]*Phi[3]*f[11]*q_+Phi[1]*BmagInv[3]*f[11]*q_+BmagInv[0]*Phi[3]*f[7]*q_+Phi[1]*BmagInv[2]*f[7]*q_+BmagInv[3]*Phi[3]*f[6]*q_+BmagInv[1]*Phi[1]*f[6]*q_+BmagInv[2]*Phi[3]*f[3]*q_+BmagInv[0]*Phi[1]*f[3]*q_)-1.732050807568877*dfac_m*dfac_v*dfac_x*(9.0*BdriftX[3]*Bmag[3]*f[11]*wm+5.0*BdriftX[1]*Bmag[1]*f[11]*wm+9.0*BdriftX[2]*Bmag[3]*f[7]*wm+5.0*BdriftX[0]*Bmag[1]*f[7]*wm+5.0*BdriftX[1]*Bmag[3]*f[6]*wm+5.0*Bmag[1]*BdriftX[3]*f[6]*wm+5.0*BdriftX[0]*Bmag[3]*f[3]*wm+5.0*Bmag[1]*BdriftX[2]*f[3]*wm+9.0*BdriftX[3]*Phi[3]*f[11]*q_+5.0*BdriftX[1]*Phi[1]*f[11]*q_+9.0*BdriftX[2]*Phi[3]*f[7]*q_+5.0*BdriftX[0]*Phi[1]*f[7]*q_+5.0*BdriftX[1]*Phi[3]*f[6]*q_+5.0*Phi[1]*BdriftX[3]*f[6]*q_+5.0*BdriftX[0]*Phi[3]*f[3]*q_+5.0*Phi[1]*BdriftX[2]*f[3]*q_)+8.660254037844386*(Bmag[1]*BmagInv[3]*f[15]+BmagInv[1]*Bmag[3]*f[15]+BmagInv[0]*Bmag[3]*f[14]+Bmag[1]*BmagInv[2]*f[14]+Bmag[3]*BmagInv[3]*f[13]+Bmag[1]*BmagInv[1]*f[13]+BmagInv[2]*Bmag[3]*f[10]+BmagInv[0]*Bmag[1]*f[10])*dfac_v*dfac_x*dfac_y-5.0*(BdriftY[0]*Bmag[3]*f[15]+BdriftY[1]*Bmag[2]*f[15]+BdriftY[1]*Bmag[3]*f[14]+BdriftY[0]*Bmag[2]*f[14]+BdriftY[2]*Bmag[3]*f[13]+Bmag[2]*BdriftY[3]*f[13]+BdriftY[3]*Bmag[3]*f[10]+BdriftY[2]*Bmag[2]*f[10])*dfac_v*dfac_y-1.0*(9.0*BdriftX[3]*Bmag[3]*f[15]+5.0*BdriftX[1]*Bmag[1]*f[15]+9.0*BdriftX[2]*Bmag[3]*f[14]+5.0*BdriftX[0]*Bmag[1]*f[14]+5.0*BdriftX[1]*Bmag[3]*f[13]+5.0*Bmag[1]*BdriftX[3]*f[13]+5.0*BdriftX[0]*Bmag[3]*f[10]+5.0*Bmag[1]*BdriftX[2]*f[10])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  out[8] += (0.25*(3.464101615137754*(BdriftX[3]*f[12]+BdriftX[2]*f[9]+BdriftX[1]*f[8]+BdriftX[0]*f[4])*dfac_m*dfac_v*dfac_x*m_*wv2+2.0*(BdriftX[3]*f[15]+BdriftX[2]*f[14]+BdriftX[1]*f[13]+BdriftX[0]*f[10])*dfac_m*dfac_x*m_*wv-3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[2]*BmagInv[3]*f[12]*wm+BmagInv[2]*Bmag[3]*f[12]*wm+Bmag[3]*BmagInv[3]*f[9]*wm+Bmag[2]*BmagInv[2]*f[9]*wm+BmagInv[0]*Bmag[3]*f[8]*wm+BmagInv[1]*Bmag[2]*f[8]*wm+BmagInv[1]*Bmag[3]*f[4]*wm+BmagInv[0]*Bmag[2]*f[4]*wm+BmagInv[2]*Phi[3]*f[12]*q_+Phi[2]*BmagInv[3]*f[12]*q_+BmagInv[3]*Phi[3]*f[9]*q_+BmagInv[2]*Phi[2]*f[9]*q_+BmagInv[0]*Phi[3]*f[8]*q_+BmagInv[1]*Phi[2]*f[8]*q_+BmagInv[1]*Phi[3]*f[4]*q_+BmagInv[0]*Phi[2]*f[4]*q_)-1.732050807568877*(Bmag[2]*BmagInv[3]*f[5]+BmagInv[2]*Bmag[3]*f[5]+f[2]*Bmag[3]*BmagInv[3]+BmagInv[0]*f[1]*Bmag[3]+f[0]*BmagInv[1]*Bmag[3]+Bmag[2]*BmagInv[2]*f[2]+BmagInv[1]*f[1]*Bmag[2]+BmagInv[0]*f[0]*Bmag[2])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[9] += (0.25*(3.464101615137754*(BdriftY[3]*f[12]+BdriftY[2]*f[9]+BdriftY[1]*f[8]+BdriftY[0]*f[4])*dfac_m*dfac_v*dfac_y*m_*wv2+2.0*(BdriftY[3]*f[15]+BdriftY[2]*f[14]+BdriftY[1]*f[13]+BdriftY[0]*f[10])*dfac_m*dfac_y*m_*wv+3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[3]*f[12]*wm+BmagInv[1]*Bmag[3]*f[12]*wm+BmagInv[0]*Bmag[3]*f[9]*wm+Bmag[1]*BmagInv[2]*f[9]*wm+Bmag[3]*BmagInv[3]*f[8]*wm+Bmag[1]*BmagInv[1]*f[8]*wm+BmagInv[2]*Bmag[3]*f[4]*wm+BmagInv[0]*Bmag[1]*f[4]*wm+BmagInv[1]*Phi[3]*f[12]*q_+Phi[1]*BmagInv[3]*f[12]*q_+BmagInv[0]*Phi[3]*f[9]*q_+Phi[1]*BmagInv[2]*f[9]*q_+BmagInv[3]*Phi[3]*f[8]*q_+BmagInv[1]*Phi[1]*f[8]*q_+BmagInv[2]*Phi[3]*f[4]*q_+BmagInv[0]*Phi[1]*f[4]*q_)+1.732050807568877*(Bmag[1]*BmagInv[3]*f[5]+BmagInv[1]*Bmag[3]*f[5]+f[1]*Bmag[3]*BmagInv[3]+BmagInv[0]*f[2]*Bmag[3]+f[0]*BmagInv[2]*Bmag[3]+Bmag[1]*BmagInv[2]*f[2]+Bmag[1]*BmagInv[1]*f[1]+BmagInv[0]*f[0]*Bmag[1])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[10] += -(0.25*(3.0*dfac_m*dfac_v*dfac_y*(BdriftY[2]*Bmag[3]*f[12]*wm+Bmag[2]*BdriftY[3]*f[12]*wm+BdriftY[3]*Bmag[3]*f[9]*wm+BdriftY[2]*Bmag[2]*f[9]*wm+BdriftY[0]*Bmag[3]*f[8]*wm+BdriftY[1]*Bmag[2]*f[8]*wm+BdriftY[1]*Bmag[3]*f[4]*wm+BdriftY[0]*Bmag[2]*f[4]*wm+BdriftY[2]*Phi[3]*f[12]*q_+Phi[2]*BdriftY[3]*f[12]*q_+BdriftY[3]*Phi[3]*f[9]*q_+BdriftY[2]*Phi[2]*f[9]*q_+BdriftY[0]*Phi[3]*f[8]*q_+BdriftY[1]*Phi[2]*f[8]*q_+BdriftY[1]*Phi[3]*f[4]*q_+BdriftY[0]*Phi[2]*f[4]*q_)*wv+3.0*dfac_m*dfac_v*dfac_x*(BdriftX[1]*Bmag[3]*f[12]*wm+Bmag[1]*BdriftX[3]*f[12]*wm+BdriftX[0]*Bmag[3]*f[9]*wm+Bmag[1]*BdriftX[2]*f[9]*wm+BdriftX[3]*Bmag[3]*f[8]*wm+BdriftX[1]*Bmag[1]*f[8]*wm+BdriftX[2]*Bmag[3]*f[4]*wm+BdriftX[0]*Bmag[1]*f[4]*wm+BdriftX[1]*Phi[3]*f[12]*q_+Phi[1]*BdriftX[3]*f[12]*q_+BdriftX[0]*Phi[3]*f[9]*q_+Phi[1]*BdriftX[2]*f[9]*q_+BdriftX[3]*Phi[3]*f[8]*q_+BdriftX[1]*Phi[1]*f[8]*q_+BdriftX[2]*Phi[3]*f[4]*q_+BdriftX[0]*Phi[1]*f[4]*q_)*wv+1.732050807568877*(BdriftY[2]*Bmag[3]*f[5]+Bmag[2]*BdriftY[3]*f[5]+f[2]*BdriftY[3]*Bmag[3]+BdriftY[0]*f[1]*Bmag[3]+f[0]*BdriftY[1]*Bmag[3]+BdriftY[2]*Bmag[2]*f[2]+BdriftY[1]*f[1]*Bmag[2]+BdriftY[0]*f[0]*Bmag[2])*dfac_v*dfac_y*wv+1.732050807568877*(BdriftX[1]*Bmag[3]*f[5]+Bmag[1]*BdriftX[3]*f[5]+f[1]*BdriftX[3]*Bmag[3]+BdriftX[0]*f[2]*Bmag[3]+f[0]*BdriftX[2]*Bmag[3]+Bmag[1]*BdriftX[2]*f[2]+BdriftX[1]*Bmag[1]*f[1]+BdriftX[0]*f[0]*Bmag[1])*dfac_v*dfac_x*wv+1.732050807568877*dfac_m*dfac_y*(BdriftY[2]*Bmag[3]*f[15]*wm+Bmag[2]*BdriftY[3]*f[15]*wm+BdriftY[3]*Bmag[3]*f[14]*wm+BdriftY[2]*Bmag[2]*f[14]*wm+BdriftY[0]*Bmag[3]*f[13]*wm+BdriftY[1]*Bmag[2]*f[13]*wm+BdriftY[1]*Bmag[3]*f[10]*wm+BdriftY[0]*Bmag[2]*f[10]*wm+BdriftY[2]*Phi[3]*f[15]*q_+Phi[2]*BdriftY[3]*f[15]*q_+BdriftY[3]*Phi[3]*f[14]*q_+BdriftY[2]*Phi[2]*f[14]*q_+BdriftY[0]*Phi[3]*f[13]*q_+BdriftY[1]*Phi[2]*f[13]*q_+BdriftY[1]*Phi[3]*f[10]*q_+BdriftY[0]*Phi[2]*f[10]*q_)+1.732050807568877*dfac_m*dfac_x*(BdriftX[1]*Bmag[3]*f[15]*wm+Bmag[1]*BdriftX[3]*f[15]*wm+BdriftX[0]*Bmag[3]*f[14]*wm+Bmag[1]*BdriftX[2]*f[14]*wm+BdriftX[3]*Bmag[3]*f[13]*wm+BdriftX[1]*Bmag[1]*f[13]*wm+BdriftX[2]*Bmag[3]*f[10]*wm+BdriftX[0]*Bmag[1]*f[10]*wm+BdriftX[1]*Phi[3]*f[15]*q_+Phi[1]*BdriftX[3]*f[15]*q_+BdriftX[0]*Phi[3]*f[14]*q_+Phi[1]*BdriftX[2]*f[14]*q_+BdriftX[3]*Phi[3]*f[13]*q_+BdriftX[1]*Phi[1]*f[13]*q_+BdriftX[2]*Phi[3]*f[10]*q_+BdriftX[0]*Phi[1]*f[10]*q_)+(BdriftY[2]*Bmag[3]*f[11]+Bmag[2]*BdriftY[3]*f[11]+BdriftY[3]*Bmag[3]*f[7]+BdriftY[2]*Bmag[2]*f[7]+BdriftY[0]*Bmag[3]*f[6]+BdriftY[1]*Bmag[2]*f[6]+BdriftY[1]*Bmag[3]*f[3]+BdriftY[0]*Bmag[2]*f[3])*dfac_y+(BdriftX[1]*Bmag[3]*f[11]+Bmag[1]*BdriftX[3]*f[11]+BdriftX[0]*Bmag[3]*f[7]+Bmag[1]*BdriftX[2]*f[7]+BdriftX[3]*Bmag[3]*f[6]+BdriftX[1]*Bmag[1]*f[6]+BdriftX[2]*Bmag[3]*f[3]+BdriftX[0]*Bmag[1]*f[3])*dfac_x))/(dfac_m*q_); 
  out[11] += (0.05*(1.732050807568877*dfac_m*dfac_v*dfac_y*(10.0*BdriftY[2]*f[11]*m_*wv2+10.0*BdriftY[3]*f[7]*m_*wv2+10.0*BdriftY[0]*f[6]*m_*wv2+10.0*BdriftY[1]*f[3]*m_*wv2-9.0*BdriftY[1]*Bmag[3]*f[11]*wm-5.0*BdriftY[0]*Bmag[2]*f[11]*wm-5.0*BdriftY[0]*Bmag[3]*f[7]*wm-5.0*BdriftY[1]*Bmag[2]*f[7]*wm-9.0*BdriftY[3]*Bmag[3]*f[6]*wm-5.0*BdriftY[2]*Bmag[2]*f[6]*wm-5.0*BdriftY[2]*Bmag[3]*f[3]*wm-5.0*Bmag[2]*BdriftY[3]*f[3]*wm-9.0*BdriftY[1]*Phi[3]*f[11]*q_-5.0*BdriftY[0]*Phi[2]*f[11]*q_-5.0*BdriftY[0]*Phi[3]*f[7]*q_-5.0*BdriftY[1]*Phi[2]*f[7]*q_-9.0*BdriftY[3]*Phi[3]*f[6]*q_-5.0*BdriftY[2]*Phi[2]*f[6]*q_-5.0*BdriftY[2]*Phi[3]*f[3]*q_-5.0*Phi[2]*BdriftY[3]*f[3]*q_)+1.732050807568877*dfac_m*dfac_v*dfac_x*(10.0*BdriftX[1]*f[11]*m_*wv2+10.0*BdriftX[0]*f[7]*m_*wv2+10.0*BdriftX[3]*f[6]*m_*wv2+10.0*BdriftX[2]*f[3]*m_*wv2-9.0*BdriftX[2]*Bmag[3]*f[11]*wm-5.0*BdriftX[0]*Bmag[1]*f[11]*wm-9.0*BdriftX[3]*Bmag[3]*f[7]*wm-5.0*BdriftX[1]*Bmag[1]*f[7]*wm-5.0*BdriftX[0]*Bmag[3]*f[6]*wm-5.0*Bmag[1]*BdriftX[2]*f[6]*wm-5.0*BdriftX[1]*Bmag[3]*f[3]*wm-5.0*Bmag[1]*BdriftX[3]*f[3]*wm-9.0*BdriftX[2]*Phi[3]*f[11]*q_-5.0*BdriftX[0]*Phi[1]*f[11]*q_-9.0*BdriftX[3]*Phi[3]*f[7]*q_-5.0*BdriftX[1]*Phi[1]*f[7]*q_-5.0*BdriftX[0]*Phi[3]*f[6]*q_-5.0*Phi[1]*BdriftX[2]*f[6]*q_-5.0*BdriftX[1]*Phi[3]*f[3]*q_-5.0*Phi[1]*BdriftX[3]*f[3]*q_)-3.0*dfac_m*dfac_v2*dfac_x*(9.0*BdriftX[2]*Bmag[3]*f[5]*wm+5.0*BdriftX[0]*Bmag[1]*f[5]*wm+9.0*f[2]*BdriftX[3]*Bmag[3]*wm+5.0*BdriftX[0]*f[1]*Bmag[3]*wm+5.0*f[0]*BdriftX[1]*Bmag[3]*wm+5.0*f[0]*Bmag[1]*BdriftX[3]*wm+5.0*BdriftX[1]*Bmag[1]*f[2]*wm+5.0*Bmag[1]*f[1]*BdriftX[2]*wm+9.0*BdriftX[2]*Phi[3]*f[5]*q_+5.0*BdriftX[0]*Phi[1]*f[5]*q_+9.0*f[2]*BdriftX[3]*Phi[3]*q_+5.0*BdriftX[0]*f[1]*Phi[3]*q_+5.0*f[0]*BdriftX[1]*Phi[3]*q_+5.0*f[0]*Phi[1]*BdriftX[3]*q_+5.0*BdriftX[1]*Phi[1]*f[2]*q_+5.0*Phi[1]*f[1]*BdriftX[2]*q_)*wv-3.0*dfac_m*dfac_v2*dfac_y*(9.0*BdriftY[1]*Bmag[3]*f[5]*wm+5.0*BdriftY[0]*Bmag[2]*f[5]*wm+9.0*f[1]*BdriftY[3]*Bmag[3]*wm+5.0*BdriftY[0]*f[2]*Bmag[3]*wm+5.0*f[0]*BdriftY[2]*Bmag[3]*wm+5.0*f[0]*Bmag[2]*BdriftY[3]*wm+5.0*BdriftY[1]*Bmag[2]*f[2]*wm+5.0*f[1]*BdriftY[2]*Bmag[2]*wm+9.0*BdriftY[1]*Phi[3]*f[5]*q_+5.0*BdriftY[0]*Phi[2]*f[5]*q_+9.0*f[1]*BdriftY[3]*Phi[3]*q_+5.0*BdriftY[0]*f[2]*Phi[3]*q_+5.0*f[0]*BdriftY[2]*Phi[3]*q_+5.0*f[0]*Phi[2]*BdriftY[3]*q_+5.0*BdriftY[1]*Phi[2]*f[2]*q_+5.0*f[1]*BdriftY[2]*Phi[2]*q_)*wv+10.0*(BdriftY[2]*f[5]+f[2]*BdriftY[3]+BdriftY[0]*f[1]+f[0]*BdriftY[1])*dfac_m*dfac_y*m_*wv+10.0*(BdriftX[1]*f[5]+f[1]*BdriftX[3]+BdriftX[0]*f[2]+f[0]*BdriftX[2])*dfac_m*dfac_x*m_*wv-1.732050807568877*(9.0*BdriftY[1]*Bmag[3]*f[12]+5.0*BdriftY[0]*Bmag[2]*f[12]+5.0*BdriftY[0]*Bmag[3]*f[9]+5.0*BdriftY[1]*Bmag[2]*f[9]+9.0*BdriftY[3]*Bmag[3]*f[8]+5.0*BdriftY[2]*Bmag[2]*f[8]+5.0*BdriftY[2]*Bmag[3]*f[4]+5.0*Bmag[2]*BdriftY[3]*f[4])*dfac_v2*dfac_y*wv-1.732050807568877*(9.0*BdriftX[2]*Bmag[3]*f[12]+5.0*BdriftX[0]*Bmag[1]*f[12]+9.0*BdriftX[3]*Bmag[3]*f[9]+5.0*BdriftX[1]*Bmag[1]*f[9]+5.0*BdriftX[0]*Bmag[3]*f[8]+5.0*Bmag[1]*BdriftX[2]*f[8]+5.0*BdriftX[1]*Bmag[3]*f[4]+5.0*Bmag[1]*BdriftX[3]*f[4])*dfac_v2*dfac_x*wv+15.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[2]*f[11]*wm-1.0*BmagInv[1]*Bmag[2]*f[11]*wm+Bmag[1]*BmagInv[3]*f[7]*wm-1.0*BmagInv[0]*Bmag[2]*f[7]*wm-1.0*Bmag[2]*BmagInv[3]*f[6]*wm+BmagInv[0]*Bmag[1]*f[6]*wm-1.0*Bmag[2]*BmagInv[2]*f[3]*wm+Bmag[1]*BmagInv[1]*f[3]*wm-1.0*BmagInv[1]*Phi[2]*f[11]*q_+Phi[1]*BmagInv[2]*f[11]*q_+Phi[1]*BmagInv[3]*f[7]*q_-1.0*BmagInv[0]*Phi[2]*f[7]*q_-1.0*Phi[2]*BmagInv[3]*f[6]*q_+BmagInv[0]*Phi[1]*f[6]*q_-1.0*BmagInv[2]*Phi[2]*f[3]*q_+BmagInv[1]*Phi[1]*f[3]*q_)+8.660254037844386*(Bmag[1]*BmagInv[2]*f[15]-1.0*BmagInv[1]*Bmag[2]*f[15]+Bmag[1]*BmagInv[3]*f[14]-1.0*BmagInv[0]*Bmag[2]*f[14]-1.0*Bmag[2]*BmagInv[3]*f[13]+BmagInv[0]*Bmag[1]*f[13]-1.0*Bmag[2]*BmagInv[2]*f[10]+Bmag[1]*BmagInv[1]*f[10])*dfac_v*dfac_x*dfac_y-1.0*(9.0*BdriftY[1]*Bmag[3]*f[15]+5.0*BdriftY[0]*Bmag[2]*f[15]+5.0*BdriftY[0]*Bmag[3]*f[14]+5.0*BdriftY[1]*Bmag[2]*f[14]+9.0*BdriftY[3]*Bmag[3]*f[13]+5.0*BdriftY[2]*Bmag[2]*f[13]+5.0*BdriftY[2]*Bmag[3]*f[10]+5.0*Bmag[2]*BdriftY[3]*f[10])*dfac_v*dfac_y-1.0*(9.0*BdriftX[2]*Bmag[3]*f[15]+5.0*BdriftX[0]*Bmag[1]*f[15]+9.0*BdriftX[3]*Bmag[3]*f[14]+5.0*BdriftX[1]*Bmag[1]*f[14]+5.0*BdriftX[0]*Bmag[3]*f[13]+5.0*Bmag[1]*BdriftX[2]*f[13]+5.0*BdriftX[1]*Bmag[3]*f[10]+5.0*Bmag[1]*BdriftX[3]*f[10])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  out[12] += (0.25*(3.464101615137754*(BdriftY[2]*f[12]+BdriftY[3]*f[9]+BdriftY[0]*f[8]+BdriftY[1]*f[4])*dfac_m*dfac_v*dfac_y*m_*wv2+3.464101615137754*(BdriftX[1]*f[12]+BdriftX[0]*f[9]+BdriftX[3]*f[8]+BdriftX[2]*f[4])*dfac_m*dfac_v*dfac_x*m_*wv2+2.0*(BdriftY[2]*f[15]+BdriftY[3]*f[14]+BdriftY[0]*f[13]+BdriftY[1]*f[10])*dfac_m*dfac_y*m_*wv+2.0*(BdriftX[1]*f[15]+BdriftX[0]*f[14]+BdriftX[3]*f[13]+BdriftX[2]*f[10])*dfac_m*dfac_x*m_*wv+3.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[2]*f[12]*wm-1.0*BmagInv[1]*Bmag[2]*f[12]*wm+Bmag[1]*BmagInv[3]*f[9]*wm-1.0*BmagInv[0]*Bmag[2]*f[9]*wm-1.0*Bmag[2]*BmagInv[3]*f[8]*wm+BmagInv[0]*Bmag[1]*f[8]*wm-1.0*Bmag[2]*BmagInv[2]*f[4]*wm+Bmag[1]*BmagInv[1]*f[4]*wm-1.0*BmagInv[1]*Phi[2]*f[12]*q_+Phi[1]*BmagInv[2]*f[12]*q_+Phi[1]*BmagInv[3]*f[9]*q_-1.0*BmagInv[0]*Phi[2]*f[9]*q_-1.0*Phi[2]*BmagInv[3]*f[8]*q_+BmagInv[0]*Phi[1]*f[8]*q_-1.0*BmagInv[2]*Phi[2]*f[4]*q_+BmagInv[1]*Phi[1]*f[4]*q_)+1.732050807568877*(Bmag[1]*BmagInv[2]*f[5]-1.0*BmagInv[1]*Bmag[2]*f[5]+Bmag[1]*f[2]*BmagInv[3]-1.0*f[1]*Bmag[2]*BmagInv[3]-1.0*BmagInv[0]*Bmag[2]*f[2]-1.0*f[0]*Bmag[2]*BmagInv[2]+BmagInv[0]*Bmag[1]*f[1]+f[0]*Bmag[1]*BmagInv[1])*dfac_v*dfac_x*dfac_y))/(dfac_m*dfac_v*q_); 
  out[13] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_x*(2.0*BdriftX[3]*f[15]*m_*wv2+2.0*BdriftX[2]*f[14]*m_*wv2+2.0*BdriftX[1]*f[13]*m_*wv2+2.0*BdriftX[0]*f[10]*m_*wv2-1.0*BdriftX[0]*Bmag[3]*f[15]*wm-1.0*Bmag[1]*BdriftX[2]*f[15]*wm-1.0*BdriftX[1]*Bmag[3]*f[14]*wm-1.0*Bmag[1]*BdriftX[3]*f[14]*wm-1.0*BdriftX[2]*Bmag[3]*f[13]*wm-1.0*BdriftX[0]*Bmag[1]*f[13]*wm-1.0*BdriftX[3]*Bmag[3]*f[10]*wm-1.0*BdriftX[1]*Bmag[1]*f[10]*wm-1.0*BdriftX[0]*Phi[3]*f[15]*q_-1.0*Phi[1]*BdriftX[2]*f[15]*q_-1.0*BdriftX[1]*Phi[3]*f[14]*q_-1.0*Phi[1]*BdriftX[3]*f[14]*q_-1.0*BdriftX[2]*Phi[3]*f[13]*q_-1.0*BdriftX[0]*Phi[1]*f[13]*q_-1.0*BdriftX[3]*Phi[3]*f[10]*q_-1.0*BdriftX[1]*Phi[1]*f[10]*q_)-3.0*dfac_m*dfac_v2*dfac_y*(9.0*BdriftY[3]*Bmag[3]*f[12]*wm+5.0*BdriftY[2]*Bmag[2]*f[12]*wm+5.0*BdriftY[2]*Bmag[3]*f[9]*wm+5.0*Bmag[2]*BdriftY[3]*f[9]*wm+9.0*BdriftY[1]*Bmag[3]*f[8]*wm+5.0*BdriftY[0]*Bmag[2]*f[8]*wm+5.0*BdriftY[0]*Bmag[3]*f[4]*wm+5.0*BdriftY[1]*Bmag[2]*f[4]*wm+9.0*BdriftY[3]*Phi[3]*f[12]*q_+5.0*BdriftY[2]*Phi[2]*f[12]*q_+5.0*BdriftY[2]*Phi[3]*f[9]*q_+5.0*Phi[2]*BdriftY[3]*f[9]*q_+9.0*BdriftY[1]*Phi[3]*f[8]*q_+5.0*BdriftY[0]*Phi[2]*f[8]*q_+5.0*BdriftY[0]*Phi[3]*f[4]*q_+5.0*BdriftY[1]*Phi[2]*f[4]*q_)*wv-15.0*dfac_m*dfac_v2*dfac_x*(BdriftX[0]*Bmag[3]*f[12]*wm+Bmag[1]*BdriftX[2]*f[12]*wm+BdriftX[1]*Bmag[3]*f[9]*wm+Bmag[1]*BdriftX[3]*f[9]*wm+BdriftX[2]*Bmag[3]*f[8]*wm+BdriftX[0]*Bmag[1]*f[8]*wm+BdriftX[3]*Bmag[3]*f[4]*wm+BdriftX[1]*Bmag[1]*f[4]*wm+BdriftX[0]*Phi[3]*f[12]*q_+Phi[1]*BdriftX[2]*f[12]*q_+BdriftX[1]*Phi[3]*f[9]*q_+Phi[1]*BdriftX[3]*f[9]*q_+BdriftX[2]*Phi[3]*f[8]*q_+BdriftX[0]*Phi[1]*f[8]*q_+BdriftX[3]*Phi[3]*f[4]*q_+BdriftX[1]*Phi[1]*f[4]*q_)*wv+10.0*(BdriftX[3]*f[12]+BdriftX[2]*f[9]+BdriftX[1]*f[8]+BdriftX[0]*f[4])*dfac_m*dfac_x*m_*wv-1.732050807568877*(9.0*BdriftY[3]*Bmag[3]*f[5]+5.0*BdriftY[2]*Bmag[2]*f[5]+5.0*BdriftY[2]*f[2]*Bmag[3]+9.0*BdriftY[1]*f[1]*Bmag[3]+5.0*BdriftY[0]*f[0]*Bmag[3]+5.0*Bmag[2]*f[2]*BdriftY[3]+5.0*BdriftY[0]*f[1]*Bmag[2]+5.0*f[0]*BdriftY[1]*Bmag[2])*dfac_v2*dfac_y*wv-8.660254037844386*(BdriftX[0]*Bmag[3]*f[5]+Bmag[1]*BdriftX[2]*f[5]+f[0]*BdriftX[3]*Bmag[3]+BdriftX[1]*f[2]*Bmag[3]+f[1]*BdriftX[2]*Bmag[3]+Bmag[1]*f[2]*BdriftX[3]+BdriftX[0]*Bmag[1]*f[1]+f[0]*BdriftX[1]*Bmag[1])*dfac_v2*dfac_x*wv-15.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[2]*BmagInv[3]*f[15]*wm+BmagInv[2]*Bmag[3]*f[15]*wm+Bmag[3]*BmagInv[3]*f[14]*wm+Bmag[2]*BmagInv[2]*f[14]*wm+BmagInv[0]*Bmag[3]*f[13]*wm+BmagInv[1]*Bmag[2]*f[13]*wm+BmagInv[1]*Bmag[3]*f[10]*wm+BmagInv[0]*Bmag[2]*f[10]*wm+BmagInv[2]*Phi[3]*f[15]*q_+Phi[2]*BmagInv[3]*f[15]*q_+BmagInv[3]*Phi[3]*f[14]*q_+BmagInv[2]*Phi[2]*f[14]*q_+BmagInv[0]*Phi[3]*f[13]*q_+BmagInv[1]*Phi[2]*f[13]*q_+BmagInv[1]*Phi[3]*f[10]*q_+BmagInv[0]*Phi[2]*f[10]*q_)-1.732050807568877*dfac_m*dfac_v*dfac_y*(9.0*BdriftY[3]*Bmag[3]*f[15]*wm+5.0*BdriftY[2]*Bmag[2]*f[15]*wm+5.0*BdriftY[2]*Bmag[3]*f[14]*wm+5.0*Bmag[2]*BdriftY[3]*f[14]*wm+9.0*BdriftY[1]*Bmag[3]*f[13]*wm+5.0*BdriftY[0]*Bmag[2]*f[13]*wm+5.0*BdriftY[0]*Bmag[3]*f[10]*wm+5.0*BdriftY[1]*Bmag[2]*f[10]*wm+9.0*BdriftY[3]*Phi[3]*f[15]*q_+5.0*BdriftY[2]*Phi[2]*f[15]*q_+5.0*BdriftY[2]*Phi[3]*f[14]*q_+5.0*Phi[2]*BdriftY[3]*f[14]*q_+9.0*BdriftY[1]*Phi[3]*f[13]*q_+5.0*BdriftY[0]*Phi[2]*f[13]*q_+5.0*BdriftY[0]*Phi[3]*f[10]*q_+5.0*BdriftY[1]*Phi[2]*f[10]*q_)-8.660254037844386*(Bmag[2]*BmagInv[3]*f[11]+BmagInv[2]*Bmag[3]*f[11]+Bmag[3]*BmagInv[3]*f[7]+Bmag[2]*BmagInv[2]*f[7]+BmagInv[0]*Bmag[3]*f[6]+BmagInv[1]*Bmag[2]*f[6]+BmagInv[1]*Bmag[3]*f[3]+BmagInv[0]*Bmag[2]*f[3])*dfac_v*dfac_x*dfac_y-1.0*(9.0*BdriftY[3]*Bmag[3]*f[11]+5.0*BdriftY[2]*Bmag[2]*f[11]+5.0*BdriftY[2]*Bmag[3]*f[7]+5.0*Bmag[2]*BdriftY[3]*f[7]+9.0*BdriftY[1]*Bmag[3]*f[6]+5.0*BdriftY[0]*Bmag[2]*f[6]+5.0*BdriftY[0]*Bmag[3]*f[3]+5.0*BdriftY[1]*Bmag[2]*f[3])*dfac_v*dfac_y-5.0*(BdriftX[0]*Bmag[3]*f[11]+Bmag[1]*BdriftX[2]*f[11]+BdriftX[1]*Bmag[3]*f[7]+Bmag[1]*BdriftX[3]*f[7]+BdriftX[2]*Bmag[3]*f[6]+BdriftX[0]*Bmag[1]*f[6]+BdriftX[3]*Bmag[3]*f[3]+BdriftX[1]*Bmag[1]*f[3])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  out[14] += (0.05*(8.660254037844386*dfac_m*dfac_v*dfac_y*(2.0*BdriftY[3]*f[15]*m_*wv2+2.0*BdriftY[2]*f[14]*m_*wv2+2.0*BdriftY[1]*f[13]*m_*wv2+2.0*BdriftY[0]*f[10]*m_*wv2-1.0*BdriftY[0]*Bmag[3]*f[15]*wm-1.0*BdriftY[1]*Bmag[2]*f[15]*wm-1.0*BdriftY[1]*Bmag[3]*f[14]*wm-1.0*BdriftY[0]*Bmag[2]*f[14]*wm-1.0*BdriftY[2]*Bmag[3]*f[13]*wm-1.0*Bmag[2]*BdriftY[3]*f[13]*wm-1.0*BdriftY[3]*Bmag[3]*f[10]*wm-1.0*BdriftY[2]*Bmag[2]*f[10]*wm-1.0*BdriftY[0]*Phi[3]*f[15]*q_-1.0*BdriftY[1]*Phi[2]*f[15]*q_-1.0*BdriftY[1]*Phi[3]*f[14]*q_-1.0*BdriftY[0]*Phi[2]*f[14]*q_-1.0*BdriftY[2]*Phi[3]*f[13]*q_-1.0*Phi[2]*BdriftY[3]*f[13]*q_-1.0*BdriftY[3]*Phi[3]*f[10]*q_-1.0*BdriftY[2]*Phi[2]*f[10]*q_)-3.0*dfac_m*dfac_v2*dfac_x*(9.0*BdriftX[3]*Bmag[3]*f[12]*wm+5.0*BdriftX[1]*Bmag[1]*f[12]*wm+9.0*BdriftX[2]*Bmag[3]*f[9]*wm+5.0*BdriftX[0]*Bmag[1]*f[9]*wm+5.0*BdriftX[1]*Bmag[3]*f[8]*wm+5.0*Bmag[1]*BdriftX[3]*f[8]*wm+5.0*BdriftX[0]*Bmag[3]*f[4]*wm+5.0*Bmag[1]*BdriftX[2]*f[4]*wm+9.0*BdriftX[3]*Phi[3]*f[12]*q_+5.0*BdriftX[1]*Phi[1]*f[12]*q_+9.0*BdriftX[2]*Phi[3]*f[9]*q_+5.0*BdriftX[0]*Phi[1]*f[9]*q_+5.0*BdriftX[1]*Phi[3]*f[8]*q_+5.0*Phi[1]*BdriftX[3]*f[8]*q_+5.0*BdriftX[0]*Phi[3]*f[4]*q_+5.0*Phi[1]*BdriftX[2]*f[4]*q_)*wv-15.0*dfac_m*dfac_v2*dfac_y*(BdriftY[0]*Bmag[3]*f[12]*wm+BdriftY[1]*Bmag[2]*f[12]*wm+BdriftY[1]*Bmag[3]*f[9]*wm+BdriftY[0]*Bmag[2]*f[9]*wm+BdriftY[2]*Bmag[3]*f[8]*wm+Bmag[2]*BdriftY[3]*f[8]*wm+BdriftY[3]*Bmag[3]*f[4]*wm+BdriftY[2]*Bmag[2]*f[4]*wm+BdriftY[0]*Phi[3]*f[12]*q_+BdriftY[1]*Phi[2]*f[12]*q_+BdriftY[1]*Phi[3]*f[9]*q_+BdriftY[0]*Phi[2]*f[9]*q_+BdriftY[2]*Phi[3]*f[8]*q_+Phi[2]*BdriftY[3]*f[8]*q_+BdriftY[3]*Phi[3]*f[4]*q_+BdriftY[2]*Phi[2]*f[4]*q_)*wv+10.0*(BdriftY[3]*f[12]+BdriftY[2]*f[9]+BdriftY[1]*f[8]+BdriftY[0]*f[4])*dfac_m*dfac_y*m_*wv-8.660254037844386*(BdriftY[0]*Bmag[3]*f[5]+BdriftY[1]*Bmag[2]*f[5]+f[0]*BdriftY[3]*Bmag[3]+BdriftY[1]*f[2]*Bmag[3]+f[1]*BdriftY[2]*Bmag[3]+f[1]*Bmag[2]*BdriftY[3]+BdriftY[0]*Bmag[2]*f[2]+f[0]*BdriftY[2]*Bmag[2])*dfac_v2*dfac_y*wv-1.732050807568877*(9.0*BdriftX[3]*Bmag[3]*f[5]+5.0*BdriftX[1]*Bmag[1]*f[5]+9.0*BdriftX[2]*f[2]*Bmag[3]+5.0*BdriftX[1]*f[1]*Bmag[3]+5.0*BdriftX[0]*f[0]*Bmag[3]+5.0*Bmag[1]*f[1]*BdriftX[3]+5.0*BdriftX[0]*Bmag[1]*f[2]+5.0*f[0]*Bmag[1]*BdriftX[2])*dfac_v2*dfac_x*wv+15.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[3]*f[15]*wm+BmagInv[1]*Bmag[3]*f[15]*wm+BmagInv[0]*Bmag[3]*f[14]*wm+Bmag[1]*BmagInv[2]*f[14]*wm+Bmag[3]*BmagInv[3]*f[13]*wm+Bmag[1]*BmagInv[1]*f[13]*wm+BmagInv[2]*Bmag[3]*f[10]*wm+BmagInv[0]*Bmag[1]*f[10]*wm+BmagInv[1]*Phi[3]*f[15]*q_+Phi[1]*BmagInv[3]*f[15]*q_+BmagInv[0]*Phi[3]*f[14]*q_+Phi[1]*BmagInv[2]*f[14]*q_+BmagInv[3]*Phi[3]*f[13]*q_+BmagInv[1]*Phi[1]*f[13]*q_+BmagInv[2]*Phi[3]*f[10]*q_+BmagInv[0]*Phi[1]*f[10]*q_)-1.732050807568877*dfac_m*dfac_v*dfac_x*(9.0*BdriftX[3]*Bmag[3]*f[15]*wm+5.0*BdriftX[1]*Bmag[1]*f[15]*wm+9.0*BdriftX[2]*Bmag[3]*f[14]*wm+5.0*BdriftX[0]*Bmag[1]*f[14]*wm+5.0*BdriftX[1]*Bmag[3]*f[13]*wm+5.0*Bmag[1]*BdriftX[3]*f[13]*wm+5.0*BdriftX[0]*Bmag[3]*f[10]*wm+5.0*Bmag[1]*BdriftX[2]*f[10]*wm+9.0*BdriftX[3]*Phi[3]*f[15]*q_+5.0*BdriftX[1]*Phi[1]*f[15]*q_+9.0*BdriftX[2]*Phi[3]*f[14]*q_+5.0*BdriftX[0]*Phi[1]*f[14]*q_+5.0*BdriftX[1]*Phi[3]*f[13]*q_+5.0*Phi[1]*BdriftX[3]*f[13]*q_+5.0*BdriftX[0]*Phi[3]*f[10]*q_+5.0*Phi[1]*BdriftX[2]*f[10]*q_)+8.660254037844386*(Bmag[1]*BmagInv[3]*f[11]+BmagInv[1]*Bmag[3]*f[11]+BmagInv[0]*Bmag[3]*f[7]+Bmag[1]*BmagInv[2]*f[7]+Bmag[3]*BmagInv[3]*f[6]+Bmag[1]*BmagInv[1]*f[6]+BmagInv[2]*Bmag[3]*f[3]+BmagInv[0]*Bmag[1]*f[3])*dfac_v*dfac_x*dfac_y-5.0*(BdriftY[0]*Bmag[3]*f[11]+BdriftY[1]*Bmag[2]*f[11]+BdriftY[1]*Bmag[3]*f[7]+BdriftY[0]*Bmag[2]*f[7]+BdriftY[2]*Bmag[3]*f[6]+Bmag[2]*BdriftY[3]*f[6]+BdriftY[3]*Bmag[3]*f[3]+BdriftY[2]*Bmag[2]*f[3])*dfac_v*dfac_y-1.0*(9.0*BdriftX[3]*Bmag[3]*f[11]+5.0*BdriftX[1]*Bmag[1]*f[11]+9.0*BdriftX[2]*Bmag[3]*f[7]+5.0*BdriftX[0]*Bmag[1]*f[7]+5.0*BdriftX[1]*Bmag[3]*f[6]+5.0*Bmag[1]*BdriftX[3]*f[6]+5.0*BdriftX[0]*Bmag[3]*f[3]+5.0*Bmag[1]*BdriftX[2]*f[3])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  out[15] += (0.05*(1.732050807568877*dfac_m*dfac_v*dfac_y*(10.0*BdriftY[2]*f[15]*m_*wv2+10.0*BdriftY[3]*f[14]*m_*wv2+10.0*BdriftY[0]*f[13]*m_*wv2+10.0*BdriftY[1]*f[10]*m_*wv2-9.0*BdriftY[1]*Bmag[3]*f[15]*wm-5.0*BdriftY[0]*Bmag[2]*f[15]*wm-5.0*BdriftY[0]*Bmag[3]*f[14]*wm-5.0*BdriftY[1]*Bmag[2]*f[14]*wm-9.0*BdriftY[3]*Bmag[3]*f[13]*wm-5.0*BdriftY[2]*Bmag[2]*f[13]*wm-5.0*BdriftY[2]*Bmag[3]*f[10]*wm-5.0*Bmag[2]*BdriftY[3]*f[10]*wm-9.0*BdriftY[1]*Phi[3]*f[15]*q_-5.0*BdriftY[0]*Phi[2]*f[15]*q_-5.0*BdriftY[0]*Phi[3]*f[14]*q_-5.0*BdriftY[1]*Phi[2]*f[14]*q_-9.0*BdriftY[3]*Phi[3]*f[13]*q_-5.0*BdriftY[2]*Phi[2]*f[13]*q_-5.0*BdriftY[2]*Phi[3]*f[10]*q_-5.0*Phi[2]*BdriftY[3]*f[10]*q_)+1.732050807568877*dfac_m*dfac_v*dfac_x*(10.0*BdriftX[1]*f[15]*m_*wv2+10.0*BdriftX[0]*f[14]*m_*wv2+10.0*BdriftX[3]*f[13]*m_*wv2+10.0*BdriftX[2]*f[10]*m_*wv2-9.0*BdriftX[2]*Bmag[3]*f[15]*wm-5.0*BdriftX[0]*Bmag[1]*f[15]*wm-9.0*BdriftX[3]*Bmag[3]*f[14]*wm-5.0*BdriftX[1]*Bmag[1]*f[14]*wm-5.0*BdriftX[0]*Bmag[3]*f[13]*wm-5.0*Bmag[1]*BdriftX[2]*f[13]*wm-5.0*BdriftX[1]*Bmag[3]*f[10]*wm-5.0*Bmag[1]*BdriftX[3]*f[10]*wm-9.0*BdriftX[2]*Phi[3]*f[15]*q_-5.0*BdriftX[0]*Phi[1]*f[15]*q_-9.0*BdriftX[3]*Phi[3]*f[14]*q_-5.0*BdriftX[1]*Phi[1]*f[14]*q_-5.0*BdriftX[0]*Phi[3]*f[13]*q_-5.0*Phi[1]*BdriftX[2]*f[13]*q_-5.0*BdriftX[1]*Phi[3]*f[10]*q_-5.0*Phi[1]*BdriftX[3]*f[10]*q_)-3.0*dfac_m*dfac_v2*dfac_x*(9.0*BdriftX[2]*Bmag[3]*f[12]*wm+5.0*BdriftX[0]*Bmag[1]*f[12]*wm+9.0*BdriftX[3]*Bmag[3]*f[9]*wm+5.0*BdriftX[1]*Bmag[1]*f[9]*wm+5.0*BdriftX[0]*Bmag[3]*f[8]*wm+5.0*Bmag[1]*BdriftX[2]*f[8]*wm+5.0*BdriftX[1]*Bmag[3]*f[4]*wm+5.0*Bmag[1]*BdriftX[3]*f[4]*wm+9.0*BdriftX[2]*Phi[3]*f[12]*q_+5.0*BdriftX[0]*Phi[1]*f[12]*q_+9.0*BdriftX[3]*Phi[3]*f[9]*q_+5.0*BdriftX[1]*Phi[1]*f[9]*q_+5.0*BdriftX[0]*Phi[3]*f[8]*q_+5.0*Phi[1]*BdriftX[2]*f[8]*q_+5.0*BdriftX[1]*Phi[3]*f[4]*q_+5.0*Phi[1]*BdriftX[3]*f[4]*q_)*wv-3.0*dfac_m*dfac_v2*dfac_y*(9.0*BdriftY[1]*Bmag[3]*f[12]*wm+5.0*BdriftY[0]*Bmag[2]*f[12]*wm+5.0*BdriftY[0]*Bmag[3]*f[9]*wm+5.0*BdriftY[1]*Bmag[2]*f[9]*wm+9.0*BdriftY[3]*Bmag[3]*f[8]*wm+5.0*BdriftY[2]*Bmag[2]*f[8]*wm+5.0*BdriftY[2]*Bmag[3]*f[4]*wm+5.0*Bmag[2]*BdriftY[3]*f[4]*wm+9.0*BdriftY[1]*Phi[3]*f[12]*q_+5.0*BdriftY[0]*Phi[2]*f[12]*q_+5.0*BdriftY[0]*Phi[3]*f[9]*q_+5.0*BdriftY[1]*Phi[2]*f[9]*q_+9.0*BdriftY[3]*Phi[3]*f[8]*q_+5.0*BdriftY[2]*Phi[2]*f[8]*q_+5.0*BdriftY[2]*Phi[3]*f[4]*q_+5.0*Phi[2]*BdriftY[3]*f[4]*q_)*wv+10.0*(BdriftY[2]*f[12]+BdriftY[3]*f[9]+BdriftY[0]*f[8]+BdriftY[1]*f[4])*dfac_m*dfac_y*m_*wv+10.0*(BdriftX[1]*f[12]+BdriftX[0]*f[9]+BdriftX[3]*f[8]+BdriftX[2]*f[4])*dfac_m*dfac_x*m_*wv-1.732050807568877*(9.0*BdriftY[1]*Bmag[3]*f[5]+5.0*BdriftY[0]*Bmag[2]*f[5]+9.0*f[1]*BdriftY[3]*Bmag[3]+5.0*BdriftY[0]*f[2]*Bmag[3]+5.0*f[0]*BdriftY[2]*Bmag[3]+5.0*f[0]*Bmag[2]*BdriftY[3]+5.0*BdriftY[1]*Bmag[2]*f[2]+5.0*f[1]*BdriftY[2]*Bmag[2])*dfac_v2*dfac_y*wv-1.732050807568877*(9.0*BdriftX[2]*Bmag[3]*f[5]+5.0*BdriftX[0]*Bmag[1]*f[5]+9.0*f[2]*BdriftX[3]*Bmag[3]+5.0*BdriftX[0]*f[1]*Bmag[3]+5.0*f[0]*BdriftX[1]*Bmag[3]+5.0*f[0]*Bmag[1]*BdriftX[3]+5.0*BdriftX[1]*Bmag[1]*f[2]+5.0*Bmag[1]*f[1]*BdriftX[2])*dfac_v2*dfac_x*wv+15.0*dfac_m*dfac_v*dfac_x*dfac_y*(Bmag[1]*BmagInv[2]*f[15]*wm-1.0*BmagInv[1]*Bmag[2]*f[15]*wm+Bmag[1]*BmagInv[3]*f[14]*wm-1.0*BmagInv[0]*Bmag[2]*f[14]*wm-1.0*Bmag[2]*BmagInv[3]*f[13]*wm+BmagInv[0]*Bmag[1]*f[13]*wm-1.0*Bmag[2]*BmagInv[2]*f[10]*wm+Bmag[1]*BmagInv[1]*f[10]*wm-1.0*BmagInv[1]*Phi[2]*f[15]*q_+Phi[1]*BmagInv[2]*f[15]*q_+Phi[1]*BmagInv[3]*f[14]*q_-1.0*BmagInv[0]*Phi[2]*f[14]*q_-1.0*Phi[2]*BmagInv[3]*f[13]*q_+BmagInv[0]*Phi[1]*f[13]*q_-1.0*BmagInv[2]*Phi[2]*f[10]*q_+BmagInv[1]*Phi[1]*f[10]*q_)+8.660254037844386*(Bmag[1]*BmagInv[2]*f[11]-1.0*BmagInv[1]*Bmag[2]*f[11]+Bmag[1]*BmagInv[3]*f[7]-1.0*BmagInv[0]*Bmag[2]*f[7]-1.0*Bmag[2]*BmagInv[3]*f[6]+BmagInv[0]*Bmag[1]*f[6]-1.0*Bmag[2]*BmagInv[2]*f[3]+Bmag[1]*BmagInv[1]*f[3])*dfac_v*dfac_x*dfac_y-1.0*(9.0*BdriftY[1]*Bmag[3]*f[11]+5.0*BdriftY[0]*Bmag[2]*f[11]+5.0*BdriftY[0]*Bmag[3]*f[7]+5.0*BdriftY[1]*Bmag[2]*f[7]+9.0*BdriftY[3]*Bmag[3]*f[6]+5.0*BdriftY[2]*Bmag[2]*f[6]+5.0*BdriftY[2]*Bmag[3]*f[3]+5.0*Bmag[2]*BdriftY[3]*f[3])*dfac_v*dfac_y-1.0*(9.0*BdriftX[2]*Bmag[3]*f[11]+5.0*BdriftX[0]*Bmag[1]*f[11]+9.0*BdriftX[3]*Bmag[3]*f[7]+5.0*BdriftX[1]*Bmag[1]*f[7]+5.0*BdriftX[0]*Bmag[3]*f[6]+5.0*Bmag[1]*BdriftX[2]*f[6]+5.0*BdriftX[1]*Bmag[3]*f[3]+5.0*Bmag[1]*BdriftX[3]*f[3])*dfac_v*dfac_x))/(dfac_m*dfac_v*q_); 
  double cflFreq = 0.0; 
  cflFreq += fabs(0.5*Bmag[0]*((0.5*BdriftX[0]*m_*wv2)/q_-(0.2165063509461096*BmagInv[0]*dfac_y*(2.0*Bmag[2]*wm+2.0*Phi[2]*q_))/q_))*dxInv; 
  cflFreq += fabs(0.5*Bmag[0]*((0.5*BdriftY[0]*m_*wv2)/q_+(0.2165063509461096*BmagInv[0]*dfac_x*(2.0*Bmag[1]*wm+2.0*Phi[1]*q_))/q_))*dyInv; 
  cflFreq += fabs((0.5*Bmag[0]*((-(0.2165063509461096*BdriftY[0]*dfac_y*m_*(2.0*Bmag[2]*wm+2.0*Phi[2]*q_)*wv)/q_)-(0.2165063509461096*BdriftX[0]*dfac_x*m_*(2.0*Bmag[1]*wm+2.0*Phi[1]*q_)*wv)/q_))/m_)*dvInv; 
  return cflFreq; 
} 
