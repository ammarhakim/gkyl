#include <DeltaFGyrokineticModDecl.h>
double LinearDeltaFGyrokineticGenGeoSurf1x2vSer_x_P2_Bvars(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *f0L, const double *f0R, const double *f1L, const double *f1R, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamil0R[20]; 
  hamil0R[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*bmag[0]*wmuR)+2.0*m_))/rdvpar2SqR; 
  hamil0R[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamil0R[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamil0R[8] = (0.421637021355784*m_)/rdvpar2SqR; 

  double hamil1R[20]; 
  hamil1R[0] = 2.0*phi[0]*q_; 
  hamil1R[1] = 2.0*phi[1]*q_; 
  hamil1R[7] = 2.0*phi[2]*q_; 

  double BstarZdBmagR[20]; 
  BstarZdBmagR[0] = 1.414213562373095*cmag[0]*jacobTotInv[0]; 

  double alpha0R[8]; 
  alpha0R[0] = (0.4330127018922193*BstarZdBmagR[0]*hamil0R[2]*rdvpar2R)/m_; 
  alpha0R[1] = (0.9682458365518543*BstarZdBmagR[0]*hamil0R[8]*rdvpar2R)/m_; 

  double alpha1R[8]; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = (0.1082531754730548*BstarZdBmagR[0]*hamil0R[2]*rdvpar2R)/m_; 

  double incr[20]; 
  // linear term alpha0*f1 
  double fUpOrd[9];
  if (0.5*alpha0R[0]-0.6708203932499369*alpha0R[1] > 0) { 
    fUpOrd[0] = (-0.7348469228349525*f1L[19])-0.7348469228349533*f1L[18]+1.42302494707577*f1L[17]-0.4242640687119281*f1L[16]+0.5477225575051661*f1L[15]-0.4242640687119285*f1L[14]-1.060660171779821*f1L[13]+0.5477225575051661*f1L[12]-1.060660171779821*f1L[11]+1.10227038425243*f1L[10]+0.3162277660168379*(f1L[9]+f1L[8])+0.7905694150420947*f1L[7]+0.6363961030678926*f1L[6]-0.8215838362577489*(f1L[5]+f1L[4])-0.4743416490252568*(f1L[3]+f1L[2])+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[0] = 0.7348469228349525*f1R[19]+0.7348469228349533*f1R[18]+1.42302494707577*f1R[17]-0.4242640687119281*f1R[16]-0.5477225575051661*f1R[15]-0.4242640687119285*f1R[14]-1.060660171779821*f1R[13]-0.5477225575051661*f1R[12]-1.060660171779821*f1R[11]-1.10227038425243*f1R[10]+0.3162277660168379*(f1R[9]+f1R[8])+0.7905694150420947*f1R[7]+0.6363961030678926*f1R[6]+0.8215838362577489*(f1R[5]+f1R[4])-0.4743416490252568*(f1R[3]+f1R[2])-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5*alpha0R[0] > 0) { 
    fUpOrd[1] = 0.9185586535436913*f1L[18]+0.5477225575051661*f1L[15]+0.5303300858899104*f1L[14]-1.060660171779821*f1L[13]-0.6846531968814574*f1L[12]+0.3162277660168379*f1L[9]-0.3952847075210473*f1L[8]+0.7905694150420947*f1L[7]-0.8215838362577489*f1L[5]-0.4743416490252568*f1L[3]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[1] = (-0.9185586535436913*f1R[18])-0.5477225575051661*f1R[15]+0.5303300858899104*f1R[14]-1.060660171779821*f1R[13]+0.6846531968814574*f1R[12]+0.3162277660168379*f1R[9]-0.3952847075210473*f1R[8]+0.7905694150420947*f1R[7]+0.8215838362577489*f1R[5]-0.4743416490252568*f1R[3]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[2] = 0.7348469228349525*f1L[19]-0.7348469228349533*f1L[18]-1.42302494707577*f1L[17]+0.4242640687119281*f1L[16]+0.5477225575051661*f1L[15]-0.4242640687119285*f1L[14]-1.060660171779821*f1L[13]+0.5477225575051661*f1L[12]+1.060660171779821*f1L[11]-1.10227038425243*f1L[10]+0.3162277660168379*(f1L[9]+f1L[8])+0.7905694150420947*f1L[7]-0.6363961030678926*f1L[6]-0.8215838362577489*f1L[5]+0.8215838362577489*f1L[4]-0.4743416490252568*f1L[3]+0.4743416490252568*f1L[2]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[2] = (-0.7348469228349525*f1R[19])+0.7348469228349533*f1R[18]-1.42302494707577*f1R[17]+0.4242640687119281*f1R[16]-0.5477225575051661*f1R[15]-0.4242640687119285*f1R[14]-1.060660171779821*f1R[13]-0.5477225575051661*f1R[12]+1.060660171779821*f1R[11]+1.10227038425243*f1R[10]+0.3162277660168379*(f1R[9]+f1R[8])+0.7905694150420947*f1R[7]-0.6363961030678926*f1R[6]+0.8215838362577489*f1R[5]-0.8215838362577489*f1R[4]-0.4743416490252568*f1R[3]+0.4743416490252568*f1R[2]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5*alpha0R[0]-0.6708203932499369*alpha0R[1] > 0) { 
    fUpOrd[3] = 0.9185586535436913*f1L[19]+0.5303300858899104*f1L[16]-0.6846531968814574*f1L[15]+0.5477225575051661*f1L[12]-1.060660171779821*f1L[11]-0.3952847075210473*f1L[9]+0.3162277660168379*f1L[8]+0.7905694150420947*f1L[7]-0.8215838362577489*f1L[4]-0.4743416490252568*f1L[2]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[3] = (-0.9185586535436913*f1R[19])+0.5303300858899104*f1R[16]+0.6846531968814574*f1R[15]-0.5477225575051661*f1R[12]-1.060660171779821*f1R[11]-0.3952847075210473*f1R[9]+0.3162277660168379*f1R[8]+0.7905694150420947*f1R[7]+0.8215838362577489*f1R[4]-0.4743416490252568*f1R[2]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5*alpha0R[0] > 0) { 
    fUpOrd[4] = (-0.6846531968814574*(f1L[15]+f1L[12]))-0.3952847075210473*(f1L[9]+f1L[8])+0.7905694150420947*f1L[7]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[4] = 0.6846531968814574*(f1R[15]+f1R[12])-0.3952847075210473*(f1R[9]+f1R[8])+0.7905694150420947*f1R[7]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[5] = (-0.9185586535436913*f1L[19])-0.5303300858899104*f1L[16]-0.6846531968814574*f1L[15]+0.5477225575051661*f1L[12]+1.060660171779821*f1L[11]-0.3952847075210473*f1L[9]+0.3162277660168379*f1L[8]+0.7905694150420947*f1L[7]+0.8215838362577489*f1L[4]+0.4743416490252568*f1L[2]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[5] = 0.9185586535436913*f1R[19]-0.5303300858899104*f1R[16]+0.6846531968814574*f1R[15]-0.5477225575051661*f1R[12]+1.060660171779821*f1R[11]-0.3952847075210473*f1R[9]+0.3162277660168379*f1R[8]+0.7905694150420947*f1R[7]-0.8215838362577489*f1R[4]+0.4743416490252568*f1R[2]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5*alpha0R[0]-0.6708203932499369*alpha0R[1] > 0) { 
    fUpOrd[6] = (-0.7348469228349525*f1L[19])+0.7348469228349533*f1L[18]-1.42302494707577*f1L[17]-0.4242640687119281*f1L[16]+0.5477225575051661*f1L[15]+0.4242640687119285*f1L[14]+1.060660171779821*f1L[13]+0.5477225575051661*f1L[12]-1.060660171779821*f1L[11]-1.10227038425243*f1L[10]+0.3162277660168379*(f1L[9]+f1L[8])+0.7905694150420947*f1L[7]-0.6363961030678926*f1L[6]+0.8215838362577489*f1L[5]-0.8215838362577489*f1L[4]+0.4743416490252568*f1L[3]-0.4743416490252568*f1L[2]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[6] = 0.7348469228349525*f1R[19]-0.7348469228349533*f1R[18]-1.42302494707577*f1R[17]-0.4242640687119281*f1R[16]-0.5477225575051661*f1R[15]+0.4242640687119285*f1R[14]+1.060660171779821*f1R[13]-0.5477225575051661*f1R[12]-1.060660171779821*f1R[11]+1.10227038425243*f1R[10]+0.3162277660168379*(f1R[9]+f1R[8])+0.7905694150420947*f1R[7]-0.6363961030678926*f1R[6]-0.8215838362577489*f1R[5]+0.8215838362577489*f1R[4]+0.4743416490252568*f1R[3]-0.4743416490252568*f1R[2]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5*alpha0R[0] > 0) { 
    fUpOrd[7] = (-0.9185586535436913*f1L[18])+0.5477225575051661*f1L[15]-0.5303300858899104*f1L[14]+1.060660171779821*f1L[13]-0.6846531968814574*f1L[12]+0.3162277660168379*f1L[9]-0.3952847075210473*f1L[8]+0.7905694150420947*f1L[7]+0.8215838362577489*f1L[5]+0.4743416490252568*f1L[3]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[7] = 0.9185586535436913*f1R[18]-0.5477225575051661*f1R[15]-0.5303300858899104*f1R[14]+1.060660171779821*f1R[13]+0.6846531968814574*f1R[12]+0.3162277660168379*f1R[9]-0.3952847075210473*f1R[8]+0.7905694150420947*f1R[7]-0.8215838362577489*f1R[5]+0.4743416490252568*f1R[3]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[8] = 0.7348469228349525*f1L[19]+0.7348469228349533*f1L[18]+1.42302494707577*f1L[17]+0.4242640687119281*f1L[16]+0.5477225575051661*f1L[15]+0.4242640687119285*f1L[14]+1.060660171779821*f1L[13]+0.5477225575051661*f1L[12]+1.060660171779821*f1L[11]+1.10227038425243*f1L[10]+0.3162277660168379*(f1L[9]+f1L[8])+0.7905694150420947*f1L[7]+0.6363961030678926*f1L[6]+0.8215838362577489*(f1L[5]+f1L[4])+0.4743416490252568*(f1L[3]+f1L[2])+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[8] = (-0.7348469228349525*f1R[19])-0.7348469228349533*f1R[18]+1.42302494707577*f1R[17]+0.4242640687119281*f1R[16]-0.5477225575051661*f1R[15]+0.4242640687119285*f1R[14]+1.060660171779821*f1R[13]-0.5477225575051661*f1R[12]+1.060660171779821*f1R[11]-1.10227038425243*f1R[10]+0.3162277660168379*(f1R[9]+f1R[8])+0.7905694150420947*f1R[7]+0.6363961030678926*f1R[6]-0.8215838362577489*(f1R[5]+f1R[4])+0.4743416490252568*(f1R[3]+f1R[2])-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 

  double fUp[9];
  fUp[0] = 0.154320987654321*fUpOrd[8]+0.2469135802469136*fUpOrd[7]+0.154320987654321*fUpOrd[6]+0.2469135802469136*fUpOrd[5]+0.3950617283950617*fUpOrd[4]+0.2469135802469136*fUpOrd[3]+0.154320987654321*fUpOrd[2]+0.2469135802469136*fUpOrd[1]+0.154320987654321*fUpOrd[0]; 
  fUp[1] = 0.2070433312499809*fUpOrd[8]-0.2070433312499809*fUpOrd[6]+0.3312693299999694*fUpOrd[5]-0.3312693299999694*fUpOrd[3]+0.2070433312499809*fUpOrd[2]-0.2070433312499809*fUpOrd[0]; 
  fUp[2] = 0.2070433312499809*fUpOrd[8]+0.3312693299999694*fUpOrd[7]+0.2070433312499809*fUpOrd[6]-0.2070433312499809*fUpOrd[2]-0.3312693299999694*fUpOrd[1]-0.2070433312499809*fUpOrd[0]; 
  fUp[3] = 0.2777777777777778*fUpOrd[8]-0.2777777777777778*fUpOrd[6]-0.2777777777777778*fUpOrd[2]+0.2777777777777778*fUpOrd[0]; 
  fUp[4] = 0.1380288874999873*fUpOrd[8]-0.2760577749999745*fUpOrd[7]+0.1380288874999873*fUpOrd[6]+0.2208462199999796*fUpOrd[5]-0.4416924399999593*fUpOrd[4]+0.2208462199999796*fUpOrd[3]+0.1380288874999873*fUpOrd[2]-0.2760577749999745*fUpOrd[1]+0.1380288874999873*fUpOrd[0]; 
  fUp[5] = 0.1380288874999873*fUpOrd[8]+0.2208462199999796*fUpOrd[7]+0.1380288874999873*fUpOrd[6]-0.2760577749999745*fUpOrd[5]-0.4416924399999593*fUpOrd[4]-0.2760577749999745*fUpOrd[3]+0.1380288874999873*fUpOrd[2]+0.2208462199999796*fUpOrd[1]+0.1380288874999873*fUpOrd[0]; 
  fUp[6] = 0.1851851851851852*fUpOrd[8]-0.3703703703703703*fUpOrd[7]+0.1851851851851852*fUpOrd[6]-0.1851851851851852*fUpOrd[2]+0.3703703703703703*fUpOrd[1]-0.1851851851851852*fUpOrd[0]; 
  fUp[7] = 0.1851851851851852*fUpOrd[8]-0.1851851851851852*fUpOrd[6]-0.3703703703703703*fUpOrd[5]+0.3703703703703703*fUpOrd[3]+0.1851851851851852*fUpOrd[2]-0.1851851851851852*fUpOrd[0]; 

  incr[0] = 0.3535533905932737*(alpha0R[1]*fUp[1]+alpha0R[0]*fUp[0]); 
  incr[1] = -0.6123724356957944*(alpha0R[1]*fUp[1]+alpha0R[0]*fUp[0]); 
  incr[2] = 0.07071067811865474*(4.47213595499958*alpha0R[1]*fUp[4]+5.0*(alpha0R[0]*fUp[1]+fUp[0]*alpha0R[1])); 
  incr[3] = 0.3535533905932737*(alpha0R[1]*fUp[3]+alpha0R[0]*fUp[2]); 
  incr[4] = -0.07071067811865474*(7.745966692414834*alpha0R[1]*fUp[4]+8.660254037844386*(alpha0R[0]*fUp[1]+fUp[0]*alpha0R[1])); 
  incr[5] = -0.6123724356957944*(alpha0R[1]*fUp[3]+alpha0R[0]*fUp[2]); 
  incr[6] = 0.02357022603955158*(13.41640786499874*alpha0R[1]*fUp[6]+15.0*(alpha0R[0]*fUp[3]+alpha0R[1]*fUp[2])); 
  incr[7] = 0.7905694150420947*(alpha0R[1]*fUp[1]+alpha0R[0]*fUp[0]); 
  incr[8] = 0.07071067811865474*(5.0*alpha0R[0]*fUp[4]+4.47213595499958*alpha0R[1]*fUp[1]); 
  incr[9] = 0.02357022603955158*(15.0*alpha0R[1]*fUp[7]+15.0*alpha0R[0]*fUp[5]); 
  incr[10] = -0.07071067811865474*(7.745966692414834*alpha0R[1]*fUp[6]+8.660254037844386*(alpha0R[0]*fUp[3]+alpha0R[1]*fUp[2])); 
  incr[11] = 0.02357022603955158*(30.0*alpha0R[1]*fUp[4]+33.54101966249684*(alpha0R[0]*fUp[1]+fUp[0]*alpha0R[1])); 
  incr[12] = -0.07071067811865474*(8.660254037844387*alpha0R[0]*fUp[4]+7.745966692414834*alpha0R[1]*fUp[1]); 
  incr[13] = 0.7905694150420945*(alpha0R[1]*fUp[3]+alpha0R[0]*fUp[2]); 
  incr[14] = 0.02357022603955158*(15.0*alpha0R[0]*fUp[6]+13.41640786499874*alpha0R[1]*fUp[3]); 
  incr[15] = -0.07071067811865474*(8.660254037844386*alpha0R[1]*fUp[7]+8.660254037844387*alpha0R[0]*fUp[5]); 
  incr[16] = 0.02357022603955158*(15.0*alpha0R[0]*fUp[7]+15.0*alpha0R[1]*fUp[5]); 
  incr[17] = 0.02357022603955158*(30.0*alpha0R[1]*fUp[6]+33.54101966249685*(alpha0R[0]*fUp[3]+alpha0R[1]*fUp[2])); 
  incr[18] = -0.07071067811865474*(8.660254037844387*alpha0R[0]*fUp[6]+7.745966692414834*alpha0R[1]*fUp[3]); 
  incr[19] = -0.07071067811865474*(8.660254037844387*alpha0R[0]*fUp[7]+8.660254037844386*alpha0R[1]*fUp[5]); 

  outR[0] += incr[0]*rdx2R; 
  outR[1] += incr[1]*rdx2R; 
  outR[2] += incr[2]*rdx2R; 
  outR[3] += incr[3]*rdx2R; 
  outR[4] += incr[4]*rdx2R; 
  outR[5] += incr[5]*rdx2R; 
  outR[6] += incr[6]*rdx2R; 
  outR[7] += incr[7]*rdx2R; 
  outR[8] += incr[8]*rdx2R; 
  outR[9] += incr[9]*rdx2R; 
  outR[10] += incr[10]*rdx2R; 
  outR[11] += incr[11]*rdx2R; 
  outR[12] += incr[12]*rdx2R; 
  outR[13] += incr[13]*rdx2R; 
  outR[14] += incr[14]*rdx2R; 
  outR[15] += incr[15]*rdx2R; 
  outR[16] += incr[16]*rdx2R; 
  outR[17] += incr[17]*rdx2R; 
  outR[18] += incr[18]*rdx2R; 
  outR[19] += incr[19]*rdx2R; 

  outL[0] += -1.0*incr[0]*rdx2L; 
  outL[1] += incr[1]*rdx2L; 
  outL[2] += -1.0*incr[2]*rdx2L; 
  outL[3] += -1.0*incr[3]*rdx2L; 
  outL[4] += incr[4]*rdx2L; 
  outL[5] += incr[5]*rdx2L; 
  outL[6] += -1.0*incr[6]*rdx2L; 
  outL[7] += -1.0*incr[7]*rdx2L; 
  outL[8] += -1.0*incr[8]*rdx2L; 
  outL[9] += -1.0*incr[9]*rdx2L; 
  outL[10] += incr[10]*rdx2L; 
  outL[11] += -1.0*incr[11]*rdx2L; 
  outL[12] += incr[12]*rdx2L; 
  outL[13] += -1.0*incr[13]*rdx2L; 
  outL[14] += -1.0*incr[14]*rdx2L; 
  outL[15] += incr[15]*rdx2L; 
  outL[16] += -1.0*incr[16]*rdx2L; 
  outL[17] += -1.0*incr[17]*rdx2L; 
  outL[18] += incr[18]*rdx2L; 
  outL[19] += incr[19]*rdx2L; 

  // alpha1 == 0, so nothing to do for alpha1*f0 and alpha1*f1 terms.
  return std::abs(alphaSurfAvgR); 
} 
double LinearDeltaFGyrokineticGenGeoSurf1x2vSer_vpar_P2_Bvars(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *f0L, const double *f0R, const double *f1L, const double *f1R, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamil0R[20]; 
  hamil0R[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*bmag[0]*wmuR)+2.0*m_))/rdvpar2SqR; 
  hamil0R[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamil0R[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamil0R[8] = (0.421637021355784*m_)/rdvpar2SqR; 

  double hamil1R[20]; 
  hamil1R[0] = 2.0*phi[0]*q_; 
  hamil1R[1] = 2.0*phi[1]*q_; 
  hamil1R[7] = 2.0*phi[2]*q_; 

  double BstarZdBmagR[20]; 
  BstarZdBmagR[0] = 1.414213562373095*cmag[0]*jacobTotInv[0]; 

  double alpha0R[8]; 

  double alpha1R[8]; 
  alpha1R[0] = -(0.4330127018922193*BstarZdBmagR[0]*hamil1R[1]*rdx2R)/m_; 
  alpha1R[1] = -(0.9682458365518543*BstarZdBmagR[0]*hamil1R[7]*rdx2R)/m_; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = -(0.1082531754730548*BstarZdBmagR[0]*hamil1R[1]*rdx2R)/m_; 

  double incr[20]; 
  // alpha0 == 0, so nothing to do for alpha0*f1 term.
  // linear term alpha1*f0 
  double fUpOrd[9];
  if (0.5*alpha1R[0]-0.6708203932499369*alpha1R[1] > 0) { 
    fUpOrd[0] = (-0.7348469228349525*f0L[19])+1.42302494707577*f0L[18]-0.7348469228349533*f0L[17]+0.5477225575051661*f0L[16]-0.4242640687119281*f0L[15]-1.060660171779821*f0L[14]-0.4242640687119285*f0L[13]-1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]+1.10227038425243*f0L[10]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]-0.8215838362577489*f0L[6]+0.6363961030678926*f0L[5]-0.8215838362577489*f0L[4]-0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]-0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[0] = 0.7348469228349525*f0R[19]+1.42302494707577*f0R[18]+0.7348469228349533*f0R[17]-0.5477225575051661*f0R[16]-0.4242640687119281*f0R[15]-1.060660171779821*f0R[14]-0.4242640687119285*f0R[13]-1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]-1.10227038425243*f0R[10]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]+0.8215838362577489*f0R[6]+0.6363961030678926*f0R[5]+0.8215838362577489*f0R[4]-0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]-0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 
  if (0.5*alpha1R[0] > 0) { 
    fUpOrd[1] = 0.9185586535436913*f0L[17]+0.5477225575051661*f0L[16]-1.060660171779821*f0L[14]+0.5303300858899104*f0L[13]-0.6846531968814574*f0L[11]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]-0.3952847075210473*f0L[7]-0.8215838362577489*f0L[6]-0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[1] = (-0.9185586535436913*f0R[17])-0.5477225575051661*f0R[16]-1.060660171779821*f0R[14]+0.5303300858899104*f0R[13]+0.6846531968814574*f0R[11]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]-0.3952847075210473*f0R[7]+0.8215838362577489*f0R[6]-0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]+0.3535533905932737*f0R[0]; 
  } 
  if (0.6708203932499369*alpha1R[1]+0.5*alpha1R[0] > 0) { 
    fUpOrd[2] = 0.7348469228349525*f0L[19]-1.42302494707577*f0L[18]-0.7348469228349533*f0L[17]+0.5477225575051661*f0L[16]+0.4242640687119281*f0L[15]-1.060660171779821*f0L[14]-0.4242640687119285*f0L[13]+1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]-1.10227038425243*f0L[10]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]-0.8215838362577489*f0L[6]-0.6363961030678926*f0L[5]+0.8215838362577489*f0L[4]-0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]+0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[2] = (-0.7348469228349525*f0R[19])-1.42302494707577*f0R[18]+0.7348469228349533*f0R[17]-0.5477225575051661*f0R[16]+0.4242640687119281*f0R[15]-1.060660171779821*f0R[14]-0.4242640687119285*f0R[13]+1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]+1.10227038425243*f0R[10]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]+0.8215838362577489*f0R[6]-0.6363961030678926*f0R[5]-0.8215838362577489*f0R[4]-0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]+0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 
  if (0.5*alpha1R[0]-0.6708203932499369*alpha1R[1] > 0) { 
    fUpOrd[3] = 0.9185586535436913*f0L[19]-0.6846531968814574*f0L[16]+0.5303300858899104*f0L[15]-1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]-0.3952847075210473*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]-0.8215838362577489*f0L[4]+0.6123724356957944*f0L[2]-0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[3] = (-0.9185586535436913*f0R[19])+0.6846531968814574*f0R[16]+0.5303300858899104*f0R[15]-1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]-0.3952847075210473*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]+0.8215838362577489*f0R[4]-0.6123724356957944*f0R[2]-0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 
  if (0.5*alpha1R[0] > 0) { 
    fUpOrd[4] = (-0.6846531968814574*(f0L[16]+f0L[11]))-0.3952847075210473*f0L[9]+0.7905694150420947*f0L[8]-0.3952847075210473*f0L[7]+0.6123724356957944*f0L[2]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[4] = 0.6846531968814574*(f0R[16]+f0R[11])-0.3952847075210473*f0R[9]+0.7905694150420947*f0R[8]-0.3952847075210473*f0R[7]-0.6123724356957944*f0R[2]+0.3535533905932737*f0R[0]; 
  } 
  if (0.6708203932499369*alpha1R[1]+0.5*alpha1R[0] > 0) { 
    fUpOrd[5] = (-0.9185586535436913*f0L[19])-0.6846531968814574*f0L[16]-0.5303300858899104*f0L[15]+1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]-0.3952847075210473*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]+0.8215838362577489*f0L[4]+0.6123724356957944*f0L[2]+0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[5] = 0.9185586535436913*f0R[19]+0.6846531968814574*f0R[16]-0.5303300858899104*f0R[15]+1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]-0.3952847075210473*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]-0.8215838362577489*f0R[4]-0.6123724356957944*f0R[2]+0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 
  if (0.5*alpha1R[0]-0.6708203932499369*alpha1R[1] > 0) { 
    fUpOrd[6] = (-0.7348469228349525*f0L[19])-1.42302494707577*f0L[18]+0.7348469228349533*f0L[17]+0.5477225575051661*f0L[16]-0.4242640687119281*f0L[15]+1.060660171779821*f0L[14]+0.4242640687119285*f0L[13]-1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]-1.10227038425243*f0L[10]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]+0.8215838362577489*f0L[6]-0.6363961030678926*f0L[5]-0.8215838362577489*f0L[4]+0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]-0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[6] = 0.7348469228349525*f0R[19]-1.42302494707577*f0R[18]-0.7348469228349533*f0R[17]-0.5477225575051661*f0R[16]-0.4242640687119281*f0R[15]+1.060660171779821*f0R[14]+0.4242640687119285*f0R[13]-1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]+1.10227038425243*f0R[10]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]-0.8215838362577489*f0R[6]-0.6363961030678926*f0R[5]+0.8215838362577489*f0R[4]+0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]-0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 
  if (0.5*alpha1R[0] > 0) { 
    fUpOrd[7] = (-0.9185586535436913*f0L[17])+0.5477225575051661*f0L[16]+1.060660171779821*f0L[14]-0.5303300858899104*f0L[13]-0.6846531968814574*f0L[11]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]-0.3952847075210473*f0L[7]+0.8215838362577489*f0L[6]+0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[7] = 0.9185586535436913*f0R[17]-0.5477225575051661*f0R[16]+1.060660171779821*f0R[14]-0.5303300858899104*f0R[13]+0.6846531968814574*f0R[11]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]-0.3952847075210473*f0R[7]-0.8215838362577489*f0R[6]+0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]+0.3535533905932737*f0R[0]; 
  } 
  if (0.6708203932499369*alpha1R[1]+0.5*alpha1R[0] > 0) { 
    fUpOrd[8] = 0.7348469228349525*f0L[19]+1.42302494707577*f0L[18]+0.7348469228349533*f0L[17]+0.5477225575051661*f0L[16]+0.4242640687119281*f0L[15]+1.060660171779821*f0L[14]+0.4242640687119285*f0L[13]+1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]+1.10227038425243*f0L[10]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]+0.8215838362577489*f0L[6]+0.6363961030678926*f0L[5]+0.8215838362577489*f0L[4]+0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]+0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[8] = (-0.7348469228349525*f0R[19])+1.42302494707577*f0R[18]-0.7348469228349533*f0R[17]-0.5477225575051661*f0R[16]+0.4242640687119281*f0R[15]+1.060660171779821*f0R[14]+0.4242640687119285*f0R[13]+1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]-1.10227038425243*f0R[10]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]-0.8215838362577489*f0R[6]+0.6363961030678926*f0R[5]-0.8215838362577489*f0R[4]+0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]+0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 

  double fUp[9];
  fUp[0] = 0.154320987654321*fUpOrd[8]+0.2469135802469136*fUpOrd[7]+0.154320987654321*fUpOrd[6]+0.2469135802469136*fUpOrd[5]+0.3950617283950617*fUpOrd[4]+0.2469135802469136*fUpOrd[3]+0.154320987654321*fUpOrd[2]+0.2469135802469136*fUpOrd[1]+0.154320987654321*fUpOrd[0]; 
  fUp[1] = 0.2070433312499809*fUpOrd[8]-0.2070433312499809*fUpOrd[6]+0.3312693299999694*fUpOrd[5]-0.3312693299999694*fUpOrd[3]+0.2070433312499809*fUpOrd[2]-0.2070433312499809*fUpOrd[0]; 
  fUp[2] = 0.2070433312499809*fUpOrd[8]+0.3312693299999694*fUpOrd[7]+0.2070433312499809*fUpOrd[6]-0.2070433312499809*fUpOrd[2]-0.3312693299999694*fUpOrd[1]-0.2070433312499809*fUpOrd[0]; 
  fUp[3] = 0.2777777777777778*fUpOrd[8]-0.2777777777777778*fUpOrd[6]-0.2777777777777778*fUpOrd[2]+0.2777777777777778*fUpOrd[0]; 
  fUp[4] = 0.1380288874999873*fUpOrd[8]-0.2760577749999745*fUpOrd[7]+0.1380288874999873*fUpOrd[6]+0.2208462199999796*fUpOrd[5]-0.4416924399999593*fUpOrd[4]+0.2208462199999796*fUpOrd[3]+0.1380288874999873*fUpOrd[2]-0.2760577749999745*fUpOrd[1]+0.1380288874999873*fUpOrd[0]; 
  fUp[5] = 0.1380288874999873*fUpOrd[8]+0.2208462199999796*fUpOrd[7]+0.1380288874999873*fUpOrd[6]-0.2760577749999745*fUpOrd[5]-0.4416924399999593*fUpOrd[4]-0.2760577749999745*fUpOrd[3]+0.1380288874999873*fUpOrd[2]+0.2208462199999796*fUpOrd[1]+0.1380288874999873*fUpOrd[0]; 
  fUp[6] = 0.1851851851851852*fUpOrd[8]-0.3703703703703703*fUpOrd[7]+0.1851851851851852*fUpOrd[6]-0.1851851851851852*fUpOrd[2]+0.3703703703703703*fUpOrd[1]-0.1851851851851852*fUpOrd[0]; 
  fUp[7] = 0.1851851851851852*fUpOrd[8]-0.1851851851851852*fUpOrd[6]-0.3703703703703703*fUpOrd[5]+0.3703703703703703*fUpOrd[3]+0.1851851851851852*fUpOrd[2]-0.1851851851851852*fUpOrd[0]; 

  incr[0] = 0.3535533905932737*(alpha1R[1]*fUp[1]+alpha1R[0]*fUp[0]); 
  incr[1] = 0.07071067811865474*(4.47213595499958*alpha1R[1]*fUp[4]+5.0*(alpha1R[0]*fUp[1]+fUp[0]*alpha1R[1])); 
  incr[2] = -0.6123724356957944*(alpha1R[1]*fUp[1]+alpha1R[0]*fUp[0]); 
  incr[3] = 0.3535533905932737*(alpha1R[1]*fUp[3]+alpha1R[0]*fUp[2]); 
  incr[4] = -0.07071067811865474*(7.745966692414834*alpha1R[1]*fUp[4]+8.660254037844386*(alpha1R[0]*fUp[1]+fUp[0]*alpha1R[1])); 
  incr[5] = 0.02357022603955158*(13.41640786499874*alpha1R[1]*fUp[6]+15.0*(alpha1R[0]*fUp[3]+alpha1R[1]*fUp[2])); 
  incr[6] = -0.6123724356957944*(alpha1R[1]*fUp[3]+alpha1R[0]*fUp[2]); 
  incr[7] = 0.07071067811865474*(5.0*alpha1R[0]*fUp[4]+4.47213595499958*alpha1R[1]*fUp[1]); 
  incr[8] = 0.7905694150420947*(alpha1R[1]*fUp[1]+alpha1R[0]*fUp[0]); 
  incr[9] = 0.02357022603955158*(15.0*alpha1R[1]*fUp[7]+15.0*alpha1R[0]*fUp[5]); 
  incr[10] = -0.07071067811865474*(7.745966692414834*alpha1R[1]*fUp[6]+8.660254037844386*(alpha1R[0]*fUp[3]+alpha1R[1]*fUp[2])); 
  incr[11] = -0.07071067811865474*(8.660254037844387*alpha1R[0]*fUp[4]+7.745966692414834*alpha1R[1]*fUp[1]); 
  incr[12] = 0.02357022603955158*(30.0*alpha1R[1]*fUp[4]+33.54101966249684*(alpha1R[0]*fUp[1]+fUp[0]*alpha1R[1])); 
  incr[13] = 0.02357022603955158*(15.0*alpha1R[0]*fUp[6]+13.41640786499874*alpha1R[1]*fUp[3]); 
  incr[14] = 0.7905694150420945*(alpha1R[1]*fUp[3]+alpha1R[0]*fUp[2]); 
  incr[15] = 0.02357022603955158*(15.0*alpha1R[0]*fUp[7]+15.0*alpha1R[1]*fUp[5]); 
  incr[16] = -0.07071067811865474*(8.660254037844386*alpha1R[1]*fUp[7]+8.660254037844387*alpha1R[0]*fUp[5]); 
  incr[17] = -0.07071067811865474*(8.660254037844387*alpha1R[0]*fUp[6]+7.745966692414834*alpha1R[1]*fUp[3]); 
  incr[18] = 0.02357022603955158*(30.0*alpha1R[1]*fUp[6]+33.54101966249685*(alpha1R[0]*fUp[3]+alpha1R[1]*fUp[2])); 
  incr[19] = -0.07071067811865474*(8.660254037844387*alpha1R[0]*fUp[7]+8.660254037844386*alpha1R[1]*fUp[5]); 

  outR[0] += incr[0]*rdvpar2R; 
  outR[1] += incr[1]*rdvpar2R; 
  outR[2] += incr[2]*rdvpar2R; 
  outR[3] += incr[3]*rdvpar2R; 
  outR[4] += incr[4]*rdvpar2R; 
  outR[5] += incr[5]*rdvpar2R; 
  outR[6] += incr[6]*rdvpar2R; 
  outR[7] += incr[7]*rdvpar2R; 
  outR[8] += incr[8]*rdvpar2R; 
  outR[9] += incr[9]*rdvpar2R; 
  outR[10] += incr[10]*rdvpar2R; 
  outR[11] += incr[11]*rdvpar2R; 
  outR[12] += incr[12]*rdvpar2R; 
  outR[13] += incr[13]*rdvpar2R; 
  outR[14] += incr[14]*rdvpar2R; 
  outR[15] += incr[15]*rdvpar2R; 
  outR[16] += incr[16]*rdvpar2R; 
  outR[17] += incr[17]*rdvpar2R; 
  outR[18] += incr[18]*rdvpar2R; 
  outR[19] += incr[19]*rdvpar2R; 

  outL[0] += -1.0*incr[0]*rdvpar2L; 
  outL[1] += -1.0*incr[1]*rdvpar2L; 
  outL[2] += incr[2]*rdvpar2L; 
  outL[3] += -1.0*incr[3]*rdvpar2L; 
  outL[4] += incr[4]*rdvpar2L; 
  outL[5] += -1.0*incr[5]*rdvpar2L; 
  outL[6] += incr[6]*rdvpar2L; 
  outL[7] += -1.0*incr[7]*rdvpar2L; 
  outL[8] += -1.0*incr[8]*rdvpar2L; 
  outL[9] += -1.0*incr[9]*rdvpar2L; 
  outL[10] += incr[10]*rdvpar2L; 
  outL[11] += incr[11]*rdvpar2L; 
  outL[12] += -1.0*incr[12]*rdvpar2L; 
  outL[13] += -1.0*incr[13]*rdvpar2L; 
  outL[14] += -1.0*incr[14]*rdvpar2L; 
  outL[15] += -1.0*incr[15]*rdvpar2L; 
  outL[16] += incr[16]*rdvpar2L; 
  outL[17] += incr[17]*rdvpar2L; 
  outL[18] += -1.0*incr[18]*rdvpar2L; 
  outL[19] += incr[19]*rdvpar2L; 

  return std::abs(alphaSurfAvgR); 
} 
double LinearDeltaFGyrokineticGenGeoSurf1x2vSer_x_P2_Bvarsx(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *f0L, const double *f0R, const double *f1L, const double *f1R, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamil0R[20]; 
  hamil0R[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*bmag[0]*wmuR)+2.0*m_))/rdvpar2SqR; 
  hamil0R[1] = 2.0*bmag[1]*wmuR; 
  hamil0R[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamil0R[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamil0R[5] = (1.154700538379252*bmag[1])/rdmu2R; 
  hamil0R[7] = 2.0*bmag[2]*wmuR; 
  hamil0R[8] = (0.421637021355784*m_)/rdvpar2SqR; 
  hamil0R[13] = (1.154700538379251*bmag[2])/rdmu2R; 

  double hamil1R[20]; 
  hamil1R[0] = 2.0*phi[0]*q_; 
  hamil1R[1] = 2.0*phi[1]*q_; 
  hamil1R[7] = 2.0*phi[2]*q_; 

  double BstarZdBmagR[20]; 
  BstarZdBmagR[0] = (1.414213562373095*(1.732050807568877*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R*wvparR+(cmag[2]*jacobTotInv[2]+cmag[1]*jacobTotInv[1]+cmag[0]*jacobTotInv[0])*q_))/q_; 
  BstarZdBmagR[1] = (0.2828427124746191*(1.732050807568877*(b_y[2]*(10.0*jacobTotInv[2]+11.18033988749895*jacobTotInv[0])+5.0*b_y[1]*jacobTotInv[1])*m_*rdx2R*wvparR+(4.47213595499958*(cmag[1]*jacobTotInv[2]+jacobTotInv[1]*cmag[2])+5.0*(cmag[0]*jacobTotInv[1]+jacobTotInv[0]*cmag[1]))*q_))/q_; 
  BstarZdBmagR[2] = (1.414213562373095*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[4] = (1.414213562373095*(b_y[2]*(2.0*jacobTotInv[2]+2.23606797749979*jacobTotInv[0])+b_y[1]*jacobTotInv[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[7] = (0.04040610178208843*(60.6217782649107*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R*wvparR+((22.3606797749979*cmag[2]+35.0*cmag[0])*jacobTotInv[2]+7.0*(5.0*jacobTotInv[0]*cmag[2]+4.47213595499958*cmag[1]*jacobTotInv[1]))*q_))/q_; 
  BstarZdBmagR[11] = (1.414213562373095*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R)/(q_*rdvpar2R); 

  double alpha0R[8]; 
  alpha0R[0] = (0.25*(hamil0R[8]*(8.660254037844387*BstarZdBmagR[11]-6.708203932499369*BstarZdBmagR[4]+3.872983346207417*BstarZdBmagR[2])+hamil0R[2]*(3.872983346207417*BstarZdBmagR[7]-3.0*BstarZdBmagR[1]+1.732050807568877*BstarZdBmagR[0]))*rdvpar2R)/m_; 
  alpha0R[1] = (0.25*(3.872983346207417*hamil0R[2]*BstarZdBmagR[11]+(8.660254037844386*BstarZdBmagR[7]-6.708203932499369*BstarZdBmagR[1]+3.872983346207417*BstarZdBmagR[0])*hamil0R[8]+hamil0R[2]*(1.732050807568877*BstarZdBmagR[2]-3.0*BstarZdBmagR[4]))*rdvpar2R)/m_; 
  alpha0R[4] = (0.5*hamil0R[8]*(3.872983346207417*BstarZdBmagR[11]-3.0*BstarZdBmagR[4]+1.732050807568877*BstarZdBmagR[2])*rdvpar2R)/m_; 

  double alpha1R[8]; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = (0.0625*(8.660254037844387*hamil0R[8]*BstarZdBmagR[11]+(3.872983346207417*BstarZdBmagR[2]-6.708203932499369*BstarZdBmagR[4])*hamil0R[8]+3.872983346207417*hamil0R[2]*BstarZdBmagR[7]+(1.732050807568877*BstarZdBmagR[0]-3.0*BstarZdBmagR[1])*hamil0R[2])*rdvpar2R)/m_; 

  double incr[20]; 
  // linear term alpha0*f1 
  double fUpOrd[9];
  if (0.4472135954999579*alpha0R[4]-0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[0] = (-0.7348469228349525*f1L[19])-0.7348469228349533*f1L[18]+1.42302494707577*f1L[17]-0.4242640687119281*f1L[16]+0.5477225575051661*f1L[15]-0.4242640687119285*f1L[14]-1.060660171779821*f1L[13]+0.5477225575051661*f1L[12]-1.060660171779821*f1L[11]+1.10227038425243*f1L[10]+0.3162277660168379*(f1L[9]+f1L[8])+0.7905694150420947*f1L[7]+0.6363961030678926*f1L[6]-0.8215838362577489*(f1L[5]+f1L[4])-0.4743416490252568*(f1L[3]+f1L[2])+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[0] = 0.7348469228349525*f1R[19]+0.7348469228349533*f1R[18]+1.42302494707577*f1R[17]-0.4242640687119281*f1R[16]-0.5477225575051661*f1R[15]-0.4242640687119285*f1R[14]-1.060660171779821*f1R[13]-0.5477225575051661*f1R[12]-1.060660171779821*f1R[11]-1.10227038425243*f1R[10]+0.3162277660168379*(f1R[9]+f1R[8])+0.7905694150420947*f1R[7]+0.6363961030678926*f1R[6]+0.8215838362577489*(f1R[5]+f1R[4])-0.4743416490252568*(f1R[3]+f1R[2])-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5*alpha0R[0]-0.5590169943749475*alpha0R[4] > 0) { 
    fUpOrd[1] = 0.9185586535436913*f1L[18]+0.5477225575051661*f1L[15]+0.5303300858899104*f1L[14]-1.060660171779821*f1L[13]-0.6846531968814574*f1L[12]+0.3162277660168379*f1L[9]-0.3952847075210473*f1L[8]+0.7905694150420947*f1L[7]-0.8215838362577489*f1L[5]-0.4743416490252568*f1L[3]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[1] = (-0.9185586535436913*f1R[18])-0.5477225575051661*f1R[15]+0.5303300858899104*f1R[14]-1.060660171779821*f1R[13]+0.6846531968814574*f1R[12]+0.3162277660168379*f1R[9]-0.3952847075210473*f1R[8]+0.7905694150420947*f1R[7]+0.8215838362577489*f1R[5]-0.4743416490252568*f1R[3]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.4472135954999579*alpha0R[4]+0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[2] = 0.7348469228349525*f1L[19]-0.7348469228349533*f1L[18]-1.42302494707577*f1L[17]+0.4242640687119281*f1L[16]+0.5477225575051661*f1L[15]-0.4242640687119285*f1L[14]-1.060660171779821*f1L[13]+0.5477225575051661*f1L[12]+1.060660171779821*f1L[11]-1.10227038425243*f1L[10]+0.3162277660168379*(f1L[9]+f1L[8])+0.7905694150420947*f1L[7]-0.6363961030678926*f1L[6]-0.8215838362577489*f1L[5]+0.8215838362577489*f1L[4]-0.4743416490252568*f1L[3]+0.4743416490252568*f1L[2]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[2] = (-0.7348469228349525*f1R[19])+0.7348469228349533*f1R[18]-1.42302494707577*f1R[17]+0.4242640687119281*f1R[16]-0.5477225575051661*f1R[15]-0.4242640687119285*f1R[14]-1.060660171779821*f1R[13]-0.5477225575051661*f1R[12]+1.060660171779821*f1R[11]+1.10227038425243*f1R[10]+0.3162277660168379*(f1R[9]+f1R[8])+0.7905694150420947*f1R[7]-0.6363961030678926*f1R[6]+0.8215838362577489*f1R[5]-0.8215838362577489*f1R[4]-0.4743416490252568*f1R[3]+0.4743416490252568*f1R[2]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.4472135954999579*alpha0R[4]-0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[3] = 0.9185586535436913*f1L[19]+0.5303300858899104*f1L[16]-0.6846531968814574*f1L[15]+0.5477225575051661*f1L[12]-1.060660171779821*f1L[11]-0.3952847075210473*f1L[9]+0.3162277660168379*f1L[8]+0.7905694150420947*f1L[7]-0.8215838362577489*f1L[4]-0.4743416490252568*f1L[2]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[3] = (-0.9185586535436913*f1R[19])+0.5303300858899104*f1R[16]+0.6846531968814574*f1R[15]-0.5477225575051661*f1R[12]-1.060660171779821*f1R[11]-0.3952847075210473*f1R[9]+0.3162277660168379*f1R[8]+0.7905694150420947*f1R[7]+0.8215838362577489*f1R[4]-0.4743416490252568*f1R[2]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5*alpha0R[0]-0.5590169943749475*alpha0R[4] > 0) { 
    fUpOrd[4] = (-0.6846531968814574*(f1L[15]+f1L[12]))-0.3952847075210473*(f1L[9]+f1L[8])+0.7905694150420947*f1L[7]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[4] = 0.6846531968814574*(f1R[15]+f1R[12])-0.3952847075210473*(f1R[9]+f1R[8])+0.7905694150420947*f1R[7]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.4472135954999579*alpha0R[4]+0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[5] = (-0.9185586535436913*f1L[19])-0.5303300858899104*f1L[16]-0.6846531968814574*f1L[15]+0.5477225575051661*f1L[12]+1.060660171779821*f1L[11]-0.3952847075210473*f1L[9]+0.3162277660168379*f1L[8]+0.7905694150420947*f1L[7]+0.8215838362577489*f1L[4]+0.4743416490252568*f1L[2]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[5] = 0.9185586535436913*f1R[19]-0.5303300858899104*f1R[16]+0.6846531968814574*f1R[15]-0.5477225575051661*f1R[12]+1.060660171779821*f1R[11]-0.3952847075210473*f1R[9]+0.3162277660168379*f1R[8]+0.7905694150420947*f1R[7]-0.8215838362577489*f1R[4]+0.4743416490252568*f1R[2]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.4472135954999579*alpha0R[4]-0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[6] = (-0.7348469228349525*f1L[19])+0.7348469228349533*f1L[18]-1.42302494707577*f1L[17]-0.4242640687119281*f1L[16]+0.5477225575051661*f1L[15]+0.4242640687119285*f1L[14]+1.060660171779821*f1L[13]+0.5477225575051661*f1L[12]-1.060660171779821*f1L[11]-1.10227038425243*f1L[10]+0.3162277660168379*(f1L[9]+f1L[8])+0.7905694150420947*f1L[7]-0.6363961030678926*f1L[6]+0.8215838362577489*f1L[5]-0.8215838362577489*f1L[4]+0.4743416490252568*f1L[3]-0.4743416490252568*f1L[2]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[6] = 0.7348469228349525*f1R[19]-0.7348469228349533*f1R[18]-1.42302494707577*f1R[17]-0.4242640687119281*f1R[16]-0.5477225575051661*f1R[15]+0.4242640687119285*f1R[14]+1.060660171779821*f1R[13]-0.5477225575051661*f1R[12]-1.060660171779821*f1R[11]+1.10227038425243*f1R[10]+0.3162277660168379*(f1R[9]+f1R[8])+0.7905694150420947*f1R[7]-0.6363961030678926*f1R[6]-0.8215838362577489*f1R[5]+0.8215838362577489*f1R[4]+0.4743416490252568*f1R[3]-0.4743416490252568*f1R[2]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5*alpha0R[0]-0.5590169943749475*alpha0R[4] > 0) { 
    fUpOrd[7] = (-0.9185586535436913*f1L[18])+0.5477225575051661*f1L[15]-0.5303300858899104*f1L[14]+1.060660171779821*f1L[13]-0.6846531968814574*f1L[12]+0.3162277660168379*f1L[9]-0.3952847075210473*f1L[8]+0.7905694150420947*f1L[7]+0.8215838362577489*f1L[5]+0.4743416490252568*f1L[3]+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[7] = 0.9185586535436913*f1R[18]-0.5477225575051661*f1R[15]-0.5303300858899104*f1R[14]+1.060660171779821*f1R[13]+0.6846531968814574*f1R[12]+0.3162277660168379*f1R[9]-0.3952847075210473*f1R[8]+0.7905694150420947*f1R[7]-0.8215838362577489*f1R[5]+0.4743416490252568*f1R[3]-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.4472135954999579*alpha0R[4]+0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[8] = 0.7348469228349525*f1L[19]+0.7348469228349533*f1L[18]+1.42302494707577*f1L[17]+0.4242640687119281*f1L[16]+0.5477225575051661*f1L[15]+0.4242640687119285*f1L[14]+1.060660171779821*f1L[13]+0.5477225575051661*f1L[12]+1.060660171779821*f1L[11]+1.10227038425243*f1L[10]+0.3162277660168379*(f1L[9]+f1L[8])+0.7905694150420947*f1L[7]+0.6363961030678926*f1L[6]+0.8215838362577489*(f1L[5]+f1L[4])+0.4743416490252568*(f1L[3]+f1L[2])+0.6123724356957944*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[8] = (-0.7348469228349525*f1R[19])-0.7348469228349533*f1R[18]+1.42302494707577*f1R[17]+0.4242640687119281*f1R[16]-0.5477225575051661*f1R[15]+0.4242640687119285*f1R[14]+1.060660171779821*f1R[13]-0.5477225575051661*f1R[12]+1.060660171779821*f1R[11]-1.10227038425243*f1R[10]+0.3162277660168379*(f1R[9]+f1R[8])+0.7905694150420947*f1R[7]+0.6363961030678926*f1R[6]-0.8215838362577489*(f1R[5]+f1R[4])+0.4743416490252568*(f1R[3]+f1R[2])-0.6123724356957944*f1R[1]+0.3535533905932737*f1R[0]; 
  } 

  double fUp[9];
  fUp[0] = 0.154320987654321*fUpOrd[8]+0.2469135802469136*fUpOrd[7]+0.154320987654321*fUpOrd[6]+0.2469135802469136*fUpOrd[5]+0.3950617283950617*fUpOrd[4]+0.2469135802469136*fUpOrd[3]+0.154320987654321*fUpOrd[2]+0.2469135802469136*fUpOrd[1]+0.154320987654321*fUpOrd[0]; 
  fUp[1] = 0.2070433312499809*fUpOrd[8]-0.2070433312499809*fUpOrd[6]+0.3312693299999694*fUpOrd[5]-0.3312693299999694*fUpOrd[3]+0.2070433312499809*fUpOrd[2]-0.2070433312499809*fUpOrd[0]; 
  fUp[2] = 0.2070433312499809*fUpOrd[8]+0.3312693299999694*fUpOrd[7]+0.2070433312499809*fUpOrd[6]-0.2070433312499809*fUpOrd[2]-0.3312693299999694*fUpOrd[1]-0.2070433312499809*fUpOrd[0]; 
  fUp[3] = 0.2777777777777778*fUpOrd[8]-0.2777777777777778*fUpOrd[6]-0.2777777777777778*fUpOrd[2]+0.2777777777777778*fUpOrd[0]; 
  fUp[4] = 0.1380288874999873*fUpOrd[8]-0.2760577749999745*fUpOrd[7]+0.1380288874999873*fUpOrd[6]+0.2208462199999796*fUpOrd[5]-0.4416924399999593*fUpOrd[4]+0.2208462199999796*fUpOrd[3]+0.1380288874999873*fUpOrd[2]-0.2760577749999745*fUpOrd[1]+0.1380288874999873*fUpOrd[0]; 
  fUp[5] = 0.1380288874999873*fUpOrd[8]+0.2208462199999796*fUpOrd[7]+0.1380288874999873*fUpOrd[6]-0.2760577749999745*fUpOrd[5]-0.4416924399999593*fUpOrd[4]-0.2760577749999745*fUpOrd[3]+0.1380288874999873*fUpOrd[2]+0.2208462199999796*fUpOrd[1]+0.1380288874999873*fUpOrd[0]; 
  fUp[6] = 0.1851851851851852*fUpOrd[8]-0.3703703703703703*fUpOrd[7]+0.1851851851851852*fUpOrd[6]-0.1851851851851852*fUpOrd[2]+0.3703703703703703*fUpOrd[1]-0.1851851851851852*fUpOrd[0]; 
  fUp[7] = 0.1851851851851852*fUpOrd[8]-0.1851851851851852*fUpOrd[6]-0.3703703703703703*fUpOrd[5]+0.3703703703703703*fUpOrd[3]+0.1851851851851852*fUpOrd[2]-0.1851851851851852*fUpOrd[0]; 

  incr[0] = 0.3535533905932737*(alpha0R[4]*fUp[4]+alpha0R[1]*fUp[1]+alpha0R[0]*fUp[0]); 
  incr[1] = -0.6123724356957944*(alpha0R[4]*fUp[4]+alpha0R[1]*fUp[1]+alpha0R[0]*fUp[0]); 
  incr[2] = 0.07071067811865474*(4.47213595499958*(alpha0R[1]*fUp[4]+fUp[1]*alpha0R[4])+5.0*(alpha0R[0]*fUp[1]+fUp[0]*alpha0R[1])); 
  incr[3] = 0.02357022603955158*(15.0*alpha0R[4]*fUp[6]+15.0*(alpha0R[1]*fUp[3]+alpha0R[0]*fUp[2])); 
  incr[4] = -0.07071067811865474*(7.745966692414834*(alpha0R[1]*fUp[4]+fUp[1]*alpha0R[4])+8.660254037844386*(alpha0R[0]*fUp[1]+fUp[0]*alpha0R[1])); 
  incr[5] = -0.07071067811865474*(8.660254037844387*alpha0R[4]*fUp[6]+8.660254037844386*(alpha0R[1]*fUp[3]+alpha0R[0]*fUp[2])); 
  incr[6] = 0.02357022603955158*(13.41640786499874*alpha0R[1]*fUp[6]+13.41640786499874*fUp[3]*alpha0R[4]+15.0*(alpha0R[0]*fUp[3]+alpha0R[1]*fUp[2])); 
  incr[7] = 0.7905694150420947*(alpha0R[4]*fUp[4]+alpha0R[1]*fUp[1]+alpha0R[0]*fUp[0]); 
  incr[8] = 0.01010152544552211*((22.3606797749979*alpha0R[4]+35.0*alpha0R[0])*fUp[4]+35.0*fUp[0]*alpha0R[4]+31.30495168499706*alpha0R[1]*fUp[1]); 
  incr[9] = 0.02357022603955158*(15.0*alpha0R[1]*fUp[7]+15.0*alpha0R[0]*fUp[5]); 
  incr[10] = -0.07071067811865474*(7.745966692414834*(alpha0R[1]*fUp[6]+fUp[3]*alpha0R[4])+8.660254037844386*(alpha0R[0]*fUp[3]+alpha0R[1]*fUp[2])); 
  incr[11] = 0.02357022603955158*(30.0*(alpha0R[1]*fUp[4]+fUp[1]*alpha0R[4])+33.54101966249684*(alpha0R[0]*fUp[1]+fUp[0]*alpha0R[1])); 
  incr[12] = -0.01010152544552211*((38.72983346207417*alpha0R[4]+60.62177826491071*alpha0R[0])*fUp[4]+60.62177826491071*fUp[0]*alpha0R[4]+54.22176684690384*alpha0R[1]*fUp[1]); 
  incr[13] = 0.1178511301977579*(6.708203932499369*alpha0R[4]*fUp[6]+6.708203932499369*(alpha0R[1]*fUp[3]+alpha0R[0]*fUp[2])); 
  incr[14] = 0.003367175148507369*((67.0820393249937*alpha0R[4]+105.0*alpha0R[0])*fUp[6]+105.0*fUp[2]*alpha0R[4]+93.91485505499116*alpha0R[1]*fUp[3]); 
  incr[15] = -0.07071067811865474*(8.660254037844386*alpha0R[1]*fUp[7]+8.660254037844387*alpha0R[0]*fUp[5]); 
  incr[16] = 0.02357022603955158*((13.41640786499874*alpha0R[4]+15.0*alpha0R[0])*fUp[7]+15.0*alpha0R[1]*fUp[5]); 
  incr[17] = 0.02357022603955158*(30.0*alpha0R[1]*fUp[6]+30.0*fUp[3]*alpha0R[4]+33.54101966249685*(alpha0R[0]*fUp[3]+alpha0R[1]*fUp[2])); 
  incr[18] = -0.01010152544552211*((38.72983346207417*alpha0R[4]+60.62177826491071*alpha0R[0])*fUp[6]+60.6217782649107*fUp[2]*alpha0R[4]+54.22176684690384*alpha0R[1]*fUp[3]); 
  incr[19] = -0.07071067811865474*((7.745966692414834*alpha0R[4]+8.660254037844387*alpha0R[0])*fUp[7]+8.660254037844386*alpha0R[1]*fUp[5]); 

  outR[0] += incr[0]*rdx2R; 
  outR[1] += incr[1]*rdx2R; 
  outR[2] += incr[2]*rdx2R; 
  outR[3] += incr[3]*rdx2R; 
  outR[4] += incr[4]*rdx2R; 
  outR[5] += incr[5]*rdx2R; 
  outR[6] += incr[6]*rdx2R; 
  outR[7] += incr[7]*rdx2R; 
  outR[8] += incr[8]*rdx2R; 
  outR[9] += incr[9]*rdx2R; 
  outR[10] += incr[10]*rdx2R; 
  outR[11] += incr[11]*rdx2R; 
  outR[12] += incr[12]*rdx2R; 
  outR[13] += incr[13]*rdx2R; 
  outR[14] += incr[14]*rdx2R; 
  outR[15] += incr[15]*rdx2R; 
  outR[16] += incr[16]*rdx2R; 
  outR[17] += incr[17]*rdx2R; 
  outR[18] += incr[18]*rdx2R; 
  outR[19] += incr[19]*rdx2R; 

  outL[0] += -1.0*incr[0]*rdx2L; 
  outL[1] += incr[1]*rdx2L; 
  outL[2] += -1.0*incr[2]*rdx2L; 
  outL[3] += -1.0*incr[3]*rdx2L; 
  outL[4] += incr[4]*rdx2L; 
  outL[5] += incr[5]*rdx2L; 
  outL[6] += -1.0*incr[6]*rdx2L; 
  outL[7] += -1.0*incr[7]*rdx2L; 
  outL[8] += -1.0*incr[8]*rdx2L; 
  outL[9] += -1.0*incr[9]*rdx2L; 
  outL[10] += incr[10]*rdx2L; 
  outL[11] += -1.0*incr[11]*rdx2L; 
  outL[12] += incr[12]*rdx2L; 
  outL[13] += -1.0*incr[13]*rdx2L; 
  outL[14] += -1.0*incr[14]*rdx2L; 
  outL[15] += incr[15]*rdx2L; 
  outL[16] += -1.0*incr[16]*rdx2L; 
  outL[17] += -1.0*incr[17]*rdx2L; 
  outL[18] += incr[18]*rdx2L; 
  outL[19] += incr[19]*rdx2L; 

  // alpha1 == 0, so nothing to do for alpha1*f0 and alpha1*f1 terms.
  return std::abs(alphaSurfAvgR); 
} 
double LinearDeltaFGyrokineticGenGeoSurf1x2vSer_vpar_P2_Bvarsx(const double q_, const double m_, const double cflL, const double cflR, const double *wL, const double *dxvL, const double *wR, const double *dxvR, const double amax_in, const double *bmag, const double *jacobTotInv, const double *cmag, const double *b_x, const double *b_y, const double *b_z, const double *phi, const double *f0L, const double *f0R, const double *f1L, const double *f1R, double *outL, double *outR) 
{ 
  // jacobTotInv: reciprocal of the conf-space jacobian time the guiding center coordinate Jacobian.
  // b_x,b_y,b_z: covariant components of the field aligned unit vector.
  // q_,m_: species charge and mass.
  // cflL,cflR: CFL rate in left and right cells.
  // wL[NDIM],wR[NDIM]: cell-center in left and right cells.
  // dxvL[NDIM],dxvR[NDIM]: Cell length in left and right cells.
  // amax_in: maximum phase-space speed.
  // bmag: magnetic field amplitude.
  // cmag: coefficient multiplying parallel gradient.
  // phi: electrostatic potential .
  // fL,fR: Distribution function in left and right cells.
  // outL/outR: Output increment in left and right cells.

  double wxL = wL[0];
  double wxR = wR[0];
  double rdx2L = 2.0/dxvL[0];
  double rdx2R = 2.0/dxvR[0];
  double wvparL = wL[1];
  double wvparR = wR[1];
  double rdvpar2L = 2.0/dxvL[1];
  double rdvpar2R = 2.0/dxvR[1];
  double wmuL = wL[2];
  double wmuR = wR[2];
  double rdmu2L = 2.0/dxvL[2];
  double rdmu2R = 2.0/dxvR[2];

  double wxSqL = wL[0]*wL[0];
  double wxSqR = wR[0]*wR[0];
  double rdx2SqL = rdx2L*rdx2L;
  double rdx2SqR = rdx2R*rdx2R;
  double wvparSqL = wL[1]*wL[1];
  double wvparSqR = wR[1]*wR[1];
  double rdvpar2SqL = rdvpar2L*rdvpar2L;
  double rdvpar2SqR = rdvpar2R*rdvpar2R;
  double wmuSqL = wL[2]*wL[2];
  double wmuSqR = wR[2]*wR[2];
  double rdmu2SqL = rdmu2L*rdmu2L;
  double rdmu2SqR = rdmu2R*rdmu2R;

  double hamil0R[20]; 
  hamil0R[0] = (0.2357022603955158*(3.0*rdvpar2SqR*(2.0*m_*wvparSqR+2.828427124746191*bmag[0]*wmuR)+2.0*m_))/rdvpar2SqR; 
  hamil0R[1] = 2.0*bmag[1]*wmuR; 
  hamil0R[2] = (1.632993161855453*m_*wvparR)/rdvpar2R; 
  hamil0R[3] = (1.154700538379252*bmag[0])/rdmu2R; 
  hamil0R[5] = (1.154700538379252*bmag[1])/rdmu2R; 
  hamil0R[7] = 2.0*bmag[2]*wmuR; 
  hamil0R[8] = (0.421637021355784*m_)/rdvpar2SqR; 
  hamil0R[13] = (1.154700538379251*bmag[2])/rdmu2R; 

  double hamil1R[20]; 
  hamil1R[0] = 2.0*phi[0]*q_; 
  hamil1R[1] = 2.0*phi[1]*q_; 
  hamil1R[7] = 2.0*phi[2]*q_; 

  double BstarZdBmagR[20]; 
  BstarZdBmagR[0] = (1.414213562373095*(1.732050807568877*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R*wvparR+(cmag[2]*jacobTotInv[2]+cmag[1]*jacobTotInv[1]+cmag[0]*jacobTotInv[0])*q_))/q_; 
  BstarZdBmagR[1] = (0.2828427124746191*(1.732050807568877*(b_y[2]*(10.0*jacobTotInv[2]+11.18033988749895*jacobTotInv[0])+5.0*b_y[1]*jacobTotInv[1])*m_*rdx2R*wvparR+(4.47213595499958*(cmag[1]*jacobTotInv[2]+jacobTotInv[1]*cmag[2])+5.0*(cmag[0]*jacobTotInv[1]+jacobTotInv[0]*cmag[1]))*q_))/q_; 
  BstarZdBmagR[2] = (1.414213562373095*(2.23606797749979*jacobTotInv[1]*b_y[2]+jacobTotInv[0]*b_y[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[4] = (1.414213562373095*(b_y[2]*(2.0*jacobTotInv[2]+2.23606797749979*jacobTotInv[0])+b_y[1]*jacobTotInv[1])*m_*rdx2R)/(q_*rdvpar2R); 
  BstarZdBmagR[7] = (0.04040610178208843*(60.6217782649107*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R*wvparR+((22.3606797749979*cmag[2]+35.0*cmag[0])*jacobTotInv[2]+7.0*(5.0*jacobTotInv[0]*cmag[2]+4.47213595499958*cmag[1]*jacobTotInv[1]))*q_))/q_; 
  BstarZdBmagR[11] = (1.414213562373095*(b_y[1]*jacobTotInv[2]+2.0*jacobTotInv[1]*b_y[2])*m_*rdx2R)/(q_*rdvpar2R); 

  double alpha0R[8]; 
  alpha0R[0] = (0.25*((6.708203932499369*BstarZdBmagR[4]-3.872983346207417*BstarZdBmagR[1])*hamil0R[7]+hamil0R[1]*(3.0*BstarZdBmagR[2]-1.732050807568877*BstarZdBmagR[0]))*rdx2R)/m_; 
  alpha0R[1] = (0.05*(hamil0R[7]*(30.0*BstarZdBmagR[11]-17.32050807568877*BstarZdBmagR[7]+33.54101966249685*BstarZdBmagR[2]-19.36491673103709*BstarZdBmagR[0])+hamil0R[1]*(15.0*BstarZdBmagR[4]-8.660254037844386*BstarZdBmagR[1]))*rdx2R)/m_; 
  alpha0R[2] = (0.25*((6.708203932499369*BstarZdBmagR[4]-3.872983346207417*BstarZdBmagR[1])*hamil0R[13]+(3.0*BstarZdBmagR[2]-1.732050807568877*BstarZdBmagR[0])*hamil0R[5])*rdx2R)/m_; 
  alpha0R[3] = (0.05*((30.0*BstarZdBmagR[11]-17.32050807568877*BstarZdBmagR[7]+33.54101966249684*BstarZdBmagR[2]-19.36491673103708*BstarZdBmagR[0])*hamil0R[13]+(15.0*BstarZdBmagR[4]-8.660254037844386*BstarZdBmagR[1])*hamil0R[5])*rdx2R)/m_; 
  alpha0R[4] = (0.05*(15.0*hamil0R[1]*BstarZdBmagR[11]+(30.0*BstarZdBmagR[4]-17.32050807568877*BstarZdBmagR[1])*hamil0R[7]-8.660254037844386*hamil0R[1]*BstarZdBmagR[7])*rdx2R)/m_; 
  alpha0R[6] = (0.05*((30.0*BstarZdBmagR[4]-17.32050807568877*BstarZdBmagR[1])*hamil0R[13]+hamil0R[5]*(15.0*BstarZdBmagR[11]-8.660254037844387*BstarZdBmagR[7]))*rdx2R)/m_; 

  double alpha1R[8]; 
  alpha1R[0] = (0.25*((6.708203932499369*BstarZdBmagR[4]-3.872983346207417*BstarZdBmagR[1])*hamil1R[7]+hamil1R[1]*(3.0*BstarZdBmagR[2]-1.732050807568877*BstarZdBmagR[0]))*rdx2R)/m_; 
  alpha1R[1] = (0.05*(hamil1R[7]*(30.0*BstarZdBmagR[11]-17.32050807568877*BstarZdBmagR[7]+33.54101966249685*BstarZdBmagR[2]-19.36491673103709*BstarZdBmagR[0])+hamil1R[1]*(15.0*BstarZdBmagR[4]-8.660254037844386*BstarZdBmagR[1]))*rdx2R)/m_; 
  alpha1R[4] = (0.05*(15.0*hamil1R[1]*BstarZdBmagR[11]+(30.0*BstarZdBmagR[4]-17.32050807568877*BstarZdBmagR[1])*hamil1R[7]-8.660254037844386*hamil1R[1]*BstarZdBmagR[7])*rdx2R)/m_; 

  // Surface-averaged phase velocity in this direction.
  double alphaSurfAvgR = (0.0625*((6.708203932499369*BstarZdBmagR[4]-3.872983346207417*BstarZdBmagR[1])*hamil1R[7]+(6.708203932499369*BstarZdBmagR[4]-3.872983346207417*BstarZdBmagR[1])*hamil0R[7]+(3.0*hamil1R[1]+3.0*hamil0R[1])*BstarZdBmagR[2]-1.732050807568877*BstarZdBmagR[0]*hamil1R[1]-1.732050807568877*BstarZdBmagR[0]*hamil0R[1])*rdx2R)/m_; 

  double incr[20]; 
  // linear term alpha0*f1 
  double fUpOrd[9];
  if ((-0.5999999999999999*alpha0R[6])+0.4472135954999579*alpha0R[4]+0.9*alpha0R[3]-0.6708203932499369*(alpha0R[2]+alpha0R[1])+0.5*alpha0R[0] > 0) { 
    fUpOrd[0] = (-0.7348469228349525*f1L[19])+1.42302494707577*f1L[18]-0.7348469228349533*f1L[17]+0.5477225575051661*f1L[16]-0.4242640687119281*f1L[15]-1.060660171779821*f1L[14]-0.4242640687119285*f1L[13]-1.060660171779821*f1L[12]+0.5477225575051661*f1L[11]+1.10227038425243*f1L[10]+0.3162277660168379*f1L[9]+0.7905694150420947*f1L[8]+0.3162277660168379*f1L[7]-0.8215838362577489*f1L[6]+0.6363961030678926*f1L[5]-0.8215838362577489*f1L[4]-0.4743416490252568*f1L[3]+0.6123724356957944*f1L[2]-0.4743416490252568*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[0] = 0.7348469228349525*f1R[19]+1.42302494707577*f1R[18]+0.7348469228349533*f1R[17]-0.5477225575051661*f1R[16]-0.4242640687119281*f1R[15]-1.060660171779821*f1R[14]-0.4242640687119285*f1R[13]-1.060660171779821*f1R[12]-0.5477225575051661*f1R[11]-1.10227038425243*f1R[10]+0.3162277660168379*f1R[9]+0.7905694150420947*f1R[8]+0.3162277660168379*f1R[7]+0.8215838362577489*f1R[6]+0.6363961030678926*f1R[5]+0.8215838362577489*f1R[4]-0.4743416490252568*f1R[3]-0.6123724356957944*f1R[2]-0.4743416490252568*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.75*alpha0R[6]-0.5590169943749475*alpha0R[4]-0.6708203932499369*alpha0R[2]+0.5*alpha0R[0] > 0) { 
    fUpOrd[1] = 0.9185586535436913*f1L[17]+0.5477225575051661*f1L[16]-1.060660171779821*f1L[14]+0.5303300858899104*f1L[13]-0.6846531968814574*f1L[11]+0.3162277660168379*f1L[9]+0.7905694150420947*f1L[8]-0.3952847075210473*f1L[7]-0.8215838362577489*f1L[6]-0.4743416490252568*f1L[3]+0.6123724356957944*f1L[2]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[1] = (-0.9185586535436913*f1R[17])-0.5477225575051661*f1R[16]-1.060660171779821*f1R[14]+0.5303300858899104*f1R[13]+0.6846531968814574*f1R[11]+0.3162277660168379*f1R[9]+0.7905694150420947*f1R[8]-0.3952847075210473*f1R[7]+0.8215838362577489*f1R[6]-0.4743416490252568*f1R[3]-0.6123724356957944*f1R[2]+0.3535533905932737*f1R[0]; 
  } 
  if ((-0.5999999999999999*alpha0R[6])+0.4472135954999579*alpha0R[4]-0.9*alpha0R[3]-0.6708203932499369*alpha0R[2]+0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[2] = 0.7348469228349525*f1L[19]-1.42302494707577*f1L[18]-0.7348469228349533*f1L[17]+0.5477225575051661*f1L[16]+0.4242640687119281*f1L[15]-1.060660171779821*f1L[14]-0.4242640687119285*f1L[13]+1.060660171779821*f1L[12]+0.5477225575051661*f1L[11]-1.10227038425243*f1L[10]+0.3162277660168379*f1L[9]+0.7905694150420947*f1L[8]+0.3162277660168379*f1L[7]-0.8215838362577489*f1L[6]-0.6363961030678926*f1L[5]+0.8215838362577489*f1L[4]-0.4743416490252568*f1L[3]+0.6123724356957944*f1L[2]+0.4743416490252568*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[2] = (-0.7348469228349525*f1R[19])-1.42302494707577*f1R[18]+0.7348469228349533*f1R[17]-0.5477225575051661*f1R[16]+0.4242640687119281*f1R[15]-1.060660171779821*f1R[14]-0.4242640687119285*f1R[13]+1.060660171779821*f1R[12]-0.5477225575051661*f1R[11]+1.10227038425243*f1R[10]+0.3162277660168379*f1R[9]+0.7905694150420947*f1R[8]+0.3162277660168379*f1R[7]+0.8215838362577489*f1R[6]-0.6363961030678926*f1R[5]-0.8215838362577489*f1R[4]-0.4743416490252568*f1R[3]-0.6123724356957944*f1R[2]+0.4743416490252568*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.4472135954999579*alpha0R[4]-0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[3] = 0.9185586535436913*f1L[19]-0.6846531968814574*f1L[16]+0.5303300858899104*f1L[15]-1.060660171779821*f1L[12]+0.5477225575051661*f1L[11]-0.3952847075210473*f1L[9]+0.7905694150420947*f1L[8]+0.3162277660168379*f1L[7]-0.8215838362577489*f1L[4]+0.6123724356957944*f1L[2]-0.4743416490252568*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[3] = (-0.9185586535436913*f1R[19])+0.6846531968814574*f1R[16]+0.5303300858899104*f1R[15]-1.060660171779821*f1R[12]-0.5477225575051661*f1R[11]-0.3952847075210473*f1R[9]+0.7905694150420947*f1R[8]+0.3162277660168379*f1R[7]+0.8215838362577489*f1R[4]-0.6123724356957944*f1R[2]-0.4743416490252568*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5*alpha0R[0]-0.5590169943749475*alpha0R[4] > 0) { 
    fUpOrd[4] = (-0.6846531968814574*(f1L[16]+f1L[11]))-0.3952847075210473*f1L[9]+0.7905694150420947*f1L[8]-0.3952847075210473*f1L[7]+0.6123724356957944*f1L[2]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[4] = 0.6846531968814574*(f1R[16]+f1R[11])-0.3952847075210473*f1R[9]+0.7905694150420947*f1R[8]-0.3952847075210473*f1R[7]-0.6123724356957944*f1R[2]+0.3535533905932737*f1R[0]; 
  } 
  if (0.4472135954999579*alpha0R[4]+0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[5] = (-0.9185586535436913*f1L[19])-0.6846531968814574*f1L[16]-0.5303300858899104*f1L[15]+1.060660171779821*f1L[12]+0.5477225575051661*f1L[11]-0.3952847075210473*f1L[9]+0.7905694150420947*f1L[8]+0.3162277660168379*f1L[7]+0.8215838362577489*f1L[4]+0.6123724356957944*f1L[2]+0.4743416490252568*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[5] = 0.9185586535436913*f1R[19]+0.6846531968814574*f1R[16]-0.5303300858899104*f1R[15]+1.060660171779821*f1R[12]-0.5477225575051661*f1R[11]-0.3952847075210473*f1R[9]+0.7905694150420947*f1R[8]+0.3162277660168379*f1R[7]-0.8215838362577489*f1R[4]-0.6123724356957944*f1R[2]+0.4743416490252568*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5999999999999999*alpha0R[6]+0.4472135954999579*alpha0R[4]-0.9*alpha0R[3]+0.6708203932499369*alpha0R[2]-0.6708203932499369*alpha0R[1]+0.5*alpha0R[0] > 0) { 
    fUpOrd[6] = (-0.7348469228349525*f1L[19])-1.42302494707577*f1L[18]+0.7348469228349533*f1L[17]+0.5477225575051661*f1L[16]-0.4242640687119281*f1L[15]+1.060660171779821*f1L[14]+0.4242640687119285*f1L[13]-1.060660171779821*f1L[12]+0.5477225575051661*f1L[11]-1.10227038425243*f1L[10]+0.3162277660168379*f1L[9]+0.7905694150420947*f1L[8]+0.3162277660168379*f1L[7]+0.8215838362577489*f1L[6]-0.6363961030678926*f1L[5]-0.8215838362577489*f1L[4]+0.4743416490252568*f1L[3]+0.6123724356957944*f1L[2]-0.4743416490252568*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[6] = 0.7348469228349525*f1R[19]-1.42302494707577*f1R[18]-0.7348469228349533*f1R[17]-0.5477225575051661*f1R[16]-0.4242640687119281*f1R[15]+1.060660171779821*f1R[14]+0.4242640687119285*f1R[13]-1.060660171779821*f1R[12]-0.5477225575051661*f1R[11]+1.10227038425243*f1R[10]+0.3162277660168379*f1R[9]+0.7905694150420947*f1R[8]+0.3162277660168379*f1R[7]-0.8215838362577489*f1R[6]-0.6363961030678926*f1R[5]+0.8215838362577489*f1R[4]+0.4743416490252568*f1R[3]-0.6123724356957944*f1R[2]-0.4743416490252568*f1R[1]+0.3535533905932737*f1R[0]; 
  } 
  if ((-0.75*alpha0R[6])-0.5590169943749475*alpha0R[4]+0.6708203932499369*alpha0R[2]+0.5*alpha0R[0] > 0) { 
    fUpOrd[7] = (-0.9185586535436913*f1L[17])+0.5477225575051661*f1L[16]+1.060660171779821*f1L[14]-0.5303300858899104*f1L[13]-0.6846531968814574*f1L[11]+0.3162277660168379*f1L[9]+0.7905694150420947*f1L[8]-0.3952847075210473*f1L[7]+0.8215838362577489*f1L[6]+0.4743416490252568*f1L[3]+0.6123724356957944*f1L[2]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[7] = 0.9185586535436913*f1R[17]-0.5477225575051661*f1R[16]+1.060660171779821*f1R[14]-0.5303300858899104*f1R[13]+0.6846531968814574*f1R[11]+0.3162277660168379*f1R[9]+0.7905694150420947*f1R[8]-0.3952847075210473*f1R[7]-0.8215838362577489*f1R[6]+0.4743416490252568*f1R[3]-0.6123724356957944*f1R[2]+0.3535533905932737*f1R[0]; 
  } 
  if (0.5999999999999999*alpha0R[6]+0.4472135954999579*alpha0R[4]+0.9*alpha0R[3]+0.6708203932499369*(alpha0R[2]+alpha0R[1])+0.5*alpha0R[0] > 0) { 
    fUpOrd[8] = 0.7348469228349525*f1L[19]+1.42302494707577*f1L[18]+0.7348469228349533*f1L[17]+0.5477225575051661*f1L[16]+0.4242640687119281*f1L[15]+1.060660171779821*f1L[14]+0.4242640687119285*f1L[13]+1.060660171779821*f1L[12]+0.5477225575051661*f1L[11]+1.10227038425243*f1L[10]+0.3162277660168379*f1L[9]+0.7905694150420947*f1L[8]+0.3162277660168379*f1L[7]+0.8215838362577489*f1L[6]+0.6363961030678926*f1L[5]+0.8215838362577489*f1L[4]+0.4743416490252568*f1L[3]+0.6123724356957944*f1L[2]+0.4743416490252568*f1L[1]+0.3535533905932737*f1L[0]; 
  } else { 
    fUpOrd[8] = (-0.7348469228349525*f1R[19])+1.42302494707577*f1R[18]-0.7348469228349533*f1R[17]-0.5477225575051661*f1R[16]+0.4242640687119281*f1R[15]+1.060660171779821*f1R[14]+0.4242640687119285*f1R[13]+1.060660171779821*f1R[12]-0.5477225575051661*f1R[11]-1.10227038425243*f1R[10]+0.3162277660168379*f1R[9]+0.7905694150420947*f1R[8]+0.3162277660168379*f1R[7]-0.8215838362577489*f1R[6]+0.6363961030678926*f1R[5]-0.8215838362577489*f1R[4]+0.4743416490252568*f1R[3]-0.6123724356957944*f1R[2]+0.4743416490252568*f1R[1]+0.3535533905932737*f1R[0]; 
  } 

  double fUp[9];
  fUp[0] = 0.154320987654321*fUpOrd[8]+0.2469135802469136*fUpOrd[7]+0.154320987654321*fUpOrd[6]+0.2469135802469136*fUpOrd[5]+0.3950617283950617*fUpOrd[4]+0.2469135802469136*fUpOrd[3]+0.154320987654321*fUpOrd[2]+0.2469135802469136*fUpOrd[1]+0.154320987654321*fUpOrd[0]; 
  fUp[1] = 0.2070433312499809*fUpOrd[8]-0.2070433312499809*fUpOrd[6]+0.3312693299999694*fUpOrd[5]-0.3312693299999694*fUpOrd[3]+0.2070433312499809*fUpOrd[2]-0.2070433312499809*fUpOrd[0]; 
  fUp[2] = 0.2070433312499809*fUpOrd[8]+0.3312693299999694*fUpOrd[7]+0.2070433312499809*fUpOrd[6]-0.2070433312499809*fUpOrd[2]-0.3312693299999694*fUpOrd[1]-0.2070433312499809*fUpOrd[0]; 
  fUp[3] = 0.2777777777777778*fUpOrd[8]-0.2777777777777778*fUpOrd[6]-0.2777777777777778*fUpOrd[2]+0.2777777777777778*fUpOrd[0]; 
  fUp[4] = 0.1380288874999873*fUpOrd[8]-0.2760577749999745*fUpOrd[7]+0.1380288874999873*fUpOrd[6]+0.2208462199999796*fUpOrd[5]-0.4416924399999593*fUpOrd[4]+0.2208462199999796*fUpOrd[3]+0.1380288874999873*fUpOrd[2]-0.2760577749999745*fUpOrd[1]+0.1380288874999873*fUpOrd[0]; 
  fUp[5] = 0.1380288874999873*fUpOrd[8]+0.2208462199999796*fUpOrd[7]+0.1380288874999873*fUpOrd[6]-0.2760577749999745*fUpOrd[5]-0.4416924399999593*fUpOrd[4]-0.2760577749999745*fUpOrd[3]+0.1380288874999873*fUpOrd[2]+0.2208462199999796*fUpOrd[1]+0.1380288874999873*fUpOrd[0]; 
  fUp[6] = 0.1851851851851852*fUpOrd[8]-0.3703703703703703*fUpOrd[7]+0.1851851851851852*fUpOrd[6]-0.1851851851851852*fUpOrd[2]+0.3703703703703703*fUpOrd[1]-0.1851851851851852*fUpOrd[0]; 
  fUp[7] = 0.1851851851851852*fUpOrd[8]-0.1851851851851852*fUpOrd[6]-0.3703703703703703*fUpOrd[5]+0.3703703703703703*fUpOrd[3]+0.1851851851851852*fUpOrd[2]-0.1851851851851852*fUpOrd[0]; 

  incr[0] = 0.3535533905932737*(alpha0R[6]*fUp[6]+alpha0R[4]*fUp[4]+alpha0R[3]*fUp[3]+alpha0R[2]*fUp[2]+alpha0R[1]*fUp[1]+alpha0R[0]*fUp[0]); 
  incr[1] = 0.02357022603955158*(13.41640786499874*(alpha0R[3]*fUp[6]+fUp[3]*alpha0R[6])+13.41640786499874*(alpha0R[1]*fUp[4]+fUp[1]*alpha0R[4])+15.0*(alpha0R[2]*fUp[3]+fUp[2]*alpha0R[3]+alpha0R[0]*fUp[1]+fUp[0]*alpha0R[1])); 
  incr[2] = -0.6123724356957944*(alpha0R[6]*fUp[6]+alpha0R[4]*fUp[4]+alpha0R[3]*fUp[3]+alpha0R[2]*fUp[2]+alpha0R[1]*fUp[1]+alpha0R[0]*fUp[0]); 
  incr[3] = 0.02357022603955158*(13.41640786499874*alpha0R[3]*fUp[7]+15.0*(alpha0R[4]*fUp[6]+fUp[4]*alpha0R[6])+13.41640786499874*alpha0R[2]*fUp[5]+15.0*(alpha0R[1]*fUp[3]+fUp[1]*alpha0R[3]+alpha0R[0]*fUp[2]+fUp[0]*alpha0R[2])); 
  incr[4] = -0.07071067811865474*(7.745966692414834*(alpha0R[3]*fUp[6]+fUp[3]*alpha0R[6]+alpha0R[1]*fUp[4]+fUp[1]*alpha0R[4])+8.660254037844386*(alpha0R[2]*fUp[3]+fUp[2]*alpha0R[3]+alpha0R[0]*fUp[1]+fUp[0]*alpha0R[1])); 
  incr[5] = 0.02357022603955158*((12.0*alpha0R[6]+13.41640786499874*alpha0R[2])*fUp[7]+13.41640786499874*(alpha0R[1]*fUp[6]+fUp[1]*alpha0R[6])+13.41640786499874*(alpha0R[3]*(fUp[5]+fUp[4])+fUp[3]*alpha0R[4])+15.0*(alpha0R[0]*fUp[3]+fUp[0]*alpha0R[3]+alpha0R[1]*fUp[2]+fUp[1]*alpha0R[2])); 
  incr[6] = -0.07071067811865474*(7.745966692414834*alpha0R[3]*fUp[7]+8.660254037844387*(alpha0R[4]*fUp[6]+fUp[4]*alpha0R[6])+7.745966692414834*alpha0R[2]*fUp[5]+8.660254037844386*(alpha0R[1]*fUp[3]+fUp[1]*alpha0R[3]+alpha0R[0]*fUp[2]+fUp[0]*alpha0R[2])); 
  incr[7] = 0.003367175148507369*((67.0820393249937*alpha0R[6]+105.0*alpha0R[2])*fUp[6]+105.0*fUp[2]*alpha0R[6]+(67.0820393249937*alpha0R[4]+105.0*alpha0R[0])*fUp[4]+105.0*fUp[0]*alpha0R[4]+93.91485505499116*(alpha0R[3]*fUp[3]+alpha0R[1]*fUp[1])); 
  incr[8] = 0.7905694150420947*(alpha0R[6]*fUp[6]+alpha0R[4]*fUp[4]+alpha0R[3]*fUp[3]+alpha0R[2]*fUp[2]+alpha0R[1]*fUp[1]+alpha0R[0]*fUp[0]); 
  incr[9] = 0.02357022603955158*(15.0*alpha0R[1]*fUp[7]+13.41640786499874*alpha0R[6]*fUp[6]+15.0*alpha0R[0]*fUp[5]+13.41640786499874*(alpha0R[3]*fUp[3]+alpha0R[2]*fUp[2])); 
  incr[10] = -0.07071067811865474*((6.928203230275509*alpha0R[6]+7.745966692414834*alpha0R[2])*fUp[7]+7.745966692414834*(alpha0R[1]*fUp[6]+fUp[1]*alpha0R[6]+alpha0R[3]*(fUp[5]+fUp[4])+fUp[3]*alpha0R[4])+8.660254037844386*(alpha0R[0]*fUp[3]+fUp[0]*alpha0R[3]+alpha0R[1]*fUp[2]+fUp[1]*alpha0R[2])); 
  incr[11] = -0.01010152544552211*((38.72983346207417*alpha0R[6]+60.6217782649107*alpha0R[2])*fUp[6]+60.6217782649107*fUp[2]*alpha0R[6]+(38.72983346207417*alpha0R[4]+60.62177826491071*alpha0R[0])*fUp[4]+60.62177826491071*fUp[0]*alpha0R[4]+54.22176684690384*(alpha0R[3]*fUp[3]+alpha0R[1]*fUp[1])); 
  incr[12] = 0.02357022603955158*(30.0*(alpha0R[3]*fUp[6]+fUp[3]*alpha0R[6])+30.0*(alpha0R[1]*fUp[4]+fUp[1]*alpha0R[4])+33.54101966249684*(alpha0R[2]*fUp[3]+fUp[2]*alpha0R[3]+alpha0R[0]*fUp[1]+fUp[0]*alpha0R[1])); 
  incr[13] = 0.003367175148507369*(84.0*alpha0R[3]*fUp[7]+(67.0820393249937*alpha0R[4]+105.0*alpha0R[0])*fUp[6]+(93.91485505499116*fUp[5]+67.0820393249937*fUp[4]+105.0*fUp[0])*alpha0R[6]+105.0*(alpha0R[2]*fUp[4]+fUp[2]*alpha0R[4])+93.91485505499116*(alpha0R[1]*fUp[3]+fUp[1]*alpha0R[3])); 
  incr[14] = 0.02357022603955158*(30.0*alpha0R[3]*fUp[7]+33.54101966249685*(alpha0R[4]*fUp[6]+fUp[4]*alpha0R[6])+30.0*alpha0R[2]*fUp[5]+33.54101966249684*(alpha0R[1]*fUp[3]+fUp[1]*alpha0R[3]+alpha0R[0]*fUp[2]+fUp[0]*alpha0R[2])); 
  incr[15] = 0.02357022603955158*((13.41640786499874*alpha0R[4]+15.0*alpha0R[0])*fUp[7]+12.0*(alpha0R[3]*fUp[6]+fUp[3]*alpha0R[6])+15.0*alpha0R[1]*fUp[5]+13.41640786499874*(alpha0R[2]*fUp[3]+fUp[2]*alpha0R[3])); 
  incr[16] = -0.07071067811865474*(8.660254037844386*alpha0R[1]*fUp[7]+7.745966692414834*alpha0R[6]*fUp[6]+8.660254037844387*alpha0R[0]*fUp[5]+7.745966692414834*(alpha0R[3]*fUp[3]+alpha0R[2]*fUp[2])); 
  incr[17] = -0.002020305089104421*(242.4871130596428*alpha0R[3]*fUp[7]+(193.6491673103708*alpha0R[4]+303.1088913245536*alpha0R[0])*fUp[6]+(271.1088342345192*fUp[5]+193.6491673103708*fUp[4]+303.1088913245536*fUp[0])*alpha0R[6]+303.1088913245535*(alpha0R[2]*fUp[4]+fUp[2]*alpha0R[4])+271.1088342345192*(alpha0R[1]*fUp[3]+fUp[1]*alpha0R[3])); 
  incr[18] = 0.02357022603955158*((26.83281572999748*alpha0R[6]+30.0*alpha0R[2])*fUp[7]+30.0*(alpha0R[1]*fUp[6]+fUp[1]*alpha0R[6])+30.0*(alpha0R[3]*(fUp[5]+fUp[4])+fUp[3]*alpha0R[4])+33.54101966249685*(alpha0R[0]*fUp[3]+fUp[0]*alpha0R[3]+alpha0R[1]*fUp[2]+fUp[1]*alpha0R[2])); 
  incr[19] = -0.01414213562373095*((38.72983346207417*alpha0R[4]+43.30127018922195*alpha0R[0])*fUp[7]+34.64101615137755*(alpha0R[3]*fUp[6]+fUp[3]*alpha0R[6])+43.30127018922193*alpha0R[1]*fUp[5]+38.72983346207418*(alpha0R[2]*fUp[3]+fUp[2]*alpha0R[3])); 

  outR[0] += incr[0]*rdvpar2R; 
  outR[1] += incr[1]*rdvpar2R; 
  outR[2] += incr[2]*rdvpar2R; 
  outR[3] += incr[3]*rdvpar2R; 
  outR[4] += incr[4]*rdvpar2R; 
  outR[5] += incr[5]*rdvpar2R; 
  outR[6] += incr[6]*rdvpar2R; 
  outR[7] += incr[7]*rdvpar2R; 
  outR[8] += incr[8]*rdvpar2R; 
  outR[9] += incr[9]*rdvpar2R; 
  outR[10] += incr[10]*rdvpar2R; 
  outR[11] += incr[11]*rdvpar2R; 
  outR[12] += incr[12]*rdvpar2R; 
  outR[13] += incr[13]*rdvpar2R; 
  outR[14] += incr[14]*rdvpar2R; 
  outR[15] += incr[15]*rdvpar2R; 
  outR[16] += incr[16]*rdvpar2R; 
  outR[17] += incr[17]*rdvpar2R; 
  outR[18] += incr[18]*rdvpar2R; 
  outR[19] += incr[19]*rdvpar2R; 

  outL[0] += -1.0*incr[0]*rdvpar2L; 
  outL[1] += -1.0*incr[1]*rdvpar2L; 
  outL[2] += incr[2]*rdvpar2L; 
  outL[3] += -1.0*incr[3]*rdvpar2L; 
  outL[4] += incr[4]*rdvpar2L; 
  outL[5] += -1.0*incr[5]*rdvpar2L; 
  outL[6] += incr[6]*rdvpar2L; 
  outL[7] += -1.0*incr[7]*rdvpar2L; 
  outL[8] += -1.0*incr[8]*rdvpar2L; 
  outL[9] += -1.0*incr[9]*rdvpar2L; 
  outL[10] += incr[10]*rdvpar2L; 
  outL[11] += incr[11]*rdvpar2L; 
  outL[12] += -1.0*incr[12]*rdvpar2L; 
  outL[13] += -1.0*incr[13]*rdvpar2L; 
  outL[14] += -1.0*incr[14]*rdvpar2L; 
  outL[15] += -1.0*incr[15]*rdvpar2L; 
  outL[16] += incr[16]*rdvpar2L; 
  outL[17] += incr[17]*rdvpar2L; 
  outL[18] += -1.0*incr[18]*rdvpar2L; 
  outL[19] += incr[19]*rdvpar2L; 

  // linear term alpha1*f0 
  if (0.4472135954999579*alpha1R[4]-0.6708203932499369*alpha1R[1]+0.5*alpha1R[0] > 0) { 
    fUpOrd[0] = (-0.7348469228349525*f0L[19])+1.42302494707577*f0L[18]-0.7348469228349533*f0L[17]+0.5477225575051661*f0L[16]-0.4242640687119281*f0L[15]-1.060660171779821*f0L[14]-0.4242640687119285*f0L[13]-1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]+1.10227038425243*f0L[10]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]-0.8215838362577489*f0L[6]+0.6363961030678926*f0L[5]-0.8215838362577489*f0L[4]-0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]-0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[0] = 0.7348469228349525*f0R[19]+1.42302494707577*f0R[18]+0.7348469228349533*f0R[17]-0.5477225575051661*f0R[16]-0.4242640687119281*f0R[15]-1.060660171779821*f0R[14]-0.4242640687119285*f0R[13]-1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]-1.10227038425243*f0R[10]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]+0.8215838362577489*f0R[6]+0.6363961030678926*f0R[5]+0.8215838362577489*f0R[4]-0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]-0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 
  if (0.5*alpha1R[0]-0.5590169943749475*alpha1R[4] > 0) { 
    fUpOrd[1] = 0.9185586535436913*f0L[17]+0.5477225575051661*f0L[16]-1.060660171779821*f0L[14]+0.5303300858899104*f0L[13]-0.6846531968814574*f0L[11]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]-0.3952847075210473*f0L[7]-0.8215838362577489*f0L[6]-0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[1] = (-0.9185586535436913*f0R[17])-0.5477225575051661*f0R[16]-1.060660171779821*f0R[14]+0.5303300858899104*f0R[13]+0.6846531968814574*f0R[11]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]-0.3952847075210473*f0R[7]+0.8215838362577489*f0R[6]-0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]+0.3535533905932737*f0R[0]; 
  } 
  if (0.4472135954999579*alpha1R[4]+0.6708203932499369*alpha1R[1]+0.5*alpha1R[0] > 0) { 
    fUpOrd[2] = 0.7348469228349525*f0L[19]-1.42302494707577*f0L[18]-0.7348469228349533*f0L[17]+0.5477225575051661*f0L[16]+0.4242640687119281*f0L[15]-1.060660171779821*f0L[14]-0.4242640687119285*f0L[13]+1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]-1.10227038425243*f0L[10]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]-0.8215838362577489*f0L[6]-0.6363961030678926*f0L[5]+0.8215838362577489*f0L[4]-0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]+0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[2] = (-0.7348469228349525*f0R[19])-1.42302494707577*f0R[18]+0.7348469228349533*f0R[17]-0.5477225575051661*f0R[16]+0.4242640687119281*f0R[15]-1.060660171779821*f0R[14]-0.4242640687119285*f0R[13]+1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]+1.10227038425243*f0R[10]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]+0.8215838362577489*f0R[6]-0.6363961030678926*f0R[5]-0.8215838362577489*f0R[4]-0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]+0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 
  if (0.4472135954999579*alpha1R[4]-0.6708203932499369*alpha1R[1]+0.5*alpha1R[0] > 0) { 
    fUpOrd[3] = 0.9185586535436913*f0L[19]-0.6846531968814574*f0L[16]+0.5303300858899104*f0L[15]-1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]-0.3952847075210473*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]-0.8215838362577489*f0L[4]+0.6123724356957944*f0L[2]-0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[3] = (-0.9185586535436913*f0R[19])+0.6846531968814574*f0R[16]+0.5303300858899104*f0R[15]-1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]-0.3952847075210473*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]+0.8215838362577489*f0R[4]-0.6123724356957944*f0R[2]-0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 
  if (0.5*alpha1R[0]-0.5590169943749475*alpha1R[4] > 0) { 
    fUpOrd[4] = (-0.6846531968814574*(f0L[16]+f0L[11]))-0.3952847075210473*f0L[9]+0.7905694150420947*f0L[8]-0.3952847075210473*f0L[7]+0.6123724356957944*f0L[2]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[4] = 0.6846531968814574*(f0R[16]+f0R[11])-0.3952847075210473*f0R[9]+0.7905694150420947*f0R[8]-0.3952847075210473*f0R[7]-0.6123724356957944*f0R[2]+0.3535533905932737*f0R[0]; 
  } 
  if (0.4472135954999579*alpha1R[4]+0.6708203932499369*alpha1R[1]+0.5*alpha1R[0] > 0) { 
    fUpOrd[5] = (-0.9185586535436913*f0L[19])-0.6846531968814574*f0L[16]-0.5303300858899104*f0L[15]+1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]-0.3952847075210473*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]+0.8215838362577489*f0L[4]+0.6123724356957944*f0L[2]+0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[5] = 0.9185586535436913*f0R[19]+0.6846531968814574*f0R[16]-0.5303300858899104*f0R[15]+1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]-0.3952847075210473*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]-0.8215838362577489*f0R[4]-0.6123724356957944*f0R[2]+0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 
  if (0.4472135954999579*alpha1R[4]-0.6708203932499369*alpha1R[1]+0.5*alpha1R[0] > 0) { 
    fUpOrd[6] = (-0.7348469228349525*f0L[19])-1.42302494707577*f0L[18]+0.7348469228349533*f0L[17]+0.5477225575051661*f0L[16]-0.4242640687119281*f0L[15]+1.060660171779821*f0L[14]+0.4242640687119285*f0L[13]-1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]-1.10227038425243*f0L[10]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]+0.8215838362577489*f0L[6]-0.6363961030678926*f0L[5]-0.8215838362577489*f0L[4]+0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]-0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[6] = 0.7348469228349525*f0R[19]-1.42302494707577*f0R[18]-0.7348469228349533*f0R[17]-0.5477225575051661*f0R[16]-0.4242640687119281*f0R[15]+1.060660171779821*f0R[14]+0.4242640687119285*f0R[13]-1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]+1.10227038425243*f0R[10]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]-0.8215838362577489*f0R[6]-0.6363961030678926*f0R[5]+0.8215838362577489*f0R[4]+0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]-0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 
  if (0.5*alpha1R[0]-0.5590169943749475*alpha1R[4] > 0) { 
    fUpOrd[7] = (-0.9185586535436913*f0L[17])+0.5477225575051661*f0L[16]+1.060660171779821*f0L[14]-0.5303300858899104*f0L[13]-0.6846531968814574*f0L[11]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]-0.3952847075210473*f0L[7]+0.8215838362577489*f0L[6]+0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[7] = 0.9185586535436913*f0R[17]-0.5477225575051661*f0R[16]+1.060660171779821*f0R[14]-0.5303300858899104*f0R[13]+0.6846531968814574*f0R[11]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]-0.3952847075210473*f0R[7]-0.8215838362577489*f0R[6]+0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]+0.3535533905932737*f0R[0]; 
  } 
  if (0.4472135954999579*alpha1R[4]+0.6708203932499369*alpha1R[1]+0.5*alpha1R[0] > 0) { 
    fUpOrd[8] = 0.7348469228349525*f0L[19]+1.42302494707577*f0L[18]+0.7348469228349533*f0L[17]+0.5477225575051661*f0L[16]+0.4242640687119281*f0L[15]+1.060660171779821*f0L[14]+0.4242640687119285*f0L[13]+1.060660171779821*f0L[12]+0.5477225575051661*f0L[11]+1.10227038425243*f0L[10]+0.3162277660168379*f0L[9]+0.7905694150420947*f0L[8]+0.3162277660168379*f0L[7]+0.8215838362577489*f0L[6]+0.6363961030678926*f0L[5]+0.8215838362577489*f0L[4]+0.4743416490252568*f0L[3]+0.6123724356957944*f0L[2]+0.4743416490252568*f0L[1]+0.3535533905932737*f0L[0]; 
  } else { 
    fUpOrd[8] = (-0.7348469228349525*f0R[19])+1.42302494707577*f0R[18]-0.7348469228349533*f0R[17]-0.5477225575051661*f0R[16]+0.4242640687119281*f0R[15]+1.060660171779821*f0R[14]+0.4242640687119285*f0R[13]+1.060660171779821*f0R[12]-0.5477225575051661*f0R[11]-1.10227038425243*f0R[10]+0.3162277660168379*f0R[9]+0.7905694150420947*f0R[8]+0.3162277660168379*f0R[7]-0.8215838362577489*f0R[6]+0.6363961030678926*f0R[5]-0.8215838362577489*f0R[4]+0.4743416490252568*f0R[3]-0.6123724356957944*f0R[2]+0.4743416490252568*f0R[1]+0.3535533905932737*f0R[0]; 
  } 

  fUp[0] = 0.154320987654321*fUpOrd[8]+0.2469135802469136*fUpOrd[7]+0.154320987654321*fUpOrd[6]+0.2469135802469136*fUpOrd[5]+0.3950617283950617*fUpOrd[4]+0.2469135802469136*fUpOrd[3]+0.154320987654321*fUpOrd[2]+0.2469135802469136*fUpOrd[1]+0.154320987654321*fUpOrd[0]; 
  fUp[1] = 0.2070433312499809*fUpOrd[8]-0.2070433312499809*fUpOrd[6]+0.3312693299999694*fUpOrd[5]-0.3312693299999694*fUpOrd[3]+0.2070433312499809*fUpOrd[2]-0.2070433312499809*fUpOrd[0]; 
  fUp[2] = 0.2070433312499809*fUpOrd[8]+0.3312693299999694*fUpOrd[7]+0.2070433312499809*fUpOrd[6]-0.2070433312499809*fUpOrd[2]-0.3312693299999694*fUpOrd[1]-0.2070433312499809*fUpOrd[0]; 
  fUp[3] = 0.2777777777777778*fUpOrd[8]-0.2777777777777778*fUpOrd[6]-0.2777777777777778*fUpOrd[2]+0.2777777777777778*fUpOrd[0]; 
  fUp[4] = 0.1380288874999873*fUpOrd[8]-0.2760577749999745*fUpOrd[7]+0.1380288874999873*fUpOrd[6]+0.2208462199999796*fUpOrd[5]-0.4416924399999593*fUpOrd[4]+0.2208462199999796*fUpOrd[3]+0.1380288874999873*fUpOrd[2]-0.2760577749999745*fUpOrd[1]+0.1380288874999873*fUpOrd[0]; 
  fUp[5] = 0.1380288874999873*fUpOrd[8]+0.2208462199999796*fUpOrd[7]+0.1380288874999873*fUpOrd[6]-0.2760577749999745*fUpOrd[5]-0.4416924399999593*fUpOrd[4]-0.2760577749999745*fUpOrd[3]+0.1380288874999873*fUpOrd[2]+0.2208462199999796*fUpOrd[1]+0.1380288874999873*fUpOrd[0]; 
  fUp[6] = 0.1851851851851852*fUpOrd[8]-0.3703703703703703*fUpOrd[7]+0.1851851851851852*fUpOrd[6]-0.1851851851851852*fUpOrd[2]+0.3703703703703703*fUpOrd[1]-0.1851851851851852*fUpOrd[0]; 
  fUp[7] = 0.1851851851851852*fUpOrd[8]-0.1851851851851852*fUpOrd[6]-0.3703703703703703*fUpOrd[5]+0.3703703703703703*fUpOrd[3]+0.1851851851851852*fUpOrd[2]-0.1851851851851852*fUpOrd[0]; 

  incr[0] = 0.3535533905932737*(alpha1R[4]*fUp[4]+alpha1R[1]*fUp[1]+alpha1R[0]*fUp[0]); 
  incr[1] = 0.07071067811865474*(4.47213595499958*(alpha1R[1]*fUp[4]+fUp[1]*alpha1R[4])+5.0*(alpha1R[0]*fUp[1]+fUp[0]*alpha1R[1])); 
  incr[2] = -0.6123724356957944*(alpha1R[4]*fUp[4]+alpha1R[1]*fUp[1]+alpha1R[0]*fUp[0]); 
  incr[3] = 0.02357022603955158*(15.0*alpha1R[4]*fUp[6]+15.0*(alpha1R[1]*fUp[3]+alpha1R[0]*fUp[2])); 
  incr[4] = -0.07071067811865474*(7.745966692414834*(alpha1R[1]*fUp[4]+fUp[1]*alpha1R[4])+8.660254037844386*(alpha1R[0]*fUp[1]+fUp[0]*alpha1R[1])); 
  incr[5] = 0.02357022603955158*(13.41640786499874*alpha1R[1]*fUp[6]+13.41640786499874*fUp[3]*alpha1R[4]+15.0*(alpha1R[0]*fUp[3]+alpha1R[1]*fUp[2])); 
  incr[6] = -0.07071067811865474*(8.660254037844387*alpha1R[4]*fUp[6]+8.660254037844386*(alpha1R[1]*fUp[3]+alpha1R[0]*fUp[2])); 
  incr[7] = 0.01010152544552211*((22.3606797749979*alpha1R[4]+35.0*alpha1R[0])*fUp[4]+35.0*fUp[0]*alpha1R[4]+31.30495168499706*alpha1R[1]*fUp[1]); 
  incr[8] = 0.7905694150420947*(alpha1R[4]*fUp[4]+alpha1R[1]*fUp[1]+alpha1R[0]*fUp[0]); 
  incr[9] = 0.02357022603955158*(15.0*alpha1R[1]*fUp[7]+15.0*alpha1R[0]*fUp[5]); 
  incr[10] = -0.07071067811865474*(7.745966692414834*(alpha1R[1]*fUp[6]+fUp[3]*alpha1R[4])+8.660254037844386*(alpha1R[0]*fUp[3]+alpha1R[1]*fUp[2])); 
  incr[11] = -0.01010152544552211*((38.72983346207417*alpha1R[4]+60.62177826491071*alpha1R[0])*fUp[4]+60.62177826491071*fUp[0]*alpha1R[4]+54.22176684690384*alpha1R[1]*fUp[1]); 
  incr[12] = 0.02357022603955158*(30.0*(alpha1R[1]*fUp[4]+fUp[1]*alpha1R[4])+33.54101966249684*(alpha1R[0]*fUp[1]+fUp[0]*alpha1R[1])); 
  incr[13] = 0.003367175148507369*((67.0820393249937*alpha1R[4]+105.0*alpha1R[0])*fUp[6]+105.0*fUp[2]*alpha1R[4]+93.91485505499116*alpha1R[1]*fUp[3]); 
  incr[14] = 0.1178511301977579*(6.708203932499369*alpha1R[4]*fUp[6]+6.708203932499369*(alpha1R[1]*fUp[3]+alpha1R[0]*fUp[2])); 
  incr[15] = 0.02357022603955158*((13.41640786499874*alpha1R[4]+15.0*alpha1R[0])*fUp[7]+15.0*alpha1R[1]*fUp[5]); 
  incr[16] = -0.07071067811865474*(8.660254037844386*alpha1R[1]*fUp[7]+8.660254037844387*alpha1R[0]*fUp[5]); 
  incr[17] = -0.01010152544552211*((38.72983346207417*alpha1R[4]+60.62177826491071*alpha1R[0])*fUp[6]+60.6217782649107*fUp[2]*alpha1R[4]+54.22176684690384*alpha1R[1]*fUp[3]); 
  incr[18] = 0.02357022603955158*(30.0*alpha1R[1]*fUp[6]+30.0*fUp[3]*alpha1R[4]+33.54101966249685*(alpha1R[0]*fUp[3]+alpha1R[1]*fUp[2])); 
  incr[19] = -0.07071067811865474*((7.745966692414834*alpha1R[4]+8.660254037844387*alpha1R[0])*fUp[7]+8.660254037844386*alpha1R[1]*fUp[5]); 

  outR[0] += incr[0]*rdvpar2R; 
  outR[1] += incr[1]*rdvpar2R; 
  outR[2] += incr[2]*rdvpar2R; 
  outR[3] += incr[3]*rdvpar2R; 
  outR[4] += incr[4]*rdvpar2R; 
  outR[5] += incr[5]*rdvpar2R; 
  outR[6] += incr[6]*rdvpar2R; 
  outR[7] += incr[7]*rdvpar2R; 
  outR[8] += incr[8]*rdvpar2R; 
  outR[9] += incr[9]*rdvpar2R; 
  outR[10] += incr[10]*rdvpar2R; 
  outR[11] += incr[11]*rdvpar2R; 
  outR[12] += incr[12]*rdvpar2R; 
  outR[13] += incr[13]*rdvpar2R; 
  outR[14] += incr[14]*rdvpar2R; 
  outR[15] += incr[15]*rdvpar2R; 
  outR[16] += incr[16]*rdvpar2R; 
  outR[17] += incr[17]*rdvpar2R; 
  outR[18] += incr[18]*rdvpar2R; 
  outR[19] += incr[19]*rdvpar2R; 

  outL[0] += -1.0*incr[0]*rdvpar2L; 
  outL[1] += -1.0*incr[1]*rdvpar2L; 
  outL[2] += incr[2]*rdvpar2L; 
  outL[3] += -1.0*incr[3]*rdvpar2L; 
  outL[4] += incr[4]*rdvpar2L; 
  outL[5] += -1.0*incr[5]*rdvpar2L; 
  outL[6] += incr[6]*rdvpar2L; 
  outL[7] += -1.0*incr[7]*rdvpar2L; 
  outL[8] += -1.0*incr[8]*rdvpar2L; 
  outL[9] += -1.0*incr[9]*rdvpar2L; 
  outL[10] += incr[10]*rdvpar2L; 
  outL[11] += incr[11]*rdvpar2L; 
  outL[12] += -1.0*incr[12]*rdvpar2L; 
  outL[13] += -1.0*incr[13]*rdvpar2L; 
  outL[14] += -1.0*incr[14]*rdvpar2L; 
  outL[15] += -1.0*incr[15]*rdvpar2L; 
  outL[16] += incr[16]*rdvpar2L; 
  outL[17] += incr[17]*rdvpar2L; 
  outL[18] += -1.0*incr[18]*rdvpar2L; 
  outL[19] += incr[19]*rdvpar2L; 

  return std::abs(alphaSurfAvgR); 
} 
