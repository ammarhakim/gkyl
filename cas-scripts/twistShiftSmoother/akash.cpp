
void twist_shift_smoother_bc_mod_lower_3x_Ser_p1(double *confField, double *confFieldGhost) 
{ 
  // confField: electrostatic potential in boundary cell.
  // confFieldGhost: electrostatic potential in  ghost cell.

  double confFieldNod[8] = {0.};
  confFieldNod[0] = 0.9185586535436915*confFieldGhost[7]-0.9185586535436915*confField[7]-0.5303300858899105*confFieldGhost[6]+0.5303300858899105*confField[6]-0.5303300858899105*confFieldGhost[5]+0.5303300858899105*confField[5]+0.5303300858899105*confFieldGhost[4]+0.5303300858899105*confField[4]+0.3061862178478972*confFieldGhost[3]-0.3061862178478972*confField[3]-0.3061862178478972*confFieldGhost[2]-0.3061862178478972*confField[2]-0.3061862178478972*confFieldGhost[1]-0.3061862178478972*confField[1]+0.1767766952966368*confFieldGhost[0]+0.1767766952966368*confField[0]; 
  confFieldNod[1] = (-0.9185586535436915*confFieldGhost[7])+0.9185586535436915*confField[7]-0.5303300858899105*confFieldGhost[6]+0.5303300858899105*confField[6]+0.5303300858899105*confFieldGhost[5]-0.5303300858899105*confField[5]-0.5303300858899105*confFieldGhost[4]-0.5303300858899105*confField[4]+0.3061862178478972*confFieldGhost[3]-0.3061862178478972*confField[3]-0.3061862178478972*confFieldGhost[2]-0.3061862178478972*confField[2]+0.3061862178478972*confFieldGhost[1]+0.3061862178478972*confField[1]+0.1767766952966368*confFieldGhost[0]+0.1767766952966368*confField[0]; 
  confFieldNod[2] = (-0.9185586535436915*confFieldGhost[7])+0.9185586535436915*confField[7]+0.5303300858899105*confFieldGhost[6]-0.5303300858899105*confField[6]-0.5303300858899105*confFieldGhost[5]+0.5303300858899105*confField[5]-0.5303300858899105*confFieldGhost[4]-0.5303300858899105*confField[4]+0.3061862178478972*confFieldGhost[3]-0.3061862178478972*confField[3]+0.3061862178478972*confFieldGhost[2]+0.3061862178478972*confField[2]-0.3061862178478972*confFieldGhost[1]-0.3061862178478972*confField[1]+0.1767766952966368*confFieldGhost[0]+0.1767766952966368*confField[0]; 
  confFieldNod[3] = 0.9185586535436915*confFieldGhost[7]-0.9185586535436915*confField[7]+0.5303300858899105*confFieldGhost[6]-0.5303300858899105*confField[6]+0.5303300858899105*confFieldGhost[5]-0.5303300858899105*confField[5]+0.5303300858899105*confFieldGhost[4]+0.5303300858899105*confField[4]+0.3061862178478972*confFieldGhost[3]-0.3061862178478972*confField[3]+0.3061862178478972*confFieldGhost[2]+0.3061862178478972*confField[2]+0.3061862178478972*confFieldGhost[1]+0.3061862178478972*confField[1]+0.1767766952966368*confFieldGhost[0]+0.1767766952966368*confField[0]; 
  confFieldNod[4] = 1.837117307087383*confField[7]-1.060660171779821*confField[6]-1.060660171779821*confField[5]+1.060660171779821*confField[4]+0.6123724356957944*confField[3]-0.6123724356957944*confField[2]-0.6123724356957944*confField[1]+0.3535533905932737*confField[0]; 
  confFieldNod[5] = (-1.837117307087383*confField[7])-1.060660171779821*confField[6]+1.060660171779821*confField[5]-1.060660171779821*confField[4]+0.6123724356957944*confField[3]-0.6123724356957944*confField[2]+0.6123724356957944*confField[1]+0.3535533905932737*confField[0]; 
  confFieldNod[6] = (-1.837117307087383*confField[7])+1.060660171779821*confField[6]-1.060660171779821*confField[5]-1.060660171779821*confField[4]+0.6123724356957944*confField[3]+0.6123724356957944*confField[2]-0.6123724356957944*confField[1]+0.3535533905932737*confField[0]; 
  confFieldNod[7] = 1.837117307087383*confField[7]+1.060660171779821*confField[6]+1.060660171779821*confField[5]+1.060660171779821*confField[4]+0.6123724356957944*confField[3]+0.6123724356957944*confField[2]+0.6123724356957944*confField[1]+0.3535533905932737*confField[0]; 

  confField[0] = 0.3535533905932737*confFieldNod[7]+0.3535533905932737*confFieldNod[6]+0.3535533905932737*confFieldNod[5]+0.3535533905932737*confFieldNod[4]+0.3535533905932737*confFieldNod[3]+0.3535533905932737*confFieldNod[2]+0.3535533905932737*confFieldNod[1]+0.3535533905932737*confFieldNod[0]; 
  confField[1] = 0.2041241452319314*confFieldNod[7]-0.2041241452319314*confFieldNod[6]+0.2041241452319314*confFieldNod[5]-0.2041241452319314*confFieldNod[4]+0.2041241452319314*confFieldNod[3]-0.2041241452319314*confFieldNod[2]+0.2041241452319314*confFieldNod[1]-0.2041241452319314*confFieldNod[0]; 
  confField[2] = 0.2041241452319314*confFieldNod[7]+0.2041241452319314*confFieldNod[6]-0.2041241452319314*confFieldNod[5]-0.2041241452319314*confFieldNod[4]+0.2041241452319314*confFieldNod[3]+0.2041241452319314*confFieldNod[2]-0.2041241452319314*confFieldNod[1]-0.2041241452319314*confFieldNod[0]; 
  confField[3] = 0.2041241452319314*confFieldNod[7]+0.2041241452319314*confFieldNod[6]+0.2041241452319314*confFieldNod[5]+0.2041241452319314*confFieldNod[4]-0.2041241452319314*confFieldNod[3]-0.2041241452319314*confFieldNod[2]-0.2041241452319314*confFieldNod[1]-0.2041241452319314*confFieldNod[0]; 
  confField[4] = 0.1178511301977578*confFieldNod[7]-0.1178511301977578*confFieldNod[6]-0.1178511301977578*confFieldNod[5]+0.1178511301977578*confFieldNod[4]+0.1178511301977578*confFieldNod[3]-0.1178511301977578*confFieldNod[2]-0.1178511301977578*confFieldNod[1]+0.1178511301977578*confFieldNod[0]; 
  confField[5] = 0.1178511301977578*confFieldNod[7]-0.1178511301977578*confFieldNod[6]+0.1178511301977578*confFieldNod[5]-0.1178511301977578*confFieldNod[4]-0.1178511301977578*confFieldNod[3]+0.1178511301977578*confFieldNod[2]-0.1178511301977578*confFieldNod[1]+0.1178511301977578*confFieldNod[0]; 
  confField[6] = 0.1178511301977578*confFieldNod[7]+0.1178511301977578*confFieldNod[6]-0.1178511301977578*confFieldNod[5]-0.1178511301977578*confFieldNod[4]-0.1178511301977578*confFieldNod[3]-0.1178511301977578*confFieldNod[2]+0.1178511301977578*confFieldNod[1]+0.1178511301977578*confFieldNod[0]; 
  confField[7] = 0.06804138174397717*confFieldNod[7]-0.06804138174397717*confFieldNod[6]-0.06804138174397717*confFieldNod[5]+0.06804138174397717*confFieldNod[4]-0.06804138174397717*confFieldNod[3]+0.06804138174397717*confFieldNod[2]+0.06804138174397717*confFieldNod[1]-0.06804138174397717*confFieldNod[0]; 
 
}

void twist_shift_smoother_bc_mod_upper_3x_Ser_p1(double *confField, double *confFieldGhost) 
{ 
  // confField: electrostatic potential in boundary cell.
  // confFieldGhost: electrostatic potential in  ghost cell.

  double confFieldNod[8] = {0.};
  confFieldNod[0] = (-1.837117307087383*confField[7])+1.060660171779821*confField[6]+1.060660171779821*confField[5]+1.060660171779821*confField[4]-0.6123724356957944*confField[3]-0.6123724356957944*confField[2]-0.6123724356957944*confField[1]+0.3535533905932737*confField[0]; 
  confFieldNod[1] = 1.837117307087383*confField[7]+1.060660171779821*confField[6]-1.060660171779821*confField[5]-1.060660171779821*confField[4]-0.6123724356957944*confField[3]-0.6123724356957944*confField[2]+0.6123724356957944*confField[1]+0.3535533905932737*confField[0]; 
  confFieldNod[2] = 1.837117307087383*confField[7]-1.060660171779821*confField[6]+1.060660171779821*confField[5]-1.060660171779821*confField[4]-0.6123724356957944*confField[3]+0.6123724356957944*confField[2]-0.6123724356957944*confField[1]+0.3535533905932737*confField[0]; 
  confFieldNod[3] = (-1.837117307087383*confField[7])-1.060660171779821*confField[6]-1.060660171779821*confField[5]+1.060660171779821*confField[4]-0.6123724356957944*confField[3]+0.6123724356957944*confField[2]+0.6123724356957944*confField[1]+0.3535533905932737*confField[0]; 
  confFieldNod[4] = (-0.9185586535436915*confFieldGhost[7])+0.9185586535436915*confField[7]+0.5303300858899105*confFieldGhost[6]-0.5303300858899105*confField[6]+0.5303300858899105*confFieldGhost[5]-0.5303300858899105*confField[5]+0.5303300858899105*confFieldGhost[4]+0.5303300858899105*confField[4]-0.3061862178478972*confFieldGhost[3]+0.3061862178478972*confField[3]-0.3061862178478972*confFieldGhost[2]-0.3061862178478972*confField[2]-0.3061862178478972*confFieldGhost[1]-0.3061862178478972*confField[1]+0.1767766952966368*confFieldGhost[0]+0.1767766952966368*confField[0]; 
  confFieldNod[5] = 0.9185586535436915*confFieldGhost[7]-0.9185586535436915*confField[7]+0.5303300858899105*confFieldGhost[6]-0.5303300858899105*confField[6]-0.5303300858899105*confFieldGhost[5]+0.5303300858899105*confField[5]-0.5303300858899105*confFieldGhost[4]-0.5303300858899105*confField[4]-0.3061862178478972*confFieldGhost[3]+0.3061862178478972*confField[3]-0.3061862178478972*confFieldGhost[2]-0.3061862178478972*confField[2]+0.3061862178478972*confFieldGhost[1]+0.3061862178478972*confField[1]+0.1767766952966368*confFieldGhost[0]+0.1767766952966368*confField[0]; 
  confFieldNod[6] = 0.9185586535436915*confFieldGhost[7]-0.9185586535436915*confField[7]-0.5303300858899105*confFieldGhost[6]+0.5303300858899105*confField[6]+0.5303300858899105*confFieldGhost[5]-0.5303300858899105*confField[5]-0.5303300858899105*confFieldGhost[4]-0.5303300858899105*confField[4]-0.3061862178478972*confFieldGhost[3]+0.3061862178478972*confField[3]+0.3061862178478972*confFieldGhost[2]+0.3061862178478972*confField[2]-0.3061862178478972*confFieldGhost[1]-0.3061862178478972*confField[1]+0.1767766952966368*confFieldGhost[0]+0.1767766952966368*confField[0]; 
  confFieldNod[7] = (-0.9185586535436915*confFieldGhost[7])+0.9185586535436915*confField[7]-0.5303300858899105*confFieldGhost[6]+0.5303300858899105*confField[6]-0.5303300858899105*confFieldGhost[5]+0.5303300858899105*confField[5]+0.5303300858899105*confFieldGhost[4]+0.5303300858899105*confField[4]-0.3061862178478972*confFieldGhost[3]+0.3061862178478972*confField[3]+0.3061862178478972*confFieldGhost[2]+0.3061862178478972*confField[2]+0.3061862178478972*confFieldGhost[1]+0.3061862178478972*confField[1]+0.1767766952966368*confFieldGhost[0]+0.1767766952966368*confField[0]; 

  confField[0] = 0.3535533905932737*confFieldNod[7]+0.3535533905932737*confFieldNod[6]+0.3535533905932737*confFieldNod[5]+0.3535533905932737*confFieldNod[4]+0.3535533905932737*confFieldNod[3]+0.3535533905932737*confFieldNod[2]+0.3535533905932737*confFieldNod[1]+0.3535533905932737*confFieldNod[0]; 
  confField[1] = 0.2041241452319314*confFieldNod[7]-0.2041241452319314*confFieldNod[6]+0.2041241452319314*confFieldNod[5]-0.2041241452319314*confFieldNod[4]+0.2041241452319314*confFieldNod[3]-0.2041241452319314*confFieldNod[2]+0.2041241452319314*confFieldNod[1]-0.2041241452319314*confFieldNod[0]; 
  confField[2] = 0.2041241452319314*confFieldNod[7]+0.2041241452319314*confFieldNod[6]-0.2041241452319314*confFieldNod[5]-0.2041241452319314*confFieldNod[4]+0.2041241452319314*confFieldNod[3]+0.2041241452319314*confFieldNod[2]-0.2041241452319314*confFieldNod[1]-0.2041241452319314*confFieldNod[0]; 
  confField[3] = 0.2041241452319314*confFieldNod[7]+0.2041241452319314*confFieldNod[6]+0.2041241452319314*confFieldNod[5]+0.2041241452319314*confFieldNod[4]-0.2041241452319314*confFieldNod[3]-0.2041241452319314*confFieldNod[2]-0.2041241452319314*confFieldNod[1]-0.2041241452319314*confFieldNod[0]; 
  confField[4] = 0.1178511301977578*confFieldNod[7]-0.1178511301977578*confFieldNod[6]-0.1178511301977578*confFieldNod[5]+0.1178511301977578*confFieldNod[4]+0.1178511301977578*confFieldNod[3]-0.1178511301977578*confFieldNod[2]-0.1178511301977578*confFieldNod[1]+0.1178511301977578*confFieldNod[0]; 
  confField[5] = 0.1178511301977578*confFieldNod[7]-0.1178511301977578*confFieldNod[6]+0.1178511301977578*confFieldNod[5]-0.1178511301977578*confFieldNod[4]-0.1178511301977578*confFieldNod[3]+0.1178511301977578*confFieldNod[2]-0.1178511301977578*confFieldNod[1]+0.1178511301977578*confFieldNod[0]; 
  confField[6] = 0.1178511301977578*confFieldNod[7]+0.1178511301977578*confFieldNod[6]-0.1178511301977578*confFieldNod[5]-0.1178511301977578*confFieldNod[4]-0.1178511301977578*confFieldNod[3]-0.1178511301977578*confFieldNod[2]+0.1178511301977578*confFieldNod[1]+0.1178511301977578*confFieldNod[0]; 
  confField[7] = 0.06804138174397717*confFieldNod[7]-0.06804138174397717*confFieldNod[6]-0.06804138174397717*confFieldNod[5]+0.06804138174397717*confFieldNod[4]-0.06804138174397717*confFieldNod[3]+0.06804138174397717*confFieldNod[2]+0.06804138174397717*confFieldNod[1]-0.06804138174397717*confFieldNod[0]; 
 
}
