#include <math.h>
#include <fpoKernelsDecl.h>

void fpoDragKernelP1(const double dt, const double *dv, const double *f, const double *fL, const double *fR, const double *fT, const double *fB, const double *h, const double *hL, const double *hR, const double *hT, const double *hB, const int isTopEdge, const int isBotEdge, const int isLeftEdge, const int isRightEdge, double *fOut) {
  if (isLeftEdge) {
    fOut[0] = f[0] + 0.02083333333333333*((9.0*fR[3]+15.0*f[3]+19.05255888325765*fR[2]+32.90896534380867*f[2])*hR[3]+((-15.0*fR[3])-9.0*f[3]+32.90896534380867*fR[2]+19.05255888325765*f[2])*h[3]+(15.58845726811989*hR[2]-15.58845726811989*h[2])*fR[3]+(15.58845726811989*h[2]-15.58845726811989*hR[2])*f[3]+((-27.0*fR[2])-27.0*f[2])*hR[2]+(27.0*fR[2]+27.0*f[2])*h[2]+(9.0*fR[1]+15.0*f[1]+19.05255888325765*fR[0]+32.90896534380867*f[0])*hR[1]+((-15.0*fR[1])-9.0*f[1]+32.90896534380867*fR[0]+19.05255888325765*f[0])*h[1]+(15.58845726811989*hR[0]-15.58845726811989*h[0])*fR[1]+(15.58845726811989*h[0]-15.58845726811989*hR[0])*f[1]+((-27.0*fR[0])-27.0*f[0])*hR[0]+(27.0*fR[0]+27.0*f[0])*h[0])*gkyl_ipow(dv[0],-2)*dt;
    fOut[1] = f[1] + 0.03608439182435162*((9.0*fR[3]+15.0*f[3]+19.05255888325765*fR[2]+32.90896534380867*f[2])*hR[3]+((-15.0*fR[3])-9.0*f[3]+32.90896534380867*fR[2]+19.05255888325765*f[2])*h[3]+(15.58845726811989*hR[2]-15.58845726811989*h[2])*fR[3]+(15.58845726811989*h[2]-15.58845726811989*hR[2])*f[3]+((-27.0*fR[2])-27.0*f[2])*hR[2]+(27.0*fR[2]+27.0*f[2])*h[2]+(9.0*fR[1]+15.0*f[1]+19.05255888325765*fR[0]+32.90896534380867*f[0])*hR[1]+((-15.0*fR[1])-9.0*f[1]+32.90896534380867*fR[0]+19.05255888325765*f[0])*h[1]+(15.58845726811989*hR[0]-15.58845726811989*h[0])*fR[1]+(15.58845726811989*h[0]-15.58845726811989*hR[0])*f[1]+((-27.0*fR[0])-27.0*f[0])*hR[0]+(27.0*fR[0]+27.0*f[0])*h[0])*gkyl_ipow(dv[0],-2)*dt;
    fOut[2] = f[2] + 0.03608439182435162*((5.196152422706631*fR[1]+8.660254037844386*f[1]+11.0*fR[0]+19.0*f[0])*hR[3]+((-8.660254037844386*fR[1])-5.196152422706631*f[1]+19.0*fR[0]+11.0*f[0])*h[3]+(5.196152422706631*hR[1]-8.660254037844386*h[1]+9.0*hR[0]-9.0*h[0])*fR[3]+(8.660254037844386*hR[1]-5.196152422706631*h[1]-9.0*hR[0]+9.0*h[0])*f[3]+(9.0*fR[1]-9.0*f[1]-15.58845726811989*fR[0]-15.58845726811989*f[0])*hR[2]+((-9.0*fR[1])+9.0*f[1]+15.58845726811989*fR[0]+15.58845726811989*f[0])*h[2]+(11.0*hR[1]+19.0*h[1]-15.58845726811989*hR[0]+15.58845726811989*h[0])*fR[2]+(19.0*hR[1]+11.0*h[1]-15.58845726811989*hR[0]+15.58845726811989*h[0])*f[2])*gkyl_ipow(dv[0],-2)*dt;
    fOut[3] = f[3] + 0.0625*((5.196152422706631*fR[1]+8.660254037844386*f[1]+11.0*fR[0]+19.0*f[0])*hR[3]+((-8.660254037844386*fR[1])-5.196152422706631*f[1]+19.0*fR[0]+11.0*f[0])*h[3]+(5.196152422706631*hR[1]-8.660254037844386*h[1]+9.0*hR[0]-9.0*h[0])*fR[3]+(8.660254037844386*hR[1]-5.196152422706631*h[1]-9.0*hR[0]+9.0*h[0])*f[3]+(9.0*fR[1]-9.0*f[1]-15.58845726811989*fR[0]-15.58845726811989*f[0])*hR[2]+((-9.0*fR[1])+9.0*f[1]+15.58845726811989*fR[0]+15.58845726811989*f[0])*h[2]+(11.0*hR[1]+19.0*h[1]-15.58845726811989*hR[0]+15.58845726811989*h[0])*fR[2]+(19.0*hR[1]+11.0*h[1]-15.58845726811989*hR[0]+15.58845726811989*h[0])*f[2])*gkyl_ipow(dv[0],-2)*dt;
  } else if (isRightEdge) {
    fOut[0] = f[0] + 0.02083333333333333*((9.0*fL[3]+15.0*f[3]-19.05255888325765*fL[2]-32.90896534380867*f[2])*hL[3]+((-15.0*fL[3])-9.0*f[3]-32.90896534380867*fL[2]-19.05255888325765*f[2])*h[3]+(15.58845726811989*h[2]-15.58845726811989*hL[2])*fL[3]+(15.58845726811989*hL[2]-15.58845726811989*h[2])*f[3]+((-27.0*fL[2])-27.0*f[2])*hL[2]+(27.0*fL[2]+27.0*f[2])*h[2]+(9.0*fL[1]+15.0*f[1]-19.05255888325765*fL[0]-32.90896534380867*f[0])*hL[1]+((-15.0*fL[1])-9.0*f[1]-32.90896534380867*fL[0]-19.05255888325765*f[0])*h[1]+(15.58845726811989*h[0]-15.58845726811989*hL[0])*fL[1]+(15.58845726811989*hL[0]-15.58845726811989*h[0])*f[1]+((-27.0*fL[0])-27.0*f[0])*hL[0]+(27.0*fL[0]+27.0*f[0])*h[0])*gkyl_ipow(dv[0],-2)*dt;
    fOut[1] = f[1] + -0.03608439182435162*((9.0*fL[3]+15.0*f[3]-19.05255888325765*fL[2]-32.90896534380867*f[2])*hL[3]+((-15.0*fL[3])-9.0*f[3]-32.90896534380867*fL[2]-19.05255888325765*f[2])*h[3]+(15.58845726811989*h[2]-15.58845726811989*hL[2])*fL[3]+(15.58845726811989*hL[2]-15.58845726811989*h[2])*f[3]+((-27.0*fL[2])-27.0*f[2])*hL[2]+(27.0*fL[2]+27.0*f[2])*h[2]+(9.0*fL[1]+15.0*f[1]-19.05255888325765*fL[0]-32.90896534380867*f[0])*hL[1]+((-15.0*fL[1])-9.0*f[1]-32.90896534380867*fL[0]-19.05255888325765*f[0])*h[1]+(15.58845726811989*h[0]-15.58845726811989*hL[0])*fL[1]+(15.58845726811989*hL[0]-15.58845726811989*h[0])*f[1]+((-27.0*fL[0])-27.0*f[0])*hL[0]+(27.0*fL[0]+27.0*f[0])*h[0])*gkyl_ipow(dv[0],-2)*dt;
    fOut[2] = f[2] + 0.03608439182435162*((5.196152422706631*fL[1]+8.660254037844386*f[1]-11.0*fL[0]-19.0*f[0])*hL[3]+((-8.660254037844386*fL[1])-5.196152422706631*f[1]-19.0*fL[0]-11.0*f[0])*h[3]+(5.196152422706631*hL[1]-8.660254037844386*h[1]-9.0*hL[0]+9.0*h[0])*fL[3]+(8.660254037844386*hL[1]-5.196152422706631*h[1]+9.0*hL[0]-9.0*h[0])*f[3]+((-9.0*fL[1])+9.0*f[1]-15.58845726811989*fL[0]-15.58845726811989*f[0])*hL[2]+(9.0*fL[1]-9.0*f[1]+15.58845726811989*fL[0]+15.58845726811989*f[0])*h[2]+((-11.0*hL[1])-19.0*h[1]-15.58845726811989*hL[0]+15.58845726811989*h[0])*fL[2]+((-19.0*hL[1])-11.0*h[1]-15.58845726811989*hL[0]+15.58845726811989*h[0])*f[2])*gkyl_ipow(dv[0],-2)*dt;
    fOut[3] = f[3] + -0.0625*((5.196152422706631*fL[1]+8.660254037844386*f[1]-11.0*fL[0]-19.0*f[0])*hL[3]+((-8.660254037844386*fL[1])-5.196152422706631*f[1]-19.0*fL[0]-11.0*f[0])*h[3]+(5.196152422706631*hL[1]-8.660254037844386*h[1]-9.0*hL[0]+9.0*h[0])*fL[3]+(8.660254037844386*hL[1]-5.196152422706631*h[1]+9.0*hL[0]-9.0*h[0])*f[3]+((-9.0*fL[1])+9.0*f[1]-15.58845726811989*fL[0]-15.58845726811989*f[0])*hL[2]+(9.0*fL[1]-9.0*f[1]+15.58845726811989*fL[0]+15.58845726811989*f[0])*h[2]+((-11.0*hL[1])-19.0*h[1]-15.58845726811989*hL[0]+15.58845726811989*h[0])*fL[2]+((-19.0*hL[1])-11.0*h[1]-15.58845726811989*hL[0]+15.58845726811989*h[0])*f[2])*gkyl_ipow(dv[0],-2)*dt;
  } else {
    fOut[0] = f[0] + 0.02083333333333333*((9.0*fR[3]+15.0*f[3]+19.05255888325765*fR[2]+32.90896534380867*f[2])*hR[3]+(9.0*fL[3]+15.0*f[3]-19.05255888325765*fL[2]-32.90896534380867*f[2])*hL[3]+((-15.0*fR[3])-15.0*fL[3]-18.0*f[3]+32.90896534380867*fR[2]-32.90896534380867*fL[2])*h[3]+(15.58845726811989*hR[2]-15.58845726811989*h[2])*fR[3]+(15.58845726811989*h[2]-15.58845726811989*hL[2])*fL[3]+(15.58845726811989*hL[2]-15.58845726811989*hR[2])*f[3]+((-27.0*fR[2])-27.0*f[2])*hR[2]+((-27.0*fL[2])-27.0*f[2])*hL[2]+(27.0*fR[2]+27.0*fL[2]+54.0*f[2])*h[2]+(9.0*fR[1]+15.0*f[1]+19.05255888325765*fR[0]+32.90896534380867*f[0])*hR[1]+(9.0*fL[1]+15.0*f[1]-19.05255888325765*fL[0]-32.90896534380867*f[0])*hL[1]+((-15.0*fR[1])-15.0*fL[1]-18.0*f[1]+32.90896534380867*fR[0]-32.90896534380867*fL[0])*h[1]+(15.58845726811989*hR[0]-15.58845726811989*h[0])*fR[1]+(15.58845726811989*h[0]-15.58845726811989*hL[0])*fL[1]+(15.58845726811989*hL[0]-15.58845726811989*hR[0])*f[1]+((-27.0*fR[0])-27.0*f[0])*hR[0]+((-27.0*fL[0])-27.0*f[0])*hL[0]+(27.0*fR[0]+27.0*fL[0]+54.0*f[0])*h[0])*gkyl_ipow(dv[0],-2)*dt;
    fOut[1] = f[1] + 0.0625*((5.196152422706631*fR[3]+8.660254037844386*f[3]+11.0*fR[2]+19.0*f[2])*hR[3]+((-5.196152422706631*fL[3])-8.660254037844386*f[3]+11.0*fL[2]+19.0*f[2])*hL[3]+((-8.660254037844386*fR[3])+8.660254037844386*fL[3]+19.0*fR[2]+19.0*fL[2]+22.0*f[2])*h[3]+(9.0*hR[2]-9.0*h[2])*fR[3]+(9.0*hL[2]-9.0*h[2])*fL[3]+((-9.0*hR[2])-9.0*hL[2]+18.0*h[2])*f[3]+((-15.58845726811989*fR[2])-15.58845726811989*f[2])*hR[2]+(15.58845726811989*fL[2]+15.58845726811989*f[2])*hL[2]+(15.58845726811989*fR[2]-15.58845726811989*fL[2])*h[2]+(5.196152422706631*fR[1]+8.660254037844386*f[1]+11.0*fR[0]+19.0*f[0])*hR[1]+((-5.196152422706631*fL[1])-8.660254037844386*f[1]+11.0*fL[0]+19.0*f[0])*hL[1]+((-8.660254037844386*fR[1])+8.660254037844386*fL[1]+19.0*fR[0]+19.0*fL[0]+22.0*f[0])*h[1]+(9.0*hR[0]-9.0*h[0])*fR[1]+(9.0*hL[0]-9.0*h[0])*fL[1]+((-9.0*hR[0])-9.0*hL[0]+18.0*h[0])*f[1]+((-15.58845726811989*fR[0])-15.58845726811989*f[0])*hR[0]+(15.58845726811989*fL[0]+15.58845726811989*f[0])*hL[0]+(15.58845726811989*fR[0]-15.58845726811989*fL[0])*h[0])*gkyl_ipow(dv[0],-2)*dt;
    fOut[2] = f[2] + 0.02083333333333333*((9.0*fR[1]+15.0*f[1]+19.05255888325765*fR[0]+32.90896534380867*f[0])*hR[3]+(9.0*fL[1]+15.0*f[1]-19.05255888325765*fL[0]-32.90896534380867*f[0])*hL[3]+((-15.0*fR[1])-15.0*fL[1]-18.0*f[1]+32.90896534380867*fR[0]-32.90896534380867*fL[0])*h[3]+(9.0*hR[1]-15.0*h[1]+15.58845726811989*hR[0]-15.58845726811989*h[0])*fR[3]+(9.0*hL[1]-15.0*h[1]-15.58845726811989*hL[0]+15.58845726811989*h[0])*fL[3]+(15.0*hR[1]+15.0*hL[1]-18.0*h[1]-15.58845726811989*hR[0]+15.58845726811989*hL[0])*f[3]+(15.58845726811989*fR[1]-15.58845726811989*f[1]-27.0*fR[0]-27.0*f[0])*hR[2]+((-15.58845726811989*fL[1])+15.58845726811989*f[1]-27.0*fL[0]-27.0*f[0])*hL[2]+((-15.58845726811989*fR[1])+15.58845726811989*fL[1]+27.0*fR[0]+27.0*fL[0]+54.0*f[0])*h[2]+(19.05255888325765*hR[1]+32.90896534380867*h[1]-27.0*hR[0]+27.0*h[0])*fR[2]+((-19.05255888325765*hL[1])-32.90896534380867*h[1]-27.0*hL[0]+27.0*h[0])*fL[2]+(32.90896534380867*hR[1]-32.90896534380867*hL[1]-27.0*hR[0]-27.0*hL[0]+54.0*h[0])*f[2])*gkyl_ipow(dv[0],-2)*dt;
    fOut[3] = f[3] + 0.0625*((5.196152422706631*fR[1]+8.660254037844386*f[1]+11.0*fR[0]+19.0*f[0])*hR[3]+((-5.196152422706631*fL[1])-8.660254037844386*f[1]+11.0*fL[0]+19.0*f[0])*hL[3]+((-8.660254037844386*fR[1])+8.660254037844386*fL[1]+19.0*fR[0]+19.0*fL[0]+22.0*f[0])*h[3]+(5.196152422706631*hR[1]-8.660254037844386*h[1]+9.0*hR[0]-9.0*h[0])*fR[3]+((-5.196152422706631*hL[1])+8.660254037844386*h[1]+9.0*hL[0]-9.0*h[0])*fL[3]+(8.660254037844386*hR[1]-8.660254037844386*hL[1]-9.0*hR[0]-9.0*hL[0]+18.0*h[0])*f[3]+(9.0*fR[1]-9.0*f[1]-15.58845726811989*fR[0]-15.58845726811989*f[0])*hR[2]+(9.0*fL[1]-9.0*f[1]+15.58845726811989*fL[0]+15.58845726811989*f[0])*hL[2]+((-9.0*fR[1])-9.0*fL[1]+18.0*f[1]+15.58845726811989*fR[0]-15.58845726811989*fL[0])*h[2]+(11.0*hR[1]+19.0*h[1]-15.58845726811989*hR[0]+15.58845726811989*h[0])*fR[2]+(11.0*hL[1]+19.0*h[1]+15.58845726811989*hL[0]-15.58845726811989*h[0])*fL[2]+(19.0*hR[1]+19.0*hL[1]+22.0*h[1]-15.58845726811989*hR[0]+15.58845726811989*hL[0])*f[2])*gkyl_ipow(dv[0],-2)*dt;
  }

  fOut[0] += 0.0;
  fOut[1] += (6.0*f[2]*h[3]+6.0*f[0]*h[1])*gkyl_ipow(dv[0],-2)*dt;
  fOut[2] += 0.0;
  fOut[3] += (6.0*f[0]*h[3]+6.0*h[1]*f[2])*gkyl_ipow(dv[0],-2)*dt;

  if (isBotEdge) {
    fOut[0] += 0.02083333333333333*((9.0*fT[3]+15.0*f[3]+19.05255888325765*fT[1]+32.90896534380867*f[1])*hT[3]+((-15.0*fT[3])-9.0*f[3]+32.90896534380867*fT[1]+19.05255888325765*f[1])*h[3]+(15.58845726811989*hT[1]-15.58845726811989*h[1])*fT[3]+(15.58845726811989*h[1]-15.58845726811989*hT[1])*f[3]+(9.0*fT[2]+15.0*f[2]+19.05255888325765*fT[0]+32.90896534380867*f[0])*hT[2]+((-15.0*fT[2])-9.0*f[2]+32.90896534380867*fT[0]+19.05255888325765*f[0])*h[2]+(15.58845726811989*hT[0]-15.58845726811989*h[0])*fT[2]+(15.58845726811989*h[0]-15.58845726811989*hT[0])*f[2]+((-27.0*fT[1])-27.0*f[1])*hT[1]+(27.0*fT[1]+27.0*f[1])*h[1]+((-27.0*fT[0])-27.0*f[0])*hT[0]+(27.0*fT[0]+27.0*f[0])*h[0])*gkyl_ipow(dv[1],-2)*dt;
    fOut[1] += 0.03608439182435162*((5.196152422706631*fT[2]+8.660254037844386*f[2]+11.0*fT[0]+19.0*f[0])*hT[3]+((-8.660254037844386*fT[2])-5.196152422706631*f[2]+19.0*fT[0]+11.0*f[0])*h[3]+(5.196152422706631*hT[2]-8.660254037844386*h[2]+9.0*hT[0]-9.0*h[0])*fT[3]+(8.660254037844386*hT[2]-5.196152422706631*h[2]-9.0*hT[0]+9.0*h[0])*f[3]+(11.0*fT[1]+19.0*f[1])*hT[2]+(19.0*fT[1]+11.0*f[1])*h[2]+(9.0*hT[1]-9.0*h[1])*fT[2]+(9.0*h[1]-9.0*hT[1])*f[2]+((-15.58845726811989*fT[0])-15.58845726811989*f[0])*hT[1]+(15.58845726811989*fT[0]+15.58845726811989*f[0])*h[1]+(15.58845726811989*h[0]-15.58845726811989*hT[0])*fT[1]+(15.58845726811989*h[0]-15.58845726811989*hT[0])*f[1])*gkyl_ipow(dv[1],-2)*dt;
    fOut[2] += 0.03608439182435162*((9.0*fT[3]+15.0*f[3]+19.05255888325765*fT[1]+32.90896534380867*f[1])*hT[3]+((-15.0*fT[3])-9.0*f[3]+32.90896534380867*fT[1]+19.05255888325765*f[1])*h[3]+(15.58845726811989*hT[1]-15.58845726811989*h[1])*fT[3]+(15.58845726811989*h[1]-15.58845726811989*hT[1])*f[3]+(9.0*fT[2]+15.0*f[2]+19.05255888325765*fT[0]+32.90896534380867*f[0])*hT[2]+((-15.0*fT[2])-9.0*f[2]+32.90896534380867*fT[0]+19.05255888325765*f[0])*h[2]+(15.58845726811989*hT[0]-15.58845726811989*h[0])*fT[2]+(15.58845726811989*h[0]-15.58845726811989*hT[0])*f[2]+((-27.0*fT[1])-27.0*f[1])*hT[1]+(27.0*fT[1]+27.0*f[1])*h[1]+((-27.0*fT[0])-27.0*f[0])*hT[0]+(27.0*fT[0]+27.0*f[0])*h[0])*gkyl_ipow(dv[1],-2)*dt;
    fOut[3] += 0.0625*((5.196152422706631*fT[2]+8.660254037844386*f[2]+11.0*fT[0]+19.0*f[0])*hT[3]+((-8.660254037844386*fT[2])-5.196152422706631*f[2]+19.0*fT[0]+11.0*f[0])*h[3]+(5.196152422706631*hT[2]-8.660254037844386*h[2]+9.0*hT[0]-9.0*h[0])*fT[3]+(8.660254037844386*hT[2]-5.196152422706631*h[2]-9.0*hT[0]+9.0*h[0])*f[3]+(11.0*fT[1]+19.0*f[1])*hT[2]+(19.0*fT[1]+11.0*f[1])*h[2]+(9.0*hT[1]-9.0*h[1])*fT[2]+(9.0*h[1]-9.0*hT[1])*f[2]+((-15.58845726811989*fT[0])-15.58845726811989*f[0])*hT[1]+(15.58845726811989*fT[0]+15.58845726811989*f[0])*h[1]+(15.58845726811989*h[0]-15.58845726811989*hT[0])*fT[1]+(15.58845726811989*h[0]-15.58845726811989*hT[0])*f[1])*gkyl_ipow(dv[1],-2)*dt;
  } else if (isTopEdge) {
    fOut[0] += 0.02083333333333333*((9.0*fB[3]+15.0*f[3]-19.05255888325765*fB[1]-32.90896534380867*f[1])*hB[3]+((-15.0*fB[3])-9.0*f[3]-32.90896534380867*fB[1]-19.05255888325765*f[1])*h[3]+(15.58845726811989*h[1]-15.58845726811989*hB[1])*fB[3]+(15.58845726811989*hB[1]-15.58845726811989*h[1])*f[3]+(9.0*fB[2]+15.0*f[2]-19.05255888325765*fB[0]-32.90896534380867*f[0])*hB[2]+((-15.0*fB[2])-9.0*f[2]-32.90896534380867*fB[0]-19.05255888325765*f[0])*h[2]+(15.58845726811989*h[0]-15.58845726811989*hB[0])*fB[2]+(15.58845726811989*hB[0]-15.58845726811989*h[0])*f[2]+((-27.0*fB[1])-27.0*f[1])*hB[1]+(27.0*fB[1]+27.0*f[1])*h[1]+((-27.0*fB[0])-27.0*f[0])*hB[0]+(27.0*fB[0]+27.0*f[0])*h[0])*gkyl_ipow(dv[1],-2)*dt;
    fOut[1] += 0.03608439182435162*((5.196152422706631*fB[2]+8.660254037844386*f[2]-11.0*fB[0]-19.0*f[0])*hB[3]+((-8.660254037844386*fB[2])-5.196152422706631*f[2]-19.0*fB[0]-11.0*f[0])*h[3]+(5.196152422706631*hB[2]-8.660254037844386*h[2]-9.0*hB[0]+9.0*h[0])*fB[3]+(8.660254037844386*hB[2]-5.196152422706631*h[2]+9.0*hB[0]-9.0*h[0])*f[3]+((-11.0*fB[1])-19.0*f[1])*hB[2]+((-19.0*fB[1])-11.0*f[1])*h[2]+(9.0*h[1]-9.0*hB[1])*fB[2]+(9.0*hB[1]-9.0*h[1])*f[2]+((-15.58845726811989*fB[0])-15.58845726811989*f[0])*hB[1]+(15.58845726811989*fB[0]+15.58845726811989*f[0])*h[1]+(15.58845726811989*h[0]-15.58845726811989*hB[0])*fB[1]+(15.58845726811989*h[0]-15.58845726811989*hB[0])*f[1])*gkyl_ipow(dv[1],-2)*dt;
    fOut[2] += -0.03608439182435162*((9.0*fB[3]+15.0*f[3]-19.05255888325765*fB[1]-32.90896534380867*f[1])*hB[3]+((-15.0*fB[3])-9.0*f[3]-32.90896534380867*fB[1]-19.05255888325765*f[1])*h[3]+(15.58845726811989*h[1]-15.58845726811989*hB[1])*fB[3]+(15.58845726811989*hB[1]-15.58845726811989*h[1])*f[3]+(9.0*fB[2]+15.0*f[2]-19.05255888325765*fB[0]-32.90896534380867*f[0])*hB[2]+((-15.0*fB[2])-9.0*f[2]-32.90896534380867*fB[0]-19.05255888325765*f[0])*h[2]+(15.58845726811989*h[0]-15.58845726811989*hB[0])*fB[2]+(15.58845726811989*hB[0]-15.58845726811989*h[0])*f[2]+((-27.0*fB[1])-27.0*f[1])*hB[1]+(27.0*fB[1]+27.0*f[1])*h[1]+((-27.0*fB[0])-27.0*f[0])*hB[0]+(27.0*fB[0]+27.0*f[0])*h[0])*gkyl_ipow(dv[1],-2)*dt;
    fOut[3] += -0.0625*((5.196152422706631*fB[2]+8.660254037844386*f[2]-11.0*fB[0]-19.0*f[0])*hB[3]+((-8.660254037844386*fB[2])-5.196152422706631*f[2]-19.0*fB[0]-11.0*f[0])*h[3]+(5.196152422706631*hB[2]-8.660254037844386*h[2]-9.0*hB[0]+9.0*h[0])*fB[3]+(8.660254037844386*hB[2]-5.196152422706631*h[2]+9.0*hB[0]-9.0*h[0])*f[3]+((-11.0*fB[1])-19.0*f[1])*hB[2]+((-19.0*fB[1])-11.0*f[1])*h[2]+(9.0*h[1]-9.0*hB[1])*fB[2]+(9.0*hB[1]-9.0*h[1])*f[2]+((-15.58845726811989*fB[0])-15.58845726811989*f[0])*hB[1]+(15.58845726811989*fB[0]+15.58845726811989*f[0])*h[1]+(15.58845726811989*h[0]-15.58845726811989*hB[0])*fB[1]+(15.58845726811989*h[0]-15.58845726811989*hB[0])*f[1])*gkyl_ipow(dv[1],-2)*dt;
  } else {
    fOut[0] += 0.02083333333333333*((9.0*fT[3]+15.0*f[3]+19.05255888325765*fT[1]+32.90896534380867*f[1])*hT[3]+(9.0*fB[3]+15.0*f[3]-19.05255888325765*fB[1]-32.90896534380867*f[1])*hB[3]+((-15.0*fT[3])-15.0*fB[3]-18.0*f[3]+32.90896534380867*fT[1]-32.90896534380867*fB[1])*h[3]+(15.58845726811989*hT[1]-15.58845726811989*h[1])*fT[3]+(15.58845726811989*h[1]-15.58845726811989*hB[1])*fB[3]+(15.58845726811989*hB[1]-15.58845726811989*hT[1])*f[3]+(9.0*fT[2]+15.0*f[2]+19.05255888325765*fT[0]+32.90896534380867*f[0])*hT[2]+(9.0*fB[2]+15.0*f[2]-19.05255888325765*fB[0]-32.90896534380867*f[0])*hB[2]+((-15.0*fT[2])-15.0*fB[2]-18.0*f[2]+32.90896534380867*fT[0]-32.90896534380867*fB[0])*h[2]+(15.58845726811989*hT[0]-15.58845726811989*h[0])*fT[2]+(15.58845726811989*h[0]-15.58845726811989*hB[0])*fB[2]+(15.58845726811989*hB[0]-15.58845726811989*hT[0])*f[2]+((-27.0*fT[1])-27.0*f[1])*hT[1]+((-27.0*fB[1])-27.0*f[1])*hB[1]+(27.0*fT[1]+27.0*fB[1]+54.0*f[1])*h[1]+((-27.0*fT[0])-27.0*f[0])*hT[0]+((-27.0*fB[0])-27.0*f[0])*hB[0]+(27.0*fT[0]+27.0*fB[0]+54.0*f[0])*h[0])*gkyl_ipow(dv[1],-2)*dt;
    fOut[1] += 0.02083333333333333*((9.0*fT[2]+15.0*f[2]+19.05255888325765*fT[0]+32.90896534380867*f[0])*hT[3]+(9.0*fB[2]+15.0*f[2]-19.05255888325765*fB[0]-32.90896534380867*f[0])*hB[3]+((-15.0*fT[2])-15.0*fB[2]-18.0*f[2]+32.90896534380867*fT[0]-32.90896534380867*fB[0])*h[3]+(9.0*hT[2]-15.0*h[2]+15.58845726811989*hT[0]-15.58845726811989*h[0])*fT[3]+(9.0*hB[2]-15.0*h[2]-15.58845726811989*hB[0]+15.58845726811989*h[0])*fB[3]+(15.0*hT[2]+15.0*hB[2]-18.0*h[2]-15.58845726811989*hT[0]+15.58845726811989*hB[0])*f[3]+(19.05255888325765*fT[1]+32.90896534380867*f[1])*hT[2]+((-19.05255888325765*fB[1])-32.90896534380867*f[1])*hB[2]+(32.90896534380867*fT[1]-32.90896534380867*fB[1])*h[2]+(15.58845726811989*hT[1]-15.58845726811989*h[1])*fT[2]+(15.58845726811989*h[1]-15.58845726811989*hB[1])*fB[2]+(15.58845726811989*hB[1]-15.58845726811989*hT[1])*f[2]+((-27.0*fT[0])-27.0*f[0])*hT[1]+((-27.0*fB[0])-27.0*f[0])*hB[1]+(27.0*fT[0]+27.0*fB[0]+54.0*f[0])*h[1]+(27.0*h[0]-27.0*hT[0])*fT[1]+(27.0*h[0]-27.0*hB[0])*fB[1]+((-27.0*hT[0])-27.0*hB[0]+54.0*h[0])*f[1])*gkyl_ipow(dv[1],-2)*dt;
    fOut[2] += 0.0625*((5.196152422706631*fT[3]+8.660254037844386*f[3]+11.0*fT[1]+19.0*f[1])*hT[3]+((-5.196152422706631*fB[3])-8.660254037844386*f[3]+11.0*fB[1]+19.0*f[1])*hB[3]+((-8.660254037844386*fT[3])+8.660254037844386*fB[3]+19.0*fT[1]+19.0*fB[1]+22.0*f[1])*h[3]+(9.0*hT[1]-9.0*h[1])*fT[3]+(9.0*hB[1]-9.0*h[1])*fB[3]+((-9.0*hT[1])-9.0*hB[1]+18.0*h[1])*f[3]+(5.196152422706631*fT[2]+8.660254037844386*f[2]+11.0*fT[0]+19.0*f[0])*hT[2]+((-5.196152422706631*fB[2])-8.660254037844386*f[2]+11.0*fB[0]+19.0*f[0])*hB[2]+((-8.660254037844386*fT[2])+8.660254037844386*fB[2]+19.0*fT[0]+19.0*fB[0]+22.0*f[0])*h[2]+(9.0*hT[0]-9.0*h[0])*fT[2]+(9.0*hB[0]-9.0*h[0])*fB[2]+((-9.0*hT[0])-9.0*hB[0]+18.0*h[0])*f[2]+((-15.58845726811989*fT[1])-15.58845726811989*f[1])*hT[1]+(15.58845726811989*fB[1]+15.58845726811989*f[1])*hB[1]+(15.58845726811989*fT[1]-15.58845726811989*fB[1])*h[1]+((-15.58845726811989*fT[0])-15.58845726811989*f[0])*hT[0]+(15.58845726811989*fB[0]+15.58845726811989*f[0])*hB[0]+(15.58845726811989*fT[0]-15.58845726811989*fB[0])*h[0])*gkyl_ipow(dv[1],-2)*dt;
    fOut[3] += 0.0625*((5.196152422706631*fT[2]+8.660254037844386*f[2]+11.0*fT[0]+19.0*f[0])*hT[3]+((-5.196152422706631*fB[2])-8.660254037844386*f[2]+11.0*fB[0]+19.0*f[0])*hB[3]+((-8.660254037844386*fT[2])+8.660254037844386*fB[2]+19.0*fT[0]+19.0*fB[0]+22.0*f[0])*h[3]+(5.196152422706631*hT[2]-8.660254037844386*h[2]+9.0*hT[0]-9.0*h[0])*fT[3]+((-5.196152422706631*hB[2])+8.660254037844386*h[2]+9.0*hB[0]-9.0*h[0])*fB[3]+(8.660254037844386*hT[2]-8.660254037844386*hB[2]-9.0*hT[0]-9.0*hB[0]+18.0*h[0])*f[3]+(11.0*fT[1]+19.0*f[1])*hT[2]+(11.0*fB[1]+19.0*f[1])*hB[2]+(19.0*fT[1]+19.0*fB[1]+22.0*f[1])*h[2]+(9.0*hT[1]-9.0*h[1])*fT[2]+(9.0*hB[1]-9.0*h[1])*fB[2]+((-9.0*hT[1])-9.0*hB[1]+18.0*h[1])*f[2]+((-15.58845726811989*fT[0])-15.58845726811989*f[0])*hT[1]+(15.58845726811989*fB[0]+15.58845726811989*f[0])*hB[1]+(15.58845726811989*fT[0]-15.58845726811989*fB[0])*h[1]+(15.58845726811989*h[0]-15.58845726811989*hT[0])*fT[1]+(15.58845726811989*hB[0]-15.58845726811989*h[0])*fB[1]+(15.58845726811989*hB[0]-15.58845726811989*hT[0])*f[1])*gkyl_ipow(dv[1],-2)*dt;
  }

  fOut[0] += 0.0;
  fOut[1] += 0.0;
  fOut[2] += (6.0*f[1]*h[3]+6.0*f[0]*h[2])*gkyl_ipow(dv[1],-2)*dt;
  fOut[3] += (6.0*f[0]*h[3]+6.0*f[1]*h[2])*gkyl_ipow(dv[1],-2)*dt;
}