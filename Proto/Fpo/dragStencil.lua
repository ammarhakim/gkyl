local function dragStencilFunc(dt, dx, dy,
			 fPtr, fLPtr, fRPtr, fTPtr, fBPtr,
			 hPtr, hLPtr, hRPtr, hTPtr, hBPtr,
			 isTopEdge, isBotEdge, isLeftEdge, isRightEdge,
			 fOutPtr)

   if isLeftEdge then
    fOutPtr[1] = fPtr[1]-dt*((0.078125*fRPtr[4]*hRPtr[4]*dy^2)/dx-(0.078125*fPtr[4]*hRPtr[4]*dy^2)/dx-(0.06765823467065926*fRPtr[3]*hRPtr[4]*dy^2)/dx-(0.06765823467065926*fPtr[3]*hRPtr[4]*dy^2)/dx+(0.078125*fRPtr[4]*hPtr[4]*dy^2)/dx-(0.078125*fPtr[4]*hPtr[4]*dy^2)/dx-(0.06765823467065926*fRPtr[3]*hPtr[4]*dy^2)/dx-(0.06765823467065926*fPtr[3]*hPtr[4]*dy^2)/dx-(0.08118988160479111*hRPtr[3]*fRPtr[4]*dy^2)/dx+(0.08118988160479111*hPtr[3]*fRPtr[4]*dy^2)/dx+(0.08118988160479111*hRPtr[3]*fPtr[4]*dy^2)/dx-(0.08118988160479111*hPtr[3]*fPtr[4]*dy^2)/dx+(0.0703125*fRPtr[3]*hRPtr[3]*dy^2)/dx+(0.0703125*fPtr[3]*hRPtr[3]*dy^2)/dx-(0.0703125*fRPtr[3]*hPtr[3]*dy^2)/dx-(0.0703125*fPtr[3]*hPtr[3]*dy^2)/dx+(0.3125*fRPtr[2]*hRPtr[2])/dx-(0.3125*fPtr[2]*hRPtr[2])/dx-(0.270632938682637*fRPtr[1]*hRPtr[2])/dx-(0.270632938682637*fPtr[1]*hRPtr[2])/dx+(0.3125*fRPtr[2]*hPtr[2])/dx-(0.3125*fPtr[2]*hPtr[2])/dx-(0.270632938682637*fRPtr[1]*hPtr[2])/dx-(0.270632938682637*fPtr[1]*hPtr[2])/dx-(0.3247595264191644*hRPtr[1]*fRPtr[2])/dx+(0.3247595264191644*hPtr[1]*fRPtr[2])/dx+(0.3247595264191644*hRPtr[1]*fPtr[2])/dx-(0.3247595264191644*hPtr[1]*fPtr[2])/dx+(0.28125*fRPtr[1]*hRPtr[1])/dx+(0.28125*fPtr[1]*hRPtr[1])/dx-(0.28125*fRPtr[1]*hPtr[1])/dx-(0.28125*fPtr[1]*hPtr[1])/dx)
    fOutPtr[2] = fPtr[2]-dt*((0.1353164693413185*fRPtr[4]*hRPtr[4]*dy^2)/dx-(0.1353164693413185*fPtr[4]*hRPtr[4]*dy^2)/dx-(0.1171875*fRPtr[3]*hRPtr[4]*dy^2)/dx-(0.1171875*fPtr[3]*hRPtr[4]*dy^2)/dx+(0.1353164693413185*fRPtr[4]*hPtr[4]*dy^2)/dx-(0.1353164693413185*fPtr[4]*hPtr[4]*dy^2)/dx-(0.1171875*fRPtr[3]*hPtr[4]*dy^2)/dx-(0.1171875*fPtr[3]*hPtr[4]*dy^2)/dx-(0.140625*hRPtr[3]*fRPtr[4]*dy^2)/dx+(0.140625*hPtr[3]*fRPtr[4]*dy^2)/dx+(0.140625*hRPtr[3]*fPtr[4]*dy^2)/dx-(0.140625*hPtr[3]*fPtr[4]*dy^2)/dx+(0.1217848224071866*fRPtr[3]*hRPtr[3]*dy^2)/dx+(0.1217848224071866*fPtr[3]*hRPtr[3]*dy^2)/dx-(0.1217848224071866*fRPtr[3]*hPtr[3]*dy^2)/dx-(0.1217848224071866*fPtr[3]*hPtr[3]*dy^2)/dx+(0.5412658773652741*fRPtr[2]*hRPtr[2])/dx-(0.5412658773652741*fPtr[2]*hRPtr[2])/dx-(0.46875*fRPtr[1]*hRPtr[2])/dx-(0.46875*fPtr[1]*hRPtr[2])/dx+(0.5412658773652741*fRPtr[2]*hPtr[2])/dx-(0.5412658773652741*fPtr[2]*hPtr[2])/dx-(0.46875*fRPtr[1]*hPtr[2])/dx-(0.46875*fPtr[1]*hPtr[2])/dx-(0.5625*hRPtr[1]*fRPtr[2])/dx+(0.5625*hPtr[1]*fRPtr[2])/dx+(0.5625*hRPtr[1]*fPtr[2])/dx-(0.5625*hPtr[1]*fPtr[2])/dx+(0.4871392896287466*fRPtr[1]*hRPtr[1])/dx+(0.4871392896287466*fPtr[1]*hRPtr[1])/dx-(0.4871392896287466*fRPtr[1]*hPtr[1])/dx-(0.4871392896287466*fPtr[1]*hPtr[1])/dx)
    fOutPtr[3] = fPtr[3]-dt*((0.15625*fRPtr[2]*hRPtr[4]*dy)/dx-(0.15625*fPtr[2]*hRPtr[4]*dy)/dx-(0.1353164693413185*fRPtr[1]*hRPtr[4]*dy)/dx-(0.1353164693413185*fPtr[1]*hRPtr[4]*dy)/dx+(0.15625*fRPtr[2]*hPtr[4]*dy)/dx-(0.15625*fPtr[2]*hPtr[4]*dy)/dx-(0.1353164693413185*fRPtr[1]*hPtr[4]*dy)/dx-(0.1353164693413185*fPtr[1]*hPtr[4]*dy)/dx+(0.15625*hRPtr[2]*fRPtr[4]*dy)/dx+(0.15625*hPtr[2]*fRPtr[4]*dy)/dx-(0.1623797632095822*hRPtr[1]*fRPtr[4]*dy)/dx+(0.1623797632095822*hPtr[1]*fRPtr[4]*dy)/dx-(0.15625*hRPtr[2]*fPtr[4]*dy)/dx-(0.15625*hPtr[2]*fPtr[4]*dy)/dx+(0.1623797632095822*hRPtr[1]*fPtr[4]*dy)/dx-(0.1623797632095822*hPtr[1]*fPtr[4]*dy)/dx-(0.1623797632095822*fRPtr[2]*hRPtr[3]*dy)/dx+(0.1623797632095822*fPtr[2]*hRPtr[3]*dy)/dx+(0.140625*fRPtr[1]*hRPtr[3]*dy)/dx+(0.140625*fPtr[1]*hRPtr[3]*dy)/dx+(0.1623797632095822*fRPtr[2]*hPtr[3]*dy)/dx-(0.1623797632095822*fPtr[2]*hPtr[3]*dy)/dx-(0.140625*fRPtr[1]*hPtr[3]*dy)/dx-(0.140625*fPtr[1]*hPtr[3]*dy)/dx-(0.1353164693413185*hRPtr[2]*fRPtr[3]*dy)/dx-(0.1353164693413185*hPtr[2]*fRPtr[3]*dy)/dx+(0.140625*hRPtr[1]*fRPtr[3]*dy)/dx-(0.140625*hPtr[1]*fRPtr[3]*dy)/dx-(0.1353164693413185*hRPtr[2]*fPtr[3]*dy)/dx-(0.1353164693413185*hPtr[2]*fPtr[3]*dy)/dx+(0.140625*hRPtr[1]*fPtr[3]*dy)/dx-(0.140625*hPtr[1]*fPtr[3]*dy)/dx)
    fOutPtr[4] = fPtr[4]-dt*((0.270632938682637*fRPtr[2]*hRPtr[4]*dy)/dx-(0.270632938682637*fPtr[2]*hRPtr[4]*dy)/dx-(0.234375*fRPtr[1]*hRPtr[4]*dy)/dx-(0.234375*fPtr[1]*hRPtr[4]*dy)/dx+(0.270632938682637*fRPtr[2]*hPtr[4]*dy)/dx-(0.270632938682637*fPtr[2]*hPtr[4]*dy)/dx-(0.234375*fRPtr[1]*hPtr[4]*dy)/dx-(0.234375*fPtr[1]*hPtr[4]*dy)/dx+(0.270632938682637*hRPtr[2]*fRPtr[4]*dy)/dx+(0.270632938682637*hPtr[2]*fRPtr[4]*dy)/dx-(0.28125*hRPtr[1]*fRPtr[4]*dy)/dx+(0.28125*hPtr[1]*fRPtr[4]*dy)/dx-(0.270632938682637*hRPtr[2]*fPtr[4]*dy)/dx-(0.270632938682637*hPtr[2]*fPtr[4]*dy)/dx+(0.28125*hRPtr[1]*fPtr[4]*dy)/dx-(0.28125*hPtr[1]*fPtr[4]*dy)/dx-(0.28125*fRPtr[2]*hRPtr[3]*dy)/dx+(0.28125*fPtr[2]*hRPtr[3]*dy)/dx+(0.2435696448143733*fRPtr[1]*hRPtr[3]*dy)/dx+(0.2435696448143733*fPtr[1]*hRPtr[3]*dy)/dx+(0.28125*fRPtr[2]*hPtr[3]*dy)/dx-(0.28125*fPtr[2]*hPtr[3]*dy)/dx-(0.2435696448143733*fRPtr[1]*hPtr[3]*dy)/dx-(0.2435696448143733*fPtr[1]*hPtr[3]*dy)/dx-(0.234375*hRPtr[2]*fRPtr[3]*dy)/dx-(0.234375*hPtr[2]*fRPtr[3]*dy)/dx+(0.2435696448143733*hRPtr[1]*fRPtr[3]*dy)/dx-(0.2435696448143733*hPtr[1]*fRPtr[3]*dy)/dx-(0.234375*hRPtr[2]*fPtr[3]*dy)/dx-(0.234375*hPtr[2]*fPtr[3]*dy)/dx+(0.2435696448143733*hRPtr[1]*fPtr[3]*dy)/dx-(0.2435696448143733*hPtr[1]*fPtr[3]*dy)/dx)
elseif isRightEdge then
    fOutPtr[1] = fPtr[1]-dt*((-(0.078125*fPtr[4]*hPtr[4]*dy^2)/dx)+(0.078125*fLPtr[4]*hPtr[4]*dy^2)/dx+(0.06765823467065926*fPtr[3]*hPtr[4]*dy^2)/dx+(0.06765823467065926*fLPtr[3]*hPtr[4]*dy^2)/dx-(0.078125*fPtr[4]*hLPtr[4]*dy^2)/dx+(0.078125*fLPtr[4]*hLPtr[4]*dy^2)/dx+(0.06765823467065926*fPtr[3]*hLPtr[4]*dy^2)/dx+(0.06765823467065926*fLPtr[3]*hLPtr[4]*dy^2)/dx+(0.08118988160479111*hPtr[3]*fPtr[4]*dy^2)/dx-(0.08118988160479111*hLPtr[3]*fPtr[4]*dy^2)/dx-(0.08118988160479111*hPtr[3]*fLPtr[4]*dy^2)/dx+(0.08118988160479111*hLPtr[3]*fLPtr[4]*dy^2)/dx-(0.0703125*fPtr[3]*hPtr[3]*dy^2)/dx-(0.0703125*fLPtr[3]*hPtr[3]*dy^2)/dx+(0.0703125*fPtr[3]*hLPtr[3]*dy^2)/dx+(0.0703125*fLPtr[3]*hLPtr[3]*dy^2)/dx-(0.3125*fPtr[2]*hPtr[2])/dx+(0.3125*fLPtr[2]*hPtr[2])/dx+(0.270632938682637*fPtr[1]*hPtr[2])/dx+(0.270632938682637*fLPtr[1]*hPtr[2])/dx-(0.3125*fPtr[2]*hLPtr[2])/dx+(0.3125*fLPtr[2]*hLPtr[2])/dx+(0.270632938682637*fPtr[1]*hLPtr[2])/dx+(0.270632938682637*fLPtr[1]*hLPtr[2])/dx+(0.3247595264191644*hPtr[1]*fPtr[2])/dx-(0.3247595264191644*hLPtr[1]*fPtr[2])/dx-(0.3247595264191644*hPtr[1]*fLPtr[2])/dx+(0.3247595264191644*hLPtr[1]*fLPtr[2])/dx-(0.28125*fPtr[1]*hPtr[1])/dx-(0.28125*fLPtr[1]*hPtr[1])/dx+(0.28125*fPtr[1]*hLPtr[1])/dx+(0.28125*fLPtr[1]*hLPtr[1])/dx)
    fOutPtr[2] = fPtr[2]-dt*((0.1353164693413185*fPtr[4]*hPtr[4]*dy^2)/dx-(0.1353164693413185*fLPtr[4]*hPtr[4]*dy^2)/dx-(0.1171875*fPtr[3]*hPtr[4]*dy^2)/dx-(0.1171875*fLPtr[3]*hPtr[4]*dy^2)/dx+(0.1353164693413185*fPtr[4]*hLPtr[4]*dy^2)/dx-(0.1353164693413185*fLPtr[4]*hLPtr[4]*dy^2)/dx-(0.1171875*fPtr[3]*hLPtr[4]*dy^2)/dx-(0.1171875*fLPtr[3]*hLPtr[4]*dy^2)/dx-(0.140625*hPtr[3]*fPtr[4]*dy^2)/dx+(0.140625*hLPtr[3]*fPtr[4]*dy^2)/dx+(0.140625*hPtr[3]*fLPtr[4]*dy^2)/dx-(0.140625*hLPtr[3]*fLPtr[4]*dy^2)/dx+(0.1217848224071866*fPtr[3]*hPtr[3]*dy^2)/dx+(0.1217848224071866*fLPtr[3]*hPtr[3]*dy^2)/dx-(0.1217848224071866*fPtr[3]*hLPtr[3]*dy^2)/dx-(0.1217848224071866*fLPtr[3]*hLPtr[3]*dy^2)/dx+(0.5412658773652741*fPtr[2]*hPtr[2])/dx-(0.5412658773652741*fLPtr[2]*hPtr[2])/dx-(0.46875*fPtr[1]*hPtr[2])/dx-(0.46875*fLPtr[1]*hPtr[2])/dx+(0.5412658773652741*fPtr[2]*hLPtr[2])/dx-(0.5412658773652741*fLPtr[2]*hLPtr[2])/dx-(0.46875*fPtr[1]*hLPtr[2])/dx-(0.46875*fLPtr[1]*hLPtr[2])/dx-(0.5625*hPtr[1]*fPtr[2])/dx+(0.5625*hLPtr[1]*fPtr[2])/dx+(0.5625*hPtr[1]*fLPtr[2])/dx-(0.5625*hLPtr[1]*fLPtr[2])/dx+(0.4871392896287466*fPtr[1]*hPtr[1])/dx+(0.4871392896287466*fLPtr[1]*hPtr[1])/dx-(0.4871392896287466*fPtr[1]*hLPtr[1])/dx-(0.4871392896287466*fLPtr[1]*hLPtr[1])/dx)
    fOutPtr[3] = fPtr[3]-dt*((-(0.15625*fPtr[2]*hPtr[4]*dy)/dx)+(0.15625*fLPtr[2]*hPtr[4]*dy)/dx+(0.1353164693413185*fPtr[1]*hPtr[4]*dy)/dx+(0.1353164693413185*fLPtr[1]*hPtr[4]*dy)/dx-(0.15625*fPtr[2]*hLPtr[4]*dy)/dx+(0.15625*fLPtr[2]*hLPtr[4]*dy)/dx+(0.1353164693413185*fPtr[1]*hLPtr[4]*dy)/dx+(0.1353164693413185*fLPtr[1]*hLPtr[4]*dy)/dx-(0.15625*hPtr[2]*fPtr[4]*dy)/dx-(0.15625*hLPtr[2]*fPtr[4]*dy)/dx+(0.1623797632095822*hPtr[1]*fPtr[4]*dy)/dx-(0.1623797632095822*hLPtr[1]*fPtr[4]*dy)/dx+(0.15625*hPtr[2]*fLPtr[4]*dy)/dx+(0.15625*hLPtr[2]*fLPtr[4]*dy)/dx-(0.1623797632095822*hPtr[1]*fLPtr[4]*dy)/dx+(0.1623797632095822*hLPtr[1]*fLPtr[4]*dy)/dx+(0.1623797632095822*fPtr[2]*hPtr[3]*dy)/dx-(0.1623797632095822*fLPtr[2]*hPtr[3]*dy)/dx-(0.140625*fPtr[1]*hPtr[3]*dy)/dx-(0.140625*fLPtr[1]*hPtr[3]*dy)/dx-(0.1623797632095822*fPtr[2]*hLPtr[3]*dy)/dx+(0.1623797632095822*fLPtr[2]*hLPtr[3]*dy)/dx+(0.140625*fPtr[1]*hLPtr[3]*dy)/dx+(0.140625*fLPtr[1]*hLPtr[3]*dy)/dx+(0.1353164693413185*hPtr[2]*fPtr[3]*dy)/dx+(0.1353164693413185*hLPtr[2]*fPtr[3]*dy)/dx-(0.140625*hPtr[1]*fPtr[3]*dy)/dx+(0.140625*hLPtr[1]*fPtr[3]*dy)/dx+(0.1353164693413185*hPtr[2]*fLPtr[3]*dy)/dx+(0.1353164693413185*hLPtr[2]*fLPtr[3]*dy)/dx-(0.140625*hPtr[1]*fLPtr[3]*dy)/dx+(0.140625*hLPtr[1]*fLPtr[3]*dy)/dx)
    fOutPtr[4] = fPtr[4]-dt*((0.270632938682637*fPtr[2]*hPtr[4]*dy)/dx-(0.270632938682637*fLPtr[2]*hPtr[4]*dy)/dx-(0.234375*fPtr[1]*hPtr[4]*dy)/dx-(0.234375*fLPtr[1]*hPtr[4]*dy)/dx+(0.270632938682637*fPtr[2]*hLPtr[4]*dy)/dx-(0.270632938682637*fLPtr[2]*hLPtr[4]*dy)/dx-(0.234375*fPtr[1]*hLPtr[4]*dy)/dx-(0.234375*fLPtr[1]*hLPtr[4]*dy)/dx+(0.270632938682637*hPtr[2]*fPtr[4]*dy)/dx+(0.270632938682637*hLPtr[2]*fPtr[4]*dy)/dx-(0.28125*hPtr[1]*fPtr[4]*dy)/dx+(0.28125*hLPtr[1]*fPtr[4]*dy)/dx-(0.270632938682637*hPtr[2]*fLPtr[4]*dy)/dx-(0.270632938682637*hLPtr[2]*fLPtr[4]*dy)/dx+(0.28125*hPtr[1]*fLPtr[4]*dy)/dx-(0.28125*hLPtr[1]*fLPtr[4]*dy)/dx-(0.28125*fPtr[2]*hPtr[3]*dy)/dx+(0.28125*fLPtr[2]*hPtr[3]*dy)/dx+(0.2435696448143733*fPtr[1]*hPtr[3]*dy)/dx+(0.2435696448143733*fLPtr[1]*hPtr[3]*dy)/dx+(0.28125*fPtr[2]*hLPtr[3]*dy)/dx-(0.28125*fLPtr[2]*hLPtr[3]*dy)/dx-(0.2435696448143733*fPtr[1]*hLPtr[3]*dy)/dx-(0.2435696448143733*fLPtr[1]*hLPtr[3]*dy)/dx-(0.234375*hPtr[2]*fPtr[3]*dy)/dx-(0.234375*hLPtr[2]*fPtr[3]*dy)/dx+(0.2435696448143733*hPtr[1]*fPtr[3]*dy)/dx-(0.2435696448143733*hLPtr[1]*fPtr[3]*dy)/dx-(0.234375*hPtr[2]*fLPtr[3]*dy)/dx-(0.234375*hLPtr[2]*fLPtr[3]*dy)/dx+(0.2435696448143733*hPtr[1]*fLPtr[3]*dy)/dx-(0.2435696448143733*hLPtr[1]*fLPtr[3]*dy)/dx)
else
    fOutPtr[1] = fPtr[1]-dt*((0.078125*fRPtr[4]*hRPtr[4]*dy^2)/dx-(0.078125*fPtr[4]*hRPtr[4]*dy^2)/dx-(0.06765823467065926*fRPtr[3]*hRPtr[4]*dy^2)/dx-(0.06765823467065926*fPtr[3]*hRPtr[4]*dy^2)/dx+(0.078125*fRPtr[4]*hPtr[4]*dy^2)/dx-(0.15625*fPtr[4]*hPtr[4]*dy^2)/dx+(0.078125*fLPtr[4]*hPtr[4]*dy^2)/dx-(0.06765823467065926*fRPtr[3]*hPtr[4]*dy^2)/dx+(0.06765823467065926*fLPtr[3]*hPtr[4]*dy^2)/dx-(0.078125*fPtr[4]*hLPtr[4]*dy^2)/dx+(0.078125*fLPtr[4]*hLPtr[4]*dy^2)/dx+(0.06765823467065926*fPtr[3]*hLPtr[4]*dy^2)/dx+(0.06765823467065926*fLPtr[3]*hLPtr[4]*dy^2)/dx-(0.08118988160479111*hRPtr[3]*fRPtr[4]*dy^2)/dx+(0.08118988160479111*hPtr[3]*fRPtr[4]*dy^2)/dx+(0.08118988160479111*hRPtr[3]*fPtr[4]*dy^2)/dx-(0.08118988160479111*hLPtr[3]*fPtr[4]*dy^2)/dx-(0.08118988160479111*hPtr[3]*fLPtr[4]*dy^2)/dx+(0.08118988160479111*hLPtr[3]*fLPtr[4]*dy^2)/dx+(0.0703125*fRPtr[3]*hRPtr[3]*dy^2)/dx+(0.0703125*fPtr[3]*hRPtr[3]*dy^2)/dx-(0.0703125*fRPtr[3]*hPtr[3]*dy^2)/dx-(0.140625*fPtr[3]*hPtr[3]*dy^2)/dx-(0.0703125*fLPtr[3]*hPtr[3]*dy^2)/dx+(0.0703125*fPtr[3]*hLPtr[3]*dy^2)/dx+(0.0703125*fLPtr[3]*hLPtr[3]*dy^2)/dx+(0.3125*fRPtr[2]*hRPtr[2])/dx-(0.3125*fPtr[2]*hRPtr[2])/dx-(0.270632938682637*fRPtr[1]*hRPtr[2])/dx-(0.270632938682637*fPtr[1]*hRPtr[2])/dx+(0.3125*fRPtr[2]*hPtr[2])/dx-(0.625*fPtr[2]*hPtr[2])/dx+(0.3125*fLPtr[2]*hPtr[2])/dx-(0.270632938682637*fRPtr[1]*hPtr[2])/dx+(0.270632938682637*fLPtr[1]*hPtr[2])/dx-(0.3125*fPtr[2]*hLPtr[2])/dx+(0.3125*fLPtr[2]*hLPtr[2])/dx+(0.270632938682637*fPtr[1]*hLPtr[2])/dx+(0.270632938682637*fLPtr[1]*hLPtr[2])/dx-(0.3247595264191644*hRPtr[1]*fRPtr[2])/dx+(0.3247595264191644*hPtr[1]*fRPtr[2])/dx+(0.3247595264191644*hRPtr[1]*fPtr[2])/dx-(0.3247595264191644*hLPtr[1]*fPtr[2])/dx-(0.3247595264191644*hPtr[1]*fLPtr[2])/dx+(0.3247595264191644*hLPtr[1]*fLPtr[2])/dx+(0.28125*fRPtr[1]*hRPtr[1])/dx+(0.28125*fPtr[1]*hRPtr[1])/dx-(0.28125*fRPtr[1]*hPtr[1])/dx-(0.5625*fPtr[1]*hPtr[1])/dx-(0.28125*fLPtr[1]*hPtr[1])/dx+(0.28125*fPtr[1]*hLPtr[1])/dx+(0.28125*fLPtr[1]*hLPtr[1])/dx)
    fOutPtr[2] = fPtr[2]-dt*((0.1353164693413185*fRPtr[4]*hRPtr[4]*dy^2)/dx-(0.1353164693413185*fPtr[4]*hRPtr[4]*dy^2)/dx-(0.1171875*fRPtr[3]*hRPtr[4]*dy^2)/dx-(0.1171875*fPtr[3]*hRPtr[4]*dy^2)/dx+(0.1353164693413185*fRPtr[4]*hPtr[4]*dy^2)/dx-(0.1353164693413185*fLPtr[4]*hPtr[4]*dy^2)/dx-(0.1171875*fRPtr[3]*hPtr[4]*dy^2)/dx-(0.234375*fPtr[3]*hPtr[4]*dy^2)/dx-(0.1171875*fLPtr[3]*hPtr[4]*dy^2)/dx+(0.1353164693413185*fPtr[4]*hLPtr[4]*dy^2)/dx-(0.1353164693413185*fLPtr[4]*hLPtr[4]*dy^2)/dx-(0.1171875*fPtr[3]*hLPtr[4]*dy^2)/dx-(0.1171875*fLPtr[3]*hLPtr[4]*dy^2)/dx-(0.140625*hRPtr[3]*fRPtr[4]*dy^2)/dx+(0.140625*hPtr[3]*fRPtr[4]*dy^2)/dx+(0.140625*hRPtr[3]*fPtr[4]*dy^2)/dx-(0.28125*hPtr[3]*fPtr[4]*dy^2)/dx+(0.140625*hLPtr[3]*fPtr[4]*dy^2)/dx+(0.140625*hPtr[3]*fLPtr[4]*dy^2)/dx-(0.140625*hLPtr[3]*fLPtr[4]*dy^2)/dx+(0.1217848224071866*fRPtr[3]*hRPtr[3]*dy^2)/dx+(0.1217848224071866*fPtr[3]*hRPtr[3]*dy^2)/dx-(0.1217848224071866*fRPtr[3]*hPtr[3]*dy^2)/dx+(0.1217848224071866*fLPtr[3]*hPtr[3]*dy^2)/dx-(0.1217848224071866*fPtr[3]*hLPtr[3]*dy^2)/dx-(0.1217848224071866*fLPtr[3]*hLPtr[3]*dy^2)/dx+(0.5412658773652741*fRPtr[2]*hRPtr[2])/dx-(0.5412658773652741*fPtr[2]*hRPtr[2])/dx-(0.46875*fRPtr[1]*hRPtr[2])/dx-(0.46875*fPtr[1]*hRPtr[2])/dx+(0.5412658773652741*fRPtr[2]*hPtr[2])/dx-(0.5412658773652741*fLPtr[2]*hPtr[2])/dx-(0.46875*fRPtr[1]*hPtr[2])/dx-(0.9375*fPtr[1]*hPtr[2])/dx-(0.46875*fLPtr[1]*hPtr[2])/dx+(0.5412658773652741*fPtr[2]*hLPtr[2])/dx-(0.5412658773652741*fLPtr[2]*hLPtr[2])/dx-(0.46875*fPtr[1]*hLPtr[2])/dx-(0.46875*fLPtr[1]*hLPtr[2])/dx-(0.5625*hRPtr[1]*fRPtr[2])/dx+(0.5625*hPtr[1]*fRPtr[2])/dx+(0.5625*hRPtr[1]*fPtr[2])/dx-(1.125*hPtr[1]*fPtr[2])/dx+(0.5625*hLPtr[1]*fPtr[2])/dx+(0.5625*hPtr[1]*fLPtr[2])/dx-(0.5625*hLPtr[1]*fLPtr[2])/dx+(0.4871392896287466*fRPtr[1]*hRPtr[1])/dx+(0.4871392896287466*fPtr[1]*hRPtr[1])/dx-(0.4871392896287466*fRPtr[1]*hPtr[1])/dx+(0.4871392896287466*fLPtr[1]*hPtr[1])/dx-(0.4871392896287466*fPtr[1]*hLPtr[1])/dx-(0.4871392896287466*fLPtr[1]*hLPtr[1])/dx)
    fOutPtr[3] = fPtr[3]-dt*((0.15625*fRPtr[2]*hRPtr[4]*dy)/dx-(0.15625*fPtr[2]*hRPtr[4]*dy)/dx-(0.1353164693413185*fRPtr[1]*hRPtr[4]*dy)/dx-(0.1353164693413185*fPtr[1]*hRPtr[4]*dy)/dx+(0.15625*fRPtr[2]*hPtr[4]*dy)/dx-(0.3125*fPtr[2]*hPtr[4]*dy)/dx+(0.15625*fLPtr[2]*hPtr[4]*dy)/dx-(0.1353164693413185*fRPtr[1]*hPtr[4]*dy)/dx+(0.1353164693413185*fLPtr[1]*hPtr[4]*dy)/dx-(0.15625*fPtr[2]*hLPtr[4]*dy)/dx+(0.15625*fLPtr[2]*hLPtr[4]*dy)/dx+(0.1353164693413185*fPtr[1]*hLPtr[4]*dy)/dx+(0.1353164693413185*fLPtr[1]*hLPtr[4]*dy)/dx+(0.15625*hRPtr[2]*fRPtr[4]*dy)/dx+(0.15625*hPtr[2]*fRPtr[4]*dy)/dx-(0.1623797632095822*hRPtr[1]*fRPtr[4]*dy)/dx+(0.1623797632095822*hPtr[1]*fRPtr[4]*dy)/dx-(0.15625*hRPtr[2]*fPtr[4]*dy)/dx-(0.3125*hPtr[2]*fPtr[4]*dy)/dx-(0.15625*hLPtr[2]*fPtr[4]*dy)/dx+(0.1623797632095822*hRPtr[1]*fPtr[4]*dy)/dx-(0.1623797632095822*hLPtr[1]*fPtr[4]*dy)/dx+(0.15625*hPtr[2]*fLPtr[4]*dy)/dx+(0.15625*hLPtr[2]*fLPtr[4]*dy)/dx-(0.1623797632095822*hPtr[1]*fLPtr[4]*dy)/dx+(0.1623797632095822*hLPtr[1]*fLPtr[4]*dy)/dx-(0.1623797632095822*fRPtr[2]*hRPtr[3]*dy)/dx+(0.1623797632095822*fPtr[2]*hRPtr[3]*dy)/dx+(0.140625*fRPtr[1]*hRPtr[3]*dy)/dx+(0.140625*fPtr[1]*hRPtr[3]*dy)/dx+(0.1623797632095822*fRPtr[2]*hPtr[3]*dy)/dx-(0.1623797632095822*fLPtr[2]*hPtr[3]*dy)/dx-(0.140625*fRPtr[1]*hPtr[3]*dy)/dx-(0.28125*fPtr[1]*hPtr[3]*dy)/dx-(0.140625*fLPtr[1]*hPtr[3]*dy)/dx-(0.1623797632095822*fPtr[2]*hLPtr[3]*dy)/dx+(0.1623797632095822*fLPtr[2]*hLPtr[3]*dy)/dx+(0.140625*fPtr[1]*hLPtr[3]*dy)/dx+(0.140625*fLPtr[1]*hLPtr[3]*dy)/dx-(0.1353164693413185*hRPtr[2]*fRPtr[3]*dy)/dx-(0.1353164693413185*hPtr[2]*fRPtr[3]*dy)/dx+(0.140625*hRPtr[1]*fRPtr[3]*dy)/dx-(0.140625*hPtr[1]*fRPtr[3]*dy)/dx-(0.1353164693413185*hRPtr[2]*fPtr[3]*dy)/dx+(0.1353164693413185*hLPtr[2]*fPtr[3]*dy)/dx+(0.140625*hRPtr[1]*fPtr[3]*dy)/dx-(0.28125*hPtr[1]*fPtr[3]*dy)/dx+(0.140625*hLPtr[1]*fPtr[3]*dy)/dx+(0.1353164693413185*hPtr[2]*fLPtr[3]*dy)/dx+(0.1353164693413185*hLPtr[2]*fLPtr[3]*dy)/dx-(0.140625*hPtr[1]*fLPtr[3]*dy)/dx+(0.140625*hLPtr[1]*fLPtr[3]*dy)/dx)
    fOutPtr[4] = fPtr[4]-dt*((0.270632938682637*fRPtr[2]*hRPtr[4]*dy)/dx-(0.270632938682637*fPtr[2]*hRPtr[4]*dy)/dx-(0.234375*fRPtr[1]*hRPtr[4]*dy)/dx-(0.234375*fPtr[1]*hRPtr[4]*dy)/dx+(0.270632938682637*fRPtr[2]*hPtr[4]*dy)/dx-(0.270632938682637*fLPtr[2]*hPtr[4]*dy)/dx-(0.234375*fRPtr[1]*hPtr[4]*dy)/dx-(0.46875*fPtr[1]*hPtr[4]*dy)/dx-(0.234375*fLPtr[1]*hPtr[4]*dy)/dx+(0.270632938682637*fPtr[2]*hLPtr[4]*dy)/dx-(0.270632938682637*fLPtr[2]*hLPtr[4]*dy)/dx-(0.234375*fPtr[1]*hLPtr[4]*dy)/dx-(0.234375*fLPtr[1]*hLPtr[4]*dy)/dx+(0.270632938682637*hRPtr[2]*fRPtr[4]*dy)/dx+(0.270632938682637*hPtr[2]*fRPtr[4]*dy)/dx-(0.28125*hRPtr[1]*fRPtr[4]*dy)/dx+(0.28125*hPtr[1]*fRPtr[4]*dy)/dx-(0.270632938682637*hRPtr[2]*fPtr[4]*dy)/dx+(0.270632938682637*hLPtr[2]*fPtr[4]*dy)/dx+(0.28125*hRPtr[1]*fPtr[4]*dy)/dx-(0.5625*hPtr[1]*fPtr[4]*dy)/dx+(0.28125*hLPtr[1]*fPtr[4]*dy)/dx-(0.270632938682637*hPtr[2]*fLPtr[4]*dy)/dx-(0.270632938682637*hLPtr[2]*fLPtr[4]*dy)/dx+(0.28125*hPtr[1]*fLPtr[4]*dy)/dx-(0.28125*hLPtr[1]*fLPtr[4]*dy)/dx-(0.28125*fRPtr[2]*hRPtr[3]*dy)/dx+(0.28125*fPtr[2]*hRPtr[3]*dy)/dx+(0.2435696448143733*fRPtr[1]*hRPtr[3]*dy)/dx+(0.2435696448143733*fPtr[1]*hRPtr[3]*dy)/dx+(0.28125*fRPtr[2]*hPtr[3]*dy)/dx-(0.5625*fPtr[2]*hPtr[3]*dy)/dx+(0.28125*fLPtr[2]*hPtr[3]*dy)/dx-(0.2435696448143733*fRPtr[1]*hPtr[3]*dy)/dx+(0.2435696448143733*fLPtr[1]*hPtr[3]*dy)/dx+(0.28125*fPtr[2]*hLPtr[3]*dy)/dx-(0.28125*fLPtr[2]*hLPtr[3]*dy)/dx-(0.2435696448143733*fPtr[1]*hLPtr[3]*dy)/dx-(0.2435696448143733*fLPtr[1]*hLPtr[3]*dy)/dx-(0.234375*hRPtr[2]*fRPtr[3]*dy)/dx-(0.234375*hPtr[2]*fRPtr[3]*dy)/dx+(0.2435696448143733*hRPtr[1]*fRPtr[3]*dy)/dx-(0.2435696448143733*hPtr[1]*fRPtr[3]*dy)/dx-(0.234375*hRPtr[2]*fPtr[3]*dy)/dx-(0.46875*hPtr[2]*fPtr[3]*dy)/dx-(0.234375*hLPtr[2]*fPtr[3]*dy)/dx+(0.2435696448143733*hRPtr[1]*fPtr[3]*dy)/dx-(0.2435696448143733*hLPtr[1]*fPtr[3]*dy)/dx-(0.234375*hPtr[2]*fLPtr[3]*dy)/dx-(0.234375*hLPtr[2]*fLPtr[3]*dy)/dx+(0.2435696448143733*hPtr[1]*fLPtr[3]*dy)/dx-(0.2435696448143733*hLPtr[1]*fLPtr[3]*dy)/dx)
end

fOutPtr[1] = fOutPtr[1]
fOutPtr[2] = dt*((6.0*fPtr[3]*hPtr[4])/dx^2+(6.0*fPtr[1]*hPtr[2])/dx^2)+fOutPtr[2]
fOutPtr[3] = fOutPtr[3]
fOutPtr[4] = dt*((6.0*fPtr[1]*hPtr[4])/dx^2+(6.0*hPtr[2]*fPtr[3])/dx^2)+fOutPtr[4]

if isTopEdge then
    fOutPtr[1] = fOutPtr[1]-dt*((-(0.078125*fPtr[4]*hPtr[4]*dx^2)/dy)+(0.078125*fBPtr[4]*hPtr[4]*dx^2)/dy+(0.06765823467065926*fPtr[2]*hPtr[4]*dx^2)/dy+(0.06765823467065926*fBPtr[2]*hPtr[4]*dx^2)/dy-(0.078125*fPtr[4]*hBPtr[4]*dx^2)/dy+(0.078125*fBPtr[4]*hBPtr[4]*dx^2)/dy+(0.06765823467065926*fPtr[2]*hBPtr[4]*dx^2)/dy+(0.06765823467065926*fBPtr[2]*hBPtr[4]*dx^2)/dy+(0.08118988160479111*hPtr[2]*fPtr[4]*dx^2)/dy-(0.08118988160479111*hBPtr[2]*fPtr[4]*dx^2)/dy-(0.08118988160479111*hPtr[2]*fBPtr[4]*dx^2)/dy+(0.08118988160479111*hBPtr[2]*fBPtr[4]*dx^2)/dy-(0.0703125*fPtr[2]*hPtr[2]*dx^2)/dy-(0.0703125*fBPtr[2]*hPtr[2]*dx^2)/dy+(0.0703125*fPtr[2]*hBPtr[2]*dx^2)/dy+(0.0703125*fBPtr[2]*hBPtr[2]*dx^2)/dy-(0.3125*fPtr[3]*hPtr[3])/dy+(0.3125*fBPtr[3]*hPtr[3])/dy+(0.270632938682637*fPtr[1]*hPtr[3])/dy+(0.270632938682637*fBPtr[1]*hPtr[3])/dy-(0.3125*fPtr[3]*hBPtr[3])/dy+(0.3125*fBPtr[3]*hBPtr[3])/dy+(0.270632938682637*fPtr[1]*hBPtr[3])/dy+(0.270632938682637*fBPtr[1]*hBPtr[3])/dy+(0.3247595264191644*hPtr[1]*fPtr[3])/dy-(0.3247595264191644*hBPtr[1]*fPtr[3])/dy-(0.3247595264191644*hPtr[1]*fBPtr[3])/dy+(0.3247595264191644*hBPtr[1]*fBPtr[3])/dy-(0.28125*fPtr[1]*hPtr[1])/dy-(0.28125*fBPtr[1]*hPtr[1])/dy+(0.28125*fPtr[1]*hBPtr[1])/dy+(0.28125*fBPtr[1]*hBPtr[1])/dy)
    fOutPtr[2] = fOutPtr[2]-dt*((-(0.15625*fPtr[3]*hPtr[4]*dx)/dy)+(0.15625*fBPtr[3]*hPtr[4]*dx)/dy+(0.1353164693413185*fPtr[1]*hPtr[4]*dx)/dy+(0.1353164693413185*fBPtr[1]*hPtr[4]*dx)/dy-(0.15625*fPtr[3]*hBPtr[4]*dx)/dy+(0.15625*fBPtr[3]*hBPtr[4]*dx)/dy+(0.1353164693413185*fPtr[1]*hBPtr[4]*dx)/dy+(0.1353164693413185*fBPtr[1]*hBPtr[4]*dx)/dy-(0.15625*hPtr[3]*fPtr[4]*dx)/dy-(0.15625*hBPtr[3]*fPtr[4]*dx)/dy+(0.1623797632095822*hPtr[1]*fPtr[4]*dx)/dy-(0.1623797632095822*hBPtr[1]*fPtr[4]*dx)/dy+(0.15625*hPtr[3]*fBPtr[4]*dx)/dy+(0.15625*hBPtr[3]*fBPtr[4]*dx)/dy-(0.1623797632095822*hPtr[1]*fBPtr[4]*dx)/dy+(0.1623797632095822*hBPtr[1]*fBPtr[4]*dx)/dy+(0.1353164693413185*fPtr[2]*hPtr[3]*dx)/dy+(0.1353164693413185*fBPtr[2]*hPtr[3]*dx)/dy+(0.1353164693413185*fPtr[2]*hBPtr[3]*dx)/dy+(0.1353164693413185*fBPtr[2]*hBPtr[3]*dx)/dy+(0.1623797632095822*hPtr[2]*fPtr[3]*dx)/dy-(0.1623797632095822*hBPtr[2]*fPtr[3]*dx)/dy-(0.1623797632095822*hPtr[2]*fBPtr[3]*dx)/dy+(0.1623797632095822*hBPtr[2]*fBPtr[3]*dx)/dy-(0.140625*fPtr[1]*hPtr[2]*dx)/dy-(0.140625*fBPtr[1]*hPtr[2]*dx)/dy+(0.140625*fPtr[1]*hBPtr[2]*dx)/dy+(0.140625*fBPtr[1]*hBPtr[2]*dx)/dy-(0.140625*hPtr[1]*fPtr[2]*dx)/dy+(0.140625*hBPtr[1]*fPtr[2]*dx)/dy-(0.140625*hPtr[1]*fBPtr[2]*dx)/dy+(0.140625*hBPtr[1]*fBPtr[2]*dx)/dy)
    fOutPtr[3] = fOutPtr[3]-dt*((0.1353164693413185*fPtr[4]*hPtr[4]*dx^2)/dy-(0.1353164693413185*fBPtr[4]*hPtr[4]*dx^2)/dy-(0.1171875*fPtr[2]*hPtr[4]*dx^2)/dy-(0.1171875*fBPtr[2]*hPtr[4]*dx^2)/dy+(0.1353164693413185*fPtr[4]*hBPtr[4]*dx^2)/dy-(0.1353164693413185*fBPtr[4]*hBPtr[4]*dx^2)/dy-(0.1171875*fPtr[2]*hBPtr[4]*dx^2)/dy-(0.1171875*fBPtr[2]*hBPtr[4]*dx^2)/dy-(0.140625*hPtr[2]*fPtr[4]*dx^2)/dy+(0.140625*hBPtr[2]*fPtr[4]*dx^2)/dy+(0.140625*hPtr[2]*fBPtr[4]*dx^2)/dy-(0.140625*hBPtr[2]*fBPtr[4]*dx^2)/dy+(0.1217848224071866*fPtr[2]*hPtr[2]*dx^2)/dy+(0.1217848224071866*fBPtr[2]*hPtr[2]*dx^2)/dy-(0.1217848224071866*fPtr[2]*hBPtr[2]*dx^2)/dy-(0.1217848224071866*fBPtr[2]*hBPtr[2]*dx^2)/dy+(0.5412658773652741*fPtr[3]*hPtr[3])/dy-(0.5412658773652741*fBPtr[3]*hPtr[3])/dy-(0.46875*fPtr[1]*hPtr[3])/dy-(0.46875*fBPtr[1]*hPtr[3])/dy+(0.5412658773652741*fPtr[3]*hBPtr[3])/dy-(0.5412658773652741*fBPtr[3]*hBPtr[3])/dy-(0.46875*fPtr[1]*hBPtr[3])/dy-(0.46875*fBPtr[1]*hBPtr[3])/dy-(0.5625*hPtr[1]*fPtr[3])/dy+(0.5625*hBPtr[1]*fPtr[3])/dy+(0.5625*hPtr[1]*fBPtr[3])/dy-(0.5625*hBPtr[1]*fBPtr[3])/dy+(0.4871392896287466*fPtr[1]*hPtr[1])/dy+(0.4871392896287466*fBPtr[1]*hPtr[1])/dy-(0.4871392896287466*fPtr[1]*hBPtr[1])/dy-(0.4871392896287466*fBPtr[1]*hBPtr[1])/dy)
    fOutPtr[4] = fOutPtr[4]-dt*((0.270632938682637*fPtr[3]*hPtr[4]*dx)/dy-(0.270632938682637*fBPtr[3]*hPtr[4]*dx)/dy-(0.234375*fPtr[1]*hPtr[4]*dx)/dy-(0.234375*fBPtr[1]*hPtr[4]*dx)/dy+(0.270632938682637*fPtr[3]*hBPtr[4]*dx)/dy-(0.270632938682637*fBPtr[3]*hBPtr[4]*dx)/dy-(0.234375*fPtr[1]*hBPtr[4]*dx)/dy-(0.234375*fBPtr[1]*hBPtr[4]*dx)/dy+(0.270632938682637*hPtr[3]*fPtr[4]*dx)/dy+(0.270632938682637*hBPtr[3]*fPtr[4]*dx)/dy-(0.28125*hPtr[1]*fPtr[4]*dx)/dy+(0.28125*hBPtr[1]*fPtr[4]*dx)/dy-(0.270632938682637*hPtr[3]*fBPtr[4]*dx)/dy-(0.270632938682637*hBPtr[3]*fBPtr[4]*dx)/dy+(0.28125*hPtr[1]*fBPtr[4]*dx)/dy-(0.28125*hBPtr[1]*fBPtr[4]*dx)/dy-(0.234375*fPtr[2]*hPtr[3]*dx)/dy-(0.234375*fBPtr[2]*hPtr[3]*dx)/dy-(0.234375*fPtr[2]*hBPtr[3]*dx)/dy-(0.234375*fBPtr[2]*hBPtr[3]*dx)/dy-(0.28125*hPtr[2]*fPtr[3]*dx)/dy+(0.28125*hBPtr[2]*fPtr[3]*dx)/dy+(0.28125*hPtr[2]*fBPtr[3]*dx)/dy-(0.28125*hBPtr[2]*fBPtr[3]*dx)/dy+(0.2435696448143733*fPtr[1]*hPtr[2]*dx)/dy+(0.2435696448143733*fBPtr[1]*hPtr[2]*dx)/dy-(0.2435696448143733*fPtr[1]*hBPtr[2]*dx)/dy-(0.2435696448143733*fBPtr[1]*hBPtr[2]*dx)/dy+(0.2435696448143733*hPtr[1]*fPtr[2]*dx)/dy-(0.2435696448143733*hBPtr[1]*fPtr[2]*dx)/dy+(0.2435696448143733*hPtr[1]*fBPtr[2]*dx)/dy-(0.2435696448143733*hBPtr[1]*fBPtr[2]*dx)/dy)
elseif isBotEdge then
    fOutPtr[1] = fOutPtr[1]-dt*((0.078125*fTPtr[4]*hTPtr[4]*dx^2)/dy-(0.078125*fPtr[4]*hTPtr[4]*dx^2)/dy-(0.06765823467065926*fTPtr[2]*hTPtr[4]*dx^2)/dy-(0.06765823467065926*fPtr[2]*hTPtr[4]*dx^2)/dy+(0.078125*fTPtr[4]*hPtr[4]*dx^2)/dy-(0.078125*fPtr[4]*hPtr[4]*dx^2)/dy-(0.06765823467065926*fTPtr[2]*hPtr[4]*dx^2)/dy-(0.06765823467065926*fPtr[2]*hPtr[4]*dx^2)/dy-(0.08118988160479111*hTPtr[2]*fTPtr[4]*dx^2)/dy+(0.08118988160479111*hPtr[2]*fTPtr[4]*dx^2)/dy+(0.08118988160479111*hTPtr[2]*fPtr[4]*dx^2)/dy-(0.08118988160479111*hPtr[2]*fPtr[4]*dx^2)/dy+(0.0703125*fTPtr[2]*hTPtr[2]*dx^2)/dy+(0.0703125*fPtr[2]*hTPtr[2]*dx^2)/dy-(0.0703125*fTPtr[2]*hPtr[2]*dx^2)/dy-(0.0703125*fPtr[2]*hPtr[2]*dx^2)/dy+(0.3125*fTPtr[3]*hTPtr[3])/dy-(0.3125*fPtr[3]*hTPtr[3])/dy-(0.270632938682637*fTPtr[1]*hTPtr[3])/dy-(0.270632938682637*fPtr[1]*hTPtr[3])/dy+(0.3125*fTPtr[3]*hPtr[3])/dy-(0.3125*fPtr[3]*hPtr[3])/dy-(0.270632938682637*fTPtr[1]*hPtr[3])/dy-(0.270632938682637*fPtr[1]*hPtr[3])/dy-(0.3247595264191644*hTPtr[1]*fTPtr[3])/dy+(0.3247595264191644*hPtr[1]*fTPtr[3])/dy+(0.3247595264191644*hTPtr[1]*fPtr[3])/dy-(0.3247595264191644*hPtr[1]*fPtr[3])/dy+(0.28125*fTPtr[1]*hTPtr[1])/dy+(0.28125*fPtr[1]*hTPtr[1])/dy-(0.28125*fTPtr[1]*hPtr[1])/dy-(0.28125*fPtr[1]*hPtr[1])/dy)
    fOutPtr[2] = fOutPtr[2]-dt*((0.15625*fTPtr[3]*hTPtr[4]*dx)/dy-(0.15625*fPtr[3]*hTPtr[4]*dx)/dy-(0.1353164693413185*fTPtr[1]*hTPtr[4]*dx)/dy-(0.1353164693413185*fPtr[1]*hTPtr[4]*dx)/dy+(0.15625*fTPtr[3]*hPtr[4]*dx)/dy-(0.15625*fPtr[3]*hPtr[4]*dx)/dy-(0.1353164693413185*fTPtr[1]*hPtr[4]*dx)/dy-(0.1353164693413185*fPtr[1]*hPtr[4]*dx)/dy+(0.15625*hTPtr[3]*fTPtr[4]*dx)/dy+(0.15625*hPtr[3]*fTPtr[4]*dx)/dy-(0.1623797632095822*hTPtr[1]*fTPtr[4]*dx)/dy+(0.1623797632095822*hPtr[1]*fTPtr[4]*dx)/dy-(0.15625*hTPtr[3]*fPtr[4]*dx)/dy-(0.15625*hPtr[3]*fPtr[4]*dx)/dy+(0.1623797632095822*hTPtr[1]*fPtr[4]*dx)/dy-(0.1623797632095822*hPtr[1]*fPtr[4]*dx)/dy-(0.1353164693413185*fTPtr[2]*hTPtr[3]*dx)/dy-(0.1353164693413185*fPtr[2]*hTPtr[3]*dx)/dy-(0.1353164693413185*fTPtr[2]*hPtr[3]*dx)/dy-(0.1353164693413185*fPtr[2]*hPtr[3]*dx)/dy-(0.1623797632095822*hTPtr[2]*fTPtr[3]*dx)/dy+(0.1623797632095822*hPtr[2]*fTPtr[3]*dx)/dy+(0.1623797632095822*hTPtr[2]*fPtr[3]*dx)/dy-(0.1623797632095822*hPtr[2]*fPtr[3]*dx)/dy+(0.140625*fTPtr[1]*hTPtr[2]*dx)/dy+(0.140625*fPtr[1]*hTPtr[2]*dx)/dy-(0.140625*fTPtr[1]*hPtr[2]*dx)/dy-(0.140625*fPtr[1]*hPtr[2]*dx)/dy+(0.140625*hTPtr[1]*fTPtr[2]*dx)/dy-(0.140625*hPtr[1]*fTPtr[2]*dx)/dy+(0.140625*hTPtr[1]*fPtr[2]*dx)/dy-(0.140625*hPtr[1]*fPtr[2]*dx)/dy)
    fOutPtr[3] = fOutPtr[3]-dt*((0.1353164693413185*fTPtr[4]*hTPtr[4]*dx^2)/dy-(0.1353164693413185*fPtr[4]*hTPtr[4]*dx^2)/dy-(0.1171875*fTPtr[2]*hTPtr[4]*dx^2)/dy-(0.1171875*fPtr[2]*hTPtr[4]*dx^2)/dy+(0.1353164693413185*fTPtr[4]*hPtr[4]*dx^2)/dy-(0.1353164693413185*fPtr[4]*hPtr[4]*dx^2)/dy-(0.1171875*fTPtr[2]*hPtr[4]*dx^2)/dy-(0.1171875*fPtr[2]*hPtr[4]*dx^2)/dy-(0.140625*hTPtr[2]*fTPtr[4]*dx^2)/dy+(0.140625*hPtr[2]*fTPtr[4]*dx^2)/dy+(0.140625*hTPtr[2]*fPtr[4]*dx^2)/dy-(0.140625*hPtr[2]*fPtr[4]*dx^2)/dy+(0.1217848224071866*fTPtr[2]*hTPtr[2]*dx^2)/dy+(0.1217848224071866*fPtr[2]*hTPtr[2]*dx^2)/dy-(0.1217848224071866*fTPtr[2]*hPtr[2]*dx^2)/dy-(0.1217848224071866*fPtr[2]*hPtr[2]*dx^2)/dy+(0.5412658773652741*fTPtr[3]*hTPtr[3])/dy-(0.5412658773652741*fPtr[3]*hTPtr[3])/dy-(0.46875*fTPtr[1]*hTPtr[3])/dy-(0.46875*fPtr[1]*hTPtr[3])/dy+(0.5412658773652741*fTPtr[3]*hPtr[3])/dy-(0.5412658773652741*fPtr[3]*hPtr[3])/dy-(0.46875*fTPtr[1]*hPtr[3])/dy-(0.46875*fPtr[1]*hPtr[3])/dy-(0.5625*hTPtr[1]*fTPtr[3])/dy+(0.5625*hPtr[1]*fTPtr[3])/dy+(0.5625*hTPtr[1]*fPtr[3])/dy-(0.5625*hPtr[1]*fPtr[3])/dy+(0.4871392896287466*fTPtr[1]*hTPtr[1])/dy+(0.4871392896287466*fPtr[1]*hTPtr[1])/dy-(0.4871392896287466*fTPtr[1]*hPtr[1])/dy-(0.4871392896287466*fPtr[1]*hPtr[1])/dy)
    fOutPtr[4] = fOutPtr[4]-dt*((0.270632938682637*fTPtr[3]*hTPtr[4]*dx)/dy-(0.270632938682637*fPtr[3]*hTPtr[4]*dx)/dy-(0.234375*fTPtr[1]*hTPtr[4]*dx)/dy-(0.234375*fPtr[1]*hTPtr[4]*dx)/dy+(0.270632938682637*fTPtr[3]*hPtr[4]*dx)/dy-(0.270632938682637*fPtr[3]*hPtr[4]*dx)/dy-(0.234375*fTPtr[1]*hPtr[4]*dx)/dy-(0.234375*fPtr[1]*hPtr[4]*dx)/dy+(0.270632938682637*hTPtr[3]*fTPtr[4]*dx)/dy+(0.270632938682637*hPtr[3]*fTPtr[4]*dx)/dy-(0.28125*hTPtr[1]*fTPtr[4]*dx)/dy+(0.28125*hPtr[1]*fTPtr[4]*dx)/dy-(0.270632938682637*hTPtr[3]*fPtr[4]*dx)/dy-(0.270632938682637*hPtr[3]*fPtr[4]*dx)/dy+(0.28125*hTPtr[1]*fPtr[4]*dx)/dy-(0.28125*hPtr[1]*fPtr[4]*dx)/dy-(0.234375*fTPtr[2]*hTPtr[3]*dx)/dy-(0.234375*fPtr[2]*hTPtr[3]*dx)/dy-(0.234375*fTPtr[2]*hPtr[3]*dx)/dy-(0.234375*fPtr[2]*hPtr[3]*dx)/dy-(0.28125*hTPtr[2]*fTPtr[3]*dx)/dy+(0.28125*hPtr[2]*fTPtr[3]*dx)/dy+(0.28125*hTPtr[2]*fPtr[3]*dx)/dy-(0.28125*hPtr[2]*fPtr[3]*dx)/dy+(0.2435696448143733*fTPtr[1]*hTPtr[2]*dx)/dy+(0.2435696448143733*fPtr[1]*hTPtr[2]*dx)/dy-(0.2435696448143733*fTPtr[1]*hPtr[2]*dx)/dy-(0.2435696448143733*fPtr[1]*hPtr[2]*dx)/dy+(0.2435696448143733*hTPtr[1]*fTPtr[2]*dx)/dy-(0.2435696448143733*hPtr[1]*fTPtr[2]*dx)/dy+(0.2435696448143733*hTPtr[1]*fPtr[2]*dx)/dy-(0.2435696448143733*hPtr[1]*fPtr[2]*dx)/dy)
else
    fOutPtr[1] = fOutPtr[1]-dt*((0.078125*fTPtr[4]*hTPtr[4]*dx^2)/dy-(0.078125*fPtr[4]*hTPtr[4]*dx^2)/dy-(0.06765823467065926*fTPtr[2]*hTPtr[4]*dx^2)/dy-(0.06765823467065926*fPtr[2]*hTPtr[4]*dx^2)/dy+(0.078125*fTPtr[4]*hPtr[4]*dx^2)/dy-(0.15625*fPtr[4]*hPtr[4]*dx^2)/dy+(0.078125*fBPtr[4]*hPtr[4]*dx^2)/dy-(0.06765823467065926*fTPtr[2]*hPtr[4]*dx^2)/dy+(0.06765823467065926*fBPtr[2]*hPtr[4]*dx^2)/dy-(0.078125*fPtr[4]*hBPtr[4]*dx^2)/dy+(0.078125*fBPtr[4]*hBPtr[4]*dx^2)/dy+(0.06765823467065926*fPtr[2]*hBPtr[4]*dx^2)/dy+(0.06765823467065926*fBPtr[2]*hBPtr[4]*dx^2)/dy-(0.08118988160479111*hTPtr[2]*fTPtr[4]*dx^2)/dy+(0.08118988160479111*hPtr[2]*fTPtr[4]*dx^2)/dy+(0.08118988160479111*hTPtr[2]*fPtr[4]*dx^2)/dy-(0.08118988160479111*hBPtr[2]*fPtr[4]*dx^2)/dy-(0.08118988160479111*hPtr[2]*fBPtr[4]*dx^2)/dy+(0.08118988160479111*hBPtr[2]*fBPtr[4]*dx^2)/dy+(0.0703125*fTPtr[2]*hTPtr[2]*dx^2)/dy+(0.0703125*fPtr[2]*hTPtr[2]*dx^2)/dy-(0.0703125*fTPtr[2]*hPtr[2]*dx^2)/dy-(0.140625*fPtr[2]*hPtr[2]*dx^2)/dy-(0.0703125*fBPtr[2]*hPtr[2]*dx^2)/dy+(0.0703125*fPtr[2]*hBPtr[2]*dx^2)/dy+(0.0703125*fBPtr[2]*hBPtr[2]*dx^2)/dy+(0.3125*fTPtr[3]*hTPtr[3])/dy-(0.3125*fPtr[3]*hTPtr[3])/dy-(0.270632938682637*fTPtr[1]*hTPtr[3])/dy-(0.270632938682637*fPtr[1]*hTPtr[3])/dy+(0.3125*fTPtr[3]*hPtr[3])/dy-(0.625*fPtr[3]*hPtr[3])/dy+(0.3125*fBPtr[3]*hPtr[3])/dy-(0.270632938682637*fTPtr[1]*hPtr[3])/dy+(0.270632938682637*fBPtr[1]*hPtr[3])/dy-(0.3125*fPtr[3]*hBPtr[3])/dy+(0.3125*fBPtr[3]*hBPtr[3])/dy+(0.270632938682637*fPtr[1]*hBPtr[3])/dy+(0.270632938682637*fBPtr[1]*hBPtr[3])/dy-(0.3247595264191644*hTPtr[1]*fTPtr[3])/dy+(0.3247595264191644*hPtr[1]*fTPtr[3])/dy+(0.3247595264191644*hTPtr[1]*fPtr[3])/dy-(0.3247595264191644*hBPtr[1]*fPtr[3])/dy-(0.3247595264191644*hPtr[1]*fBPtr[3])/dy+(0.3247595264191644*hBPtr[1]*fBPtr[3])/dy+(0.28125*fTPtr[1]*hTPtr[1])/dy+(0.28125*fPtr[1]*hTPtr[1])/dy-(0.28125*fTPtr[1]*hPtr[1])/dy-(0.5625*fPtr[1]*hPtr[1])/dy-(0.28125*fBPtr[1]*hPtr[1])/dy+(0.28125*fPtr[1]*hBPtr[1])/dy+(0.28125*fBPtr[1]*hBPtr[1])/dy)
    fOutPtr[2] = fOutPtr[2]-dt*((0.15625*fTPtr[3]*hTPtr[4]*dx)/dy-(0.15625*fPtr[3]*hTPtr[4]*dx)/dy-(0.1353164693413185*fTPtr[1]*hTPtr[4]*dx)/dy-(0.1353164693413185*fPtr[1]*hTPtr[4]*dx)/dy+(0.15625*fTPtr[3]*hPtr[4]*dx)/dy-(0.3125*fPtr[3]*hPtr[4]*dx)/dy+(0.15625*fBPtr[3]*hPtr[4]*dx)/dy-(0.1353164693413185*fTPtr[1]*hPtr[4]*dx)/dy+(0.1353164693413185*fBPtr[1]*hPtr[4]*dx)/dy-(0.15625*fPtr[3]*hBPtr[4]*dx)/dy+(0.15625*fBPtr[3]*hBPtr[4]*dx)/dy+(0.1353164693413185*fPtr[1]*hBPtr[4]*dx)/dy+(0.1353164693413185*fBPtr[1]*hBPtr[4]*dx)/dy+(0.15625*hTPtr[3]*fTPtr[4]*dx)/dy+(0.15625*hPtr[3]*fTPtr[4]*dx)/dy-(0.1623797632095822*hTPtr[1]*fTPtr[4]*dx)/dy+(0.1623797632095822*hPtr[1]*fTPtr[4]*dx)/dy-(0.15625*hTPtr[3]*fPtr[4]*dx)/dy-(0.3125*hPtr[3]*fPtr[4]*dx)/dy-(0.15625*hBPtr[3]*fPtr[4]*dx)/dy+(0.1623797632095822*hTPtr[1]*fPtr[4]*dx)/dy-(0.1623797632095822*hBPtr[1]*fPtr[4]*dx)/dy+(0.15625*hPtr[3]*fBPtr[4]*dx)/dy+(0.15625*hBPtr[3]*fBPtr[4]*dx)/dy-(0.1623797632095822*hPtr[1]*fBPtr[4]*dx)/dy+(0.1623797632095822*hBPtr[1]*fBPtr[4]*dx)/dy-(0.1353164693413185*fTPtr[2]*hTPtr[3]*dx)/dy-(0.1353164693413185*fPtr[2]*hTPtr[3]*dx)/dy-(0.1353164693413185*fTPtr[2]*hPtr[3]*dx)/dy+(0.1353164693413185*fBPtr[2]*hPtr[3]*dx)/dy+(0.1353164693413185*fPtr[2]*hBPtr[3]*dx)/dy+(0.1353164693413185*fBPtr[2]*hBPtr[3]*dx)/dy-(0.1623797632095822*hTPtr[2]*fTPtr[3]*dx)/dy+(0.1623797632095822*hPtr[2]*fTPtr[3]*dx)/dy+(0.1623797632095822*hTPtr[2]*fPtr[3]*dx)/dy-(0.1623797632095822*hBPtr[2]*fPtr[3]*dx)/dy-(0.1623797632095822*hPtr[2]*fBPtr[3]*dx)/dy+(0.1623797632095822*hBPtr[2]*fBPtr[3]*dx)/dy+(0.140625*fTPtr[1]*hTPtr[2]*dx)/dy+(0.140625*fPtr[1]*hTPtr[2]*dx)/dy-(0.140625*fTPtr[1]*hPtr[2]*dx)/dy-(0.28125*fPtr[1]*hPtr[2]*dx)/dy-(0.140625*fBPtr[1]*hPtr[2]*dx)/dy+(0.140625*fPtr[1]*hBPtr[2]*dx)/dy+(0.140625*fBPtr[1]*hBPtr[2]*dx)/dy+(0.140625*hTPtr[1]*fTPtr[2]*dx)/dy-(0.140625*hPtr[1]*fTPtr[2]*dx)/dy+(0.140625*hTPtr[1]*fPtr[2]*dx)/dy-(0.28125*hPtr[1]*fPtr[2]*dx)/dy+(0.140625*hBPtr[1]*fPtr[2]*dx)/dy-(0.140625*hPtr[1]*fBPtr[2]*dx)/dy+(0.140625*hBPtr[1]*fBPtr[2]*dx)/dy)
    fOutPtr[3] = fOutPtr[3]-dt*((0.1353164693413185*fTPtr[4]*hTPtr[4]*dx^2)/dy-(0.1353164693413185*fPtr[4]*hTPtr[4]*dx^2)/dy-(0.1171875*fTPtr[2]*hTPtr[4]*dx^2)/dy-(0.1171875*fPtr[2]*hTPtr[4]*dx^2)/dy+(0.1353164693413185*fTPtr[4]*hPtr[4]*dx^2)/dy-(0.1353164693413185*fBPtr[4]*hPtr[4]*dx^2)/dy-(0.1171875*fTPtr[2]*hPtr[4]*dx^2)/dy-(0.234375*fPtr[2]*hPtr[4]*dx^2)/dy-(0.1171875*fBPtr[2]*hPtr[4]*dx^2)/dy+(0.1353164693413185*fPtr[4]*hBPtr[4]*dx^2)/dy-(0.1353164693413185*fBPtr[4]*hBPtr[4]*dx^2)/dy-(0.1171875*fPtr[2]*hBPtr[4]*dx^2)/dy-(0.1171875*fBPtr[2]*hBPtr[4]*dx^2)/dy-(0.140625*hTPtr[2]*fTPtr[4]*dx^2)/dy+(0.140625*hPtr[2]*fTPtr[4]*dx^2)/dy+(0.140625*hTPtr[2]*fPtr[4]*dx^2)/dy-(0.28125*hPtr[2]*fPtr[4]*dx^2)/dy+(0.140625*hBPtr[2]*fPtr[4]*dx^2)/dy+(0.140625*hPtr[2]*fBPtr[4]*dx^2)/dy-(0.140625*hBPtr[2]*fBPtr[4]*dx^2)/dy+(0.1217848224071866*fTPtr[2]*hTPtr[2]*dx^2)/dy+(0.1217848224071866*fPtr[2]*hTPtr[2]*dx^2)/dy-(0.1217848224071866*fTPtr[2]*hPtr[2]*dx^2)/dy+(0.1217848224071866*fBPtr[2]*hPtr[2]*dx^2)/dy-(0.1217848224071866*fPtr[2]*hBPtr[2]*dx^2)/dy-(0.1217848224071866*fBPtr[2]*hBPtr[2]*dx^2)/dy+(0.5412658773652741*fTPtr[3]*hTPtr[3])/dy-(0.5412658773652741*fPtr[3]*hTPtr[3])/dy-(0.46875*fTPtr[1]*hTPtr[3])/dy-(0.46875*fPtr[1]*hTPtr[3])/dy+(0.5412658773652741*fTPtr[3]*hPtr[3])/dy-(0.5412658773652741*fBPtr[3]*hPtr[3])/dy-(0.46875*fTPtr[1]*hPtr[3])/dy-(0.9375*fPtr[1]*hPtr[3])/dy-(0.46875*fBPtr[1]*hPtr[3])/dy+(0.5412658773652741*fPtr[3]*hBPtr[3])/dy-(0.5412658773652741*fBPtr[3]*hBPtr[3])/dy-(0.46875*fPtr[1]*hBPtr[3])/dy-(0.46875*fBPtr[1]*hBPtr[3])/dy-(0.5625*hTPtr[1]*fTPtr[3])/dy+(0.5625*hPtr[1]*fTPtr[3])/dy+(0.5625*hTPtr[1]*fPtr[3])/dy-(1.125*hPtr[1]*fPtr[3])/dy+(0.5625*hBPtr[1]*fPtr[3])/dy+(0.5625*hPtr[1]*fBPtr[3])/dy-(0.5625*hBPtr[1]*fBPtr[3])/dy+(0.4871392896287466*fTPtr[1]*hTPtr[1])/dy+(0.4871392896287466*fPtr[1]*hTPtr[1])/dy-(0.4871392896287466*fTPtr[1]*hPtr[1])/dy+(0.4871392896287466*fBPtr[1]*hPtr[1])/dy-(0.4871392896287466*fPtr[1]*hBPtr[1])/dy-(0.4871392896287466*fBPtr[1]*hBPtr[1])/dy)
    fOutPtr[4] = fOutPtr[4]-dt*((0.270632938682637*fTPtr[3]*hTPtr[4]*dx)/dy-(0.270632938682637*fPtr[3]*hTPtr[4]*dx)/dy-(0.234375*fTPtr[1]*hTPtr[4]*dx)/dy-(0.234375*fPtr[1]*hTPtr[4]*dx)/dy+(0.270632938682637*fTPtr[3]*hPtr[4]*dx)/dy-(0.270632938682637*fBPtr[3]*hPtr[4]*dx)/dy-(0.234375*fTPtr[1]*hPtr[4]*dx)/dy-(0.46875*fPtr[1]*hPtr[4]*dx)/dy-(0.234375*fBPtr[1]*hPtr[4]*dx)/dy+(0.270632938682637*fPtr[3]*hBPtr[4]*dx)/dy-(0.270632938682637*fBPtr[3]*hBPtr[4]*dx)/dy-(0.234375*fPtr[1]*hBPtr[4]*dx)/dy-(0.234375*fBPtr[1]*hBPtr[4]*dx)/dy+(0.270632938682637*hTPtr[3]*fTPtr[4]*dx)/dy+(0.270632938682637*hPtr[3]*fTPtr[4]*dx)/dy-(0.28125*hTPtr[1]*fTPtr[4]*dx)/dy+(0.28125*hPtr[1]*fTPtr[4]*dx)/dy-(0.270632938682637*hTPtr[3]*fPtr[4]*dx)/dy+(0.270632938682637*hBPtr[3]*fPtr[4]*dx)/dy+(0.28125*hTPtr[1]*fPtr[4]*dx)/dy-(0.5625*hPtr[1]*fPtr[4]*dx)/dy+(0.28125*hBPtr[1]*fPtr[4]*dx)/dy-(0.270632938682637*hPtr[3]*fBPtr[4]*dx)/dy-(0.270632938682637*hBPtr[3]*fBPtr[4]*dx)/dy+(0.28125*hPtr[1]*fBPtr[4]*dx)/dy-(0.28125*hBPtr[1]*fBPtr[4]*dx)/dy-(0.234375*fTPtr[2]*hTPtr[3]*dx)/dy-(0.234375*fPtr[2]*hTPtr[3]*dx)/dy-(0.234375*fTPtr[2]*hPtr[3]*dx)/dy-(0.46875*fPtr[2]*hPtr[3]*dx)/dy-(0.234375*fBPtr[2]*hPtr[3]*dx)/dy-(0.234375*fPtr[2]*hBPtr[3]*dx)/dy-(0.234375*fBPtr[2]*hBPtr[3]*dx)/dy-(0.28125*hTPtr[2]*fTPtr[3]*dx)/dy+(0.28125*hPtr[2]*fTPtr[3]*dx)/dy+(0.28125*hTPtr[2]*fPtr[3]*dx)/dy-(0.5625*hPtr[2]*fPtr[3]*dx)/dy+(0.28125*hBPtr[2]*fPtr[3]*dx)/dy+(0.28125*hPtr[2]*fBPtr[3]*dx)/dy-(0.28125*hBPtr[2]*fBPtr[3]*dx)/dy+(0.2435696448143733*fTPtr[1]*hTPtr[2]*dx)/dy+(0.2435696448143733*fPtr[1]*hTPtr[2]*dx)/dy-(0.2435696448143733*fTPtr[1]*hPtr[2]*dx)/dy+(0.2435696448143733*fBPtr[1]*hPtr[2]*dx)/dy-(0.2435696448143733*fPtr[1]*hBPtr[2]*dx)/dy-(0.2435696448143733*fBPtr[1]*hBPtr[2]*dx)/dy+(0.2435696448143733*hTPtr[1]*fTPtr[2]*dx)/dy-(0.2435696448143733*hPtr[1]*fTPtr[2]*dx)/dy+(0.2435696448143733*hTPtr[1]*fPtr[2]*dx)/dy-(0.2435696448143733*hBPtr[1]*fPtr[2]*dx)/dy+(0.2435696448143733*hPtr[1]*fBPtr[2]*dx)/dy-(0.2435696448143733*hBPtr[1]*fBPtr[2]*dx)/dy)
end

fOutPtr[1] = fOutPtr[1]
fOutPtr[2] = fOutPtr[2]
fOutPtr[3] = dt*((6.0*fPtr[2]*hPtr[4])/dy^2+(6.0*fPtr[1]*hPtr[3])/dy^2)+fOutPtr[3]
fOutPtr[4] = dt*((6.0*fPtr[1]*hPtr[4])/dy^2+(6.0*fPtr[2]*hPtr[3])/dy^2)+fOutPtr[4]


end

return dragStencilFunc
