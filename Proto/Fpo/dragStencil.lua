local function dragStencilFunc(dt, dx, dy,
			 fPtr, fLPtr, fRPtr, fTPtr, fBPtr,
			 hPtr, hLPtr, hRPtr, hTPtr, hBPtr,
			 isTopEdge, isBotEdge, isLeftEdge, isRightEdge,
			 fOutPtr)

if isLeftEdge then
    fOutPtr[1] = fPtr[1]-(0.15625*fRPtr[4]*hRPtr[4]-0.15625*fPtr[4]*hRPtr[4]-0.1353164693413185*fRPtr[3]*hRPtr[4]-0.1353164693413185*fPtr[3]*hRPtr[4]+0.15625*fRPtr[4]*hPtr[4]-0.15625*fPtr[4]*hPtr[4]-0.1353164693413185*fRPtr[3]*hPtr[4]-0.1353164693413185*fPtr[3]*hPtr[4]-0.1623797632095822*hRPtr[3]*fRPtr[4]+0.1623797632095822*hPtr[3]*fRPtr[4]+0.1623797632095822*hRPtr[3]*fPtr[4]-0.1623797632095822*hPtr[3]*fPtr[4]+0.140625*fRPtr[3]*hRPtr[3]+0.140625*fPtr[3]*hRPtr[3]-0.140625*fRPtr[3]*hPtr[3]-0.140625*fPtr[3]*hPtr[3]+0.15625*fRPtr[2]*hRPtr[2]-0.15625*fPtr[2]*hRPtr[2]-0.1353164693413185*fRPtr[1]*hRPtr[2]-0.1353164693413185*fPtr[1]*hRPtr[2]+0.15625*fRPtr[2]*hPtr[2]-0.15625*fPtr[2]*hPtr[2]-0.1353164693413185*fRPtr[1]*hPtr[2]-0.1353164693413185*fPtr[1]*hPtr[2]-0.1623797632095822*hRPtr[1]*fRPtr[2]+0.1623797632095822*hPtr[1]*fRPtr[2]+0.1623797632095822*hRPtr[1]*fPtr[2]-0.1623797632095822*hPtr[1]*fPtr[2]+0.140625*fRPtr[1]*hRPtr[1]+0.140625*fPtr[1]*hRPtr[1]-0.140625*fRPtr[1]*hPtr[1]-0.140625*fPtr[1]*hPtr[1])*dt
    fOutPtr[2] = fPtr[2]-(0.270632938682637*fRPtr[4]*hRPtr[4]-0.270632938682637*fPtr[4]*hRPtr[4]-0.234375*fRPtr[3]*hRPtr[4]-0.234375*fPtr[3]*hRPtr[4]+0.270632938682637*fRPtr[4]*hPtr[4]-0.270632938682637*fPtr[4]*hPtr[4]-0.234375*fRPtr[3]*hPtr[4]-0.234375*fPtr[3]*hPtr[4]-0.28125*hRPtr[3]*fRPtr[4]+0.28125*hPtr[3]*fRPtr[4]+0.28125*hRPtr[3]*fPtr[4]-0.28125*hPtr[3]*fPtr[4]+0.2435696448143733*fRPtr[3]*hRPtr[3]+0.2435696448143733*fPtr[3]*hRPtr[3]-0.2435696448143733*fRPtr[3]*hPtr[3]-0.2435696448143733*fPtr[3]*hPtr[3]+0.270632938682637*fRPtr[2]*hRPtr[2]-0.270632938682637*fPtr[2]*hRPtr[2]-0.234375*fRPtr[1]*hRPtr[2]-0.234375*fPtr[1]*hRPtr[2]+0.270632938682637*fRPtr[2]*hPtr[2]-0.270632938682637*fPtr[2]*hPtr[2]-0.234375*fRPtr[1]*hPtr[2]-0.234375*fPtr[1]*hPtr[2]-0.28125*hRPtr[1]*fRPtr[2]+0.28125*hPtr[1]*fRPtr[2]+0.28125*hRPtr[1]*fPtr[2]-0.28125*hPtr[1]*fPtr[2]+0.2435696448143733*fRPtr[1]*hRPtr[1]+0.2435696448143733*fPtr[1]*hRPtr[1]-0.2435696448143733*fRPtr[1]*hPtr[1]-0.2435696448143733*fPtr[1]*hPtr[1])*dt
    fOutPtr[3] = fPtr[3]-(0.15625*fRPtr[2]*hRPtr[4]-0.15625*fPtr[2]*hRPtr[4]-0.1353164693413185*fRPtr[1]*hRPtr[4]-0.1353164693413185*fPtr[1]*hRPtr[4]+0.15625*fRPtr[2]*hPtr[4]-0.15625*fPtr[2]*hPtr[4]-0.1353164693413185*fRPtr[1]*hPtr[4]-0.1353164693413185*fPtr[1]*hPtr[4]+0.15625*hRPtr[2]*fRPtr[4]+0.15625*hPtr[2]*fRPtr[4]-0.1623797632095822*hRPtr[1]*fRPtr[4]+0.1623797632095822*hPtr[1]*fRPtr[4]-0.15625*hRPtr[2]*fPtr[4]-0.15625*hPtr[2]*fPtr[4]+0.1623797632095822*hRPtr[1]*fPtr[4]-0.1623797632095822*hPtr[1]*fPtr[4]-0.1623797632095822*fRPtr[2]*hRPtr[3]+0.1623797632095822*fPtr[2]*hRPtr[3]+0.140625*fRPtr[1]*hRPtr[3]+0.140625*fPtr[1]*hRPtr[3]+0.1623797632095822*fRPtr[2]*hPtr[3]-0.1623797632095822*fPtr[2]*hPtr[3]-0.140625*fRPtr[1]*hPtr[3]-0.140625*fPtr[1]*hPtr[3]-0.1353164693413185*hRPtr[2]*fRPtr[3]-0.1353164693413185*hPtr[2]*fRPtr[3]+0.140625*hRPtr[1]*fRPtr[3]-0.140625*hPtr[1]*fRPtr[3]-0.1353164693413185*hRPtr[2]*fPtr[3]-0.1353164693413185*hPtr[2]*fPtr[3]+0.140625*hRPtr[1]*fPtr[3]-0.140625*hPtr[1]*fPtr[3])*dt
    fOutPtr[4] = fPtr[4]-(0.270632938682637*fRPtr[2]*hRPtr[4]-0.270632938682637*fPtr[2]*hRPtr[4]-0.234375*fRPtr[1]*hRPtr[4]-0.234375*fPtr[1]*hRPtr[4]+0.270632938682637*fRPtr[2]*hPtr[4]-0.270632938682637*fPtr[2]*hPtr[4]-0.234375*fRPtr[1]*hPtr[4]-0.234375*fPtr[1]*hPtr[4]+0.270632938682637*hRPtr[2]*fRPtr[4]+0.270632938682637*hPtr[2]*fRPtr[4]-0.28125*hRPtr[1]*fRPtr[4]+0.28125*hPtr[1]*fRPtr[4]-0.270632938682637*hRPtr[2]*fPtr[4]-0.270632938682637*hPtr[2]*fPtr[4]+0.28125*hRPtr[1]*fPtr[4]-0.28125*hPtr[1]*fPtr[4]-0.28125*fRPtr[2]*hRPtr[3]+0.28125*fPtr[2]*hRPtr[3]+0.2435696448143733*fRPtr[1]*hRPtr[3]+0.2435696448143733*fPtr[1]*hRPtr[3]+0.28125*fRPtr[2]*hPtr[3]-0.28125*fPtr[2]*hPtr[3]-0.2435696448143733*fRPtr[1]*hPtr[3]-0.2435696448143733*fPtr[1]*hPtr[3]-0.234375*hRPtr[2]*fRPtr[3]-0.234375*hPtr[2]*fRPtr[3]+0.2435696448143733*hRPtr[1]*fRPtr[3]-0.2435696448143733*hPtr[1]*fRPtr[3]-0.234375*hRPtr[2]*fPtr[3]-0.234375*hPtr[2]*fPtr[3]+0.2435696448143733*hRPtr[1]*fPtr[3]-0.2435696448143733*hPtr[1]*fPtr[3])*dt
elseif isRightEdge then
    fOutPtr[1] = fPtr[1]-((-0.15625*fPtr[4]*hPtr[4])+0.15625*fLPtr[4]*hPtr[4]+0.1353164693413185*fPtr[3]*hPtr[4]+0.1353164693413185*fLPtr[3]*hPtr[4]-0.15625*fPtr[4]*hLPtr[4]+0.15625*fLPtr[4]*hLPtr[4]+0.1353164693413185*fPtr[3]*hLPtr[4]+0.1353164693413185*fLPtr[3]*hLPtr[4]+0.1623797632095822*hPtr[3]*fPtr[4]-0.1623797632095822*hLPtr[3]*fPtr[4]-0.1623797632095822*hPtr[3]*fLPtr[4]+0.1623797632095822*hLPtr[3]*fLPtr[4]-0.140625*fPtr[3]*hPtr[3]-0.140625*fLPtr[3]*hPtr[3]+0.140625*fPtr[3]*hLPtr[3]+0.140625*fLPtr[3]*hLPtr[3]-0.15625*fPtr[2]*hPtr[2]+0.15625*fLPtr[2]*hPtr[2]+0.1353164693413185*fPtr[1]*hPtr[2]+0.1353164693413185*fLPtr[1]*hPtr[2]-0.15625*fPtr[2]*hLPtr[2]+0.15625*fLPtr[2]*hLPtr[2]+0.1353164693413185*fPtr[1]*hLPtr[2]+0.1353164693413185*fLPtr[1]*hLPtr[2]+0.1623797632095822*hPtr[1]*fPtr[2]-0.1623797632095822*hLPtr[1]*fPtr[2]-0.1623797632095822*hPtr[1]*fLPtr[2]+0.1623797632095822*hLPtr[1]*fLPtr[2]-0.140625*fPtr[1]*hPtr[1]-0.140625*fLPtr[1]*hPtr[1]+0.140625*fPtr[1]*hLPtr[1]+0.140625*fLPtr[1]*hLPtr[1])*dt
    fOutPtr[2] = fPtr[2]-(0.270632938682637*fPtr[4]*hPtr[4]-0.270632938682637*fLPtr[4]*hPtr[4]-0.234375*fPtr[3]*hPtr[4]-0.234375*fLPtr[3]*hPtr[4]+0.270632938682637*fPtr[4]*hLPtr[4]-0.270632938682637*fLPtr[4]*hLPtr[4]-0.234375*fPtr[3]*hLPtr[4]-0.234375*fLPtr[3]*hLPtr[4]-0.28125*hPtr[3]*fPtr[4]+0.28125*hLPtr[3]*fPtr[4]+0.28125*hPtr[3]*fLPtr[4]-0.28125*hLPtr[3]*fLPtr[4]+0.2435696448143733*fPtr[3]*hPtr[3]+0.2435696448143733*fLPtr[3]*hPtr[3]-0.2435696448143733*fPtr[3]*hLPtr[3]-0.2435696448143733*fLPtr[3]*hLPtr[3]+0.270632938682637*fPtr[2]*hPtr[2]-0.270632938682637*fLPtr[2]*hPtr[2]-0.234375*fPtr[1]*hPtr[2]-0.234375*fLPtr[1]*hPtr[2]+0.270632938682637*fPtr[2]*hLPtr[2]-0.270632938682637*fLPtr[2]*hLPtr[2]-0.234375*fPtr[1]*hLPtr[2]-0.234375*fLPtr[1]*hLPtr[2]-0.28125*hPtr[1]*fPtr[2]+0.28125*hLPtr[1]*fPtr[2]+0.28125*hPtr[1]*fLPtr[2]-0.28125*hLPtr[1]*fLPtr[2]+0.2435696448143733*fPtr[1]*hPtr[1]+0.2435696448143733*fLPtr[1]*hPtr[1]-0.2435696448143733*fPtr[1]*hLPtr[1]-0.2435696448143733*fLPtr[1]*hLPtr[1])*dt
    fOutPtr[3] = fPtr[3]-((-0.15625*fPtr[2]*hPtr[4])+0.15625*fLPtr[2]*hPtr[4]+0.1353164693413185*fPtr[1]*hPtr[4]+0.1353164693413185*fLPtr[1]*hPtr[4]-0.15625*fPtr[2]*hLPtr[4]+0.15625*fLPtr[2]*hLPtr[4]+0.1353164693413185*fPtr[1]*hLPtr[4]+0.1353164693413185*fLPtr[1]*hLPtr[4]-0.15625*hPtr[2]*fPtr[4]-0.15625*hLPtr[2]*fPtr[4]+0.1623797632095822*hPtr[1]*fPtr[4]-0.1623797632095822*hLPtr[1]*fPtr[4]+0.15625*hPtr[2]*fLPtr[4]+0.15625*hLPtr[2]*fLPtr[4]-0.1623797632095822*hPtr[1]*fLPtr[4]+0.1623797632095822*hLPtr[1]*fLPtr[4]+0.1623797632095822*fPtr[2]*hPtr[3]-0.1623797632095822*fLPtr[2]*hPtr[3]-0.140625*fPtr[1]*hPtr[3]-0.140625*fLPtr[1]*hPtr[3]-0.1623797632095822*fPtr[2]*hLPtr[3]+0.1623797632095822*fLPtr[2]*hLPtr[3]+0.140625*fPtr[1]*hLPtr[3]+0.140625*fLPtr[1]*hLPtr[3]+0.1353164693413185*hPtr[2]*fPtr[3]+0.1353164693413185*hLPtr[2]*fPtr[3]-0.140625*hPtr[1]*fPtr[3]+0.140625*hLPtr[1]*fPtr[3]+0.1353164693413185*hPtr[2]*fLPtr[3]+0.1353164693413185*hLPtr[2]*fLPtr[3]-0.140625*hPtr[1]*fLPtr[3]+0.140625*hLPtr[1]*fLPtr[3])*dt
    fOutPtr[4] = fPtr[4]-(0.270632938682637*fPtr[2]*hPtr[4]-0.270632938682637*fLPtr[2]*hPtr[4]-0.234375*fPtr[1]*hPtr[4]-0.234375*fLPtr[1]*hPtr[4]+0.270632938682637*fPtr[2]*hLPtr[4]-0.270632938682637*fLPtr[2]*hLPtr[4]-0.234375*fPtr[1]*hLPtr[4]-0.234375*fLPtr[1]*hLPtr[4]+0.270632938682637*hPtr[2]*fPtr[4]+0.270632938682637*hLPtr[2]*fPtr[4]-0.28125*hPtr[1]*fPtr[4]+0.28125*hLPtr[1]*fPtr[4]-0.270632938682637*hPtr[2]*fLPtr[4]-0.270632938682637*hLPtr[2]*fLPtr[4]+0.28125*hPtr[1]*fLPtr[4]-0.28125*hLPtr[1]*fLPtr[4]-0.28125*fPtr[2]*hPtr[3]+0.28125*fLPtr[2]*hPtr[3]+0.2435696448143733*fPtr[1]*hPtr[3]+0.2435696448143733*fLPtr[1]*hPtr[3]+0.28125*fPtr[2]*hLPtr[3]-0.28125*fLPtr[2]*hLPtr[3]-0.2435696448143733*fPtr[1]*hLPtr[3]-0.2435696448143733*fLPtr[1]*hLPtr[3]-0.234375*hPtr[2]*fPtr[3]-0.234375*hLPtr[2]*fPtr[3]+0.2435696448143733*hPtr[1]*fPtr[3]-0.2435696448143733*hLPtr[1]*fPtr[3]-0.234375*hPtr[2]*fLPtr[3]-0.234375*hLPtr[2]*fLPtr[3]+0.2435696448143733*hPtr[1]*fLPtr[3]-0.2435696448143733*hLPtr[1]*fLPtr[3])*dt
else
    fOutPtr[1] = fPtr[1]-(0.15625*fRPtr[4]*hRPtr[4]-0.15625*fPtr[4]*hRPtr[4]-0.1353164693413185*fRPtr[3]*hRPtr[4]-0.1353164693413185*fPtr[3]*hRPtr[4]+0.15625*fRPtr[4]*hPtr[4]-0.3125*fPtr[4]*hPtr[4]+0.15625*fLPtr[4]*hPtr[4]-0.1353164693413185*fRPtr[3]*hPtr[4]+0.1353164693413185*fLPtr[3]*hPtr[4]-0.15625*fPtr[4]*hLPtr[4]+0.15625*fLPtr[4]*hLPtr[4]+0.1353164693413185*fPtr[3]*hLPtr[4]+0.1353164693413185*fLPtr[3]*hLPtr[4]-0.1623797632095822*hRPtr[3]*fRPtr[4]+0.1623797632095822*hPtr[3]*fRPtr[4]+0.1623797632095822*hRPtr[3]*fPtr[4]-0.1623797632095822*hLPtr[3]*fPtr[4]-0.1623797632095822*hPtr[3]*fLPtr[4]+0.1623797632095822*hLPtr[3]*fLPtr[4]+0.140625*fRPtr[3]*hRPtr[3]+0.140625*fPtr[3]*hRPtr[3]-0.140625*fRPtr[3]*hPtr[3]-0.28125*fPtr[3]*hPtr[3]-0.140625*fLPtr[3]*hPtr[3]+0.140625*fPtr[3]*hLPtr[3]+0.140625*fLPtr[3]*hLPtr[3]+0.15625*fRPtr[2]*hRPtr[2]-0.15625*fPtr[2]*hRPtr[2]-0.1353164693413185*fRPtr[1]*hRPtr[2]-0.1353164693413185*fPtr[1]*hRPtr[2]+0.15625*fRPtr[2]*hPtr[2]-0.3125*fPtr[2]*hPtr[2]+0.15625*fLPtr[2]*hPtr[2]-0.1353164693413185*fRPtr[1]*hPtr[2]+0.1353164693413185*fLPtr[1]*hPtr[2]-0.15625*fPtr[2]*hLPtr[2]+0.15625*fLPtr[2]*hLPtr[2]+0.1353164693413185*fPtr[1]*hLPtr[2]+0.1353164693413185*fLPtr[1]*hLPtr[2]-0.1623797632095822*hRPtr[1]*fRPtr[2]+0.1623797632095822*hPtr[1]*fRPtr[2]+0.1623797632095822*hRPtr[1]*fPtr[2]-0.1623797632095822*hLPtr[1]*fPtr[2]-0.1623797632095822*hPtr[1]*fLPtr[2]+0.1623797632095822*hLPtr[1]*fLPtr[2]+0.140625*fRPtr[1]*hRPtr[1]+0.140625*fPtr[1]*hRPtr[1]-0.140625*fRPtr[1]*hPtr[1]-0.28125*fPtr[1]*hPtr[1]-0.140625*fLPtr[1]*hPtr[1]+0.140625*fPtr[1]*hLPtr[1]+0.140625*fLPtr[1]*hLPtr[1])*dt
    fOutPtr[2] = fPtr[2]-(0.270632938682637*fRPtr[4]*hRPtr[4]-0.270632938682637*fPtr[4]*hRPtr[4]-0.234375*fRPtr[3]*hRPtr[4]-0.234375*fPtr[3]*hRPtr[4]+0.270632938682637*fRPtr[4]*hPtr[4]-0.270632938682637*fLPtr[4]*hPtr[4]-0.234375*fRPtr[3]*hPtr[4]-0.46875*fPtr[3]*hPtr[4]-0.234375*fLPtr[3]*hPtr[4]+0.270632938682637*fPtr[4]*hLPtr[4]-0.270632938682637*fLPtr[4]*hLPtr[4]-0.234375*fPtr[3]*hLPtr[4]-0.234375*fLPtr[3]*hLPtr[4]-0.28125*hRPtr[3]*fRPtr[4]+0.28125*hPtr[3]*fRPtr[4]+0.28125*hRPtr[3]*fPtr[4]-0.5625*hPtr[3]*fPtr[4]+0.28125*hLPtr[3]*fPtr[4]+0.28125*hPtr[3]*fLPtr[4]-0.28125*hLPtr[3]*fLPtr[4]+0.2435696448143733*fRPtr[3]*hRPtr[3]+0.2435696448143733*fPtr[3]*hRPtr[3]-0.2435696448143733*fRPtr[3]*hPtr[3]+0.2435696448143733*fLPtr[3]*hPtr[3]-0.2435696448143733*fPtr[3]*hLPtr[3]-0.2435696448143733*fLPtr[3]*hLPtr[3]+0.270632938682637*fRPtr[2]*hRPtr[2]-0.270632938682637*fPtr[2]*hRPtr[2]-0.234375*fRPtr[1]*hRPtr[2]-0.234375*fPtr[1]*hRPtr[2]+0.270632938682637*fRPtr[2]*hPtr[2]-0.270632938682637*fLPtr[2]*hPtr[2]-0.234375*fRPtr[1]*hPtr[2]-0.46875*fPtr[1]*hPtr[2]-0.234375*fLPtr[1]*hPtr[2]+0.270632938682637*fPtr[2]*hLPtr[2]-0.270632938682637*fLPtr[2]*hLPtr[2]-0.234375*fPtr[1]*hLPtr[2]-0.234375*fLPtr[1]*hLPtr[2]-0.28125*hRPtr[1]*fRPtr[2]+0.28125*hPtr[1]*fRPtr[2]+0.28125*hRPtr[1]*fPtr[2]-0.5625*hPtr[1]*fPtr[2]+0.28125*hLPtr[1]*fPtr[2]+0.28125*hPtr[1]*fLPtr[2]-0.28125*hLPtr[1]*fLPtr[2]+0.2435696448143733*fRPtr[1]*hRPtr[1]+0.2435696448143733*fPtr[1]*hRPtr[1]-0.2435696448143733*fRPtr[1]*hPtr[1]+0.2435696448143733*fLPtr[1]*hPtr[1]-0.2435696448143733*fPtr[1]*hLPtr[1]-0.2435696448143733*fLPtr[1]*hLPtr[1])*dt
    fOutPtr[3] = fPtr[3]-(0.15625*fRPtr[2]*hRPtr[4]-0.15625*fPtr[2]*hRPtr[4]-0.1353164693413185*fRPtr[1]*hRPtr[4]-0.1353164693413185*fPtr[1]*hRPtr[4]+0.15625*fRPtr[2]*hPtr[4]-0.3125*fPtr[2]*hPtr[4]+0.15625*fLPtr[2]*hPtr[4]-0.1353164693413185*fRPtr[1]*hPtr[4]+0.1353164693413185*fLPtr[1]*hPtr[4]-0.15625*fPtr[2]*hLPtr[4]+0.15625*fLPtr[2]*hLPtr[4]+0.1353164693413185*fPtr[1]*hLPtr[4]+0.1353164693413185*fLPtr[1]*hLPtr[4]+0.15625*hRPtr[2]*fRPtr[4]+0.15625*hPtr[2]*fRPtr[4]-0.1623797632095822*hRPtr[1]*fRPtr[4]+0.1623797632095822*hPtr[1]*fRPtr[4]-0.15625*hRPtr[2]*fPtr[4]-0.3125*hPtr[2]*fPtr[4]-0.15625*hLPtr[2]*fPtr[4]+0.1623797632095822*hRPtr[1]*fPtr[4]-0.1623797632095822*hLPtr[1]*fPtr[4]+0.15625*hPtr[2]*fLPtr[4]+0.15625*hLPtr[2]*fLPtr[4]-0.1623797632095822*hPtr[1]*fLPtr[4]+0.1623797632095822*hLPtr[1]*fLPtr[4]-0.1623797632095822*fRPtr[2]*hRPtr[3]+0.1623797632095822*fPtr[2]*hRPtr[3]+0.140625*fRPtr[1]*hRPtr[3]+0.140625*fPtr[1]*hRPtr[3]+0.1623797632095822*fRPtr[2]*hPtr[3]-0.1623797632095822*fLPtr[2]*hPtr[3]-0.140625*fRPtr[1]*hPtr[3]-0.28125*fPtr[1]*hPtr[3]-0.140625*fLPtr[1]*hPtr[3]-0.1623797632095822*fPtr[2]*hLPtr[3]+0.1623797632095822*fLPtr[2]*hLPtr[3]+0.140625*fPtr[1]*hLPtr[3]+0.140625*fLPtr[1]*hLPtr[3]-0.1353164693413185*hRPtr[2]*fRPtr[3]-0.1353164693413185*hPtr[2]*fRPtr[3]+0.140625*hRPtr[1]*fRPtr[3]-0.140625*hPtr[1]*fRPtr[3]-0.1353164693413185*hRPtr[2]*fPtr[3]+0.1353164693413185*hLPtr[2]*fPtr[3]+0.140625*hRPtr[1]*fPtr[3]-0.28125*hPtr[1]*fPtr[3]+0.140625*hLPtr[1]*fPtr[3]+0.1353164693413185*hPtr[2]*fLPtr[3]+0.1353164693413185*hLPtr[2]*fLPtr[3]-0.140625*hPtr[1]*fLPtr[3]+0.140625*hLPtr[1]*fLPtr[3])*dt
    fOutPtr[4] = fPtr[4]-(0.270632938682637*fRPtr[2]*hRPtr[4]-0.270632938682637*fPtr[2]*hRPtr[4]-0.234375*fRPtr[1]*hRPtr[4]-0.234375*fPtr[1]*hRPtr[4]+0.270632938682637*fRPtr[2]*hPtr[4]-0.270632938682637*fLPtr[2]*hPtr[4]-0.234375*fRPtr[1]*hPtr[4]-0.46875*fPtr[1]*hPtr[4]-0.234375*fLPtr[1]*hPtr[4]+0.270632938682637*fPtr[2]*hLPtr[4]-0.270632938682637*fLPtr[2]*hLPtr[4]-0.234375*fPtr[1]*hLPtr[4]-0.234375*fLPtr[1]*hLPtr[4]+0.270632938682637*hRPtr[2]*fRPtr[4]+0.270632938682637*hPtr[2]*fRPtr[4]-0.28125*hRPtr[1]*fRPtr[4]+0.28125*hPtr[1]*fRPtr[4]-0.270632938682637*hRPtr[2]*fPtr[4]+0.270632938682637*hLPtr[2]*fPtr[4]+0.28125*hRPtr[1]*fPtr[4]-0.5625*hPtr[1]*fPtr[4]+0.28125*hLPtr[1]*fPtr[4]-0.270632938682637*hPtr[2]*fLPtr[4]-0.270632938682637*hLPtr[2]*fLPtr[4]+0.28125*hPtr[1]*fLPtr[4]-0.28125*hLPtr[1]*fLPtr[4]-0.28125*fRPtr[2]*hRPtr[3]+0.28125*fPtr[2]*hRPtr[3]+0.2435696448143733*fRPtr[1]*hRPtr[3]+0.2435696448143733*fPtr[1]*hRPtr[3]+0.28125*fRPtr[2]*hPtr[3]-0.5625*fPtr[2]*hPtr[3]+0.28125*fLPtr[2]*hPtr[3]-0.2435696448143733*fRPtr[1]*hPtr[3]+0.2435696448143733*fLPtr[1]*hPtr[3]+0.28125*fPtr[2]*hLPtr[3]-0.28125*fLPtr[2]*hLPtr[3]-0.2435696448143733*fPtr[1]*hLPtr[3]-0.2435696448143733*fLPtr[1]*hLPtr[3]-0.234375*hRPtr[2]*fRPtr[3]-0.234375*hPtr[2]*fRPtr[3]+0.2435696448143733*hRPtr[1]*fRPtr[3]-0.2435696448143733*hPtr[1]*fRPtr[3]-0.234375*hRPtr[2]*fPtr[3]-0.46875*hPtr[2]*fPtr[3]-0.234375*hLPtr[2]*fPtr[3]+0.2435696448143733*hRPtr[1]*fPtr[3]-0.2435696448143733*hLPtr[1]*fPtr[3]-0.234375*hPtr[2]*fLPtr[3]-0.234375*hLPtr[2]*fLPtr[3]+0.2435696448143733*hPtr[1]*fLPtr[3]-0.2435696448143733*hLPtr[1]*fLPtr[3])*dt
end

fOutPtr[1] = fOutPtr[1]
fOutPtr[2] = ((-0.4330127018922193*fPtr[4]*hRPtr[4])-0.25*fPtr[3]*hRPtr[4]+0.5*fPtr[3]*hPtr[4]+0.4330127018922193*fPtr[4]*hLPtr[4]-0.25*fPtr[3]*hLPtr[4]+0.375*hRPtr[3]*fPtr[4]-0.75*hPtr[3]*fPtr[4]+0.375*hLPtr[3]*fPtr[4]+0.2165063509461096*fPtr[3]*hRPtr[3]-0.2165063509461096*fPtr[3]*hLPtr[3]-0.4330127018922193*fPtr[2]*hRPtr[2]-0.25*fPtr[1]*hRPtr[2]+0.5*fPtr[1]*hPtr[2]+0.4330127018922193*fPtr[2]*hLPtr[2]-0.25*fPtr[1]*hLPtr[2]+0.375*hRPtr[1]*fPtr[2]-0.75*hPtr[1]*fPtr[2]+0.375*hLPtr[1]*fPtr[2]+0.2165063509461096*fPtr[1]*hRPtr[1]-0.2165063509461096*fPtr[1]*hLPtr[1])*dt+fOutPtr[2]
fOutPtr[3] = fOutPtr[3]
fOutPtr[4] = ((-0.4330127018922193*fPtr[2]*hRPtr[4])-0.25*fPtr[1]*hRPtr[4]+0.5*fPtr[1]*hPtr[4]+0.4330127018922193*fPtr[2]*hLPtr[4]-0.25*fPtr[1]*hLPtr[4]-0.4330127018922193*hRPtr[2]*fPtr[4]+0.4330127018922193*hLPtr[2]*fPtr[4]+0.375*hRPtr[1]*fPtr[4]-0.75*hPtr[1]*fPtr[4]+0.375*hLPtr[1]*fPtr[4]+0.375*fPtr[2]*hRPtr[3]+0.2165063509461096*fPtr[1]*hRPtr[3]-0.75*fPtr[2]*hPtr[3]+0.375*fPtr[2]*hLPtr[3]-0.2165063509461096*fPtr[1]*hLPtr[3]-0.25*hRPtr[2]*fPtr[3]+0.5*hPtr[2]*fPtr[3]-0.25*hLPtr[2]*fPtr[3]+0.2165063509461096*hRPtr[1]*fPtr[3]-0.2165063509461096*hLPtr[1]*fPtr[3])*dt+fOutPtr[4]

if isTopEdge then
    fOutPtr[1] = fOutPtr[1]-((-0.15625*fPtr[4]*hPtr[4])+0.15625*fBPtr[4]*hPtr[4]+0.1353164693413185*fPtr[2]*hPtr[4]+0.1353164693413185*fBPtr[2]*hPtr[4]-0.15625*fPtr[4]*hBPtr[4]+0.15625*fBPtr[4]*hBPtr[4]+0.1353164693413185*fPtr[2]*hBPtr[4]+0.1353164693413185*fBPtr[2]*hBPtr[4]+0.1623797632095822*hPtr[2]*fPtr[4]-0.1623797632095822*hBPtr[2]*fPtr[4]-0.1623797632095822*hPtr[2]*fBPtr[4]+0.1623797632095822*hBPtr[2]*fBPtr[4]-0.15625*fPtr[3]*hPtr[3]+0.15625*fBPtr[3]*hPtr[3]+0.1353164693413185*fPtr[1]*hPtr[3]+0.1353164693413185*fBPtr[1]*hPtr[3]-0.15625*fPtr[3]*hBPtr[3]+0.15625*fBPtr[3]*hBPtr[3]+0.1353164693413185*fPtr[1]*hBPtr[3]+0.1353164693413185*fBPtr[1]*hBPtr[3]+0.1623797632095822*hPtr[1]*fPtr[3]-0.1623797632095822*hBPtr[1]*fPtr[3]-0.1623797632095822*hPtr[1]*fBPtr[3]+0.1623797632095822*hBPtr[1]*fBPtr[3]-0.140625*fPtr[2]*hPtr[2]-0.140625*fBPtr[2]*hPtr[2]+0.140625*fPtr[2]*hBPtr[2]+0.140625*fBPtr[2]*hBPtr[2]-0.140625*fPtr[1]*hPtr[1]-0.140625*fBPtr[1]*hPtr[1]+0.140625*fPtr[1]*hBPtr[1]+0.140625*fBPtr[1]*hBPtr[1])*dt
    fOutPtr[2] = fOutPtr[2]-((-0.15625*fPtr[3]*hPtr[4])+0.15625*fBPtr[3]*hPtr[4]+0.1353164693413185*fPtr[1]*hPtr[4]+0.1353164693413185*fBPtr[1]*hPtr[4]-0.15625*fPtr[3]*hBPtr[4]+0.15625*fBPtr[3]*hBPtr[4]+0.1353164693413185*fPtr[1]*hBPtr[4]+0.1353164693413185*fBPtr[1]*hBPtr[4]-0.15625*hPtr[3]*fPtr[4]-0.15625*hBPtr[3]*fPtr[4]+0.1623797632095822*hPtr[1]*fPtr[4]-0.1623797632095822*hBPtr[1]*fPtr[4]+0.15625*hPtr[3]*fBPtr[4]+0.15625*hBPtr[3]*fBPtr[4]-0.1623797632095822*hPtr[1]*fBPtr[4]+0.1623797632095822*hBPtr[1]*fBPtr[4]+0.1353164693413185*fPtr[2]*hPtr[3]+0.1353164693413185*fBPtr[2]*hPtr[3]+0.1353164693413185*fPtr[2]*hBPtr[3]+0.1353164693413185*fBPtr[2]*hBPtr[3]+0.1623797632095822*hPtr[2]*fPtr[3]-0.1623797632095822*hBPtr[2]*fPtr[3]-0.1623797632095822*hPtr[2]*fBPtr[3]+0.1623797632095822*hBPtr[2]*fBPtr[3]-0.140625*fPtr[1]*hPtr[2]-0.140625*fBPtr[1]*hPtr[2]+0.140625*fPtr[1]*hBPtr[2]+0.140625*fBPtr[1]*hBPtr[2]-0.140625*hPtr[1]*fPtr[2]+0.140625*hBPtr[1]*fPtr[2]-0.140625*hPtr[1]*fBPtr[2]+0.140625*hBPtr[1]*fBPtr[2])*dt
    fOutPtr[3] = fOutPtr[3]-(0.270632938682637*fPtr[4]*hPtr[4]-0.270632938682637*fBPtr[4]*hPtr[4]-0.234375*fPtr[2]*hPtr[4]-0.234375*fBPtr[2]*hPtr[4]+0.270632938682637*fPtr[4]*hBPtr[4]-0.270632938682637*fBPtr[4]*hBPtr[4]-0.234375*fPtr[2]*hBPtr[4]-0.234375*fBPtr[2]*hBPtr[4]-0.28125*hPtr[2]*fPtr[4]+0.28125*hBPtr[2]*fPtr[4]+0.28125*hPtr[2]*fBPtr[4]-0.28125*hBPtr[2]*fBPtr[4]+0.270632938682637*fPtr[3]*hPtr[3]-0.270632938682637*fBPtr[3]*hPtr[3]-0.234375*fPtr[1]*hPtr[3]-0.234375*fBPtr[1]*hPtr[3]+0.270632938682637*fPtr[3]*hBPtr[3]-0.270632938682637*fBPtr[3]*hBPtr[3]-0.234375*fPtr[1]*hBPtr[3]-0.234375*fBPtr[1]*hBPtr[3]-0.28125*hPtr[1]*fPtr[3]+0.28125*hBPtr[1]*fPtr[3]+0.28125*hPtr[1]*fBPtr[3]-0.28125*hBPtr[1]*fBPtr[3]+0.2435696448143733*fPtr[2]*hPtr[2]+0.2435696448143733*fBPtr[2]*hPtr[2]-0.2435696448143733*fPtr[2]*hBPtr[2]-0.2435696448143733*fBPtr[2]*hBPtr[2]+0.2435696448143733*fPtr[1]*hPtr[1]+0.2435696448143733*fBPtr[1]*hPtr[1]-0.2435696448143733*fPtr[1]*hBPtr[1]-0.2435696448143733*fBPtr[1]*hBPtr[1])*dt
    fOutPtr[4] = fOutPtr[4]-(0.270632938682637*fPtr[3]*hPtr[4]-0.270632938682637*fBPtr[3]*hPtr[4]-0.234375*fPtr[1]*hPtr[4]-0.234375*fBPtr[1]*hPtr[4]+0.270632938682637*fPtr[3]*hBPtr[4]-0.270632938682637*fBPtr[3]*hBPtr[4]-0.234375*fPtr[1]*hBPtr[4]-0.234375*fBPtr[1]*hBPtr[4]+0.270632938682637*hPtr[3]*fPtr[4]+0.270632938682637*hBPtr[3]*fPtr[4]-0.28125*hPtr[1]*fPtr[4]+0.28125*hBPtr[1]*fPtr[4]-0.270632938682637*hPtr[3]*fBPtr[4]-0.270632938682637*hBPtr[3]*fBPtr[4]+0.28125*hPtr[1]*fBPtr[4]-0.28125*hBPtr[1]*fBPtr[4]-0.234375*fPtr[2]*hPtr[3]-0.234375*fBPtr[2]*hPtr[3]-0.234375*fPtr[2]*hBPtr[3]-0.234375*fBPtr[2]*hBPtr[3]-0.28125*hPtr[2]*fPtr[3]+0.28125*hBPtr[2]*fPtr[3]+0.28125*hPtr[2]*fBPtr[3]-0.28125*hBPtr[2]*fBPtr[3]+0.2435696448143733*fPtr[1]*hPtr[2]+0.2435696448143733*fBPtr[1]*hPtr[2]-0.2435696448143733*fPtr[1]*hBPtr[2]-0.2435696448143733*fBPtr[1]*hBPtr[2]+0.2435696448143733*hPtr[1]*fPtr[2]-0.2435696448143733*hBPtr[1]*fPtr[2]+0.2435696448143733*hPtr[1]*fBPtr[2]-0.2435696448143733*hBPtr[1]*fBPtr[2])*dt
elseif isBotEdge then
    fOutPtr[1] = fOutPtr[1]-(0.15625*fTPtr[4]*hTPtr[4]-0.15625*fPtr[4]*hTPtr[4]-0.1353164693413185*fTPtr[2]*hTPtr[4]-0.1353164693413185*fPtr[2]*hTPtr[4]+0.15625*fTPtr[4]*hPtr[4]-0.15625*fPtr[4]*hPtr[4]-0.1353164693413185*fTPtr[2]*hPtr[4]-0.1353164693413185*fPtr[2]*hPtr[4]-0.1623797632095822*hTPtr[2]*fTPtr[4]+0.1623797632095822*hPtr[2]*fTPtr[4]+0.1623797632095822*hTPtr[2]*fPtr[4]-0.1623797632095822*hPtr[2]*fPtr[4]+0.15625*fTPtr[3]*hTPtr[3]-0.15625*fPtr[3]*hTPtr[3]-0.1353164693413185*fTPtr[1]*hTPtr[3]-0.1353164693413185*fPtr[1]*hTPtr[3]+0.15625*fTPtr[3]*hPtr[3]-0.15625*fPtr[3]*hPtr[3]-0.1353164693413185*fTPtr[1]*hPtr[3]-0.1353164693413185*fPtr[1]*hPtr[3]-0.1623797632095822*hTPtr[1]*fTPtr[3]+0.1623797632095822*hPtr[1]*fTPtr[3]+0.1623797632095822*hTPtr[1]*fPtr[3]-0.1623797632095822*hPtr[1]*fPtr[3]+0.140625*fTPtr[2]*hTPtr[2]+0.140625*fPtr[2]*hTPtr[2]-0.140625*fTPtr[2]*hPtr[2]-0.140625*fPtr[2]*hPtr[2]+0.140625*fTPtr[1]*hTPtr[1]+0.140625*fPtr[1]*hTPtr[1]-0.140625*fTPtr[1]*hPtr[1]-0.140625*fPtr[1]*hPtr[1])*dt
    fOutPtr[2] = fOutPtr[2]-(0.15625*fTPtr[3]*hTPtr[4]-0.15625*fPtr[3]*hTPtr[4]-0.1353164693413185*fTPtr[1]*hTPtr[4]-0.1353164693413185*fPtr[1]*hTPtr[4]+0.15625*fTPtr[3]*hPtr[4]-0.15625*fPtr[3]*hPtr[4]-0.1353164693413185*fTPtr[1]*hPtr[4]-0.1353164693413185*fPtr[1]*hPtr[4]+0.15625*hTPtr[3]*fTPtr[4]+0.15625*hPtr[3]*fTPtr[4]-0.1623797632095822*hTPtr[1]*fTPtr[4]+0.1623797632095822*hPtr[1]*fTPtr[4]-0.15625*hTPtr[3]*fPtr[4]-0.15625*hPtr[3]*fPtr[4]+0.1623797632095822*hTPtr[1]*fPtr[4]-0.1623797632095822*hPtr[1]*fPtr[4]-0.1353164693413185*fTPtr[2]*hTPtr[3]-0.1353164693413185*fPtr[2]*hTPtr[3]-0.1353164693413185*fTPtr[2]*hPtr[3]-0.1353164693413185*fPtr[2]*hPtr[3]-0.1623797632095822*hTPtr[2]*fTPtr[3]+0.1623797632095822*hPtr[2]*fTPtr[3]+0.1623797632095822*hTPtr[2]*fPtr[3]-0.1623797632095822*hPtr[2]*fPtr[3]+0.140625*fTPtr[1]*hTPtr[2]+0.140625*fPtr[1]*hTPtr[2]-0.140625*fTPtr[1]*hPtr[2]-0.140625*fPtr[1]*hPtr[2]+0.140625*hTPtr[1]*fTPtr[2]-0.140625*hPtr[1]*fTPtr[2]+0.140625*hTPtr[1]*fPtr[2]-0.140625*hPtr[1]*fPtr[2])*dt
    fOutPtr[3] = fOutPtr[3]-(0.270632938682637*fTPtr[4]*hTPtr[4]-0.270632938682637*fPtr[4]*hTPtr[4]-0.234375*fTPtr[2]*hTPtr[4]-0.234375*fPtr[2]*hTPtr[4]+0.270632938682637*fTPtr[4]*hPtr[4]-0.270632938682637*fPtr[4]*hPtr[4]-0.234375*fTPtr[2]*hPtr[4]-0.234375*fPtr[2]*hPtr[4]-0.28125*hTPtr[2]*fTPtr[4]+0.28125*hPtr[2]*fTPtr[4]+0.28125*hTPtr[2]*fPtr[4]-0.28125*hPtr[2]*fPtr[4]+0.270632938682637*fTPtr[3]*hTPtr[3]-0.270632938682637*fPtr[3]*hTPtr[3]-0.234375*fTPtr[1]*hTPtr[3]-0.234375*fPtr[1]*hTPtr[3]+0.270632938682637*fTPtr[3]*hPtr[3]-0.270632938682637*fPtr[3]*hPtr[3]-0.234375*fTPtr[1]*hPtr[3]-0.234375*fPtr[1]*hPtr[3]-0.28125*hTPtr[1]*fTPtr[3]+0.28125*hPtr[1]*fTPtr[3]+0.28125*hTPtr[1]*fPtr[3]-0.28125*hPtr[1]*fPtr[3]+0.2435696448143733*fTPtr[2]*hTPtr[2]+0.2435696448143733*fPtr[2]*hTPtr[2]-0.2435696448143733*fTPtr[2]*hPtr[2]-0.2435696448143733*fPtr[2]*hPtr[2]+0.2435696448143733*fTPtr[1]*hTPtr[1]+0.2435696448143733*fPtr[1]*hTPtr[1]-0.2435696448143733*fTPtr[1]*hPtr[1]-0.2435696448143733*fPtr[1]*hPtr[1])*dt
    fOutPtr[4] = fOutPtr[4]-(0.270632938682637*fTPtr[3]*hTPtr[4]-0.270632938682637*fPtr[3]*hTPtr[4]-0.234375*fTPtr[1]*hTPtr[4]-0.234375*fPtr[1]*hTPtr[4]+0.270632938682637*fTPtr[3]*hPtr[4]-0.270632938682637*fPtr[3]*hPtr[4]-0.234375*fTPtr[1]*hPtr[4]-0.234375*fPtr[1]*hPtr[4]+0.270632938682637*hTPtr[3]*fTPtr[4]+0.270632938682637*hPtr[3]*fTPtr[4]-0.28125*hTPtr[1]*fTPtr[4]+0.28125*hPtr[1]*fTPtr[4]-0.270632938682637*hTPtr[3]*fPtr[4]-0.270632938682637*hPtr[3]*fPtr[4]+0.28125*hTPtr[1]*fPtr[4]-0.28125*hPtr[1]*fPtr[4]-0.234375*fTPtr[2]*hTPtr[3]-0.234375*fPtr[2]*hTPtr[3]-0.234375*fTPtr[2]*hPtr[3]-0.234375*fPtr[2]*hPtr[3]-0.28125*hTPtr[2]*fTPtr[3]+0.28125*hPtr[2]*fTPtr[3]+0.28125*hTPtr[2]*fPtr[3]-0.28125*hPtr[2]*fPtr[3]+0.2435696448143733*fTPtr[1]*hTPtr[2]+0.2435696448143733*fPtr[1]*hTPtr[2]-0.2435696448143733*fTPtr[1]*hPtr[2]-0.2435696448143733*fPtr[1]*hPtr[2]+0.2435696448143733*hTPtr[1]*fTPtr[2]-0.2435696448143733*hPtr[1]*fTPtr[2]+0.2435696448143733*hTPtr[1]*fPtr[2]-0.2435696448143733*hPtr[1]*fPtr[2])*dt
else
    fOutPtr[1] = fOutPtr[1]-(0.15625*fTPtr[4]*hTPtr[4]-0.15625*fPtr[4]*hTPtr[4]-0.1353164693413185*fTPtr[2]*hTPtr[4]-0.1353164693413185*fPtr[2]*hTPtr[4]+0.15625*fTPtr[4]*hPtr[4]-0.3125*fPtr[4]*hPtr[4]+0.15625*fBPtr[4]*hPtr[4]-0.1353164693413185*fTPtr[2]*hPtr[4]+0.1353164693413185*fBPtr[2]*hPtr[4]-0.15625*fPtr[4]*hBPtr[4]+0.15625*fBPtr[4]*hBPtr[4]+0.1353164693413185*fPtr[2]*hBPtr[4]+0.1353164693413185*fBPtr[2]*hBPtr[4]-0.1623797632095822*hTPtr[2]*fTPtr[4]+0.1623797632095822*hPtr[2]*fTPtr[4]+0.1623797632095822*hTPtr[2]*fPtr[4]-0.1623797632095822*hBPtr[2]*fPtr[4]-0.1623797632095822*hPtr[2]*fBPtr[4]+0.1623797632095822*hBPtr[2]*fBPtr[4]+0.15625*fTPtr[3]*hTPtr[3]-0.15625*fPtr[3]*hTPtr[3]-0.1353164693413185*fTPtr[1]*hTPtr[3]-0.1353164693413185*fPtr[1]*hTPtr[3]+0.15625*fTPtr[3]*hPtr[3]-0.3125*fPtr[3]*hPtr[3]+0.15625*fBPtr[3]*hPtr[3]-0.1353164693413185*fTPtr[1]*hPtr[3]+0.1353164693413185*fBPtr[1]*hPtr[3]-0.15625*fPtr[3]*hBPtr[3]+0.15625*fBPtr[3]*hBPtr[3]+0.1353164693413185*fPtr[1]*hBPtr[3]+0.1353164693413185*fBPtr[1]*hBPtr[3]-0.1623797632095822*hTPtr[1]*fTPtr[3]+0.1623797632095822*hPtr[1]*fTPtr[3]+0.1623797632095822*hTPtr[1]*fPtr[3]-0.1623797632095822*hBPtr[1]*fPtr[3]-0.1623797632095822*hPtr[1]*fBPtr[3]+0.1623797632095822*hBPtr[1]*fBPtr[3]+0.140625*fTPtr[2]*hTPtr[2]+0.140625*fPtr[2]*hTPtr[2]-0.140625*fTPtr[2]*hPtr[2]-0.28125*fPtr[2]*hPtr[2]-0.140625*fBPtr[2]*hPtr[2]+0.140625*fPtr[2]*hBPtr[2]+0.140625*fBPtr[2]*hBPtr[2]+0.140625*fTPtr[1]*hTPtr[1]+0.140625*fPtr[1]*hTPtr[1]-0.140625*fTPtr[1]*hPtr[1]-0.28125*fPtr[1]*hPtr[1]-0.140625*fBPtr[1]*hPtr[1]+0.140625*fPtr[1]*hBPtr[1]+0.140625*fBPtr[1]*hBPtr[1])*dt
    fOutPtr[2] = fOutPtr[2]-(0.15625*fTPtr[3]*hTPtr[4]-0.15625*fPtr[3]*hTPtr[4]-0.1353164693413185*fTPtr[1]*hTPtr[4]-0.1353164693413185*fPtr[1]*hTPtr[4]+0.15625*fTPtr[3]*hPtr[4]-0.3125*fPtr[3]*hPtr[4]+0.15625*fBPtr[3]*hPtr[4]-0.1353164693413185*fTPtr[1]*hPtr[4]+0.1353164693413185*fBPtr[1]*hPtr[4]-0.15625*fPtr[3]*hBPtr[4]+0.15625*fBPtr[3]*hBPtr[4]+0.1353164693413185*fPtr[1]*hBPtr[4]+0.1353164693413185*fBPtr[1]*hBPtr[4]+0.15625*hTPtr[3]*fTPtr[4]+0.15625*hPtr[3]*fTPtr[4]-0.1623797632095822*hTPtr[1]*fTPtr[4]+0.1623797632095822*hPtr[1]*fTPtr[4]-0.15625*hTPtr[3]*fPtr[4]-0.3125*hPtr[3]*fPtr[4]-0.15625*hBPtr[3]*fPtr[4]+0.1623797632095822*hTPtr[1]*fPtr[4]-0.1623797632095822*hBPtr[1]*fPtr[4]+0.15625*hPtr[3]*fBPtr[4]+0.15625*hBPtr[3]*fBPtr[4]-0.1623797632095822*hPtr[1]*fBPtr[4]+0.1623797632095822*hBPtr[1]*fBPtr[4]-0.1353164693413185*fTPtr[2]*hTPtr[3]-0.1353164693413185*fPtr[2]*hTPtr[3]-0.1353164693413185*fTPtr[2]*hPtr[3]+0.1353164693413185*fBPtr[2]*hPtr[3]+0.1353164693413185*fPtr[2]*hBPtr[3]+0.1353164693413185*fBPtr[2]*hBPtr[3]-0.1623797632095822*hTPtr[2]*fTPtr[3]+0.1623797632095822*hPtr[2]*fTPtr[3]+0.1623797632095822*hTPtr[2]*fPtr[3]-0.1623797632095822*hBPtr[2]*fPtr[3]-0.1623797632095822*hPtr[2]*fBPtr[3]+0.1623797632095822*hBPtr[2]*fBPtr[3]+0.140625*fTPtr[1]*hTPtr[2]+0.140625*fPtr[1]*hTPtr[2]-0.140625*fTPtr[1]*hPtr[2]-0.28125*fPtr[1]*hPtr[2]-0.140625*fBPtr[1]*hPtr[2]+0.140625*fPtr[1]*hBPtr[2]+0.140625*fBPtr[1]*hBPtr[2]+0.140625*hTPtr[1]*fTPtr[2]-0.140625*hPtr[1]*fTPtr[2]+0.140625*hTPtr[1]*fPtr[2]-0.28125*hPtr[1]*fPtr[2]+0.140625*hBPtr[1]*fPtr[2]-0.140625*hPtr[1]*fBPtr[2]+0.140625*hBPtr[1]*fBPtr[2])*dt
    fOutPtr[3] = fOutPtr[3]-(0.270632938682637*fTPtr[4]*hTPtr[4]-0.270632938682637*fPtr[4]*hTPtr[4]-0.234375*fTPtr[2]*hTPtr[4]-0.234375*fPtr[2]*hTPtr[4]+0.270632938682637*fTPtr[4]*hPtr[4]-0.270632938682637*fBPtr[4]*hPtr[4]-0.234375*fTPtr[2]*hPtr[4]-0.46875*fPtr[2]*hPtr[4]-0.234375*fBPtr[2]*hPtr[4]+0.270632938682637*fPtr[4]*hBPtr[4]-0.270632938682637*fBPtr[4]*hBPtr[4]-0.234375*fPtr[2]*hBPtr[4]-0.234375*fBPtr[2]*hBPtr[4]-0.28125*hTPtr[2]*fTPtr[4]+0.28125*hPtr[2]*fTPtr[4]+0.28125*hTPtr[2]*fPtr[4]-0.5625*hPtr[2]*fPtr[4]+0.28125*hBPtr[2]*fPtr[4]+0.28125*hPtr[2]*fBPtr[4]-0.28125*hBPtr[2]*fBPtr[4]+0.270632938682637*fTPtr[3]*hTPtr[3]-0.270632938682637*fPtr[3]*hTPtr[3]-0.234375*fTPtr[1]*hTPtr[3]-0.234375*fPtr[1]*hTPtr[3]+0.270632938682637*fTPtr[3]*hPtr[3]-0.270632938682637*fBPtr[3]*hPtr[3]-0.234375*fTPtr[1]*hPtr[3]-0.46875*fPtr[1]*hPtr[3]-0.234375*fBPtr[1]*hPtr[3]+0.270632938682637*fPtr[3]*hBPtr[3]-0.270632938682637*fBPtr[3]*hBPtr[3]-0.234375*fPtr[1]*hBPtr[3]-0.234375*fBPtr[1]*hBPtr[3]-0.28125*hTPtr[1]*fTPtr[3]+0.28125*hPtr[1]*fTPtr[3]+0.28125*hTPtr[1]*fPtr[3]-0.5625*hPtr[1]*fPtr[3]+0.28125*hBPtr[1]*fPtr[3]+0.28125*hPtr[1]*fBPtr[3]-0.28125*hBPtr[1]*fBPtr[3]+0.2435696448143733*fTPtr[2]*hTPtr[2]+0.2435696448143733*fPtr[2]*hTPtr[2]-0.2435696448143733*fTPtr[2]*hPtr[2]+0.2435696448143733*fBPtr[2]*hPtr[2]-0.2435696448143733*fPtr[2]*hBPtr[2]-0.2435696448143733*fBPtr[2]*hBPtr[2]+0.2435696448143733*fTPtr[1]*hTPtr[1]+0.2435696448143733*fPtr[1]*hTPtr[1]-0.2435696448143733*fTPtr[1]*hPtr[1]+0.2435696448143733*fBPtr[1]*hPtr[1]-0.2435696448143733*fPtr[1]*hBPtr[1]-0.2435696448143733*fBPtr[1]*hBPtr[1])*dt
    fOutPtr[4] = fOutPtr[4]-(0.270632938682637*fTPtr[3]*hTPtr[4]-0.270632938682637*fPtr[3]*hTPtr[4]-0.234375*fTPtr[1]*hTPtr[4]-0.234375*fPtr[1]*hTPtr[4]+0.270632938682637*fTPtr[3]*hPtr[4]-0.270632938682637*fBPtr[3]*hPtr[4]-0.234375*fTPtr[1]*hPtr[4]-0.46875*fPtr[1]*hPtr[4]-0.234375*fBPtr[1]*hPtr[4]+0.270632938682637*fPtr[3]*hBPtr[4]-0.270632938682637*fBPtr[3]*hBPtr[4]-0.234375*fPtr[1]*hBPtr[4]-0.234375*fBPtr[1]*hBPtr[4]+0.270632938682637*hTPtr[3]*fTPtr[4]+0.270632938682637*hPtr[3]*fTPtr[4]-0.28125*hTPtr[1]*fTPtr[4]+0.28125*hPtr[1]*fTPtr[4]-0.270632938682637*hTPtr[3]*fPtr[4]+0.270632938682637*hBPtr[3]*fPtr[4]+0.28125*hTPtr[1]*fPtr[4]-0.5625*hPtr[1]*fPtr[4]+0.28125*hBPtr[1]*fPtr[4]-0.270632938682637*hPtr[3]*fBPtr[4]-0.270632938682637*hBPtr[3]*fBPtr[4]+0.28125*hPtr[1]*fBPtr[4]-0.28125*hBPtr[1]*fBPtr[4]-0.234375*fTPtr[2]*hTPtr[3]-0.234375*fPtr[2]*hTPtr[3]-0.234375*fTPtr[2]*hPtr[3]-0.46875*fPtr[2]*hPtr[3]-0.234375*fBPtr[2]*hPtr[3]-0.234375*fPtr[2]*hBPtr[3]-0.234375*fBPtr[2]*hBPtr[3]-0.28125*hTPtr[2]*fTPtr[3]+0.28125*hPtr[2]*fTPtr[3]+0.28125*hTPtr[2]*fPtr[3]-0.5625*hPtr[2]*fPtr[3]+0.28125*hBPtr[2]*fPtr[3]+0.28125*hPtr[2]*fBPtr[3]-0.28125*hBPtr[2]*fBPtr[3]+0.2435696448143733*fTPtr[1]*hTPtr[2]+0.2435696448143733*fPtr[1]*hTPtr[2]-0.2435696448143733*fTPtr[1]*hPtr[2]+0.2435696448143733*fBPtr[1]*hPtr[2]-0.2435696448143733*fPtr[1]*hBPtr[2]-0.2435696448143733*fBPtr[1]*hBPtr[2]+0.2435696448143733*hTPtr[1]*fTPtr[2]-0.2435696448143733*hPtr[1]*fTPtr[2]+0.2435696448143733*hTPtr[1]*fPtr[2]-0.2435696448143733*hBPtr[1]*fPtr[2]+0.2435696448143733*hPtr[1]*fBPtr[2]-0.2435696448143733*hBPtr[1]*fBPtr[2])*dt
end

fOutPtr[1] = fOutPtr[1]
fOutPtr[2] = fOutPtr[2]
fOutPtr[3] = ((-0.4330127018922193*fPtr[4]*hTPtr[4])-0.25*fPtr[2]*hTPtr[4]+0.5*fPtr[2]*hPtr[4]+0.4330127018922193*fPtr[4]*hBPtr[4]-0.25*fPtr[2]*hBPtr[4]+0.375*hTPtr[2]*fPtr[4]-0.75*hPtr[2]*fPtr[4]+0.375*hBPtr[2]*fPtr[4]-0.4330127018922193*fPtr[3]*hTPtr[3]-0.25*fPtr[1]*hTPtr[3]+0.5*fPtr[1]*hPtr[3]+0.4330127018922193*fPtr[3]*hBPtr[3]-0.25*fPtr[1]*hBPtr[3]+0.375*hTPtr[1]*fPtr[3]-0.75*hPtr[1]*fPtr[3]+0.375*hBPtr[1]*fPtr[3]+0.2165063509461096*fPtr[2]*hTPtr[2]-0.2165063509461096*fPtr[2]*hBPtr[2]+0.2165063509461096*fPtr[1]*hTPtr[1]-0.2165063509461096*fPtr[1]*hBPtr[1])*dt+fOutPtr[3]
fOutPtr[4] = ((-0.4330127018922193*fPtr[3]*hTPtr[4])-0.25*fPtr[1]*hTPtr[4]+0.5*fPtr[1]*hPtr[4]+0.4330127018922193*fPtr[3]*hBPtr[4]-0.25*fPtr[1]*hBPtr[4]-0.4330127018922193*hTPtr[3]*fPtr[4]+0.4330127018922193*hBPtr[3]*fPtr[4]+0.375*hTPtr[1]*fPtr[4]-0.75*hPtr[1]*fPtr[4]+0.375*hBPtr[1]*fPtr[4]-0.25*fPtr[2]*hTPtr[3]+0.5*fPtr[2]*hPtr[3]-0.25*fPtr[2]*hBPtr[3]+0.375*hTPtr[2]*fPtr[3]-0.75*hPtr[2]*fPtr[3]+0.375*hBPtr[2]*fPtr[3]+0.2165063509461096*fPtr[1]*hTPtr[2]-0.2165063509461096*fPtr[1]*hBPtr[2]+0.2165063509461096*hTPtr[1]*fPtr[2]-0.2165063509461096*hBPtr[1]*fPtr[2])*dt+fOutPtr[4]

end

return dragStencilFunc
