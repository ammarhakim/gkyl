local function dragStencilFunc(dt, dx, dy,
			       fPtr, fLPtr, fRPtr, fTPtr, fBPtr,
			       hPtr, hLPtr, hRPtr, hTPtr, hBPtr,
			       isTopEdge, isBotEdge, isLeftEdge, isRightEdge,
			       fOutPtr)

   -------------------------------------------------------------------
   -- Surface term in the x-direction --------------------------------
   if isLeftEdge then
      fOutPtr[1] = fPtr[1]-dt*((0.625*fRPtr[4]*hRPtr[4])/dx^2-(0.625*fPtr[4]*hRPtr[4])/dx^2-(0.5412658773652741*fRPtr[3]*hRPtr[4])/dx^2-(0.5412658773652741*fPtr[3]*hRPtr[4])/dx^2+(0.625*fRPtr[4]*hPtr[4])/dx^2-(0.625*fPtr[4]*hPtr[4])/dx^2-(0.5412658773652741*fRPtr[3]*hPtr[4])/dx^2-(0.5412658773652741*fPtr[3]*hPtr[4])/dx^2-(0.6495190528383289*hRPtr[3]*fRPtr[4])/dx^2+(0.6495190528383289*hPtr[3]*fRPtr[4])/dx^2+(0.6495190528383289*hRPtr[3]*fPtr[4])/dx^2-(0.6495190528383289*hPtr[3]*fPtr[4])/dx^2+(0.5625*fRPtr[3]*hRPtr[3])/dx^2+(0.5625*fPtr[3]*hRPtr[3])/dx^2-(0.5625*fRPtr[3]*hPtr[3])/dx^2-(0.5625*fPtr[3]*hPtr[3])/dx^2+(0.625*fRPtr[2]*hRPtr[2])/dx^2-(0.625*fPtr[2]*hRPtr[2])/dx^2-(0.5412658773652741*fRPtr[1]*hRPtr[2])/dx^2-(0.5412658773652741*fPtr[1]*hRPtr[2])/dx^2+(0.625*fRPtr[2]*hPtr[2])/dx^2-(0.625*fPtr[2]*hPtr[2])/dx^2-(0.5412658773652741*fRPtr[1]*hPtr[2])/dx^2-(0.5412658773652741*fPtr[1]*hPtr[2])/dx^2-(0.6495190528383289*hRPtr[1]*fRPtr[2])/dx^2+(0.6495190528383289*hPtr[1]*fRPtr[2])/dx^2+(0.6495190528383289*hRPtr[1]*fPtr[2])/dx^2-(0.6495190528383289*hPtr[1]*fPtr[2])/dx^2+(0.5625*fRPtr[1]*hRPtr[1])/dx^2+(0.5625*fPtr[1]*hRPtr[1])/dx^2-(0.5625*fRPtr[1]*hPtr[1])/dx^2-(0.5625*fPtr[1]*hPtr[1])/dx^2)
      fOutPtr[2] = fPtr[2]-dt*((1.082531754730548*fRPtr[4]*hRPtr[4])/dx^2-(1.082531754730548*fPtr[4]*hRPtr[4])/dx^2-(0.9375*fRPtr[3]*hRPtr[4])/dx^2-(0.9375*fPtr[3]*hRPtr[4])/dx^2+(1.082531754730548*fRPtr[4]*hPtr[4])/dx^2-(1.082531754730548*fPtr[4]*hPtr[4])/dx^2-(0.9375*fRPtr[3]*hPtr[4])/dx^2-(0.9375*fPtr[3]*hPtr[4])/dx^2-(1.125*hRPtr[3]*fRPtr[4])/dx^2+(1.125*hPtr[3]*fRPtr[4])/dx^2+(1.125*hRPtr[3]*fPtr[4])/dx^2-(1.125*hPtr[3]*fPtr[4])/dx^2+(0.9742785792574932*fRPtr[3]*hRPtr[3])/dx^2+(0.9742785792574932*fPtr[3]*hRPtr[3])/dx^2-(0.9742785792574932*fRPtr[3]*hPtr[3])/dx^2-(0.9742785792574932*fPtr[3]*hPtr[3])/dx^2+(1.082531754730548*fRPtr[2]*hRPtr[2])/dx^2-(1.082531754730548*fPtr[2]*hRPtr[2])/dx^2-(0.9375*fRPtr[1]*hRPtr[2])/dx^2-(0.9375*fPtr[1]*hRPtr[2])/dx^2+(1.082531754730548*fRPtr[2]*hPtr[2])/dx^2-(1.082531754730548*fPtr[2]*hPtr[2])/dx^2-(0.9375*fRPtr[1]*hPtr[2])/dx^2-(0.9375*fPtr[1]*hPtr[2])/dx^2-(1.125*hRPtr[1]*fRPtr[2])/dx^2+(1.125*hPtr[1]*fRPtr[2])/dx^2+(1.125*hRPtr[1]*fPtr[2])/dx^2-(1.125*hPtr[1]*fPtr[2])/dx^2+(0.9742785792574932*fRPtr[1]*hRPtr[1])/dx^2+(0.9742785792574932*fPtr[1]*hRPtr[1])/dx^2-(0.9742785792574932*fRPtr[1]*hPtr[1])/dx^2-(0.9742785792574932*fPtr[1]*hPtr[1])/dx^2)
      fOutPtr[3] = fPtr[3]-dt*((0.625*fRPtr[2]*hRPtr[4])/dx^2-(0.625*fPtr[2]*hRPtr[4])/dx^2-(0.5412658773652741*fRPtr[1]*hRPtr[4])/dx^2-(0.5412658773652741*fPtr[1]*hRPtr[4])/dx^2+(0.625*fRPtr[2]*hPtr[4])/dx^2-(0.625*fPtr[2]*hPtr[4])/dx^2-(0.5412658773652741*fRPtr[1]*hPtr[4])/dx^2-(0.5412658773652741*fPtr[1]*hPtr[4])/dx^2+(0.625*hRPtr[2]*fRPtr[4])/dx^2+(0.625*hPtr[2]*fRPtr[4])/dx^2-(0.6495190528383289*hRPtr[1]*fRPtr[4])/dx^2+(0.6495190528383289*hPtr[1]*fRPtr[4])/dx^2-(0.625*hRPtr[2]*fPtr[4])/dx^2-(0.625*hPtr[2]*fPtr[4])/dx^2+(0.6495190528383289*hRPtr[1]*fPtr[4])/dx^2-(0.6495190528383289*hPtr[1]*fPtr[4])/dx^2-(0.6495190528383289*fRPtr[2]*hRPtr[3])/dx^2+(0.6495190528383289*fPtr[2]*hRPtr[3])/dx^2+(0.5625*fRPtr[1]*hRPtr[3])/dx^2+(0.5625*fPtr[1]*hRPtr[3])/dx^2+(0.6495190528383289*fRPtr[2]*hPtr[3])/dx^2-(0.6495190528383289*fPtr[2]*hPtr[3])/dx^2-(0.5625*fRPtr[1]*hPtr[3])/dx^2-(0.5625*fPtr[1]*hPtr[3])/dx^2-(0.5412658773652741*hRPtr[2]*fRPtr[3])/dx^2-(0.5412658773652741*hPtr[2]*fRPtr[3])/dx^2+(0.5625*hRPtr[1]*fRPtr[3])/dx^2-(0.5625*hPtr[1]*fRPtr[3])/dx^2-(0.5412658773652741*hRPtr[2]*fPtr[3])/dx^2-(0.5412658773652741*hPtr[2]*fPtr[3])/dx^2+(0.5625*hRPtr[1]*fPtr[3])/dx^2-(0.5625*hPtr[1]*fPtr[3])/dx^2)
      fOutPtr[4] = fPtr[4]-dt*((1.082531754730548*fRPtr[2]*hRPtr[4])/dx^2-(1.082531754730548*fPtr[2]*hRPtr[4])/dx^2-(0.9375*fRPtr[1]*hRPtr[4])/dx^2-(0.9375*fPtr[1]*hRPtr[4])/dx^2+(1.082531754730548*fRPtr[2]*hPtr[4])/dx^2-(1.082531754730548*fPtr[2]*hPtr[4])/dx^2-(0.9375*fRPtr[1]*hPtr[4])/dx^2-(0.9375*fPtr[1]*hPtr[4])/dx^2+(1.082531754730548*hRPtr[2]*fRPtr[4])/dx^2+(1.082531754730548*hPtr[2]*fRPtr[4])/dx^2-(1.125*hRPtr[1]*fRPtr[4])/dx^2+(1.125*hPtr[1]*fRPtr[4])/dx^2-(1.082531754730548*hRPtr[2]*fPtr[4])/dx^2-(1.082531754730548*hPtr[2]*fPtr[4])/dx^2+(1.125*hRPtr[1]*fPtr[4])/dx^2-(1.125*hPtr[1]*fPtr[4])/dx^2-(1.125*fRPtr[2]*hRPtr[3])/dx^2+(1.125*fPtr[2]*hRPtr[3])/dx^2+(0.9742785792574932*fRPtr[1]*hRPtr[3])/dx^2+(0.9742785792574932*fPtr[1]*hRPtr[3])/dx^2+(1.125*fRPtr[2]*hPtr[3])/dx^2-(1.125*fPtr[2]*hPtr[3])/dx^2-(0.9742785792574932*fRPtr[1]*hPtr[3])/dx^2-(0.9742785792574932*fPtr[1]*hPtr[3])/dx^2-(0.9375*hRPtr[2]*fRPtr[3])/dx^2-(0.9375*hPtr[2]*fRPtr[3])/dx^2+(0.9742785792574932*hRPtr[1]*fRPtr[3])/dx^2-(0.9742785792574932*hPtr[1]*fRPtr[3])/dx^2-(0.9375*hRPtr[2]*fPtr[3])/dx^2-(0.9375*hPtr[2]*fPtr[3])/dx^2+(0.9742785792574932*hRPtr[1]*fPtr[3])/dx^2-(0.9742785792574932*hPtr[1]*fPtr[3])/dx^2)
   elseif isRightEdge then
      fOutPtr[1] = fPtr[1]-dt*((-(0.625*fPtr[4]*hPtr[4])/dx^2)+(0.625*fLPtr[4]*hPtr[4])/dx^2+(0.5412658773652741*fPtr[3]*hPtr[4])/dx^2+(0.5412658773652741*fLPtr[3]*hPtr[4])/dx^2-(0.625*fPtr[4]*hLPtr[4])/dx^2+(0.625*fLPtr[4]*hLPtr[4])/dx^2+(0.5412658773652741*fPtr[3]*hLPtr[4])/dx^2+(0.5412658773652741*fLPtr[3]*hLPtr[4])/dx^2+(0.6495190528383289*hPtr[3]*fPtr[4])/dx^2-(0.6495190528383289*hLPtr[3]*fPtr[4])/dx^2-(0.6495190528383289*hPtr[3]*fLPtr[4])/dx^2+(0.6495190528383289*hLPtr[3]*fLPtr[4])/dx^2-(0.5625*fPtr[3]*hPtr[3])/dx^2-(0.5625*fLPtr[3]*hPtr[3])/dx^2+(0.5625*fPtr[3]*hLPtr[3])/dx^2+(0.5625*fLPtr[3]*hLPtr[3])/dx^2-(0.625*fPtr[2]*hPtr[2])/dx^2+(0.625*fLPtr[2]*hPtr[2])/dx^2+(0.5412658773652741*fPtr[1]*hPtr[2])/dx^2+(0.5412658773652741*fLPtr[1]*hPtr[2])/dx^2-(0.625*fPtr[2]*hLPtr[2])/dx^2+(0.625*fLPtr[2]*hLPtr[2])/dx^2+(0.5412658773652741*fPtr[1]*hLPtr[2])/dx^2+(0.5412658773652741*fLPtr[1]*hLPtr[2])/dx^2+(0.6495190528383289*hPtr[1]*fPtr[2])/dx^2-(0.6495190528383289*hLPtr[1]*fPtr[2])/dx^2-(0.6495190528383289*hPtr[1]*fLPtr[2])/dx^2+(0.6495190528383289*hLPtr[1]*fLPtr[2])/dx^2-(0.5625*fPtr[1]*hPtr[1])/dx^2-(0.5625*fLPtr[1]*hPtr[1])/dx^2+(0.5625*fPtr[1]*hLPtr[1])/dx^2+(0.5625*fLPtr[1]*hLPtr[1])/dx^2)
      fOutPtr[2] = fPtr[2]-dt*((1.082531754730548*fPtr[4]*hPtr[4])/dx^2-(1.082531754730548*fLPtr[4]*hPtr[4])/dx^2-(0.9375*fPtr[3]*hPtr[4])/dx^2-(0.9375*fLPtr[3]*hPtr[4])/dx^2+(1.082531754730548*fPtr[4]*hLPtr[4])/dx^2-(1.082531754730548*fLPtr[4]*hLPtr[4])/dx^2-(0.9375*fPtr[3]*hLPtr[4])/dx^2-(0.9375*fLPtr[3]*hLPtr[4])/dx^2-(1.125*hPtr[3]*fPtr[4])/dx^2+(1.125*hLPtr[3]*fPtr[4])/dx^2+(1.125*hPtr[3]*fLPtr[4])/dx^2-(1.125*hLPtr[3]*fLPtr[4])/dx^2+(0.9742785792574932*fPtr[3]*hPtr[3])/dx^2+(0.9742785792574932*fLPtr[3]*hPtr[3])/dx^2-(0.9742785792574932*fPtr[3]*hLPtr[3])/dx^2-(0.9742785792574932*fLPtr[3]*hLPtr[3])/dx^2+(1.082531754730548*fPtr[2]*hPtr[2])/dx^2-(1.082531754730548*fLPtr[2]*hPtr[2])/dx^2-(0.9375*fPtr[1]*hPtr[2])/dx^2-(0.9375*fLPtr[1]*hPtr[2])/dx^2+(1.082531754730548*fPtr[2]*hLPtr[2])/dx^2-(1.082531754730548*fLPtr[2]*hLPtr[2])/dx^2-(0.9375*fPtr[1]*hLPtr[2])/dx^2-(0.9375*fLPtr[1]*hLPtr[2])/dx^2-(1.125*hPtr[1]*fPtr[2])/dx^2+(1.125*hLPtr[1]*fPtr[2])/dx^2+(1.125*hPtr[1]*fLPtr[2])/dx^2-(1.125*hLPtr[1]*fLPtr[2])/dx^2+(0.9742785792574932*fPtr[1]*hPtr[1])/dx^2+(0.9742785792574932*fLPtr[1]*hPtr[1])/dx^2-(0.9742785792574932*fPtr[1]*hLPtr[1])/dx^2-(0.9742785792574932*fLPtr[1]*hLPtr[1])/dx^2)
      fOutPtr[3] = fPtr[3]-dt*((-(0.625*fPtr[2]*hPtr[4])/dx^2)+(0.625*fLPtr[2]*hPtr[4])/dx^2+(0.5412658773652741*fPtr[1]*hPtr[4])/dx^2+(0.5412658773652741*fLPtr[1]*hPtr[4])/dx^2-(0.625*fPtr[2]*hLPtr[4])/dx^2+(0.625*fLPtr[2]*hLPtr[4])/dx^2+(0.5412658773652741*fPtr[1]*hLPtr[4])/dx^2+(0.5412658773652741*fLPtr[1]*hLPtr[4])/dx^2-(0.625*hPtr[2]*fPtr[4])/dx^2-(0.625*hLPtr[2]*fPtr[4])/dx^2+(0.6495190528383289*hPtr[1]*fPtr[4])/dx^2-(0.6495190528383289*hLPtr[1]*fPtr[4])/dx^2+(0.625*hPtr[2]*fLPtr[4])/dx^2+(0.625*hLPtr[2]*fLPtr[4])/dx^2-(0.6495190528383289*hPtr[1]*fLPtr[4])/dx^2+(0.6495190528383289*hLPtr[1]*fLPtr[4])/dx^2+(0.6495190528383289*fPtr[2]*hPtr[3])/dx^2-(0.6495190528383289*fLPtr[2]*hPtr[3])/dx^2-(0.5625*fPtr[1]*hPtr[3])/dx^2-(0.5625*fLPtr[1]*hPtr[3])/dx^2-(0.6495190528383289*fPtr[2]*hLPtr[3])/dx^2+(0.6495190528383289*fLPtr[2]*hLPtr[3])/dx^2+(0.5625*fPtr[1]*hLPtr[3])/dx^2+(0.5625*fLPtr[1]*hLPtr[3])/dx^2+(0.5412658773652741*hPtr[2]*fPtr[3])/dx^2+(0.5412658773652741*hLPtr[2]*fPtr[3])/dx^2-(0.5625*hPtr[1]*fPtr[3])/dx^2+(0.5625*hLPtr[1]*fPtr[3])/dx^2+(0.5412658773652741*hPtr[2]*fLPtr[3])/dx^2+(0.5412658773652741*hLPtr[2]*fLPtr[3])/dx^2-(0.5625*hPtr[1]*fLPtr[3])/dx^2+(0.5625*hLPtr[1]*fLPtr[3])/dx^2)
      fOutPtr[4] = fPtr[4]-dt*((1.082531754730548*fPtr[2]*hPtr[4])/dx^2-(1.082531754730548*fLPtr[2]*hPtr[4])/dx^2-(0.9375*fPtr[1]*hPtr[4])/dx^2-(0.9375*fLPtr[1]*hPtr[4])/dx^2+(1.082531754730548*fPtr[2]*hLPtr[4])/dx^2-(1.082531754730548*fLPtr[2]*hLPtr[4])/dx^2-(0.9375*fPtr[1]*hLPtr[4])/dx^2-(0.9375*fLPtr[1]*hLPtr[4])/dx^2+(1.082531754730548*hPtr[2]*fPtr[4])/dx^2+(1.082531754730548*hLPtr[2]*fPtr[4])/dx^2-(1.125*hPtr[1]*fPtr[4])/dx^2+(1.125*hLPtr[1]*fPtr[4])/dx^2-(1.082531754730548*hPtr[2]*fLPtr[4])/dx^2-(1.082531754730548*hLPtr[2]*fLPtr[4])/dx^2+(1.125*hPtr[1]*fLPtr[4])/dx^2-(1.125*hLPtr[1]*fLPtr[4])/dx^2-(1.125*fPtr[2]*hPtr[3])/dx^2+(1.125*fLPtr[2]*hPtr[3])/dx^2+(0.9742785792574932*fPtr[1]*hPtr[3])/dx^2+(0.9742785792574932*fLPtr[1]*hPtr[3])/dx^2+(1.125*fPtr[2]*hLPtr[3])/dx^2-(1.125*fLPtr[2]*hLPtr[3])/dx^2-(0.9742785792574932*fPtr[1]*hLPtr[3])/dx^2-(0.9742785792574932*fLPtr[1]*hLPtr[3])/dx^2-(0.9375*hPtr[2]*fPtr[3])/dx^2-(0.9375*hLPtr[2]*fPtr[3])/dx^2+(0.9742785792574932*hPtr[1]*fPtr[3])/dx^2-(0.9742785792574932*hLPtr[1]*fPtr[3])/dx^2-(0.9375*hPtr[2]*fLPtr[3])/dx^2-(0.9375*hLPtr[2]*fLPtr[3])/dx^2+(0.9742785792574932*hPtr[1]*fLPtr[3])/dx^2-(0.9742785792574932*hLPtr[1]*fLPtr[3])/dx^2)
   else
      fOutPtr[1] = fPtr[1]-dt*((0.625*fRPtr[4]*hRPtr[4])/dx^2-(0.625*fPtr[4]*hRPtr[4])/dx^2-(0.5412658773652741*fRPtr[3]*hRPtr[4])/dx^2-(0.5412658773652741*fPtr[3]*hRPtr[4])/dx^2+(0.625*fRPtr[4]*hPtr[4])/dx^2-(1.25*fPtr[4]*hPtr[4])/dx^2+(0.625*fLPtr[4]*hPtr[4])/dx^2-(0.5412658773652741*fRPtr[3]*hPtr[4])/dx^2+(0.5412658773652741*fLPtr[3]*hPtr[4])/dx^2-(0.625*fPtr[4]*hLPtr[4])/dx^2+(0.625*fLPtr[4]*hLPtr[4])/dx^2+(0.5412658773652741*fPtr[3]*hLPtr[4])/dx^2+(0.5412658773652741*fLPtr[3]*hLPtr[4])/dx^2-(0.6495190528383289*hRPtr[3]*fRPtr[4])/dx^2+(0.6495190528383289*hPtr[3]*fRPtr[4])/dx^2+(0.6495190528383289*hRPtr[3]*fPtr[4])/dx^2-(0.6495190528383289*hLPtr[3]*fPtr[4])/dx^2-(0.6495190528383289*hPtr[3]*fLPtr[4])/dx^2+(0.6495190528383289*hLPtr[3]*fLPtr[4])/dx^2+(0.5625*fRPtr[3]*hRPtr[3])/dx^2+(0.5625*fPtr[3]*hRPtr[3])/dx^2-(0.5625*fRPtr[3]*hPtr[3])/dx^2-(1.125*fPtr[3]*hPtr[3])/dx^2-(0.5625*fLPtr[3]*hPtr[3])/dx^2+(0.5625*fPtr[3]*hLPtr[3])/dx^2+(0.5625*fLPtr[3]*hLPtr[3])/dx^2+(0.625*fRPtr[2]*hRPtr[2])/dx^2-(0.625*fPtr[2]*hRPtr[2])/dx^2-(0.5412658773652741*fRPtr[1]*hRPtr[2])/dx^2-(0.5412658773652741*fPtr[1]*hRPtr[2])/dx^2+(0.625*fRPtr[2]*hPtr[2])/dx^2-(1.25*fPtr[2]*hPtr[2])/dx^2+(0.625*fLPtr[2]*hPtr[2])/dx^2-(0.5412658773652741*fRPtr[1]*hPtr[2])/dx^2+(0.5412658773652741*fLPtr[1]*hPtr[2])/dx^2-(0.625*fPtr[2]*hLPtr[2])/dx^2+(0.625*fLPtr[2]*hLPtr[2])/dx^2+(0.5412658773652741*fPtr[1]*hLPtr[2])/dx^2+(0.5412658773652741*fLPtr[1]*hLPtr[2])/dx^2-(0.6495190528383289*hRPtr[1]*fRPtr[2])/dx^2+(0.6495190528383289*hPtr[1]*fRPtr[2])/dx^2+(0.6495190528383289*hRPtr[1]*fPtr[2])/dx^2-(0.6495190528383289*hLPtr[1]*fPtr[2])/dx^2-(0.6495190528383289*hPtr[1]*fLPtr[2])/dx^2+(0.6495190528383289*hLPtr[1]*fLPtr[2])/dx^2+(0.5625*fRPtr[1]*hRPtr[1])/dx^2+(0.5625*fPtr[1]*hRPtr[1])/dx^2-(0.5625*fRPtr[1]*hPtr[1])/dx^2-(1.125*fPtr[1]*hPtr[1])/dx^2-(0.5625*fLPtr[1]*hPtr[1])/dx^2+(0.5625*fPtr[1]*hLPtr[1])/dx^2+(0.5625*fLPtr[1]*hLPtr[1])/dx^2)
      fOutPtr[2] = fPtr[2]-dt*((1.082531754730548*fRPtr[4]*hRPtr[4])/dx^2-(1.082531754730548*fPtr[4]*hRPtr[4])/dx^2-(0.9375*fRPtr[3]*hRPtr[4])/dx^2-(0.9375*fPtr[3]*hRPtr[4])/dx^2+(1.082531754730548*fRPtr[4]*hPtr[4])/dx^2-(1.082531754730548*fLPtr[4]*hPtr[4])/dx^2-(0.9375*fRPtr[3]*hPtr[4])/dx^2-(1.875*fPtr[3]*hPtr[4])/dx^2-(0.9375*fLPtr[3]*hPtr[4])/dx^2+(1.082531754730548*fPtr[4]*hLPtr[4])/dx^2-(1.082531754730548*fLPtr[4]*hLPtr[4])/dx^2-(0.9375*fPtr[3]*hLPtr[4])/dx^2-(0.9375*fLPtr[3]*hLPtr[4])/dx^2-(1.125*hRPtr[3]*fRPtr[4])/dx^2+(1.125*hPtr[3]*fRPtr[4])/dx^2+(1.125*hRPtr[3]*fPtr[4])/dx^2-(2.25*hPtr[3]*fPtr[4])/dx^2+(1.125*hLPtr[3]*fPtr[4])/dx^2+(1.125*hPtr[3]*fLPtr[4])/dx^2-(1.125*hLPtr[3]*fLPtr[4])/dx^2+(0.9742785792574932*fRPtr[3]*hRPtr[3])/dx^2+(0.9742785792574932*fPtr[3]*hRPtr[3])/dx^2-(0.9742785792574932*fRPtr[3]*hPtr[3])/dx^2+(0.9742785792574932*fLPtr[3]*hPtr[3])/dx^2-(0.9742785792574932*fPtr[3]*hLPtr[3])/dx^2-(0.9742785792574932*fLPtr[3]*hLPtr[3])/dx^2+(1.082531754730548*fRPtr[2]*hRPtr[2])/dx^2-(1.082531754730548*fPtr[2]*hRPtr[2])/dx^2-(0.9375*fRPtr[1]*hRPtr[2])/dx^2-(0.9375*fPtr[1]*hRPtr[2])/dx^2+(1.082531754730548*fRPtr[2]*hPtr[2])/dx^2-(1.082531754730548*fLPtr[2]*hPtr[2])/dx^2-(0.9375*fRPtr[1]*hPtr[2])/dx^2-(1.875*fPtr[1]*hPtr[2])/dx^2-(0.9375*fLPtr[1]*hPtr[2])/dx^2+(1.082531754730548*fPtr[2]*hLPtr[2])/dx^2-(1.082531754730548*fLPtr[2]*hLPtr[2])/dx^2-(0.9375*fPtr[1]*hLPtr[2])/dx^2-(0.9375*fLPtr[1]*hLPtr[2])/dx^2-(1.125*hRPtr[1]*fRPtr[2])/dx^2+(1.125*hPtr[1]*fRPtr[2])/dx^2+(1.125*hRPtr[1]*fPtr[2])/dx^2-(2.25*hPtr[1]*fPtr[2])/dx^2+(1.125*hLPtr[1]*fPtr[2])/dx^2+(1.125*hPtr[1]*fLPtr[2])/dx^2-(1.125*hLPtr[1]*fLPtr[2])/dx^2+(0.9742785792574932*fRPtr[1]*hRPtr[1])/dx^2+(0.9742785792574932*fPtr[1]*hRPtr[1])/dx^2-(0.9742785792574932*fRPtr[1]*hPtr[1])/dx^2+(0.9742785792574932*fLPtr[1]*hPtr[1])/dx^2-(0.9742785792574932*fPtr[1]*hLPtr[1])/dx^2-(0.9742785792574932*fLPtr[1]*hLPtr[1])/dx^2)
      fOutPtr[3] = fPtr[3]-dt*((0.625*fRPtr[2]*hRPtr[4])/dx^2-(0.625*fPtr[2]*hRPtr[4])/dx^2-(0.5412658773652741*fRPtr[1]*hRPtr[4])/dx^2-(0.5412658773652741*fPtr[1]*hRPtr[4])/dx^2+(0.625*fRPtr[2]*hPtr[4])/dx^2-(1.25*fPtr[2]*hPtr[4])/dx^2+(0.625*fLPtr[2]*hPtr[4])/dx^2-(0.5412658773652741*fRPtr[1]*hPtr[4])/dx^2+(0.5412658773652741*fLPtr[1]*hPtr[4])/dx^2-(0.625*fPtr[2]*hLPtr[4])/dx^2+(0.625*fLPtr[2]*hLPtr[4])/dx^2+(0.5412658773652741*fPtr[1]*hLPtr[4])/dx^2+(0.5412658773652741*fLPtr[1]*hLPtr[4])/dx^2+(0.625*hRPtr[2]*fRPtr[4])/dx^2+(0.625*hPtr[2]*fRPtr[4])/dx^2-(0.6495190528383289*hRPtr[1]*fRPtr[4])/dx^2+(0.6495190528383289*hPtr[1]*fRPtr[4])/dx^2-(0.625*hRPtr[2]*fPtr[4])/dx^2-(1.25*hPtr[2]*fPtr[4])/dx^2-(0.625*hLPtr[2]*fPtr[4])/dx^2+(0.6495190528383289*hRPtr[1]*fPtr[4])/dx^2-(0.6495190528383289*hLPtr[1]*fPtr[4])/dx^2+(0.625*hPtr[2]*fLPtr[4])/dx^2+(0.625*hLPtr[2]*fLPtr[4])/dx^2-(0.6495190528383289*hPtr[1]*fLPtr[4])/dx^2+(0.6495190528383289*hLPtr[1]*fLPtr[4])/dx^2-(0.6495190528383289*fRPtr[2]*hRPtr[3])/dx^2+(0.6495190528383289*fPtr[2]*hRPtr[3])/dx^2+(0.5625*fRPtr[1]*hRPtr[3])/dx^2+(0.5625*fPtr[1]*hRPtr[3])/dx^2+(0.6495190528383289*fRPtr[2]*hPtr[3])/dx^2-(0.6495190528383289*fLPtr[2]*hPtr[3])/dx^2-(0.5625*fRPtr[1]*hPtr[3])/dx^2-(1.125*fPtr[1]*hPtr[3])/dx^2-(0.5625*fLPtr[1]*hPtr[3])/dx^2-(0.6495190528383289*fPtr[2]*hLPtr[3])/dx^2+(0.6495190528383289*fLPtr[2]*hLPtr[3])/dx^2+(0.5625*fPtr[1]*hLPtr[3])/dx^2+(0.5625*fLPtr[1]*hLPtr[3])/dx^2-(0.5412658773652741*hRPtr[2]*fRPtr[3])/dx^2-(0.5412658773652741*hPtr[2]*fRPtr[3])/dx^2+(0.5625*hRPtr[1]*fRPtr[3])/dx^2-(0.5625*hPtr[1]*fRPtr[3])/dx^2-(0.5412658773652741*hRPtr[2]*fPtr[3])/dx^2+(0.5412658773652741*hLPtr[2]*fPtr[3])/dx^2+(0.5625*hRPtr[1]*fPtr[3])/dx^2-(1.125*hPtr[1]*fPtr[3])/dx^2+(0.5625*hLPtr[1]*fPtr[3])/dx^2+(0.5412658773652741*hPtr[2]*fLPtr[3])/dx^2+(0.5412658773652741*hLPtr[2]*fLPtr[3])/dx^2-(0.5625*hPtr[1]*fLPtr[3])/dx^2+(0.5625*hLPtr[1]*fLPtr[3])/dx^2)
      fOutPtr[4] = fPtr[4]-dt*((1.082531754730548*fRPtr[2]*hRPtr[4])/dx^2-(1.082531754730548*fPtr[2]*hRPtr[4])/dx^2-(0.9375*fRPtr[1]*hRPtr[4])/dx^2-(0.9375*fPtr[1]*hRPtr[4])/dx^2+(1.082531754730548*fRPtr[2]*hPtr[4])/dx^2-(1.082531754730548*fLPtr[2]*hPtr[4])/dx^2-(0.9375*fRPtr[1]*hPtr[4])/dx^2-(1.875*fPtr[1]*hPtr[4])/dx^2-(0.9375*fLPtr[1]*hPtr[4])/dx^2+(1.082531754730548*fPtr[2]*hLPtr[4])/dx^2-(1.082531754730548*fLPtr[2]*hLPtr[4])/dx^2-(0.9375*fPtr[1]*hLPtr[4])/dx^2-(0.9375*fLPtr[1]*hLPtr[4])/dx^2+(1.082531754730548*hRPtr[2]*fRPtr[4])/dx^2+(1.082531754730548*hPtr[2]*fRPtr[4])/dx^2-(1.125*hRPtr[1]*fRPtr[4])/dx^2+(1.125*hPtr[1]*fRPtr[4])/dx^2-(1.082531754730548*hRPtr[2]*fPtr[4])/dx^2+(1.082531754730548*hLPtr[2]*fPtr[4])/dx^2+(1.125*hRPtr[1]*fPtr[4])/dx^2-(2.25*hPtr[1]*fPtr[4])/dx^2+(1.125*hLPtr[1]*fPtr[4])/dx^2-(1.082531754730548*hPtr[2]*fLPtr[4])/dx^2-(1.082531754730548*hLPtr[2]*fLPtr[4])/dx^2+(1.125*hPtr[1]*fLPtr[4])/dx^2-(1.125*hLPtr[1]*fLPtr[4])/dx^2-(1.125*fRPtr[2]*hRPtr[3])/dx^2+(1.125*fPtr[2]*hRPtr[3])/dx^2+(0.9742785792574932*fRPtr[1]*hRPtr[3])/dx^2+(0.9742785792574932*fPtr[1]*hRPtr[3])/dx^2+(1.125*fRPtr[2]*hPtr[3])/dx^2-(2.25*fPtr[2]*hPtr[3])/dx^2+(1.125*fLPtr[2]*hPtr[3])/dx^2-(0.9742785792574932*fRPtr[1]*hPtr[3])/dx^2+(0.9742785792574932*fLPtr[1]*hPtr[3])/dx^2+(1.125*fPtr[2]*hLPtr[3])/dx^2-(1.125*fLPtr[2]*hLPtr[3])/dx^2-(0.9742785792574932*fPtr[1]*hLPtr[3])/dx^2-(0.9742785792574932*fLPtr[1]*hLPtr[3])/dx^2-(0.9375*hRPtr[2]*fRPtr[3])/dx^2-(0.9375*hPtr[2]*fRPtr[3])/dx^2+(0.9742785792574932*hRPtr[1]*fRPtr[3])/dx^2-(0.9742785792574932*hPtr[1]*fRPtr[3])/dx^2-(0.9375*hRPtr[2]*fPtr[3])/dx^2-(1.875*hPtr[2]*fPtr[3])/dx^2-(0.9375*hLPtr[2]*fPtr[3])/dx^2+(0.9742785792574932*hRPtr[1]*fPtr[3])/dx^2-(0.9742785792574932*hLPtr[1]*fPtr[3])/dx^2-(0.9375*hPtr[2]*fLPtr[3])/dx^2-(0.9375*hLPtr[2]*fLPtr[3])/dx^2+(0.9742785792574932*hPtr[1]*fLPtr[3])/dx^2-(0.9742785792574932*hLPtr[1]*fLPtr[3])/dx^2)
   end

   -------------------------------------------------------------------
   -- Volume term in the x-direction ---------------------------------
   fOutPtr[1] = fOutPtr[1]
   fOutPtr[2] = dt*((-(1.732050807568877*fPtr[4]*hRPtr[4])/dx^2)-(1.0*fPtr[3]*hRPtr[4])/dx^2+(2.0*fPtr[3]*hPtr[4])/dx^2+(1.732050807568877*fPtr[4]*hLPtr[4])/dx^2-(1.0*fPtr[3]*hLPtr[4])/dx^2+(1.5*hRPtr[3]*fPtr[4])/dx^2-(3.0*hPtr[3]*fPtr[4])/dx^2+(1.5*hLPtr[3]*fPtr[4])/dx^2+(0.8660254037844386*fPtr[3]*hRPtr[3])/dx^2-(0.8660254037844386*fPtr[3]*hLPtr[3])/dx^2-(1.732050807568877*fPtr[2]*hRPtr[2])/dx^2-(1.0*fPtr[1]*hRPtr[2])/dx^2+(2.0*fPtr[1]*hPtr[2])/dx^2+(1.732050807568877*fPtr[2]*hLPtr[2])/dx^2-(1.0*fPtr[1]*hLPtr[2])/dx^2+(1.5*hRPtr[1]*fPtr[2])/dx^2-(3.0*hPtr[1]*fPtr[2])/dx^2+(1.5*hLPtr[1]*fPtr[2])/dx^2+(0.8660254037844386*fPtr[1]*hRPtr[1])/dx^2-(0.8660254037844386*fPtr[1]*hLPtr[1])/dx^2)+fOutPtr[2]
   fOutPtr[3] = fOutPtr[3]
   fOutPtr[4] = dt*((-(1.732050807568877*fPtr[2]*hRPtr[4])/dx^2)-(1.0*fPtr[1]*hRPtr[4])/dx^2+(2.0*fPtr[1]*hPtr[4])/dx^2+(1.732050807568877*fPtr[2]*hLPtr[4])/dx^2-(1.0*fPtr[1]*hLPtr[4])/dx^2-(1.732050807568877*hRPtr[2]*fPtr[4])/dx^2+(1.732050807568877*hLPtr[2]*fPtr[4])/dx^2+(1.5*hRPtr[1]*fPtr[4])/dx^2-(3.0*hPtr[1]*fPtr[4])/dx^2+(1.5*hLPtr[1]*fPtr[4])/dx^2+(1.5*fPtr[2]*hRPtr[3])/dx^2+(0.8660254037844386*fPtr[1]*hRPtr[3])/dx^2-(3.0*fPtr[2]*hPtr[3])/dx^2+(1.5*fPtr[2]*hLPtr[3])/dx^2-(0.8660254037844386*fPtr[1]*hLPtr[3])/dx^2-(1.0*hRPtr[2]*fPtr[3])/dx^2+(2.0*hPtr[2]*fPtr[3])/dx^2-(1.0*hLPtr[2]*fPtr[3])/dx^2+(0.8660254037844386*hRPtr[1]*fPtr[3])/dx^2-(0.8660254037844386*hLPtr[1]*fPtr[3])/dx^2)+fOutPtr[4]

   -------------------------------------------------------------------
   -- Surface term in the y-direction --------------------------------
   if isBotEdge then
      fOutPtr[1] = fOutPtr[1]-dt*((0.625*fTPtr[4]*hTPtr[4])/dy^2-(0.625*fPtr[4]*hTPtr[4])/dy^2-(0.5412658773652741*fTPtr[2]*hTPtr[4])/dy^2-(0.5412658773652741*fPtr[2]*hTPtr[4])/dy^2+(0.625*fTPtr[4]*hPtr[4])/dy^2-(0.625*fPtr[4]*hPtr[4])/dy^2-(0.5412658773652741*fTPtr[2]*hPtr[4])/dy^2-(0.5412658773652741*fPtr[2]*hPtr[4])/dy^2-(0.6495190528383289*hTPtr[2]*fTPtr[4])/dy^2+(0.6495190528383289*hPtr[2]*fTPtr[4])/dy^2+(0.6495190528383289*hTPtr[2]*fPtr[4])/dy^2-(0.6495190528383289*hPtr[2]*fPtr[4])/dy^2+(0.625*fTPtr[3]*hTPtr[3])/dy^2-(0.625*fPtr[3]*hTPtr[3])/dy^2-(0.5412658773652741*fTPtr[1]*hTPtr[3])/dy^2-(0.5412658773652741*fPtr[1]*hTPtr[3])/dy^2+(0.625*fTPtr[3]*hPtr[3])/dy^2-(0.625*fPtr[3]*hPtr[3])/dy^2-(0.5412658773652741*fTPtr[1]*hPtr[3])/dy^2-(0.5412658773652741*fPtr[1]*hPtr[3])/dy^2-(0.6495190528383289*hTPtr[1]*fTPtr[3])/dy^2+(0.6495190528383289*hPtr[1]*fTPtr[3])/dy^2+(0.6495190528383289*hTPtr[1]*fPtr[3])/dy^2-(0.6495190528383289*hPtr[1]*fPtr[3])/dy^2+(0.5625*fTPtr[2]*hTPtr[2])/dy^2+(0.5625*fPtr[2]*hTPtr[2])/dy^2-(0.5625*fTPtr[2]*hPtr[2])/dy^2-(0.5625*fPtr[2]*hPtr[2])/dy^2+(0.5625*fTPtr[1]*hTPtr[1])/dy^2+(0.5625*fPtr[1]*hTPtr[1])/dy^2-(0.5625*fTPtr[1]*hPtr[1])/dy^2-(0.5625*fPtr[1]*hPtr[1])/dy^2)
      fOutPtr[2] = fOutPtr[2]-dt*((0.625*fTPtr[3]*hTPtr[4])/dy^2-(0.625*fPtr[3]*hTPtr[4])/dy^2-(0.5412658773652741*fTPtr[1]*hTPtr[4])/dy^2-(0.5412658773652741*fPtr[1]*hTPtr[4])/dy^2+(0.625*fTPtr[3]*hPtr[4])/dy^2-(0.625*fPtr[3]*hPtr[4])/dy^2-(0.5412658773652741*fTPtr[1]*hPtr[4])/dy^2-(0.5412658773652741*fPtr[1]*hPtr[4])/dy^2+(0.625*hTPtr[3]*fTPtr[4])/dy^2+(0.625*hPtr[3]*fTPtr[4])/dy^2-(0.6495190528383289*hTPtr[1]*fTPtr[4])/dy^2+(0.6495190528383289*hPtr[1]*fTPtr[4])/dy^2-(0.625*hTPtr[3]*fPtr[4])/dy^2-(0.625*hPtr[3]*fPtr[4])/dy^2+(0.6495190528383289*hTPtr[1]*fPtr[4])/dy^2-(0.6495190528383289*hPtr[1]*fPtr[4])/dy^2-(0.5412658773652741*fTPtr[2]*hTPtr[3])/dy^2-(0.5412658773652741*fPtr[2]*hTPtr[3])/dy^2-(0.5412658773652741*fTPtr[2]*hPtr[3])/dy^2-(0.5412658773652741*fPtr[2]*hPtr[3])/dy^2-(0.6495190528383289*hTPtr[2]*fTPtr[3])/dy^2+(0.6495190528383289*hPtr[2]*fTPtr[3])/dy^2+(0.6495190528383289*hTPtr[2]*fPtr[3])/dy^2-(0.6495190528383289*hPtr[2]*fPtr[3])/dy^2+(0.5625*fTPtr[1]*hTPtr[2])/dy^2+(0.5625*fPtr[1]*hTPtr[2])/dy^2-(0.5625*fTPtr[1]*hPtr[2])/dy^2-(0.5625*fPtr[1]*hPtr[2])/dy^2+(0.5625*hTPtr[1]*fTPtr[2])/dy^2-(0.5625*hPtr[1]*fTPtr[2])/dy^2+(0.5625*hTPtr[1]*fPtr[2])/dy^2-(0.5625*hPtr[1]*fPtr[2])/dy^2)
      fOutPtr[3] = fOutPtr[3]-dt*((1.082531754730548*fTPtr[4]*hTPtr[4])/dy^2-(1.082531754730548*fPtr[4]*hTPtr[4])/dy^2-(0.9375*fTPtr[2]*hTPtr[4])/dy^2-(0.9375*fPtr[2]*hTPtr[4])/dy^2+(1.082531754730548*fTPtr[4]*hPtr[4])/dy^2-(1.082531754730548*fPtr[4]*hPtr[4])/dy^2-(0.9375*fTPtr[2]*hPtr[4])/dy^2-(0.9375*fPtr[2]*hPtr[4])/dy^2-(1.125*hTPtr[2]*fTPtr[4])/dy^2+(1.125*hPtr[2]*fTPtr[4])/dy^2+(1.125*hTPtr[2]*fPtr[4])/dy^2-(1.125*hPtr[2]*fPtr[4])/dy^2+(1.082531754730548*fTPtr[3]*hTPtr[3])/dy^2-(1.082531754730548*fPtr[3]*hTPtr[3])/dy^2-(0.9375*fTPtr[1]*hTPtr[3])/dy^2-(0.9375*fPtr[1]*hTPtr[3])/dy^2+(1.082531754730548*fTPtr[3]*hPtr[3])/dy^2-(1.082531754730548*fPtr[3]*hPtr[3])/dy^2-(0.9375*fTPtr[1]*hPtr[3])/dy^2-(0.9375*fPtr[1]*hPtr[3])/dy^2-(1.125*hTPtr[1]*fTPtr[3])/dy^2+(1.125*hPtr[1]*fTPtr[3])/dy^2+(1.125*hTPtr[1]*fPtr[3])/dy^2-(1.125*hPtr[1]*fPtr[3])/dy^2+(0.9742785792574932*fTPtr[2]*hTPtr[2])/dy^2+(0.9742785792574932*fPtr[2]*hTPtr[2])/dy^2-(0.9742785792574932*fTPtr[2]*hPtr[2])/dy^2-(0.9742785792574932*fPtr[2]*hPtr[2])/dy^2+(0.9742785792574932*fTPtr[1]*hTPtr[1])/dy^2+(0.9742785792574932*fPtr[1]*hTPtr[1])/dy^2-(0.9742785792574932*fTPtr[1]*hPtr[1])/dy^2-(0.9742785792574932*fPtr[1]*hPtr[1])/dy^2)
      fOutPtr[4] = fOutPtr[4]-dt*((1.082531754730548*fTPtr[3]*hTPtr[4])/dy^2-(1.082531754730548*fPtr[3]*hTPtr[4])/dy^2-(0.9375*fTPtr[1]*hTPtr[4])/dy^2-(0.9375*fPtr[1]*hTPtr[4])/dy^2+(1.082531754730548*fTPtr[3]*hPtr[4])/dy^2-(1.082531754730548*fPtr[3]*hPtr[4])/dy^2-(0.9375*fTPtr[1]*hPtr[4])/dy^2-(0.9375*fPtr[1]*hPtr[4])/dy^2+(1.082531754730548*hTPtr[3]*fTPtr[4])/dy^2+(1.082531754730548*hPtr[3]*fTPtr[4])/dy^2-(1.125*hTPtr[1]*fTPtr[4])/dy^2+(1.125*hPtr[1]*fTPtr[4])/dy^2-(1.082531754730548*hTPtr[3]*fPtr[4])/dy^2-(1.082531754730548*hPtr[3]*fPtr[4])/dy^2+(1.125*hTPtr[1]*fPtr[4])/dy^2-(1.125*hPtr[1]*fPtr[4])/dy^2-(0.9375*fTPtr[2]*hTPtr[3])/dy^2-(0.9375*fPtr[2]*hTPtr[3])/dy^2-(0.9375*fTPtr[2]*hPtr[3])/dy^2-(0.9375*fPtr[2]*hPtr[3])/dy^2-(1.125*hTPtr[2]*fTPtr[3])/dy^2+(1.125*hPtr[2]*fTPtr[3])/dy^2+(1.125*hTPtr[2]*fPtr[3])/dy^2-(1.125*hPtr[2]*fPtr[3])/dy^2+(0.9742785792574932*fTPtr[1]*hTPtr[2])/dy^2+(0.9742785792574932*fPtr[1]*hTPtr[2])/dy^2-(0.9742785792574932*fTPtr[1]*hPtr[2])/dy^2-(0.9742785792574932*fPtr[1]*hPtr[2])/dy^2+(0.9742785792574932*hTPtr[1]*fTPtr[2])/dy^2-(0.9742785792574932*hPtr[1]*fTPtr[2])/dy^2+(0.9742785792574932*hTPtr[1]*fPtr[2])/dy^2-(0.9742785792574932*hPtr[1]*fPtr[2])/dy^2)
   elseif isTopEdge then
      fOutPtr[1] = fOutPtr[1]-dt*((-(0.625*fPtr[4]*hPtr[4])/dy^2)+(0.625*fBPtr[4]*hPtr[4])/dy^2+(0.5412658773652741*fPtr[2]*hPtr[4])/dy^2+(0.5412658773652741*fBPtr[2]*hPtr[4])/dy^2-(0.625*fPtr[4]*hBPtr[4])/dy^2+(0.625*fBPtr[4]*hBPtr[4])/dy^2+(0.5412658773652741*fPtr[2]*hBPtr[4])/dy^2+(0.5412658773652741*fBPtr[2]*hBPtr[4])/dy^2+(0.6495190528383289*hPtr[2]*fPtr[4])/dy^2-(0.6495190528383289*hBPtr[2]*fPtr[4])/dy^2-(0.6495190528383289*hPtr[2]*fBPtr[4])/dy^2+(0.6495190528383289*hBPtr[2]*fBPtr[4])/dy^2-(0.625*fPtr[3]*hPtr[3])/dy^2+(0.625*fBPtr[3]*hPtr[3])/dy^2+(0.5412658773652741*fPtr[1]*hPtr[3])/dy^2+(0.5412658773652741*fBPtr[1]*hPtr[3])/dy^2-(0.625*fPtr[3]*hBPtr[3])/dy^2+(0.625*fBPtr[3]*hBPtr[3])/dy^2+(0.5412658773652741*fPtr[1]*hBPtr[3])/dy^2+(0.5412658773652741*fBPtr[1]*hBPtr[3])/dy^2+(0.6495190528383289*hPtr[1]*fPtr[3])/dy^2-(0.6495190528383289*hBPtr[1]*fPtr[3])/dy^2-(0.6495190528383289*hPtr[1]*fBPtr[3])/dy^2+(0.6495190528383289*hBPtr[1]*fBPtr[3])/dy^2-(0.5625*fPtr[2]*hPtr[2])/dy^2-(0.5625*fBPtr[2]*hPtr[2])/dy^2+(0.5625*fPtr[2]*hBPtr[2])/dy^2+(0.5625*fBPtr[2]*hBPtr[2])/dy^2-(0.5625*fPtr[1]*hPtr[1])/dy^2-(0.5625*fBPtr[1]*hPtr[1])/dy^2+(0.5625*fPtr[1]*hBPtr[1])/dy^2+(0.5625*fBPtr[1]*hBPtr[1])/dy^2)
      fOutPtr[2] = fOutPtr[2]-dt*((-(0.625*fPtr[3]*hPtr[4])/dy^2)+(0.625*fBPtr[3]*hPtr[4])/dy^2+(0.5412658773652741*fPtr[1]*hPtr[4])/dy^2+(0.5412658773652741*fBPtr[1]*hPtr[4])/dy^2-(0.625*fPtr[3]*hBPtr[4])/dy^2+(0.625*fBPtr[3]*hBPtr[4])/dy^2+(0.5412658773652741*fPtr[1]*hBPtr[4])/dy^2+(0.5412658773652741*fBPtr[1]*hBPtr[4])/dy^2-(0.625*hPtr[3]*fPtr[4])/dy^2-(0.625*hBPtr[3]*fPtr[4])/dy^2+(0.6495190528383289*hPtr[1]*fPtr[4])/dy^2-(0.6495190528383289*hBPtr[1]*fPtr[4])/dy^2+(0.625*hPtr[3]*fBPtr[4])/dy^2+(0.625*hBPtr[3]*fBPtr[4])/dy^2-(0.6495190528383289*hPtr[1]*fBPtr[4])/dy^2+(0.6495190528383289*hBPtr[1]*fBPtr[4])/dy^2+(0.5412658773652741*fPtr[2]*hPtr[3])/dy^2+(0.5412658773652741*fBPtr[2]*hPtr[3])/dy^2+(0.5412658773652741*fPtr[2]*hBPtr[3])/dy^2+(0.5412658773652741*fBPtr[2]*hBPtr[3])/dy^2+(0.6495190528383289*hPtr[2]*fPtr[3])/dy^2-(0.6495190528383289*hBPtr[2]*fPtr[3])/dy^2-(0.6495190528383289*hPtr[2]*fBPtr[3])/dy^2+(0.6495190528383289*hBPtr[2]*fBPtr[3])/dy^2-(0.5625*fPtr[1]*hPtr[2])/dy^2-(0.5625*fBPtr[1]*hPtr[2])/dy^2+(0.5625*fPtr[1]*hBPtr[2])/dy^2+(0.5625*fBPtr[1]*hBPtr[2])/dy^2-(0.5625*hPtr[1]*fPtr[2])/dy^2+(0.5625*hBPtr[1]*fPtr[2])/dy^2-(0.5625*hPtr[1]*fBPtr[2])/dy^2+(0.5625*hBPtr[1]*fBPtr[2])/dy^2)
      fOutPtr[3] = fOutPtr[3]-dt*((1.082531754730548*fPtr[4]*hPtr[4])/dy^2-(1.082531754730548*fBPtr[4]*hPtr[4])/dy^2-(0.9375*fPtr[2]*hPtr[4])/dy^2-(0.9375*fBPtr[2]*hPtr[4])/dy^2+(1.082531754730548*fPtr[4]*hBPtr[4])/dy^2-(1.082531754730548*fBPtr[4]*hBPtr[4])/dy^2-(0.9375*fPtr[2]*hBPtr[4])/dy^2-(0.9375*fBPtr[2]*hBPtr[4])/dy^2-(1.125*hPtr[2]*fPtr[4])/dy^2+(1.125*hBPtr[2]*fPtr[4])/dy^2+(1.125*hPtr[2]*fBPtr[4])/dy^2-(1.125*hBPtr[2]*fBPtr[4])/dy^2+(1.082531754730548*fPtr[3]*hPtr[3])/dy^2-(1.082531754730548*fBPtr[3]*hPtr[3])/dy^2-(0.9375*fPtr[1]*hPtr[3])/dy^2-(0.9375*fBPtr[1]*hPtr[3])/dy^2+(1.082531754730548*fPtr[3]*hBPtr[3])/dy^2-(1.082531754730548*fBPtr[3]*hBPtr[3])/dy^2-(0.9375*fPtr[1]*hBPtr[3])/dy^2-(0.9375*fBPtr[1]*hBPtr[3])/dy^2-(1.125*hPtr[1]*fPtr[3])/dy^2+(1.125*hBPtr[1]*fPtr[3])/dy^2+(1.125*hPtr[1]*fBPtr[3])/dy^2-(1.125*hBPtr[1]*fBPtr[3])/dy^2+(0.9742785792574932*fPtr[2]*hPtr[2])/dy^2+(0.9742785792574932*fBPtr[2]*hPtr[2])/dy^2-(0.9742785792574932*fPtr[2]*hBPtr[2])/dy^2-(0.9742785792574932*fBPtr[2]*hBPtr[2])/dy^2+(0.9742785792574932*fPtr[1]*hPtr[1])/dy^2+(0.9742785792574932*fBPtr[1]*hPtr[1])/dy^2-(0.9742785792574932*fPtr[1]*hBPtr[1])/dy^2-(0.9742785792574932*fBPtr[1]*hBPtr[1])/dy^2)
      fOutPtr[4] = fOutPtr[4]-dt*((1.082531754730548*fPtr[3]*hPtr[4])/dy^2-(1.082531754730548*fBPtr[3]*hPtr[4])/dy^2-(0.9375*fPtr[1]*hPtr[4])/dy^2-(0.9375*fBPtr[1]*hPtr[4])/dy^2+(1.082531754730548*fPtr[3]*hBPtr[4])/dy^2-(1.082531754730548*fBPtr[3]*hBPtr[4])/dy^2-(0.9375*fPtr[1]*hBPtr[4])/dy^2-(0.9375*fBPtr[1]*hBPtr[4])/dy^2+(1.082531754730548*hPtr[3]*fPtr[4])/dy^2+(1.082531754730548*hBPtr[3]*fPtr[4])/dy^2-(1.125*hPtr[1]*fPtr[4])/dy^2+(1.125*hBPtr[1]*fPtr[4])/dy^2-(1.082531754730548*hPtr[3]*fBPtr[4])/dy^2-(1.082531754730548*hBPtr[3]*fBPtr[4])/dy^2+(1.125*hPtr[1]*fBPtr[4])/dy^2-(1.125*hBPtr[1]*fBPtr[4])/dy^2-(0.9375*fPtr[2]*hPtr[3])/dy^2-(0.9375*fBPtr[2]*hPtr[3])/dy^2-(0.9375*fPtr[2]*hBPtr[3])/dy^2-(0.9375*fBPtr[2]*hBPtr[3])/dy^2-(1.125*hPtr[2]*fPtr[3])/dy^2+(1.125*hBPtr[2]*fPtr[3])/dy^2+(1.125*hPtr[2]*fBPtr[3])/dy^2-(1.125*hBPtr[2]*fBPtr[3])/dy^2+(0.9742785792574932*fPtr[1]*hPtr[2])/dy^2+(0.9742785792574932*fBPtr[1]*hPtr[2])/dy^2-(0.9742785792574932*fPtr[1]*hBPtr[2])/dy^2-(0.9742785792574932*fBPtr[1]*hBPtr[2])/dy^2+(0.9742785792574932*hPtr[1]*fPtr[2])/dy^2-(0.9742785792574932*hBPtr[1]*fPtr[2])/dy^2+(0.9742785792574932*hPtr[1]*fBPtr[2])/dy^2-(0.9742785792574932*hBPtr[1]*fBPtr[2])/dy^2)
   else
      fOutPtr[1] = fOutPtr[1]-dt*((0.625*fTPtr[4]*hTPtr[4])/dy^2-(0.625*fPtr[4]*hTPtr[4])/dy^2-(0.5412658773652741*fTPtr[2]*hTPtr[4])/dy^2-(0.5412658773652741*fPtr[2]*hTPtr[4])/dy^2+(0.625*fTPtr[4]*hPtr[4])/dy^2-(1.25*fPtr[4]*hPtr[4])/dy^2+(0.625*fBPtr[4]*hPtr[4])/dy^2-(0.5412658773652741*fTPtr[2]*hPtr[4])/dy^2+(0.5412658773652741*fBPtr[2]*hPtr[4])/dy^2-(0.625*fPtr[4]*hBPtr[4])/dy^2+(0.625*fBPtr[4]*hBPtr[4])/dy^2+(0.5412658773652741*fPtr[2]*hBPtr[4])/dy^2+(0.5412658773652741*fBPtr[2]*hBPtr[4])/dy^2-(0.6495190528383289*hTPtr[2]*fTPtr[4])/dy^2+(0.6495190528383289*hPtr[2]*fTPtr[4])/dy^2+(0.6495190528383289*hTPtr[2]*fPtr[4])/dy^2-(0.6495190528383289*hBPtr[2]*fPtr[4])/dy^2-(0.6495190528383289*hPtr[2]*fBPtr[4])/dy^2+(0.6495190528383289*hBPtr[2]*fBPtr[4])/dy^2+(0.625*fTPtr[3]*hTPtr[3])/dy^2-(0.625*fPtr[3]*hTPtr[3])/dy^2-(0.5412658773652741*fTPtr[1]*hTPtr[3])/dy^2-(0.5412658773652741*fPtr[1]*hTPtr[3])/dy^2+(0.625*fTPtr[3]*hPtr[3])/dy^2-(1.25*fPtr[3]*hPtr[3])/dy^2+(0.625*fBPtr[3]*hPtr[3])/dy^2-(0.5412658773652741*fTPtr[1]*hPtr[3])/dy^2+(0.5412658773652741*fBPtr[1]*hPtr[3])/dy^2-(0.625*fPtr[3]*hBPtr[3])/dy^2+(0.625*fBPtr[3]*hBPtr[3])/dy^2+(0.5412658773652741*fPtr[1]*hBPtr[3])/dy^2+(0.5412658773652741*fBPtr[1]*hBPtr[3])/dy^2-(0.6495190528383289*hTPtr[1]*fTPtr[3])/dy^2+(0.6495190528383289*hPtr[1]*fTPtr[3])/dy^2+(0.6495190528383289*hTPtr[1]*fPtr[3])/dy^2-(0.6495190528383289*hBPtr[1]*fPtr[3])/dy^2-(0.6495190528383289*hPtr[1]*fBPtr[3])/dy^2+(0.6495190528383289*hBPtr[1]*fBPtr[3])/dy^2+(0.5625*fTPtr[2]*hTPtr[2])/dy^2+(0.5625*fPtr[2]*hTPtr[2])/dy^2-(0.5625*fTPtr[2]*hPtr[2])/dy^2-(1.125*fPtr[2]*hPtr[2])/dy^2-(0.5625*fBPtr[2]*hPtr[2])/dy^2+(0.5625*fPtr[2]*hBPtr[2])/dy^2+(0.5625*fBPtr[2]*hBPtr[2])/dy^2+(0.5625*fTPtr[1]*hTPtr[1])/dy^2+(0.5625*fPtr[1]*hTPtr[1])/dy^2-(0.5625*fTPtr[1]*hPtr[1])/dy^2-(1.125*fPtr[1]*hPtr[1])/dy^2-(0.5625*fBPtr[1]*hPtr[1])/dy^2+(0.5625*fPtr[1]*hBPtr[1])/dy^2+(0.5625*fBPtr[1]*hBPtr[1])/dy^2)
      fOutPtr[2] = fOutPtr[2]-dt*((0.625*fTPtr[3]*hTPtr[4])/dy^2-(0.625*fPtr[3]*hTPtr[4])/dy^2-(0.5412658773652741*fTPtr[1]*hTPtr[4])/dy^2-(0.5412658773652741*fPtr[1]*hTPtr[4])/dy^2+(0.625*fTPtr[3]*hPtr[4])/dy^2-(1.25*fPtr[3]*hPtr[4])/dy^2+(0.625*fBPtr[3]*hPtr[4])/dy^2-(0.5412658773652741*fTPtr[1]*hPtr[4])/dy^2+(0.5412658773652741*fBPtr[1]*hPtr[4])/dy^2-(0.625*fPtr[3]*hBPtr[4])/dy^2+(0.625*fBPtr[3]*hBPtr[4])/dy^2+(0.5412658773652741*fPtr[1]*hBPtr[4])/dy^2+(0.5412658773652741*fBPtr[1]*hBPtr[4])/dy^2+(0.625*hTPtr[3]*fTPtr[4])/dy^2+(0.625*hPtr[3]*fTPtr[4])/dy^2-(0.6495190528383289*hTPtr[1]*fTPtr[4])/dy^2+(0.6495190528383289*hPtr[1]*fTPtr[4])/dy^2-(0.625*hTPtr[3]*fPtr[4])/dy^2-(1.25*hPtr[3]*fPtr[4])/dy^2-(0.625*hBPtr[3]*fPtr[4])/dy^2+(0.6495190528383289*hTPtr[1]*fPtr[4])/dy^2-(0.6495190528383289*hBPtr[1]*fPtr[4])/dy^2+(0.625*hPtr[3]*fBPtr[4])/dy^2+(0.625*hBPtr[3]*fBPtr[4])/dy^2-(0.6495190528383289*hPtr[1]*fBPtr[4])/dy^2+(0.6495190528383289*hBPtr[1]*fBPtr[4])/dy^2-(0.5412658773652741*fTPtr[2]*hTPtr[3])/dy^2-(0.5412658773652741*fPtr[2]*hTPtr[3])/dy^2-(0.5412658773652741*fTPtr[2]*hPtr[3])/dy^2+(0.5412658773652741*fBPtr[2]*hPtr[3])/dy^2+(0.5412658773652741*fPtr[2]*hBPtr[3])/dy^2+(0.5412658773652741*fBPtr[2]*hBPtr[3])/dy^2-(0.6495190528383289*hTPtr[2]*fTPtr[3])/dy^2+(0.6495190528383289*hPtr[2]*fTPtr[3])/dy^2+(0.6495190528383289*hTPtr[2]*fPtr[3])/dy^2-(0.6495190528383289*hBPtr[2]*fPtr[3])/dy^2-(0.6495190528383289*hPtr[2]*fBPtr[3])/dy^2+(0.6495190528383289*hBPtr[2]*fBPtr[3])/dy^2+(0.5625*fTPtr[1]*hTPtr[2])/dy^2+(0.5625*fPtr[1]*hTPtr[2])/dy^2-(0.5625*fTPtr[1]*hPtr[2])/dy^2-(1.125*fPtr[1]*hPtr[2])/dy^2-(0.5625*fBPtr[1]*hPtr[2])/dy^2+(0.5625*fPtr[1]*hBPtr[2])/dy^2+(0.5625*fBPtr[1]*hBPtr[2])/dy^2+(0.5625*hTPtr[1]*fTPtr[2])/dy^2-(0.5625*hPtr[1]*fTPtr[2])/dy^2+(0.5625*hTPtr[1]*fPtr[2])/dy^2-(1.125*hPtr[1]*fPtr[2])/dy^2+(0.5625*hBPtr[1]*fPtr[2])/dy^2-(0.5625*hPtr[1]*fBPtr[2])/dy^2+(0.5625*hBPtr[1]*fBPtr[2])/dy^2)
      fOutPtr[3] = fOutPtr[3]-dt*((1.082531754730548*fTPtr[4]*hTPtr[4])/dy^2-(1.082531754730548*fPtr[4]*hTPtr[4])/dy^2-(0.9375*fTPtr[2]*hTPtr[4])/dy^2-(0.9375*fPtr[2]*hTPtr[4])/dy^2+(1.082531754730548*fTPtr[4]*hPtr[4])/dy^2-(1.082531754730548*fBPtr[4]*hPtr[4])/dy^2-(0.9375*fTPtr[2]*hPtr[4])/dy^2-(1.875*fPtr[2]*hPtr[4])/dy^2-(0.9375*fBPtr[2]*hPtr[4])/dy^2+(1.082531754730548*fPtr[4]*hBPtr[4])/dy^2-(1.082531754730548*fBPtr[4]*hBPtr[4])/dy^2-(0.9375*fPtr[2]*hBPtr[4])/dy^2-(0.9375*fBPtr[2]*hBPtr[4])/dy^2-(1.125*hTPtr[2]*fTPtr[4])/dy^2+(1.125*hPtr[2]*fTPtr[4])/dy^2+(1.125*hTPtr[2]*fPtr[4])/dy^2-(2.25*hPtr[2]*fPtr[4])/dy^2+(1.125*hBPtr[2]*fPtr[4])/dy^2+(1.125*hPtr[2]*fBPtr[4])/dy^2-(1.125*hBPtr[2]*fBPtr[4])/dy^2+(1.082531754730548*fTPtr[3]*hTPtr[3])/dy^2-(1.082531754730548*fPtr[3]*hTPtr[3])/dy^2-(0.9375*fTPtr[1]*hTPtr[3])/dy^2-(0.9375*fPtr[1]*hTPtr[3])/dy^2+(1.082531754730548*fTPtr[3]*hPtr[3])/dy^2-(1.082531754730548*fBPtr[3]*hPtr[3])/dy^2-(0.9375*fTPtr[1]*hPtr[3])/dy^2-(1.875*fPtr[1]*hPtr[3])/dy^2-(0.9375*fBPtr[1]*hPtr[3])/dy^2+(1.082531754730548*fPtr[3]*hBPtr[3])/dy^2-(1.082531754730548*fBPtr[3]*hBPtr[3])/dy^2-(0.9375*fPtr[1]*hBPtr[3])/dy^2-(0.9375*fBPtr[1]*hBPtr[3])/dy^2-(1.125*hTPtr[1]*fTPtr[3])/dy^2+(1.125*hPtr[1]*fTPtr[3])/dy^2+(1.125*hTPtr[1]*fPtr[3])/dy^2-(2.25*hPtr[1]*fPtr[3])/dy^2+(1.125*hBPtr[1]*fPtr[3])/dy^2+(1.125*hPtr[1]*fBPtr[3])/dy^2-(1.125*hBPtr[1]*fBPtr[3])/dy^2+(0.9742785792574932*fTPtr[2]*hTPtr[2])/dy^2+(0.9742785792574932*fPtr[2]*hTPtr[2])/dy^2-(0.9742785792574932*fTPtr[2]*hPtr[2])/dy^2+(0.9742785792574932*fBPtr[2]*hPtr[2])/dy^2-(0.9742785792574932*fPtr[2]*hBPtr[2])/dy^2-(0.9742785792574932*fBPtr[2]*hBPtr[2])/dy^2+(0.9742785792574932*fTPtr[1]*hTPtr[1])/dy^2+(0.9742785792574932*fPtr[1]*hTPtr[1])/dy^2-(0.9742785792574932*fTPtr[1]*hPtr[1])/dy^2+(0.9742785792574932*fBPtr[1]*hPtr[1])/dy^2-(0.9742785792574932*fPtr[1]*hBPtr[1])/dy^2-(0.9742785792574932*fBPtr[1]*hBPtr[1])/dy^2)
      fOutPtr[4] = fOutPtr[4]-dt*((1.082531754730548*fTPtr[3]*hTPtr[4])/dy^2-(1.082531754730548*fPtr[3]*hTPtr[4])/dy^2-(0.9375*fTPtr[1]*hTPtr[4])/dy^2-(0.9375*fPtr[1]*hTPtr[4])/dy^2+(1.082531754730548*fTPtr[3]*hPtr[4])/dy^2-(1.082531754730548*fBPtr[3]*hPtr[4])/dy^2-(0.9375*fTPtr[1]*hPtr[4])/dy^2-(1.875*fPtr[1]*hPtr[4])/dy^2-(0.9375*fBPtr[1]*hPtr[4])/dy^2+(1.082531754730548*fPtr[3]*hBPtr[4])/dy^2-(1.082531754730548*fBPtr[3]*hBPtr[4])/dy^2-(0.9375*fPtr[1]*hBPtr[4])/dy^2-(0.9375*fBPtr[1]*hBPtr[4])/dy^2+(1.082531754730548*hTPtr[3]*fTPtr[4])/dy^2+(1.082531754730548*hPtr[3]*fTPtr[4])/dy^2-(1.125*hTPtr[1]*fTPtr[4])/dy^2+(1.125*hPtr[1]*fTPtr[4])/dy^2-(1.082531754730548*hTPtr[3]*fPtr[4])/dy^2+(1.082531754730548*hBPtr[3]*fPtr[4])/dy^2+(1.125*hTPtr[1]*fPtr[4])/dy^2-(2.25*hPtr[1]*fPtr[4])/dy^2+(1.125*hBPtr[1]*fPtr[4])/dy^2-(1.082531754730548*hPtr[3]*fBPtr[4])/dy^2-(1.082531754730548*hBPtr[3]*fBPtr[4])/dy^2+(1.125*hPtr[1]*fBPtr[4])/dy^2-(1.125*hBPtr[1]*fBPtr[4])/dy^2-(0.9375*fTPtr[2]*hTPtr[3])/dy^2-(0.9375*fPtr[2]*hTPtr[3])/dy^2-(0.9375*fTPtr[2]*hPtr[3])/dy^2-(1.875*fPtr[2]*hPtr[3])/dy^2-(0.9375*fBPtr[2]*hPtr[3])/dy^2-(0.9375*fPtr[2]*hBPtr[3])/dy^2-(0.9375*fBPtr[2]*hBPtr[3])/dy^2-(1.125*hTPtr[2]*fTPtr[3])/dy^2+(1.125*hPtr[2]*fTPtr[3])/dy^2+(1.125*hTPtr[2]*fPtr[3])/dy^2-(2.25*hPtr[2]*fPtr[3])/dy^2+(1.125*hBPtr[2]*fPtr[3])/dy^2+(1.125*hPtr[2]*fBPtr[3])/dy^2-(1.125*hBPtr[2]*fBPtr[3])/dy^2+(0.9742785792574932*fTPtr[1]*hTPtr[2])/dy^2+(0.9742785792574932*fPtr[1]*hTPtr[2])/dy^2-(0.9742785792574932*fTPtr[1]*hPtr[2])/dy^2+(0.9742785792574932*fBPtr[1]*hPtr[2])/dy^2-(0.9742785792574932*fPtr[1]*hBPtr[2])/dy^2-(0.9742785792574932*fBPtr[1]*hBPtr[2])/dy^2+(0.9742785792574932*hTPtr[1]*fTPtr[2])/dy^2-(0.9742785792574932*hPtr[1]*fTPtr[2])/dy^2+(0.9742785792574932*hTPtr[1]*fPtr[2])/dy^2-(0.9742785792574932*hBPtr[1]*fPtr[2])/dy^2+(0.9742785792574932*hPtr[1]*fBPtr[2])/dy^2-(0.9742785792574932*hBPtr[1]*fBPtr[2])/dy^2)
   end

   -------------------------------------------------------------------
   -- Volume term in the y-direction ---------------------------------
   fOutPtr[1] = fOutPtr[1]
   fOutPtr[2] = fOutPtr[2]
   fOutPtr[3] = dt*((-(1.732050807568877*fPtr[4]*hTPtr[4])/dy^2)-(1.0*fPtr[2]*hTPtr[4])/dy^2+(2.0*fPtr[2]*hPtr[4])/dy^2+(1.732050807568877*fPtr[4]*hBPtr[4])/dy^2-(1.0*fPtr[2]*hBPtr[4])/dy^2+(1.5*hTPtr[2]*fPtr[4])/dy^2-(3.0*hPtr[2]*fPtr[4])/dy^2+(1.5*hBPtr[2]*fPtr[4])/dy^2-(1.732050807568877*fPtr[3]*hTPtr[3])/dy^2-(1.0*fPtr[1]*hTPtr[3])/dy^2+(2.0*fPtr[1]*hPtr[3])/dy^2+(1.732050807568877*fPtr[3]*hBPtr[3])/dy^2-(1.0*fPtr[1]*hBPtr[3])/dy^2+(1.5*hTPtr[1]*fPtr[3])/dy^2-(3.0*hPtr[1]*fPtr[3])/dy^2+(1.5*hBPtr[1]*fPtr[3])/dy^2+(0.8660254037844386*fPtr[2]*hTPtr[2])/dy^2-(0.8660254037844386*fPtr[2]*hBPtr[2])/dy^2+(0.8660254037844386*fPtr[1]*hTPtr[1])/dy^2-(0.8660254037844386*fPtr[1]*hBPtr[1])/dy^2)+fOutPtr[3]
   fOutPtr[4] = dt*((-(1.732050807568877*fPtr[3]*hTPtr[4])/dy^2)-(1.0*fPtr[1]*hTPtr[4])/dy^2+(2.0*fPtr[1]*hPtr[4])/dy^2+(1.732050807568877*fPtr[3]*hBPtr[4])/dy^2-(1.0*fPtr[1]*hBPtr[4])/dy^2-(1.732050807568877*hTPtr[3]*fPtr[4])/dy^2+(1.732050807568877*hBPtr[3]*fPtr[4])/dy^2+(1.5*hTPtr[1]*fPtr[4])/dy^2-(3.0*hPtr[1]*fPtr[4])/dy^2+(1.5*hBPtr[1]*fPtr[4])/dy^2-(1.0*fPtr[2]*hTPtr[3])/dy^2+(2.0*fPtr[2]*hPtr[3])/dy^2-(1.0*fPtr[2]*hBPtr[3])/dy^2+(1.5*hTPtr[2]*fPtr[3])/dy^2-(3.0*hPtr[2]*fPtr[3])/dy^2+(1.5*hBPtr[2]*fPtr[3])/dy^2+(0.8660254037844386*fPtr[1]*hTPtr[2])/dy^2-(0.8660254037844386*fPtr[1]*hBPtr[2])/dy^2+(0.8660254037844386*hTPtr[1]*fPtr[2])/dy^2-(0.8660254037844386*hBPtr[1]*fPtr[2])/dy^2)+fOutPtr[4]
end

return dragStencilFunc
