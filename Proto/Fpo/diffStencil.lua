function diffStencilFunc(dt, dx, dy,
			 fPtr, fLPtr, fRPtr, fTPtr, fBPtr,
			 gPtr, gLPtr, gRPtr, gTPtr, gBPtr,
			 isTopEdge, isBotEdge, isLeftEdge, isRightEdge,
			 fOutPtr) 

if isLeftEdge then
    fOutPtr[1] = 0.5*((-0.703125*fRPtr[4]*gRPtr[4])+0.234375*fPtr[4]*gRPtr[4]+0.6495190528383289*fRPtr[3]*gRPtr[4]+0.1623797632095822*fPtr[3]*gRPtr[4]-0.234375*fRPtr[4]*gPtr[4]+0.703125*fPtr[4]*gPtr[4]+0.1623797632095822*fRPtr[3]*gPtr[4]+0.6495190528383289*fPtr[3]*gPtr[4]+0.270632938682637*gRPtr[3]*fRPtr[4]-0.270632938682637*gPtr[3]*fRPtr[4]-0.270632938682637*gRPtr[3]*fPtr[4]+0.270632938682637*gPtr[3]*fPtr[4]-0.234375*fRPtr[3]*gRPtr[3]-0.234375*fPtr[3]*gRPtr[3]+0.234375*fRPtr[3]*gPtr[3]+0.234375*fPtr[3]*gPtr[3]-0.703125*fRPtr[2]*gRPtr[2]+0.234375*fPtr[2]*gRPtr[2]+0.6495190528383289*fRPtr[1]*gRPtr[2]+0.1623797632095822*fPtr[1]*gRPtr[2]-0.234375*fRPtr[2]*gPtr[2]+0.703125*fPtr[2]*gPtr[2]+0.1623797632095822*fRPtr[1]*gPtr[2]+0.6495190528383289*fPtr[1]*gPtr[2]+0.270632938682637*gRPtr[1]*fRPtr[2]-0.270632938682637*gPtr[1]*fRPtr[2]-0.270632938682637*gRPtr[1]*fPtr[2]+0.270632938682637*gPtr[1]*fPtr[2]-0.234375*fRPtr[1]*gRPtr[1]-0.234375*fPtr[1]*gRPtr[1]+0.234375*fRPtr[1]*gPtr[1]+0.234375*fPtr[1]*gPtr[1])*dt+fOutPtr[1]
    fOutPtr[2] = 0.5*((-1.001341873125757*fRPtr[4]*gRPtr[4])+0.1894430570778459*fPtr[4]*gRPtr[4]+0.9375*fRPtr[3]*gRPtr[4]+0.09375*fPtr[3]*gRPtr[4]-0.6224557589700652*fRPtr[4]*gPtr[4]+1.434354575017976*fPtr[4]*gPtr[4]+0.46875*fRPtr[3]*gPtr[4]+1.3125*fPtr[3]*gPtr[4]+0.46875*gRPtr[3]*fRPtr[4]-0.46875*gPtr[3]*fRPtr[4]-0.46875*gRPtr[3]*fPtr[4]+0.46875*gPtr[3]*fPtr[4]-0.4059494080239556*fRPtr[3]*gRPtr[3]-0.4059494080239556*fPtr[3]*gRPtr[3]+0.4059494080239556*fRPtr[3]*gPtr[3]+0.4059494080239556*fPtr[3]*gPtr[3]-1.001341873125757*fRPtr[2]*gRPtr[2]+0.1894430570778459*fPtr[2]*gRPtr[2]+0.9375*fRPtr[1]*gRPtr[2]+0.09375*fPtr[1]*gRPtr[2]-0.6224557589700652*fRPtr[2]*gPtr[2]+1.434354575017976*fPtr[2]*gPtr[2]+0.46875*fRPtr[1]*gPtr[2]+1.3125*fPtr[1]*gPtr[2]+0.46875*gRPtr[1]*fRPtr[2]-0.46875*gPtr[1]*fRPtr[2]-0.46875*gRPtr[1]*fPtr[2]+0.46875*gPtr[1]*fPtr[2]-0.4059494080239556*fRPtr[1]*gRPtr[1]-0.4059494080239556*fPtr[1]*gRPtr[1]+0.4059494080239556*fRPtr[1]*gPtr[1]+0.4059494080239556*fPtr[1]*gPtr[1])*dt+fOutPtr[2]
    fOutPtr[3] = 0.5*((-0.703125*fRPtr[2]*gRPtr[4])+0.234375*fPtr[2]*gRPtr[4]+0.6495190528383289*fRPtr[1]*gRPtr[4]+0.1623797632095822*fPtr[1]*gRPtr[4]-0.234375*fRPtr[2]*gPtr[4]+0.703125*fPtr[2]*gPtr[4]+0.1623797632095822*fRPtr[1]*gPtr[4]+0.6495190528383289*fPtr[1]*gPtr[4]-0.703125*gRPtr[2]*fRPtr[4]-0.234375*gPtr[2]*fRPtr[4]+0.270632938682637*gRPtr[1]*fRPtr[4]-0.270632938682637*gPtr[1]*fRPtr[4]+0.234375*gRPtr[2]*fPtr[4]+0.703125*gPtr[2]*fPtr[4]-0.270632938682637*gRPtr[1]*fPtr[4]+0.270632938682637*gPtr[1]*fPtr[4]+0.270632938682637*fRPtr[2]*gRPtr[3]-0.270632938682637*fPtr[2]*gRPtr[3]-0.234375*fRPtr[1]*gRPtr[3]-0.234375*fPtr[1]*gRPtr[3]-0.270632938682637*fRPtr[2]*gPtr[3]+0.270632938682637*fPtr[2]*gPtr[3]+0.234375*fRPtr[1]*gPtr[3]+0.234375*fPtr[1]*gPtr[3]+0.6495190528383289*gRPtr[2]*fRPtr[3]+0.1623797632095822*gPtr[2]*fRPtr[3]-0.234375*gRPtr[1]*fRPtr[3]+0.234375*gPtr[1]*fRPtr[3]+0.1623797632095822*gRPtr[2]*fPtr[3]+0.6495190528383289*gPtr[2]*fPtr[3]-0.234375*gRPtr[1]*fPtr[3]+0.234375*gPtr[1]*fPtr[3])*dt+fOutPtr[3]
    fOutPtr[4] = 0.5*((-1.001341873125757*fRPtr[2]*gRPtr[4])+0.1894430570778459*fPtr[2]*gRPtr[4]+0.9375*fRPtr[1]*gRPtr[4]+0.09375*fPtr[1]*gRPtr[4]-0.6224557589700652*fRPtr[2]*gPtr[4]+1.434354575017976*fPtr[2]*gPtr[4]+0.46875*fRPtr[1]*gPtr[4]+1.3125*fPtr[1]*gPtr[4]-1.001341873125757*gRPtr[2]*fRPtr[4]-0.6224557589700652*gPtr[2]*fRPtr[4]+0.46875*gRPtr[1]*fRPtr[4]-0.46875*gPtr[1]*fRPtr[4]+0.1894430570778459*gRPtr[2]*fPtr[4]+1.434354575017976*gPtr[2]*fPtr[4]-0.46875*gRPtr[1]*fPtr[4]+0.46875*gPtr[1]*fPtr[4]+0.46875*fRPtr[2]*gRPtr[3]-0.46875*fPtr[2]*gRPtr[3]-0.4059494080239556*fRPtr[1]*gRPtr[3]-0.4059494080239556*fPtr[1]*gRPtr[3]-0.46875*fRPtr[2]*gPtr[3]+0.46875*fPtr[2]*gPtr[3]+0.4059494080239556*fRPtr[1]*gPtr[3]+0.4059494080239556*fPtr[1]*gPtr[3]+0.9375*gRPtr[2]*fRPtr[3]+0.46875*gPtr[2]*fRPtr[3]-0.4059494080239556*gRPtr[1]*fRPtr[3]+0.4059494080239556*gPtr[1]*fRPtr[3]+0.09375*gRPtr[2]*fPtr[3]+1.3125*gPtr[2]*fPtr[3]-0.4059494080239556*gRPtr[1]*fPtr[3]+0.4059494080239556*gPtr[1]*fPtr[3])*dt+fOutPtr[4]
elseif isRightEdge then
    fOutPtr[1] = 0.5*(0.703125*fPtr[4]*gPtr[4]-0.234375*fLPtr[4]*gPtr[4]-0.6495190528383289*fPtr[3]*gPtr[4]-0.1623797632095822*fLPtr[3]*gPtr[4]+0.234375*fPtr[4]*gLPtr[4]-0.703125*fLPtr[4]*gLPtr[4]-0.1623797632095822*fPtr[3]*gLPtr[4]-0.6495190528383289*fLPtr[3]*gLPtr[4]-0.270632938682637*gPtr[3]*fPtr[4]+0.270632938682637*gLPtr[3]*fPtr[4]+0.270632938682637*gPtr[3]*fLPtr[4]-0.270632938682637*gLPtr[3]*fLPtr[4]+0.234375*fPtr[3]*gPtr[3]+0.234375*fLPtr[3]*gPtr[3]-0.234375*fPtr[3]*gLPtr[3]-0.234375*fLPtr[3]*gLPtr[3]+0.703125*fPtr[2]*gPtr[2]-0.234375*fLPtr[2]*gPtr[2]-0.6495190528383289*fPtr[1]*gPtr[2]-0.1623797632095822*fLPtr[1]*gPtr[2]+0.234375*fPtr[2]*gLPtr[2]-0.703125*fLPtr[2]*gLPtr[2]-0.1623797632095822*fPtr[1]*gLPtr[2]-0.6495190528383289*fLPtr[1]*gLPtr[2]-0.270632938682637*gPtr[1]*fPtr[2]+0.270632938682637*gLPtr[1]*fPtr[2]+0.270632938682637*gPtr[1]*fLPtr[2]-0.270632938682637*gLPtr[1]*fLPtr[2]+0.234375*fPtr[1]*gPtr[1]+0.234375*fLPtr[1]*gPtr[1]-0.234375*fPtr[1]*gLPtr[1]-0.234375*fLPtr[1]*gLPtr[1])*dt+fOutPtr[1]
    fOutPtr[2] = 0.5*((-1.434354575017976*fPtr[4]*gPtr[4])+0.6224557589700652*fLPtr[4]*gPtr[4]+1.3125*fPtr[3]*gPtr[4]+0.46875*fLPtr[3]*gPtr[4]-0.1894430570778459*fPtr[4]*gLPtr[4]+1.001341873125757*fLPtr[4]*gLPtr[4]+0.09375*fPtr[3]*gLPtr[4]+0.9375*fLPtr[3]*gLPtr[4]+0.46875*gPtr[3]*fPtr[4]-0.46875*gLPtr[3]*fPtr[4]-0.46875*gPtr[3]*fLPtr[4]+0.46875*gLPtr[3]*fLPtr[4]-0.4059494080239556*fPtr[3]*gPtr[3]-0.4059494080239556*fLPtr[3]*gPtr[3]+0.4059494080239556*fPtr[3]*gLPtr[3]+0.4059494080239556*fLPtr[3]*gLPtr[3]-1.434354575017976*fPtr[2]*gPtr[2]+0.6224557589700652*fLPtr[2]*gPtr[2]+1.3125*fPtr[1]*gPtr[2]+0.46875*fLPtr[1]*gPtr[2]-0.1894430570778459*fPtr[2]*gLPtr[2]+1.001341873125757*fLPtr[2]*gLPtr[2]+0.09375*fPtr[1]*gLPtr[2]+0.9375*fLPtr[1]*gLPtr[2]+0.46875*gPtr[1]*fPtr[2]-0.46875*gLPtr[1]*fPtr[2]-0.46875*gPtr[1]*fLPtr[2]+0.46875*gLPtr[1]*fLPtr[2]-0.4059494080239556*fPtr[1]*gPtr[1]-0.4059494080239556*fLPtr[1]*gPtr[1]+0.4059494080239556*fPtr[1]*gLPtr[1]+0.4059494080239556*fLPtr[1]*gLPtr[1])*dt+fOutPtr[2]
    fOutPtr[3] = 0.5*(0.703125*fPtr[2]*gPtr[4]-0.234375*fLPtr[2]*gPtr[4]-0.6495190528383289*fPtr[1]*gPtr[4]-0.1623797632095822*fLPtr[1]*gPtr[4]+0.234375*fPtr[2]*gLPtr[4]-0.703125*fLPtr[2]*gLPtr[4]-0.1623797632095822*fPtr[1]*gLPtr[4]-0.6495190528383289*fLPtr[1]*gLPtr[4]+0.703125*gPtr[2]*fPtr[4]+0.234375*gLPtr[2]*fPtr[4]-0.270632938682637*gPtr[1]*fPtr[4]+0.270632938682637*gLPtr[1]*fPtr[4]-0.234375*gPtr[2]*fLPtr[4]-0.703125*gLPtr[2]*fLPtr[4]+0.270632938682637*gPtr[1]*fLPtr[4]-0.270632938682637*gLPtr[1]*fLPtr[4]-0.270632938682637*fPtr[2]*gPtr[3]+0.270632938682637*fLPtr[2]*gPtr[3]+0.234375*fPtr[1]*gPtr[3]+0.234375*fLPtr[1]*gPtr[3]+0.270632938682637*fPtr[2]*gLPtr[3]-0.270632938682637*fLPtr[2]*gLPtr[3]-0.234375*fPtr[1]*gLPtr[3]-0.234375*fLPtr[1]*gLPtr[3]-0.6495190528383289*gPtr[2]*fPtr[3]-0.1623797632095822*gLPtr[2]*fPtr[3]+0.234375*gPtr[1]*fPtr[3]-0.234375*gLPtr[1]*fPtr[3]-0.1623797632095822*gPtr[2]*fLPtr[3]-0.6495190528383289*gLPtr[2]*fLPtr[3]+0.234375*gPtr[1]*fLPtr[3]-0.234375*gLPtr[1]*fLPtr[3])*dt+fOutPtr[3]
    fOutPtr[4] = 0.5*((-1.434354575017976*fPtr[2]*gPtr[4])+0.6224557589700652*fLPtr[2]*gPtr[4]+1.3125*fPtr[1]*gPtr[4]+0.46875*fLPtr[1]*gPtr[4]-0.1894430570778459*fPtr[2]*gLPtr[4]+1.001341873125757*fLPtr[2]*gLPtr[4]+0.09375*fPtr[1]*gLPtr[4]+0.9375*fLPtr[1]*gLPtr[4]-1.434354575017976*gPtr[2]*fPtr[4]-0.1894430570778459*gLPtr[2]*fPtr[4]+0.46875*gPtr[1]*fPtr[4]-0.46875*gLPtr[1]*fPtr[4]+0.6224557589700652*gPtr[2]*fLPtr[4]+1.001341873125757*gLPtr[2]*fLPtr[4]-0.46875*gPtr[1]*fLPtr[4]+0.46875*gLPtr[1]*fLPtr[4]+0.46875*fPtr[2]*gPtr[3]-0.46875*fLPtr[2]*gPtr[3]-0.4059494080239556*fPtr[1]*gPtr[3]-0.4059494080239556*fLPtr[1]*gPtr[3]-0.46875*fPtr[2]*gLPtr[3]+0.46875*fLPtr[2]*gLPtr[3]+0.4059494080239556*fPtr[1]*gLPtr[3]+0.4059494080239556*fLPtr[1]*gLPtr[3]+1.3125*gPtr[2]*fPtr[3]+0.09375*gLPtr[2]*fPtr[3]-0.4059494080239556*gPtr[1]*fPtr[3]+0.4059494080239556*gLPtr[1]*fPtr[3]+0.46875*gPtr[2]*fLPtr[3]+0.9375*gLPtr[2]*fLPtr[3]-0.4059494080239556*gPtr[1]*fLPtr[3]+0.4059494080239556*gLPtr[1]*fLPtr[3])*dt+fOutPtr[4]
else
    fOutPtr[1] = 0.5*((-0.703125*fRPtr[4]*gRPtr[4])+0.234375*fPtr[4]*gRPtr[4]+0.6495190528383289*fRPtr[3]*gRPtr[4]+0.1623797632095822*fPtr[3]*gRPtr[4]-0.234375*fRPtr[4]*gPtr[4]+1.40625*fPtr[4]*gPtr[4]-0.234375*fLPtr[4]*gPtr[4]+0.1623797632095822*fRPtr[3]*gPtr[4]-0.1623797632095822*fLPtr[3]*gPtr[4]+0.234375*fPtr[4]*gLPtr[4]-0.703125*fLPtr[4]*gLPtr[4]-0.1623797632095822*fPtr[3]*gLPtr[4]-0.6495190528383289*fLPtr[3]*gLPtr[4]+0.270632938682637*gRPtr[3]*fRPtr[4]-0.270632938682637*gPtr[3]*fRPtr[4]-0.270632938682637*gRPtr[3]*fPtr[4]+0.270632938682637*gLPtr[3]*fPtr[4]+0.270632938682637*gPtr[3]*fLPtr[4]-0.270632938682637*gLPtr[3]*fLPtr[4]-0.234375*fRPtr[3]*gRPtr[3]-0.234375*fPtr[3]*gRPtr[3]+0.234375*fRPtr[3]*gPtr[3]+0.46875*fPtr[3]*gPtr[3]+0.234375*fLPtr[3]*gPtr[3]-0.234375*fPtr[3]*gLPtr[3]-0.234375*fLPtr[3]*gLPtr[3]-0.703125*fRPtr[2]*gRPtr[2]+0.234375*fPtr[2]*gRPtr[2]+0.6495190528383289*fRPtr[1]*gRPtr[2]+0.1623797632095822*fPtr[1]*gRPtr[2]-0.234375*fRPtr[2]*gPtr[2]+1.40625*fPtr[2]*gPtr[2]-0.234375*fLPtr[2]*gPtr[2]+0.1623797632095822*fRPtr[1]*gPtr[2]-0.1623797632095822*fLPtr[1]*gPtr[2]+0.234375*fPtr[2]*gLPtr[2]-0.703125*fLPtr[2]*gLPtr[2]-0.1623797632095822*fPtr[1]*gLPtr[2]-0.6495190528383289*fLPtr[1]*gLPtr[2]+0.270632938682637*gRPtr[1]*fRPtr[2]-0.270632938682637*gPtr[1]*fRPtr[2]-0.270632938682637*gRPtr[1]*fPtr[2]+0.270632938682637*gLPtr[1]*fPtr[2]+0.270632938682637*gPtr[1]*fLPtr[2]-0.270632938682637*gLPtr[1]*fLPtr[2]-0.234375*fRPtr[1]*gRPtr[1]-0.234375*fPtr[1]*gRPtr[1]+0.234375*fRPtr[1]*gPtr[1]+0.46875*fPtr[1]*gPtr[1]+0.234375*fLPtr[1]*gPtr[1]-0.234375*fPtr[1]*gLPtr[1]-0.234375*fLPtr[1]*gLPtr[1])*dt+fOutPtr[1]
    fOutPtr[2] = 0.5*((-1.001341873125757*fRPtr[4]*gRPtr[4])+0.1894430570778459*fPtr[4]*gRPtr[4]+0.9375*fRPtr[3]*gRPtr[4]+0.09375*fPtr[3]*gRPtr[4]-0.6224557589700652*fRPtr[4]*gPtr[4]+0.6224557589700652*fLPtr[4]*gPtr[4]+0.46875*fRPtr[3]*gPtr[4]+2.625*fPtr[3]*gPtr[4]+0.46875*fLPtr[3]*gPtr[4]-0.1894430570778459*fPtr[4]*gLPtr[4]+1.001341873125757*fLPtr[4]*gLPtr[4]+0.09375*fPtr[3]*gLPtr[4]+0.9375*fLPtr[3]*gLPtr[4]+0.46875*gRPtr[3]*fRPtr[4]-0.46875*gPtr[3]*fRPtr[4]-0.46875*gRPtr[3]*fPtr[4]+0.9375*gPtr[3]*fPtr[4]-0.46875*gLPtr[3]*fPtr[4]-0.46875*gPtr[3]*fLPtr[4]+0.46875*gLPtr[3]*fLPtr[4]-0.4059494080239556*fRPtr[3]*gRPtr[3]-0.4059494080239556*fPtr[3]*gRPtr[3]+0.4059494080239556*fRPtr[3]*gPtr[3]-0.4059494080239556*fLPtr[3]*gPtr[3]+0.4059494080239556*fPtr[3]*gLPtr[3]+0.4059494080239556*fLPtr[3]*gLPtr[3]-1.001341873125757*fRPtr[2]*gRPtr[2]+0.1894430570778459*fPtr[2]*gRPtr[2]+0.9375*fRPtr[1]*gRPtr[2]+0.09375*fPtr[1]*gRPtr[2]-0.6224557589700652*fRPtr[2]*gPtr[2]+0.6224557589700652*fLPtr[2]*gPtr[2]+0.46875*fRPtr[1]*gPtr[2]+2.625*fPtr[1]*gPtr[2]+0.46875*fLPtr[1]*gPtr[2]-0.1894430570778459*fPtr[2]*gLPtr[2]+1.001341873125757*fLPtr[2]*gLPtr[2]+0.09375*fPtr[1]*gLPtr[2]+0.9375*fLPtr[1]*gLPtr[2]+0.46875*gRPtr[1]*fRPtr[2]-0.46875*gPtr[1]*fRPtr[2]-0.46875*gRPtr[1]*fPtr[2]+0.9375*gPtr[1]*fPtr[2]-0.46875*gLPtr[1]*fPtr[2]-0.46875*gPtr[1]*fLPtr[2]+0.46875*gLPtr[1]*fLPtr[2]-0.4059494080239556*fRPtr[1]*gRPtr[1]-0.4059494080239556*fPtr[1]*gRPtr[1]+0.4059494080239556*fRPtr[1]*gPtr[1]-0.4059494080239556*fLPtr[1]*gPtr[1]+0.4059494080239556*fPtr[1]*gLPtr[1]+0.4059494080239556*fLPtr[1]*gLPtr[1])*dt+fOutPtr[2]
    fOutPtr[3] = 0.5*((-0.703125*fRPtr[2]*gRPtr[4])+0.234375*fPtr[2]*gRPtr[4]+0.6495190528383289*fRPtr[1]*gRPtr[4]+0.1623797632095822*fPtr[1]*gRPtr[4]-0.234375*fRPtr[2]*gPtr[4]+1.40625*fPtr[2]*gPtr[4]-0.234375*fLPtr[2]*gPtr[4]+0.1623797632095822*fRPtr[1]*gPtr[4]-0.1623797632095822*fLPtr[1]*gPtr[4]+0.234375*fPtr[2]*gLPtr[4]-0.703125*fLPtr[2]*gLPtr[4]-0.1623797632095822*fPtr[1]*gLPtr[4]-0.6495190528383289*fLPtr[1]*gLPtr[4]-0.703125*gRPtr[2]*fRPtr[4]-0.234375*gPtr[2]*fRPtr[4]+0.270632938682637*gRPtr[1]*fRPtr[4]-0.270632938682637*gPtr[1]*fRPtr[4]+0.234375*gRPtr[2]*fPtr[4]+1.40625*gPtr[2]*fPtr[4]+0.234375*gLPtr[2]*fPtr[4]-0.270632938682637*gRPtr[1]*fPtr[4]+0.270632938682637*gLPtr[1]*fPtr[4]-0.234375*gPtr[2]*fLPtr[4]-0.703125*gLPtr[2]*fLPtr[4]+0.270632938682637*gPtr[1]*fLPtr[4]-0.270632938682637*gLPtr[1]*fLPtr[4]+0.270632938682637*fRPtr[2]*gRPtr[3]-0.270632938682637*fPtr[2]*gRPtr[3]-0.234375*fRPtr[1]*gRPtr[3]-0.234375*fPtr[1]*gRPtr[3]-0.270632938682637*fRPtr[2]*gPtr[3]+0.270632938682637*fLPtr[2]*gPtr[3]+0.234375*fRPtr[1]*gPtr[3]+0.46875*fPtr[1]*gPtr[3]+0.234375*fLPtr[1]*gPtr[3]+0.270632938682637*fPtr[2]*gLPtr[3]-0.270632938682637*fLPtr[2]*gLPtr[3]-0.234375*fPtr[1]*gLPtr[3]-0.234375*fLPtr[1]*gLPtr[3]+0.6495190528383289*gRPtr[2]*fRPtr[3]+0.1623797632095822*gPtr[2]*fRPtr[3]-0.234375*gRPtr[1]*fRPtr[3]+0.234375*gPtr[1]*fRPtr[3]+0.1623797632095822*gRPtr[2]*fPtr[3]-0.1623797632095822*gLPtr[2]*fPtr[3]-0.234375*gRPtr[1]*fPtr[3]+0.46875*gPtr[1]*fPtr[3]-0.234375*gLPtr[1]*fPtr[3]-0.1623797632095822*gPtr[2]*fLPtr[3]-0.6495190528383289*gLPtr[2]*fLPtr[3]+0.234375*gPtr[1]*fLPtr[3]-0.234375*gLPtr[1]*fLPtr[3])*dt+fOutPtr[3]
    fOutPtr[4] = 0.5*((-1.001341873125757*fRPtr[2]*gRPtr[4])+0.1894430570778459*fPtr[2]*gRPtr[4]+0.9375*fRPtr[1]*gRPtr[4]+0.09375*fPtr[1]*gRPtr[4]-0.6224557589700652*fRPtr[2]*gPtr[4]+0.6224557589700652*fLPtr[2]*gPtr[4]+0.46875*fRPtr[1]*gPtr[4]+2.625*fPtr[1]*gPtr[4]+0.46875*fLPtr[1]*gPtr[4]-0.1894430570778459*fPtr[2]*gLPtr[4]+1.001341873125757*fLPtr[2]*gLPtr[4]+0.09375*fPtr[1]*gLPtr[4]+0.9375*fLPtr[1]*gLPtr[4]-1.001341873125757*gRPtr[2]*fRPtr[4]-0.6224557589700652*gPtr[2]*fRPtr[4]+0.46875*gRPtr[1]*fRPtr[4]-0.46875*gPtr[1]*fRPtr[4]+0.1894430570778459*gRPtr[2]*fPtr[4]-0.1894430570778459*gLPtr[2]*fPtr[4]-0.46875*gRPtr[1]*fPtr[4]+0.9375*gPtr[1]*fPtr[4]-0.46875*gLPtr[1]*fPtr[4]+0.6224557589700652*gPtr[2]*fLPtr[4]+1.001341873125757*gLPtr[2]*fLPtr[4]-0.46875*gPtr[1]*fLPtr[4]+0.46875*gLPtr[1]*fLPtr[4]+0.46875*fRPtr[2]*gRPtr[3]-0.46875*fPtr[2]*gRPtr[3]-0.4059494080239556*fRPtr[1]*gRPtr[3]-0.4059494080239556*fPtr[1]*gRPtr[3]-0.46875*fRPtr[2]*gPtr[3]+0.9375*fPtr[2]*gPtr[3]-0.46875*fLPtr[2]*gPtr[3]+0.4059494080239556*fRPtr[1]*gPtr[3]-0.4059494080239556*fLPtr[1]*gPtr[3]-0.46875*fPtr[2]*gLPtr[3]+0.46875*fLPtr[2]*gLPtr[3]+0.4059494080239556*fPtr[1]*gLPtr[3]+0.4059494080239556*fLPtr[1]*gLPtr[3]+0.9375*gRPtr[2]*fRPtr[3]+0.46875*gPtr[2]*fRPtr[3]-0.4059494080239556*gRPtr[1]*fRPtr[3]+0.4059494080239556*gPtr[1]*fRPtr[3]+0.09375*gRPtr[2]*fPtr[3]+2.625*gPtr[2]*fPtr[3]+0.09375*gLPtr[2]*fPtr[3]-0.4059494080239556*gRPtr[1]*fPtr[3]+0.4059494080239556*gLPtr[1]*fPtr[3]+0.46875*gPtr[2]*fLPtr[3]+0.9375*gLPtr[2]*fLPtr[3]-0.4059494080239556*gPtr[1]*fLPtr[3]+0.4059494080239556*gLPtr[1]*fLPtr[3])*dt+fOutPtr[4]
end

if isTopEdge then
    fOutPtr[1] = 0.5*(0.703125*fPtr[4]*gPtr[4]-0.234375*fBPtr[4]*gPtr[4]-0.6495190528383289*fPtr[2]*gPtr[4]-0.1623797632095822*fBPtr[2]*gPtr[4]+0.234375*fPtr[4]*gBPtr[4]-0.703125*fBPtr[4]*gBPtr[4]-0.1623797632095822*fPtr[2]*gBPtr[4]-0.6495190528383289*fBPtr[2]*gBPtr[4]-0.270632938682637*gPtr[2]*fPtr[4]+0.270632938682637*gBPtr[2]*fPtr[4]+0.270632938682637*gPtr[2]*fBPtr[4]-0.270632938682637*gBPtr[2]*fBPtr[4]+0.703125*fPtr[3]*gPtr[3]-0.234375*fBPtr[3]*gPtr[3]-0.6495190528383289*fPtr[1]*gPtr[3]-0.1623797632095822*fBPtr[1]*gPtr[3]+0.234375*fPtr[3]*gBPtr[3]-0.703125*fBPtr[3]*gBPtr[3]-0.1623797632095822*fPtr[1]*gBPtr[3]-0.6495190528383289*fBPtr[1]*gBPtr[3]-0.270632938682637*gPtr[1]*fPtr[3]+0.270632938682637*gBPtr[1]*fPtr[3]+0.270632938682637*gPtr[1]*fBPtr[3]-0.270632938682637*gBPtr[1]*fBPtr[3]+0.234375*fPtr[2]*gPtr[2]+0.234375*fBPtr[2]*gPtr[2]-0.234375*fPtr[2]*gBPtr[2]-0.234375*fBPtr[2]*gBPtr[2]+0.234375*fPtr[1]*gPtr[1]+0.234375*fBPtr[1]*gPtr[1]-0.234375*fPtr[1]*gBPtr[1]-0.234375*fBPtr[1]*gBPtr[1])*dt+fOutPtr[1]
    fOutPtr[2] = 0.5*(0.703125*fPtr[3]*gPtr[4]-0.234375*fBPtr[3]*gPtr[4]-0.6495190528383289*fPtr[1]*gPtr[4]-0.1623797632095822*fBPtr[1]*gPtr[4]+0.234375*fPtr[3]*gBPtr[4]-0.703125*fBPtr[3]*gBPtr[4]-0.1623797632095822*fPtr[1]*gBPtr[4]-0.6495190528383289*fBPtr[1]*gBPtr[4]+0.703125*gPtr[3]*fPtr[4]+0.234375*gBPtr[3]*fPtr[4]-0.270632938682637*gPtr[1]*fPtr[4]+0.270632938682637*gBPtr[1]*fPtr[4]-0.234375*gPtr[3]*fBPtr[4]-0.703125*gBPtr[3]*fBPtr[4]+0.270632938682637*gPtr[1]*fBPtr[4]-0.270632938682637*gBPtr[1]*fBPtr[4]-0.6495190528383289*fPtr[2]*gPtr[3]-0.1623797632095822*fBPtr[2]*gPtr[3]-0.1623797632095822*fPtr[2]*gBPtr[3]-0.6495190528383289*fBPtr[2]*gBPtr[3]-0.270632938682637*gPtr[2]*fPtr[3]+0.270632938682637*gBPtr[2]*fPtr[3]+0.270632938682637*gPtr[2]*fBPtr[3]-0.270632938682637*gBPtr[2]*fBPtr[3]+0.234375*fPtr[1]*gPtr[2]+0.234375*fBPtr[1]*gPtr[2]-0.234375*fPtr[1]*gBPtr[2]-0.234375*fBPtr[1]*gBPtr[2]+0.234375*gPtr[1]*fPtr[2]-0.234375*gBPtr[1]*fPtr[2]+0.234375*gPtr[1]*fBPtr[2]-0.234375*gBPtr[1]*fBPtr[2])*dt+fOutPtr[2]
    fOutPtr[3] = 0.5*((-1.434354575017976*fPtr[4]*gPtr[4])+0.6224557589700652*fBPtr[4]*gPtr[4]+1.3125*fPtr[2]*gPtr[4]+0.46875*fBPtr[2]*gPtr[4]-0.1894430570778459*fPtr[4]*gBPtr[4]+1.001341873125757*fBPtr[4]*gBPtr[4]+0.09375*fPtr[2]*gBPtr[4]+0.9375*fBPtr[2]*gBPtr[4]+0.46875*gPtr[2]*fPtr[4]-0.46875*gBPtr[2]*fPtr[4]-0.46875*gPtr[2]*fBPtr[4]+0.46875*gBPtr[2]*fBPtr[4]-1.434354575017976*fPtr[3]*gPtr[3]+0.6224557589700652*fBPtr[3]*gPtr[3]+1.3125*fPtr[1]*gPtr[3]+0.46875*fBPtr[1]*gPtr[3]-0.1894430570778459*fPtr[3]*gBPtr[3]+1.001341873125757*fBPtr[3]*gBPtr[3]+0.09375*fPtr[1]*gBPtr[3]+0.9375*fBPtr[1]*gBPtr[3]+0.46875*gPtr[1]*fPtr[3]-0.46875*gBPtr[1]*fPtr[3]-0.46875*gPtr[1]*fBPtr[3]+0.46875*gBPtr[1]*fBPtr[3]-0.4059494080239556*fPtr[2]*gPtr[2]-0.4059494080239556*fBPtr[2]*gPtr[2]+0.4059494080239556*fPtr[2]*gBPtr[2]+0.4059494080239556*fBPtr[2]*gBPtr[2]-0.4059494080239556*fPtr[1]*gPtr[1]-0.4059494080239556*fBPtr[1]*gPtr[1]+0.4059494080239556*fPtr[1]*gBPtr[1]+0.4059494080239556*fBPtr[1]*gBPtr[1])*dt+fOutPtr[3]
    fOutPtr[4] = 0.5*((-1.434354575017976*fPtr[3]*gPtr[4])+0.6224557589700652*fBPtr[3]*gPtr[4]+1.3125*fPtr[1]*gPtr[4]+0.46875*fBPtr[1]*gPtr[4]-0.1894430570778459*fPtr[3]*gBPtr[4]+1.001341873125757*fBPtr[3]*gBPtr[4]+0.09375*fPtr[1]*gBPtr[4]+0.9375*fBPtr[1]*gBPtr[4]-1.434354575017976*gPtr[3]*fPtr[4]-0.1894430570778459*gBPtr[3]*fPtr[4]+0.46875*gPtr[1]*fPtr[4]-0.46875*gBPtr[1]*fPtr[4]+0.6224557589700652*gPtr[3]*fBPtr[4]+1.001341873125757*gBPtr[3]*fBPtr[4]-0.46875*gPtr[1]*fBPtr[4]+0.46875*gBPtr[1]*fBPtr[4]+1.3125*fPtr[2]*gPtr[3]+0.46875*fBPtr[2]*gPtr[3]+0.09375*fPtr[2]*gBPtr[3]+0.9375*fBPtr[2]*gBPtr[3]+0.46875*gPtr[2]*fPtr[3]-0.46875*gBPtr[2]*fPtr[3]-0.46875*gPtr[2]*fBPtr[3]+0.46875*gBPtr[2]*fBPtr[3]-0.4059494080239556*fPtr[1]*gPtr[2]-0.4059494080239556*fBPtr[1]*gPtr[2]+0.4059494080239556*fPtr[1]*gBPtr[2]+0.4059494080239556*fBPtr[1]*gBPtr[2]-0.4059494080239556*gPtr[1]*fPtr[2]+0.4059494080239556*gBPtr[1]*fPtr[2]-0.4059494080239556*gPtr[1]*fBPtr[2]+0.4059494080239556*gBPtr[1]*fBPtr[2])*dt+fOutPtr[4]
elseif isBotEdge then
    fOutPtr[1] = 0.5*((-0.703125*fTPtr[4]*gTPtr[4])+0.234375*fPtr[4]*gTPtr[4]+0.6495190528383289*fTPtr[2]*gTPtr[4]+0.1623797632095822*fPtr[2]*gTPtr[4]-0.234375*fTPtr[4]*gPtr[4]+0.703125*fPtr[4]*gPtr[4]+0.1623797632095822*fTPtr[2]*gPtr[4]+0.6495190528383289*fPtr[2]*gPtr[4]+0.270632938682637*gTPtr[2]*fTPtr[4]-0.270632938682637*gPtr[2]*fTPtr[4]-0.270632938682637*gTPtr[2]*fPtr[4]+0.270632938682637*gPtr[2]*fPtr[4]-0.703125*fTPtr[3]*gTPtr[3]+0.234375*fPtr[3]*gTPtr[3]+0.6495190528383289*fTPtr[1]*gTPtr[3]+0.1623797632095822*fPtr[1]*gTPtr[3]-0.234375*fTPtr[3]*gPtr[3]+0.703125*fPtr[3]*gPtr[3]+0.1623797632095822*fTPtr[1]*gPtr[3]+0.6495190528383289*fPtr[1]*gPtr[3]+0.270632938682637*gTPtr[1]*fTPtr[3]-0.270632938682637*gPtr[1]*fTPtr[3]-0.270632938682637*gTPtr[1]*fPtr[3]+0.270632938682637*gPtr[1]*fPtr[3]-0.234375*fTPtr[2]*gTPtr[2]-0.234375*fPtr[2]*gTPtr[2]+0.234375*fTPtr[2]*gPtr[2]+0.234375*fPtr[2]*gPtr[2]-0.234375*fTPtr[1]*gTPtr[1]-0.234375*fPtr[1]*gTPtr[1]+0.234375*fTPtr[1]*gPtr[1]+0.234375*fPtr[1]*gPtr[1])*dt+fOutPtr[1]
    fOutPtr[2] = 0.5*((-0.703125*fTPtr[3]*gTPtr[4])+0.234375*fPtr[3]*gTPtr[4]+0.6495190528383289*fTPtr[1]*gTPtr[4]+0.1623797632095822*fPtr[1]*gTPtr[4]-0.234375*fTPtr[3]*gPtr[4]+0.703125*fPtr[3]*gPtr[4]+0.1623797632095822*fTPtr[1]*gPtr[4]+0.6495190528383289*fPtr[1]*gPtr[4]-0.703125*gTPtr[3]*fTPtr[4]-0.234375*gPtr[3]*fTPtr[4]+0.270632938682637*gTPtr[1]*fTPtr[4]-0.270632938682637*gPtr[1]*fTPtr[4]+0.234375*gTPtr[3]*fPtr[4]+0.703125*gPtr[3]*fPtr[4]-0.270632938682637*gTPtr[1]*fPtr[4]+0.270632938682637*gPtr[1]*fPtr[4]+0.6495190528383289*fTPtr[2]*gTPtr[3]+0.1623797632095822*fPtr[2]*gTPtr[3]+0.1623797632095822*fTPtr[2]*gPtr[3]+0.6495190528383289*fPtr[2]*gPtr[3]+0.270632938682637*gTPtr[2]*fTPtr[3]-0.270632938682637*gPtr[2]*fTPtr[3]-0.270632938682637*gTPtr[2]*fPtr[3]+0.270632938682637*gPtr[2]*fPtr[3]-0.234375*fTPtr[1]*gTPtr[2]-0.234375*fPtr[1]*gTPtr[2]+0.234375*fTPtr[1]*gPtr[2]+0.234375*fPtr[1]*gPtr[2]-0.234375*gTPtr[1]*fTPtr[2]+0.234375*gPtr[1]*fTPtr[2]-0.234375*gTPtr[1]*fPtr[2]+0.234375*gPtr[1]*fPtr[2])*dt+fOutPtr[2]
    fOutPtr[3] = 0.5*((-1.001341873125757*fTPtr[4]*gTPtr[4])+0.1894430570778459*fPtr[4]*gTPtr[4]+0.9375*fTPtr[2]*gTPtr[4]+0.09375*fPtr[2]*gTPtr[4]-0.6224557589700652*fTPtr[4]*gPtr[4]+1.434354575017976*fPtr[4]*gPtr[4]+0.46875*fTPtr[2]*gPtr[4]+1.3125*fPtr[2]*gPtr[4]+0.46875*gTPtr[2]*fTPtr[4]-0.46875*gPtr[2]*fTPtr[4]-0.46875*gTPtr[2]*fPtr[4]+0.46875*gPtr[2]*fPtr[4]-1.001341873125757*fTPtr[3]*gTPtr[3]+0.1894430570778459*fPtr[3]*gTPtr[3]+0.9375*fTPtr[1]*gTPtr[3]+0.09375*fPtr[1]*gTPtr[3]-0.6224557589700652*fTPtr[3]*gPtr[3]+1.434354575017976*fPtr[3]*gPtr[3]+0.46875*fTPtr[1]*gPtr[3]+1.3125*fPtr[1]*gPtr[3]+0.46875*gTPtr[1]*fTPtr[3]-0.46875*gPtr[1]*fTPtr[3]-0.46875*gTPtr[1]*fPtr[3]+0.46875*gPtr[1]*fPtr[3]-0.4059494080239556*fTPtr[2]*gTPtr[2]-0.4059494080239556*fPtr[2]*gTPtr[2]+0.4059494080239556*fTPtr[2]*gPtr[2]+0.4059494080239556*fPtr[2]*gPtr[2]-0.4059494080239556*fTPtr[1]*gTPtr[1]-0.4059494080239556*fPtr[1]*gTPtr[1]+0.4059494080239556*fTPtr[1]*gPtr[1]+0.4059494080239556*fPtr[1]*gPtr[1])*dt+fOutPtr[3]
    fOutPtr[4] = 0.5*((-1.001341873125757*fTPtr[3]*gTPtr[4])+0.1894430570778459*fPtr[3]*gTPtr[4]+0.9375*fTPtr[1]*gTPtr[4]+0.09375*fPtr[1]*gTPtr[4]-0.6224557589700652*fTPtr[3]*gPtr[4]+1.434354575017976*fPtr[3]*gPtr[4]+0.46875*fTPtr[1]*gPtr[4]+1.3125*fPtr[1]*gPtr[4]-1.001341873125757*gTPtr[3]*fTPtr[4]-0.6224557589700652*gPtr[3]*fTPtr[4]+0.46875*gTPtr[1]*fTPtr[4]-0.46875*gPtr[1]*fTPtr[4]+0.1894430570778459*gTPtr[3]*fPtr[4]+1.434354575017976*gPtr[3]*fPtr[4]-0.46875*gTPtr[1]*fPtr[4]+0.46875*gPtr[1]*fPtr[4]+0.9375*fTPtr[2]*gTPtr[3]+0.09375*fPtr[2]*gTPtr[3]+0.46875*fTPtr[2]*gPtr[3]+1.3125*fPtr[2]*gPtr[3]+0.46875*gTPtr[2]*fTPtr[3]-0.46875*gPtr[2]*fTPtr[3]-0.46875*gTPtr[2]*fPtr[3]+0.46875*gPtr[2]*fPtr[3]-0.4059494080239556*fTPtr[1]*gTPtr[2]-0.4059494080239556*fPtr[1]*gTPtr[2]+0.4059494080239556*fTPtr[1]*gPtr[2]+0.4059494080239556*fPtr[1]*gPtr[2]-0.4059494080239556*gTPtr[1]*fTPtr[2]+0.4059494080239556*gPtr[1]*fTPtr[2]-0.4059494080239556*gTPtr[1]*fPtr[2]+0.4059494080239556*gPtr[1]*fPtr[2])*dt+fOutPtr[4]
else
    fOutPtr[1] = 0.5*((-0.703125*fTPtr[4]*gTPtr[4])+0.234375*fPtr[4]*gTPtr[4]+0.6495190528383289*fTPtr[2]*gTPtr[4]+0.1623797632095822*fPtr[2]*gTPtr[4]-0.234375*fTPtr[4]*gPtr[4]+1.40625*fPtr[4]*gPtr[4]-0.234375*fBPtr[4]*gPtr[4]+0.1623797632095822*fTPtr[2]*gPtr[4]-0.1623797632095822*fBPtr[2]*gPtr[4]+0.234375*fPtr[4]*gBPtr[4]-0.703125*fBPtr[4]*gBPtr[4]-0.1623797632095822*fPtr[2]*gBPtr[4]-0.6495190528383289*fBPtr[2]*gBPtr[4]+0.270632938682637*gTPtr[2]*fTPtr[4]-0.270632938682637*gPtr[2]*fTPtr[4]-0.270632938682637*gTPtr[2]*fPtr[4]+0.270632938682637*gBPtr[2]*fPtr[4]+0.270632938682637*gPtr[2]*fBPtr[4]-0.270632938682637*gBPtr[2]*fBPtr[4]-0.703125*fTPtr[3]*gTPtr[3]+0.234375*fPtr[3]*gTPtr[3]+0.6495190528383289*fTPtr[1]*gTPtr[3]+0.1623797632095822*fPtr[1]*gTPtr[3]-0.234375*fTPtr[3]*gPtr[3]+1.40625*fPtr[3]*gPtr[3]-0.234375*fBPtr[3]*gPtr[3]+0.1623797632095822*fTPtr[1]*gPtr[3]-0.1623797632095822*fBPtr[1]*gPtr[3]+0.234375*fPtr[3]*gBPtr[3]-0.703125*fBPtr[3]*gBPtr[3]-0.1623797632095822*fPtr[1]*gBPtr[3]-0.6495190528383289*fBPtr[1]*gBPtr[3]+0.270632938682637*gTPtr[1]*fTPtr[3]-0.270632938682637*gPtr[1]*fTPtr[3]-0.270632938682637*gTPtr[1]*fPtr[3]+0.270632938682637*gBPtr[1]*fPtr[3]+0.270632938682637*gPtr[1]*fBPtr[3]-0.270632938682637*gBPtr[1]*fBPtr[3]-0.234375*fTPtr[2]*gTPtr[2]-0.234375*fPtr[2]*gTPtr[2]+0.234375*fTPtr[2]*gPtr[2]+0.46875*fPtr[2]*gPtr[2]+0.234375*fBPtr[2]*gPtr[2]-0.234375*fPtr[2]*gBPtr[2]-0.234375*fBPtr[2]*gBPtr[2]-0.234375*fTPtr[1]*gTPtr[1]-0.234375*fPtr[1]*gTPtr[1]+0.234375*fTPtr[1]*gPtr[1]+0.46875*fPtr[1]*gPtr[1]+0.234375*fBPtr[1]*gPtr[1]-0.234375*fPtr[1]*gBPtr[1]-0.234375*fBPtr[1]*gBPtr[1])*dt+fOutPtr[1]
    fOutPtr[2] = 0.5*((-0.703125*fTPtr[3]*gTPtr[4])+0.234375*fPtr[3]*gTPtr[4]+0.6495190528383289*fTPtr[1]*gTPtr[4]+0.1623797632095822*fPtr[1]*gTPtr[4]-0.234375*fTPtr[3]*gPtr[4]+1.40625*fPtr[3]*gPtr[4]-0.234375*fBPtr[3]*gPtr[4]+0.1623797632095822*fTPtr[1]*gPtr[4]-0.1623797632095822*fBPtr[1]*gPtr[4]+0.234375*fPtr[3]*gBPtr[4]-0.703125*fBPtr[3]*gBPtr[4]-0.1623797632095822*fPtr[1]*gBPtr[4]-0.6495190528383289*fBPtr[1]*gBPtr[4]-0.703125*gTPtr[3]*fTPtr[4]-0.234375*gPtr[3]*fTPtr[4]+0.270632938682637*gTPtr[1]*fTPtr[4]-0.270632938682637*gPtr[1]*fTPtr[4]+0.234375*gTPtr[3]*fPtr[4]+1.40625*gPtr[3]*fPtr[4]+0.234375*gBPtr[3]*fPtr[4]-0.270632938682637*gTPtr[1]*fPtr[4]+0.270632938682637*gBPtr[1]*fPtr[4]-0.234375*gPtr[3]*fBPtr[4]-0.703125*gBPtr[3]*fBPtr[4]+0.270632938682637*gPtr[1]*fBPtr[4]-0.270632938682637*gBPtr[1]*fBPtr[4]+0.6495190528383289*fTPtr[2]*gTPtr[3]+0.1623797632095822*fPtr[2]*gTPtr[3]+0.1623797632095822*fTPtr[2]*gPtr[3]-0.1623797632095822*fBPtr[2]*gPtr[3]-0.1623797632095822*fPtr[2]*gBPtr[3]-0.6495190528383289*fBPtr[2]*gBPtr[3]+0.270632938682637*gTPtr[2]*fTPtr[3]-0.270632938682637*gPtr[2]*fTPtr[3]-0.270632938682637*gTPtr[2]*fPtr[3]+0.270632938682637*gBPtr[2]*fPtr[3]+0.270632938682637*gPtr[2]*fBPtr[3]-0.270632938682637*gBPtr[2]*fBPtr[3]-0.234375*fTPtr[1]*gTPtr[2]-0.234375*fPtr[1]*gTPtr[2]+0.234375*fTPtr[1]*gPtr[2]+0.46875*fPtr[1]*gPtr[2]+0.234375*fBPtr[1]*gPtr[2]-0.234375*fPtr[1]*gBPtr[2]-0.234375*fBPtr[1]*gBPtr[2]-0.234375*gTPtr[1]*fTPtr[2]+0.234375*gPtr[1]*fTPtr[2]-0.234375*gTPtr[1]*fPtr[2]+0.46875*gPtr[1]*fPtr[2]-0.234375*gBPtr[1]*fPtr[2]+0.234375*gPtr[1]*fBPtr[2]-0.234375*gBPtr[1]*fBPtr[2])*dt+fOutPtr[2]
    fOutPtr[3] = 0.5*((-1.001341873125757*fTPtr[4]*gTPtr[4])+0.1894430570778459*fPtr[4]*gTPtr[4]+0.9375*fTPtr[2]*gTPtr[4]+0.09375*fPtr[2]*gTPtr[4]-0.6224557589700652*fTPtr[4]*gPtr[4]+0.6224557589700652*fBPtr[4]*gPtr[4]+0.46875*fTPtr[2]*gPtr[4]+2.625*fPtr[2]*gPtr[4]+0.46875*fBPtr[2]*gPtr[4]-0.1894430570778459*fPtr[4]*gBPtr[4]+1.001341873125757*fBPtr[4]*gBPtr[4]+0.09375*fPtr[2]*gBPtr[4]+0.9375*fBPtr[2]*gBPtr[4]+0.46875*gTPtr[2]*fTPtr[4]-0.46875*gPtr[2]*fTPtr[4]-0.46875*gTPtr[2]*fPtr[4]+0.9375*gPtr[2]*fPtr[4]-0.46875*gBPtr[2]*fPtr[4]-0.46875*gPtr[2]*fBPtr[4]+0.46875*gBPtr[2]*fBPtr[4]-1.001341873125757*fTPtr[3]*gTPtr[3]+0.1894430570778459*fPtr[3]*gTPtr[3]+0.9375*fTPtr[1]*gTPtr[3]+0.09375*fPtr[1]*gTPtr[3]-0.6224557589700652*fTPtr[3]*gPtr[3]+0.6224557589700652*fBPtr[3]*gPtr[3]+0.46875*fTPtr[1]*gPtr[3]+2.625*fPtr[1]*gPtr[3]+0.46875*fBPtr[1]*gPtr[3]-0.1894430570778459*fPtr[3]*gBPtr[3]+1.001341873125757*fBPtr[3]*gBPtr[3]+0.09375*fPtr[1]*gBPtr[3]+0.9375*fBPtr[1]*gBPtr[3]+0.46875*gTPtr[1]*fTPtr[3]-0.46875*gPtr[1]*fTPtr[3]-0.46875*gTPtr[1]*fPtr[3]+0.9375*gPtr[1]*fPtr[3]-0.46875*gBPtr[1]*fPtr[3]-0.46875*gPtr[1]*fBPtr[3]+0.46875*gBPtr[1]*fBPtr[3]-0.4059494080239556*fTPtr[2]*gTPtr[2]-0.4059494080239556*fPtr[2]*gTPtr[2]+0.4059494080239556*fTPtr[2]*gPtr[2]-0.4059494080239556*fBPtr[2]*gPtr[2]+0.4059494080239556*fPtr[2]*gBPtr[2]+0.4059494080239556*fBPtr[2]*gBPtr[2]-0.4059494080239556*fTPtr[1]*gTPtr[1]-0.4059494080239556*fPtr[1]*gTPtr[1]+0.4059494080239556*fTPtr[1]*gPtr[1]-0.4059494080239556*fBPtr[1]*gPtr[1]+0.4059494080239556*fPtr[1]*gBPtr[1]+0.4059494080239556*fBPtr[1]*gBPtr[1])*dt+fOutPtr[3]
    fOutPtr[4] = 0.5*((-1.001341873125757*fTPtr[3]*gTPtr[4])+0.1894430570778459*fPtr[3]*gTPtr[4]+0.9375*fTPtr[1]*gTPtr[4]+0.09375*fPtr[1]*gTPtr[4]-0.6224557589700652*fTPtr[3]*gPtr[4]+0.6224557589700652*fBPtr[3]*gPtr[4]+0.46875*fTPtr[1]*gPtr[4]+2.625*fPtr[1]*gPtr[4]+0.46875*fBPtr[1]*gPtr[4]-0.1894430570778459*fPtr[3]*gBPtr[4]+1.001341873125757*fBPtr[3]*gBPtr[4]+0.09375*fPtr[1]*gBPtr[4]+0.9375*fBPtr[1]*gBPtr[4]-1.001341873125757*gTPtr[3]*fTPtr[4]-0.6224557589700652*gPtr[3]*fTPtr[4]+0.46875*gTPtr[1]*fTPtr[4]-0.46875*gPtr[1]*fTPtr[4]+0.1894430570778459*gTPtr[3]*fPtr[4]-0.1894430570778459*gBPtr[3]*fPtr[4]-0.46875*gTPtr[1]*fPtr[4]+0.9375*gPtr[1]*fPtr[4]-0.46875*gBPtr[1]*fPtr[4]+0.6224557589700652*gPtr[3]*fBPtr[4]+1.001341873125757*gBPtr[3]*fBPtr[4]-0.46875*gPtr[1]*fBPtr[4]+0.46875*gBPtr[1]*fBPtr[4]+0.9375*fTPtr[2]*gTPtr[3]+0.09375*fPtr[2]*gTPtr[3]+0.46875*fTPtr[2]*gPtr[3]+2.625*fPtr[2]*gPtr[3]+0.46875*fBPtr[2]*gPtr[3]+0.09375*fPtr[2]*gBPtr[3]+0.9375*fBPtr[2]*gBPtr[3]+0.46875*gTPtr[2]*fTPtr[3]-0.46875*gPtr[2]*fTPtr[3]-0.46875*gTPtr[2]*fPtr[3]+0.9375*gPtr[2]*fPtr[3]-0.46875*gBPtr[2]*fPtr[3]-0.46875*gPtr[2]*fBPtr[3]+0.46875*gBPtr[2]*fBPtr[3]-0.4059494080239556*fTPtr[1]*gTPtr[2]-0.4059494080239556*fPtr[1]*gTPtr[2]+0.4059494080239556*fTPtr[1]*gPtr[2]-0.4059494080239556*fBPtr[1]*gPtr[2]+0.4059494080239556*fPtr[1]*gBPtr[2]+0.4059494080239556*fBPtr[1]*gBPtr[2]-0.4059494080239556*gTPtr[1]*fTPtr[2]+0.4059494080239556*gPtr[1]*fTPtr[2]-0.4059494080239556*gTPtr[1]*fPtr[2]+0.4059494080239556*gBPtr[1]*fPtr[2]-0.4059494080239556*gPtr[1]*fBPtr[2]+0.4059494080239556*gBPtr[1]*fBPtr[2])*dt+fOutPtr[4]
end




end

return diffStencilFunc
   
