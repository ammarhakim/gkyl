#include <TwistShiftModDecl.h> 
 
void twistShift_xLimDG2xSerP1_yShP1(const double sFac, const double *xLimLo, const double *xLimUp, const double yLimLo, const double yLimUp, const double dyDo, const double yOff, const double *ySh, tsStruct *tsData, const int xIdx, const bool pushNew) 
{ 
  // sFac:   scale factor, typically +/- 1.0.
  // xLimUp: 1D DG expansion of the function xLimLo(y) giving the lower limit of the x integral.
  // xLimLo: 1D DG expansion of the function xLimUp(y) giving the upper limit of the x integral.
  // yLimLo: lower limit of the y integral in [-1,1] logical space.
  // yLimUp: upper limit of the y integral in [-1,1] logical space.
  // dyDo:   y cell length of the donor cell.
  // yOff:   yOffset between the donor and target cells (in the direction of the shift).
  // ySh:    yShift translated to [-1,1] logical space.
  // tsData: twist-shift matrices and vectors.
  // xIdx:   x-index of the cell.
  // pushNew: push_back a new matrix (true) or add contribution to the last matrix (false).

  // Length of the subregion in which the DG expansion of the yLimLo/yLimUp functions are defined.
  double dyLim = yLimUp-yLimLo;

  // Logical center of the subregion in which the DG expansion of the yLimLo/yLimUp functions are defined.
  double ycLim = 0.5*(yLimUp+yLimLo);

  tsData->mat = Eigen::MatrixXd::Zero(4,4);
  double yLimLoR2 = std::pow(yLimLo,2);
  double yLimLoR3 = std::pow(yLimLo,3);
  double yLimLoR4 = std::pow(yLimLo,4);
  double yLimLoR5 = std::pow(yLimLo,5);
  double yLimLoR6 = std::pow(yLimLo,6);
  double yLimUpR2 = std::pow(yLimUp,2);
  double yLimUpR3 = std::pow(yLimUp,3);
  double yLimUpR4 = std::pow(yLimUp,4);
  double yLimUpR5 = std::pow(yLimUp,5);
  double yLimUpR6 = std::pow(yLimUp,6);
  double dyLimR2 = std::pow(dyLim,2);
  double dyLimR3 = std::pow(dyLim,3);
  double dyLimR4 = std::pow(dyLim,4);
  double ycLimR2 = std::pow(ycLim,2);
  double ycLimR3 = std::pow(ycLim,3);
  double ycLimR4 = std::pow(ycLim,4);
  double xLimLo0R2 = std::pow(xLimLo[0],2);
  double xLimLo1R2 = std::pow(xLimLo[1],2);
  double xLimLo0R3 = std::pow(xLimLo[0],3);
  double xLimLo1R3 = std::pow(xLimLo[1],3);
  double xLimLo0R4 = std::pow(xLimLo[0],4);
  double xLimLo1R4 = std::pow(xLimLo[1],4);
  double xLimUp0R2 = std::pow(xLimUp[0],2);
  double xLimUp1R2 = std::pow(xLimUp[1],2);
  double xLimUp0R3 = std::pow(xLimUp[0],3);
  double xLimUp1R3 = std::pow(xLimUp[1],3);
  double xLimUp0R4 = std::pow(xLimUp[0],4);
  double xLimUp1R4 = std::pow(xLimUp[1],4);

  tsData->mat(0,0) += -(0.125*(((4.898979485566357*xLimUp[1]-4.898979485566357*xLimLo[1])*sFac*yLimUp+(4.898979485566357*xLimLo[1]-4.898979485566357*xLimUp[1])*sFac*yLimLo)*ycLim+(2.449489742783178*xLimLo[1]-2.449489742783178*xLimUp[1])*sFac*yLimUpR2+(1.414213562373095*xLimLo[0]-1.414213562373095*xLimUp[0])*dyLim*sFac*yLimUp+(2.449489742783178*xLimUp[1]-2.449489742783178*xLimLo[1])*sFac*yLimLoR2+(1.414213562373095*xLimUp[0]-1.414213562373095*xLimLo[0])*dyLim*sFac*yLimLo))/dyLim; 
  tsData->mat(0,1) += (0.0625*(((20.78460969082652*xLimUp1R2-20.78460969082652*xLimLo1R2)*sFac*yLimUp+(20.78460969082652*xLimLo1R2-20.78460969082652*xLimUp1R2)*sFac*yLimLo)*ycLimR2+((20.78460969082652*xLimLo1R2-20.78460969082652*xLimUp1R2)*sFac*yLimUpR2+(12.0*xLimLo[0]*xLimLo[1]-12.0*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimUp+(20.78460969082652*xLimUp1R2-20.78460969082652*xLimLo1R2)*sFac*yLimLoR2+(12.0*xLimUp[0]*xLimUp[1]-12.0*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimLo)*ycLim+(6.928203230275509*xLimUp1R2-6.928203230275509*xLimLo1R2)*sFac*yLimUpR3+(6.0*xLimUp[0]*xLimUp[1]-6.0*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimUpR2+(1.732050807568877*xLimUp0R2-1.732050807568877*xLimLo0R2)*dyLimR2*sFac*yLimUp+(6.928203230275509*xLimLo1R2-6.928203230275509*xLimUp1R2)*sFac*yLimLoR3+(6.0*xLimLo[0]*xLimLo[1]-6.0*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimLoR2+(1.732050807568877*xLimLo0R2-1.732050807568877*xLimUp0R2)*dyLimR2*sFac*yLimLo))/dyLimR2; 
  tsData->mat(0,2) += (0.0625*(((50.91168824543144*xLimUp1R2-50.91168824543144*xLimLo1R2)*ySh[1]*sFac*yLimUp+(50.91168824543144*xLimLo1R2-50.91168824543144*xLimUp1R2)*ySh[1]*sFac*yLimLo)*ycLimR2+(((33.9411254969543*xLimUp[1]-33.9411254969543*xLimLo[1])*dyLim*sFac*yLimUp+(33.9411254969543*xLimLo[1]-33.9411254969543*xLimUp[1])*dyLim*sFac*yLimLo)*yOff+((8.485281374238571*xLimLo[1]-8.485281374238571*xLimUp[1])*dyDo*dyLim+(50.91168824543144*xLimLo1R2-50.91168824543144*xLimUp1R2)*ySh[1])*sFac*yLimUpR2+((29.39387691339815*xLimLo[0]*xLimLo[1]-29.39387691339815*xLimUp[0]*xLimUp[1])*ySh[1]-24.0*ySh[0]*xLimUp[1]+24.0*ySh[0]*xLimLo[1])*dyLim*sFac*yLimUp+((8.485281374238571*xLimUp[1]-8.485281374238571*xLimLo[1])*dyDo*dyLim+(50.91168824543144*xLimUp1R2-50.91168824543144*xLimLo1R2)*ySh[1])*sFac*yLimLoR2+((29.39387691339815*xLimUp[0]*xLimUp[1]-29.39387691339815*xLimLo[0]*xLimLo[1])*ySh[1]+24.0*ySh[0]*xLimUp[1]-24.0*ySh[0]*xLimLo[1])*dyLim*sFac*yLimLo)*ycLim+((16.97056274847715*xLimLo[1]-16.97056274847715*xLimUp[1])*dyLim*sFac*yLimUpR2+(9.797958971132715*xLimLo[0]-9.797958971132715*xLimUp[0])*dyLimR2*sFac*yLimUp+(16.97056274847715*xLimUp[1]-16.97056274847715*xLimLo[1])*dyLim*sFac*yLimLoR2+(9.797958971132715*xLimUp[0]-9.797958971132715*xLimLo[0])*dyLimR2*sFac*yLimLo)*yOff+((5.656854249492382*xLimUp[1]-5.656854249492382*xLimLo[1])*dyDo*dyLim+(16.97056274847715*xLimUp1R2-16.97056274847715*xLimLo1R2)*ySh[1])*sFac*yLimUpR3+((2.449489742783178*xLimUp[0]-2.449489742783178*xLimLo[0])*dyDo*dyLimR2+((14.69693845669907*xLimUp[0]*xLimUp[1]-14.69693845669907*xLimLo[0]*xLimLo[1])*ySh[1]+12.0*ySh[0]*xLimUp[1]-12.0*ySh[0]*xLimLo[1])*dyLim)*sFac*yLimUpR2+((4.242640687119286*xLimUp0R2-4.242640687119286*xLimLo0R2)*ySh[1]+(6.928203230275509*xLimUp[0]-6.928203230275509*xLimLo[0])*ySh[0])*dyLimR2*sFac*yLimUp+((5.656854249492382*xLimLo[1]-5.656854249492382*xLimUp[1])*dyDo*dyLim+(16.97056274847715*xLimLo1R2-16.97056274847715*xLimUp1R2)*ySh[1])*sFac*yLimLoR3+((2.449489742783178*xLimLo[0]-2.449489742783178*xLimUp[0])*dyDo*dyLimR2+((14.69693845669907*xLimLo[0]*xLimLo[1]-14.69693845669907*xLimUp[0]*xLimUp[1])*ySh[1]-12.0*ySh[0]*xLimUp[1]+12.0*ySh[0]*xLimLo[1])*dyLim)*sFac*yLimLoR2+((4.242640687119286*xLimLo0R2-4.242640687119286*xLimUp0R2)*ySh[1]+(6.928203230275509*xLimLo[0]-6.928203230275509*xLimUp[0])*ySh[0])*dyLimR2*sFac*yLimLo))/(dyDo*dyLimR2); 
  tsData->mat(0,3) += -(0.03125*(((288.0*xLimUp1R3-288.0*xLimLo1R3)*ySh[1]*sFac*yLimUp+(288.0*xLimLo1R3-288.0*xLimUp1R3)*ySh[1]*sFac*yLimLo)*ycLimR3+(((144.0*xLimUp1R2-144.0*xLimLo1R2)*dyLim*sFac*yLimUp+(144.0*xLimLo1R2-144.0*xLimUp1R2)*dyLim*sFac*yLimLo)*yOff+((36.0*xLimLo1R2-36.0*xLimUp1R2)*dyDo*dyLim+(432.0*xLimLo1R3-432.0*xLimUp1R3)*ySh[1])*sFac*yLimUpR2+((249.4153162899183*xLimLo[0]*xLimLo1R2-249.4153162899183*xLimUp[0]*xLimUp1R2)*ySh[1]-101.8233764908629*ySh[0]*xLimUp1R2+101.8233764908629*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimUp+((36.0*xLimUp1R2-36.0*xLimLo1R2)*dyDo*dyLim+(432.0*xLimUp1R3-432.0*xLimLo1R3)*ySh[1])*sFac*yLimLoR2+((249.4153162899183*xLimUp[0]*xLimUp1R2-249.4153162899183*xLimLo[0]*xLimLo1R2)*ySh[1]+101.8233764908629*ySh[0]*xLimUp1R2-101.8233764908629*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimLo)*ycLimR2+(((144.0*xLimLo1R2-144.0*xLimUp1R2)*dyLim*sFac*yLimUpR2+(83.1384387633061*xLimLo[0]*xLimLo[1]-83.1384387633061*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimUp+(144.0*xLimUp1R2-144.0*xLimLo1R2)*dyLim*sFac*yLimLoR2+(83.1384387633061*xLimUp[0]*xLimUp[1]-83.1384387633061*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimLo)*yOff+((48.0*xLimUp1R2-48.0*xLimLo1R2)*dyDo*dyLim+(288.0*xLimUp1R3-288.0*xLimLo1R3)*ySh[1])*sFac*yLimUpR3+((20.78460969082652*xLimUp[0]*xLimUp[1]-20.78460969082652*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((249.4153162899183*xLimUp[0]*xLimUp1R2-249.4153162899183*xLimLo[0]*xLimLo1R2)*ySh[1]+101.8233764908629*ySh[0]*xLimUp1R2-101.8233764908629*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR2+((72.0*xLimUp0R2*xLimUp[1]-72.0*xLimLo0R2*xLimLo[1])*ySh[1]+58.7877538267963*xLimUp[0]*ySh[0]*xLimUp[1]-58.7877538267963*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimUp+((48.0*xLimLo1R2-48.0*xLimUp1R2)*dyDo*dyLim+(288.0*xLimLo1R3-288.0*xLimUp1R3)*ySh[1])*sFac*yLimLoR3+((20.78460969082652*xLimLo[0]*xLimLo[1]-20.78460969082652*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((249.4153162899183*xLimLo[0]*xLimLo1R2-249.4153162899183*xLimUp[0]*xLimUp1R2)*ySh[1]-101.8233764908629*ySh[0]*xLimUp1R2+101.8233764908629*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR2+((72.0*xLimLo0R2*xLimLo[1]-72.0*xLimUp0R2*xLimUp[1])*ySh[1]-58.7877538267963*xLimUp[0]*ySh[0]*xLimUp[1]+58.7877538267963*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimLo)*ycLim+((48.0*xLimUp1R2-48.0*xLimLo1R2)*dyLim*sFac*yLimUpR3+(41.56921938165305*xLimUp[0]*xLimUp[1]-41.56921938165305*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR2+(12.0*xLimUp0R2-12.0*xLimLo0R2)*dyLimR3*sFac*yLimUp+(48.0*xLimLo1R2-48.0*xLimUp1R2)*dyLim*sFac*yLimLoR3+(41.56921938165305*xLimLo[0]*xLimLo[1]-41.56921938165305*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimLoR2+(12.0*xLimLo0R2-12.0*xLimUp0R2)*dyLimR3*sFac*yLimLo)*yOff+((18.0*xLimLo1R2-18.0*xLimUp1R2)*dyDo*dyLim+(72.0*xLimLo1R3-72.0*xLimUp1R3)*ySh[1])*sFac*yLimUpR4+((13.85640646055102*xLimLo[0]*xLimLo[1]-13.85640646055102*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((83.1384387633061*xLimLo[0]*xLimLo1R2-83.1384387633061*xLimUp[0]*xLimUp1R2)*ySh[1]-33.9411254969543*ySh[0]*xLimUp1R2+33.9411254969543*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR3+((3.0*xLimLo0R2-3.0*xLimUp0R2)*dyDo*dyLimR3+((36.0*xLimLo0R2*xLimLo[1]-36.0*xLimUp0R2*xLimUp[1])*ySh[1]-29.39387691339815*xLimUp[0]*ySh[0]*xLimUp[1]+29.39387691339815*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimUpR2+((6.928203230275509*xLimLo0R3-6.928203230275509*xLimUp0R3)*ySh[1]+(8.485281374238571*xLimLo0R2-8.485281374238571*xLimUp0R2)*ySh[0])*dyLimR3*sFac*yLimUp+((18.0*xLimUp1R2-18.0*xLimLo1R2)*dyDo*dyLim+(72.0*xLimUp1R3-72.0*xLimLo1R3)*ySh[1])*sFac*yLimLoR4+((13.85640646055102*xLimUp[0]*xLimUp[1]-13.85640646055102*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((83.1384387633061*xLimUp[0]*xLimUp1R2-83.1384387633061*xLimLo[0]*xLimLo1R2)*ySh[1]+33.9411254969543*ySh[0]*xLimUp1R2-33.9411254969543*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR3+((3.0*xLimUp0R2-3.0*xLimLo0R2)*dyDo*dyLimR3+((36.0*xLimUp0R2*xLimUp[1]-36.0*xLimLo0R2*xLimLo[1])*ySh[1]+29.39387691339815*xLimUp[0]*ySh[0]*xLimUp[1]-29.39387691339815*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimLoR2+((6.928203230275509*xLimUp0R3-6.928203230275509*xLimLo0R3)*ySh[1]+(8.485281374238571*xLimUp0R2-8.485281374238571*xLimLo0R2)*ySh[0])*dyLimR3*sFac*yLimLo))/(dyDo*dyLimR3); 
  tsData->mat(1,0) += (0.0625*(((20.78460969082652*xLimUp1R2-20.78460969082652*xLimLo1R2)*sFac*yLimUp+(20.78460969082652*xLimLo1R2-20.78460969082652*xLimUp1R2)*sFac*yLimLo)*ycLimR2+((20.78460969082652*xLimLo1R2-20.78460969082652*xLimUp1R2)*sFac*yLimUpR2+(12.0*xLimLo[0]*xLimLo[1]-12.0*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimUp+(20.78460969082652*xLimUp1R2-20.78460969082652*xLimLo1R2)*sFac*yLimLoR2+(12.0*xLimUp[0]*xLimUp[1]-12.0*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimLo)*ycLim+(6.928203230275509*xLimUp1R2-6.928203230275509*xLimLo1R2)*sFac*yLimUpR3+(6.0*xLimUp[0]*xLimUp[1]-6.0*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimUpR2+(1.732050807568877*xLimUp0R2-1.732050807568877*xLimLo0R2)*dyLimR2*sFac*yLimUp+(6.928203230275509*xLimLo1R2-6.928203230275509*xLimUp1R2)*sFac*yLimLoR3+(6.0*xLimLo[0]*xLimLo[1]-6.0*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimLoR2+(1.732050807568877*xLimLo0R2-1.732050807568877*xLimUp0R2)*dyLimR2*sFac*yLimLo))/dyLimR2; 
  tsData->mat(1,1) += -(0.0625*(((58.7877538267963*xLimUp1R3-58.7877538267963*xLimLo1R3)*sFac*yLimUp+(58.7877538267963*xLimLo1R3-58.7877538267963*xLimUp1R3)*sFac*yLimLo)*ycLimR3+((88.18163074019442*xLimLo1R3-88.18163074019442*xLimUp1R3)*sFac*yLimUpR2+(50.91168824543144*xLimLo[0]*xLimLo1R2-50.91168824543144*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimUp+(88.18163074019442*xLimUp1R3-88.18163074019442*xLimLo1R3)*sFac*yLimLoR2+(50.91168824543144*xLimUp[0]*xLimUp1R2-50.91168824543144*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimLo)*ycLimR2+((58.7877538267963*xLimUp1R3-58.7877538267963*xLimLo1R3)*sFac*yLimUpR3+(50.91168824543144*xLimUp[0]*xLimUp1R2-50.91168824543144*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimUpR2+(14.69693845669907*xLimUp0R2*xLimUp[1]-14.69693845669907*xLimLo0R2*xLimLo[1])*dyLimR2*sFac*yLimUp+(58.7877538267963*xLimLo1R3-58.7877538267963*xLimUp1R3)*sFac*yLimLoR3+(50.91168824543144*xLimLo[0]*xLimLo1R2-50.91168824543144*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimLoR2+(14.69693845669907*xLimLo0R2*xLimLo[1]-14.69693845669907*xLimUp0R2*xLimUp[1])*dyLimR2*sFac*yLimLo)*ycLim+(14.69693845669907*xLimLo1R3-14.69693845669907*xLimUp1R3)*sFac*yLimUpR4+(16.97056274847715*xLimLo[0]*xLimLo1R2-16.97056274847715*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimUpR3+(7.348469228349534*xLimLo0R2*xLimLo[1]-7.348469228349534*xLimUp0R2*xLimUp[1])*dyLimR2*sFac*yLimUpR2+(1.414213562373095*xLimLo0R3-1.414213562373095*xLimUp0R3)*dyLimR3*sFac*yLimUp+(14.69693845669907*xLimUp1R3-14.69693845669907*xLimLo1R3)*sFac*yLimLoR4+(16.97056274847715*xLimUp[0]*xLimUp1R2-16.97056274847715*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimLoR3+(7.348469228349534*xLimUp0R2*xLimUp[1]-7.348469228349534*xLimLo0R2*xLimLo[1])*dyLimR2*sFac*yLimLoR2+(1.414213562373095*xLimUp0R3-1.414213562373095*xLimLo0R3)*dyLimR3*sFac*yLimLo))/dyLimR3; 
  tsData->mat(1,2) += -(0.03125*(((288.0*xLimUp1R3-288.0*xLimLo1R3)*ySh[1]*sFac*yLimUp+(288.0*xLimLo1R3-288.0*xLimUp1R3)*ySh[1]*sFac*yLimLo)*ycLimR3+(((144.0*xLimUp1R2-144.0*xLimLo1R2)*dyLim*sFac*yLimUp+(144.0*xLimLo1R2-144.0*xLimUp1R2)*dyLim*sFac*yLimLo)*yOff+((36.0*xLimLo1R2-36.0*xLimUp1R2)*dyDo*dyLim+(432.0*xLimLo1R3-432.0*xLimUp1R3)*ySh[1])*sFac*yLimUpR2+((249.4153162899183*xLimLo[0]*xLimLo1R2-249.4153162899183*xLimUp[0]*xLimUp1R2)*ySh[1]-101.8233764908629*ySh[0]*xLimUp1R2+101.8233764908629*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimUp+((36.0*xLimUp1R2-36.0*xLimLo1R2)*dyDo*dyLim+(432.0*xLimUp1R3-432.0*xLimLo1R3)*ySh[1])*sFac*yLimLoR2+((249.4153162899183*xLimUp[0]*xLimUp1R2-249.4153162899183*xLimLo[0]*xLimLo1R2)*ySh[1]+101.8233764908629*ySh[0]*xLimUp1R2-101.8233764908629*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimLo)*ycLimR2+(((144.0*xLimLo1R2-144.0*xLimUp1R2)*dyLim*sFac*yLimUpR2+(83.1384387633061*xLimLo[0]*xLimLo[1]-83.1384387633061*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimUp+(144.0*xLimUp1R2-144.0*xLimLo1R2)*dyLim*sFac*yLimLoR2+(83.1384387633061*xLimUp[0]*xLimUp[1]-83.1384387633061*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimLo)*yOff+((48.0*xLimUp1R2-48.0*xLimLo1R2)*dyDo*dyLim+(288.0*xLimUp1R3-288.0*xLimLo1R3)*ySh[1])*sFac*yLimUpR3+((20.78460969082652*xLimUp[0]*xLimUp[1]-20.78460969082652*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((249.4153162899183*xLimUp[0]*xLimUp1R2-249.4153162899183*xLimLo[0]*xLimLo1R2)*ySh[1]+101.8233764908629*ySh[0]*xLimUp1R2-101.8233764908629*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR2+((72.0*xLimUp0R2*xLimUp[1]-72.0*xLimLo0R2*xLimLo[1])*ySh[1]+58.7877538267963*xLimUp[0]*ySh[0]*xLimUp[1]-58.7877538267963*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimUp+((48.0*xLimLo1R2-48.0*xLimUp1R2)*dyDo*dyLim+(288.0*xLimLo1R3-288.0*xLimUp1R3)*ySh[1])*sFac*yLimLoR3+((20.78460969082652*xLimLo[0]*xLimLo[1]-20.78460969082652*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((249.4153162899183*xLimLo[0]*xLimLo1R2-249.4153162899183*xLimUp[0]*xLimUp1R2)*ySh[1]-101.8233764908629*ySh[0]*xLimUp1R2+101.8233764908629*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR2+((72.0*xLimLo0R2*xLimLo[1]-72.0*xLimUp0R2*xLimUp[1])*ySh[1]-58.7877538267963*xLimUp[0]*ySh[0]*xLimUp[1]+58.7877538267963*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimLo)*ycLim+((48.0*xLimUp1R2-48.0*xLimLo1R2)*dyLim*sFac*yLimUpR3+(41.56921938165305*xLimUp[0]*xLimUp[1]-41.56921938165305*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR2+(12.0*xLimUp0R2-12.0*xLimLo0R2)*dyLimR3*sFac*yLimUp+(48.0*xLimLo1R2-48.0*xLimUp1R2)*dyLim*sFac*yLimLoR3+(41.56921938165305*xLimLo[0]*xLimLo[1]-41.56921938165305*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimLoR2+(12.0*xLimLo0R2-12.0*xLimUp0R2)*dyLimR3*sFac*yLimLo)*yOff+((18.0*xLimLo1R2-18.0*xLimUp1R2)*dyDo*dyLim+(72.0*xLimLo1R3-72.0*xLimUp1R3)*ySh[1])*sFac*yLimUpR4+((13.85640646055102*xLimLo[0]*xLimLo[1]-13.85640646055102*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((83.1384387633061*xLimLo[0]*xLimLo1R2-83.1384387633061*xLimUp[0]*xLimUp1R2)*ySh[1]-33.9411254969543*ySh[0]*xLimUp1R2+33.9411254969543*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR3+((3.0*xLimLo0R2-3.0*xLimUp0R2)*dyDo*dyLimR3+((36.0*xLimLo0R2*xLimLo[1]-36.0*xLimUp0R2*xLimUp[1])*ySh[1]-29.39387691339815*xLimUp[0]*ySh[0]*xLimUp[1]+29.39387691339815*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimUpR2+((6.928203230275509*xLimLo0R3-6.928203230275509*xLimUp0R3)*ySh[1]+(8.485281374238571*xLimLo0R2-8.485281374238571*xLimUp0R2)*ySh[0])*dyLimR3*sFac*yLimUp+((18.0*xLimUp1R2-18.0*xLimLo1R2)*dyDo*dyLim+(72.0*xLimUp1R3-72.0*xLimLo1R3)*ySh[1])*sFac*yLimLoR4+((13.85640646055102*xLimUp[0]*xLimUp[1]-13.85640646055102*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((83.1384387633061*xLimUp[0]*xLimUp1R2-83.1384387633061*xLimLo[0]*xLimLo1R2)*ySh[1]+33.9411254969543*ySh[0]*xLimUp1R2-33.9411254969543*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR3+((3.0*xLimUp0R2-3.0*xLimLo0R2)*dyDo*dyLimR3+((36.0*xLimUp0R2*xLimUp[1]-36.0*xLimLo0R2*xLimLo[1])*ySh[1]+29.39387691339815*xLimUp[0]*ySh[0]*xLimUp[1]-29.39387691339815*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimLoR2+((6.928203230275509*xLimUp0R3-6.928203230275509*xLimLo0R3)*ySh[1]+(8.485281374238571*xLimUp0R2-8.485281374238571*xLimLo0R2)*ySh[0])*dyLimR3*sFac*yLimLo))/(dyDo*dyLimR3); 
  tsData->mat(1,3) += (0.003125*(((9164.10388417766*xLimUp1R4-9164.10388417766*xLimLo1R4)*ySh[1]*sFac*yLimUp+(9164.10388417766*xLimLo1R4-9164.10388417766*xLimUp1R4)*ySh[1]*sFac*yLimLo)*ycLimR4+(((4072.935059634517*xLimUp1R3-4072.935059634517*xLimLo1R3)*dyLim*sFac*yLimUp+(4072.935059634517*xLimLo1R3-4072.935059634517*xLimUp1R3)*dyLim*sFac*yLimLo)*yOff+((1018.233764908629*xLimLo1R3-1018.233764908629*xLimUp1R3)*dyDo*dyLim+(18328.20776835533*xLimLo1R4-18328.20776835533*xLimUp1R4)*ySh[1])*sFac*yLimUpR2+((10581.79568882333*xLimLo[0]*xLimLo1R3-10581.79568882333*xLimUp[0]*xLimUp1R3)*ySh[1]-2880.0*ySh[0]*xLimUp1R3+2880.0*ySh[0]*xLimLo1R3)*dyLim*sFac*yLimUp+((1018.233764908629*xLimUp1R3-1018.233764908629*xLimLo1R3)*dyDo*dyLim+(18328.20776835533*xLimUp1R4-18328.20776835533*xLimLo1R4)*ySh[1])*sFac*yLimLoR2+((10581.79568882333*xLimUp[0]*xLimUp1R3-10581.79568882333*xLimLo[0]*xLimLo1R3)*ySh[1]+2880.0*ySh[0]*xLimUp1R3-2880.0*ySh[0]*xLimLo1R3)*dyLim*sFac*yLimLo)*ycLimR3+(((6109.402589451774*xLimLo1R3-6109.402589451774*xLimUp1R3)*dyLim*sFac*yLimUpR2+(3527.265229607778*xLimLo[0]*xLimLo1R2-3527.265229607778*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimUp+(6109.402589451774*xLimUp1R3-6109.402589451774*xLimLo1R3)*dyLim*sFac*yLimLoR2+(3527.265229607778*xLimUp[0]*xLimUp1R2-3527.265229607778*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimLo)*yOff+((2036.467529817258*xLimUp1R3-2036.467529817258*xLimLo1R3)*dyDo*dyLim+(18328.20776835533*xLimUp1R4-18328.20776835533*xLimLo1R4)*ySh[1])*sFac*yLimUpR3+((881.8163074019443*xLimUp[0]*xLimUp1R2-881.8163074019443*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((15872.69353323499*xLimUp[0]*xLimUp1R3-15872.69353323499*xLimLo[0]*xLimLo1R3)*ySh[1]+4320.0*ySh[0]*xLimUp1R3-4320.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR2+((4582.05194208883*xLimUp0R2*xLimUp1R2-4582.05194208883*xLimLo0R2*xLimLo1R2)*ySh[1]+2494.153162899182*xLimUp[0]*ySh[0]*xLimUp1R2-2494.153162899182*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2*sFac*yLimUp+((2036.467529817258*xLimLo1R3-2036.467529817258*xLimUp1R3)*dyDo*dyLim+(18328.20776835533*xLimLo1R4-18328.20776835533*xLimUp1R4)*ySh[1])*sFac*yLimLoR3+((881.8163074019443*xLimLo[0]*xLimLo1R2-881.8163074019443*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((15872.69353323499*xLimLo[0]*xLimLo1R3-15872.69353323499*xLimUp[0]*xLimUp1R3)*ySh[1]-4320.0*ySh[0]*xLimUp1R3+4320.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR2+((4582.05194208883*xLimLo0R2*xLimLo1R2-4582.05194208883*xLimUp0R2*xLimUp1R2)*ySh[1]-2494.153162899182*xLimUp[0]*ySh[0]*xLimUp1R2+2494.153162899182*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2*sFac*yLimLo)*ycLimR2+(((4072.935059634517*xLimUp1R3-4072.935059634517*xLimLo1R3)*dyLim*sFac*yLimUpR3+(3527.265229607778*xLimUp[0]*xLimUp1R2-3527.265229607778*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimUpR2+(1018.233764908629*xLimUp0R2*xLimUp[1]-1018.233764908629*xLimLo0R2*xLimLo[1])*dyLimR3*sFac*yLimUp+(4072.935059634517*xLimLo1R3-4072.935059634517*xLimUp1R3)*dyLim*sFac*yLimLoR3+(3527.265229607778*xLimLo[0]*xLimLo1R2-3527.265229607778*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimLoR2+(1018.233764908629*xLimLo0R2*xLimLo[1]-1018.233764908629*xLimUp0R2*xLimUp[1])*dyLimR3*sFac*yLimLo)*yOff+((1527.350647362943*xLimLo1R3-1527.350647362943*xLimUp1R3)*dyDo*dyLim+(9164.10388417766*xLimLo1R4-9164.10388417766*xLimUp1R4)*ySh[1])*sFac*yLimUpR4+((1175.755076535926*xLimLo[0]*xLimLo1R2-1175.755076535926*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((10581.79568882333*xLimLo[0]*xLimLo1R3-10581.79568882333*xLimUp[0]*xLimUp1R3)*ySh[1]-2880.0*ySh[0]*xLimUp1R3+2880.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR3+((254.5584412271572*xLimLo0R2*xLimLo[1]-254.5584412271572*xLimUp0R2*xLimUp[1])*dyDo*dyLimR3+((4582.05194208883*xLimLo0R2*xLimLo1R2-4582.05194208883*xLimUp0R2*xLimUp1R2)*ySh[1]-2494.153162899182*xLimUp[0]*ySh[0]*xLimUp1R2+2494.153162899182*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimUpR2+((881.8163074019443*xLimLo0R3*xLimLo[1]-881.8163074019443*xLimUp0R3*xLimUp[1])*ySh[1]-720.0*xLimUp0R2*ySh[0]*xLimUp[1]+720.0*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3*sFac*yLimUp+((1527.350647362943*xLimUp1R3-1527.350647362943*xLimLo1R3)*dyDo*dyLim+(9164.10388417766*xLimUp1R4-9164.10388417766*xLimLo1R4)*ySh[1])*sFac*yLimLoR4+((1175.755076535926*xLimUp[0]*xLimUp1R2-1175.755076535926*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((10581.79568882333*xLimUp[0]*xLimUp1R3-10581.79568882333*xLimLo[0]*xLimLo1R3)*ySh[1]+2880.0*ySh[0]*xLimUp1R3-2880.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR3+((254.5584412271572*xLimUp0R2*xLimUp[1]-254.5584412271572*xLimLo0R2*xLimLo[1])*dyDo*dyLimR3+((4582.05194208883*xLimUp0R2*xLimUp1R2-4582.05194208883*xLimLo0R2*xLimLo1R2)*ySh[1]+2494.153162899182*xLimUp[0]*ySh[0]*xLimUp1R2-2494.153162899182*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimLoR2+((881.8163074019443*xLimUp0R3*xLimUp[1]-881.8163074019443*xLimLo0R3*xLimLo[1])*ySh[1]+720.0*xLimUp0R2*ySh[0]*xLimUp[1]-720.0*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3*sFac*yLimLo)*ycLim+((1018.233764908629*xLimLo1R3-1018.233764908629*xLimUp1R3)*dyLim*sFac*yLimUpR4+(1175.755076535926*xLimLo[0]*xLimLo1R2-1175.755076535926*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimUpR3+(509.1168824543145*xLimLo0R2*xLimLo[1]-509.1168824543145*xLimUp0R2*xLimUp[1])*dyLimR3*sFac*yLimUpR2+(97.97958971132716*xLimLo0R3-97.97958971132716*xLimUp0R3)*dyLimR4*sFac*yLimUp+(1018.233764908629*xLimUp1R3-1018.233764908629*xLimLo1R3)*dyLim*sFac*yLimLoR4+(1175.755076535926*xLimUp[0]*xLimUp1R2-1175.755076535926*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimLoR3+(509.1168824543145*xLimUp0R2*xLimUp[1]-509.1168824543145*xLimLo0R2*xLimLo[1])*dyLimR3*sFac*yLimLoR2+(97.97958971132716*xLimUp0R3-97.97958971132716*xLimLo0R3)*dyLimR4*sFac*yLimLo)*yOff+((407.2935059634517*xLimUp1R3-407.2935059634517*xLimLo1R3)*dyDo*dyLim+(1832.820776835532*xLimUp1R4-1832.820776835532*xLimLo1R4)*ySh[1])*sFac*yLimUpR5+((440.9081537009721*xLimUp[0]*xLimUp1R2-440.9081537009721*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((2645.448922205833*xLimUp[0]*xLimUp1R3-2645.448922205833*xLimLo[0]*xLimLo1R3)*ySh[1]+720.0*ySh[0]*xLimUp1R3-720.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR4+((169.7056274847715*xLimUp0R2*xLimUp[1]-169.7056274847715*xLimLo0R2*xLimLo[1])*dyDo*dyLimR3+((1527.350647362943*xLimUp0R2*xLimUp1R2-1527.350647362943*xLimLo0R2*xLimLo1R2)*ySh[1]+831.384387633061*xLimUp[0]*ySh[0]*xLimUp1R2-831.384387633061*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimUpR3+((24.49489742783179*xLimUp0R3-24.49489742783179*xLimLo0R3)*dyDo*dyLimR4+((440.9081537009721*xLimUp0R3*xLimUp[1]-440.9081537009721*xLimLo0R3*xLimLo[1])*ySh[1]+360.0*xLimUp0R2*ySh[0]*xLimUp[1]-360.0*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3)*sFac*yLimUpR2+((63.63961030678928*xLimUp0R4-63.63961030678928*xLimLo0R4)*ySh[1]+(69.28203230275508*xLimUp0R3-69.28203230275508*xLimLo0R3)*ySh[0])*dyLimR4*sFac*yLimUp+((407.2935059634517*xLimLo1R3-407.2935059634517*xLimUp1R3)*dyDo*dyLim+(1832.820776835532*xLimLo1R4-1832.820776835532*xLimUp1R4)*ySh[1])*sFac*yLimLoR5+((440.9081537009721*xLimLo[0]*xLimLo1R2-440.9081537009721*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((2645.448922205833*xLimLo[0]*xLimLo1R3-2645.448922205833*xLimUp[0]*xLimUp1R3)*ySh[1]-720.0*ySh[0]*xLimUp1R3+720.0*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR4+((169.7056274847715*xLimLo0R2*xLimLo[1]-169.7056274847715*xLimUp0R2*xLimUp[1])*dyDo*dyLimR3+((1527.350647362943*xLimLo0R2*xLimLo1R2-1527.350647362943*xLimUp0R2*xLimUp1R2)*ySh[1]-831.384387633061*xLimUp[0]*ySh[0]*xLimUp1R2+831.384387633061*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimLoR3+((24.49489742783179*xLimLo0R3-24.49489742783179*xLimUp0R3)*dyDo*dyLimR4+((440.9081537009721*xLimLo0R3*xLimLo[1]-440.9081537009721*xLimUp0R3*xLimUp[1])*ySh[1]-360.0*xLimUp0R2*ySh[0]*xLimUp[1]+360.0*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3)*sFac*yLimLoR2+((63.63961030678928*xLimLo0R4-63.63961030678928*xLimUp0R4)*ySh[1]+(69.28203230275508*xLimLo0R3-69.28203230275508*xLimUp0R3)*ySh[0])*dyLimR4*sFac*yLimLo))/(dyDo*dyLimR4); 
  tsData->mat(2,0) += -(0.0625*(((8.485281374238571*xLimUp[1]-8.485281374238571*xLimLo[1])*sFac*yLimUpR2+(8.485281374238571*xLimLo[1]-8.485281374238571*xLimUp[1])*sFac*yLimLoR2)*ycLim+(5.656854249492382*xLimLo[1]-5.656854249492382*xLimUp[1])*sFac*yLimUpR3+(2.449489742783178*xLimLo[0]-2.449489742783178*xLimUp[0])*dyLim*sFac*yLimUpR2+(5.656854249492382*xLimUp[1]-5.656854249492382*xLimLo[1])*sFac*yLimLoR3+(2.449489742783178*xLimUp[0]-2.449489742783178*xLimLo[0])*dyLim*sFac*yLimLoR2))/dyLim; 
  tsData->mat(2,1) += (0.03125*(((36.0*xLimUp1R2-36.0*xLimLo1R2)*sFac*yLimUpR2+(36.0*xLimLo1R2-36.0*xLimUp1R2)*sFac*yLimLoR2)*ycLimR2+((48.0*xLimLo1R2-48.0*xLimUp1R2)*sFac*yLimUpR3+(20.78460969082652*xLimLo[0]*xLimLo[1]-20.78460969082652*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimUpR2+(48.0*xLimUp1R2-48.0*xLimLo1R2)*sFac*yLimLoR3+(20.78460969082652*xLimUp[0]*xLimUp[1]-20.78460969082652*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimLoR2)*ycLim+(18.0*xLimUp1R2-18.0*xLimLo1R2)*sFac*yLimUpR4+(13.85640646055102*xLimUp[0]*xLimUp[1]-13.85640646055102*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimUpR3+(3.0*xLimUp0R2-3.0*xLimLo0R2)*dyLimR2*sFac*yLimUpR2+(18.0*xLimLo1R2-18.0*xLimUp1R2)*sFac*yLimLoR4+(13.85640646055102*xLimLo[0]*xLimLo[1]-13.85640646055102*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimLoR3+(3.0*xLimLo0R2-3.0*xLimUp0R2)*dyLimR2*sFac*yLimLoR2))/dyLimR2; 
  tsData->mat(2,2) += (0.03125*(((88.18163074019442*xLimUp1R2-88.18163074019442*xLimLo1R2)*ySh[1]*sFac*yLimUpR2+(88.18163074019442*xLimLo1R2-88.18163074019442*xLimUp1R2)*ySh[1]*sFac*yLimLoR2)*ycLimR2+(((58.7877538267963*xLimUp[1]-58.7877538267963*xLimLo[1])*dyLim*sFac*yLimUpR2+(58.7877538267963*xLimLo[1]-58.7877538267963*xLimUp[1])*dyLim*sFac*yLimLoR2)*yOff+((19.59591794226543*xLimLo[1]-19.59591794226543*xLimUp[1])*dyDo*dyLim+(117.5755076535926*xLimLo1R2-117.5755076535926*xLimUp1R2)*ySh[1])*sFac*yLimUpR3+((50.91168824543144*xLimLo[0]*xLimLo[1]-50.91168824543144*xLimUp[0]*xLimUp[1])*ySh[1]-41.56921938165305*ySh[0]*xLimUp[1]+41.56921938165305*ySh[0]*xLimLo[1])*dyLim*sFac*yLimUpR2+((19.59591794226543*xLimUp[1]-19.59591794226543*xLimLo[1])*dyDo*dyLim+(117.5755076535926*xLimUp1R2-117.5755076535926*xLimLo1R2)*ySh[1])*sFac*yLimLoR3+((50.91168824543144*xLimUp[0]*xLimUp[1]-50.91168824543144*xLimLo[0]*xLimLo[1])*ySh[1]+41.56921938165305*ySh[0]*xLimUp[1]-41.56921938165305*ySh[0]*xLimLo[1])*dyLim*sFac*yLimLoR2)*ycLim+((39.19183588453087*xLimLo[1]-39.19183588453087*xLimUp[1])*dyLim*sFac*yLimUpR3+(16.97056274847715*xLimLo[0]-16.97056274847715*xLimUp[0])*dyLimR2*sFac*yLimUpR2+(39.19183588453087*xLimUp[1]-39.19183588453087*xLimLo[1])*dyLim*sFac*yLimLoR3+(16.97056274847715*xLimUp[0]-16.97056274847715*xLimLo[0])*dyLimR2*sFac*yLimLoR2)*yOff+((14.69693845669907*xLimUp[1]-14.69693845669907*xLimLo[1])*dyDo*dyLim+(44.0908153700972*xLimUp1R2-44.0908153700972*xLimLo1R2)*ySh[1])*sFac*yLimUpR4+((5.656854249492382*xLimUp[0]-5.656854249492382*xLimLo[0])*dyDo*dyLimR2+((33.9411254969543*xLimUp[0]*xLimUp[1]-33.9411254969543*xLimLo[0]*xLimLo[1])*ySh[1]+27.71281292110204*ySh[0]*xLimUp[1]-27.71281292110204*ySh[0]*xLimLo[1])*dyLim)*sFac*yLimUpR3+((7.348469228349534*xLimUp0R2-7.348469228349534*xLimLo0R2)*ySh[1]+(12.0*xLimUp[0]-12.0*xLimLo[0])*ySh[0])*dyLimR2*sFac*yLimUpR2+((14.69693845669907*xLimLo[1]-14.69693845669907*xLimUp[1])*dyDo*dyLim+(44.0908153700972*xLimLo1R2-44.0908153700972*xLimUp1R2)*ySh[1])*sFac*yLimLoR4+((5.656854249492382*xLimLo[0]-5.656854249492382*xLimUp[0])*dyDo*dyLimR2+((33.9411254969543*xLimLo[0]*xLimLo[1]-33.9411254969543*xLimUp[0]*xLimUp[1])*ySh[1]-27.71281292110204*ySh[0]*xLimUp[1]+27.71281292110204*ySh[0]*xLimLo[1])*dyLim)*sFac*yLimLoR3+((7.348469228349534*xLimLo0R2-7.348469228349534*xLimUp0R2)*ySh[1]+(12.0*xLimLo[0]-12.0*xLimUp[0])*ySh[0])*dyLimR2*sFac*yLimLoR2))/(dyDo*dyLimR2); 
  tsData->mat(2,3) += -(0.00625*(((1247.076581449591*xLimUp1R3-1247.076581449591*xLimLo1R3)*ySh[1]*sFac*yLimUpR2+(1247.076581449591*xLimLo1R3-1247.076581449591*xLimUp1R3)*ySh[1]*sFac*yLimLoR2)*ycLimR3+(((623.5382907247956*xLimUp1R2-623.5382907247956*xLimLo1R2)*dyLim*sFac*yLimUpR2+(623.5382907247956*xLimLo1R2-623.5382907247956*xLimUp1R2)*dyLim*sFac*yLimLoR2)*yOff+((207.8460969082653*xLimLo1R2-207.8460969082653*xLimUp1R2)*dyDo*dyLim+(2494.153162899182*xLimLo1R3-2494.153162899182*xLimUp1R3)*ySh[1])*sFac*yLimUpR3+((1080.0*xLimLo[0]*xLimLo1R2-1080.0*xLimUp[0]*xLimUp1R2)*ySh[1]-440.9081537009721*ySh[0]*xLimUp1R2+440.9081537009721*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimUpR2+((207.8460969082653*xLimUp1R2-207.8460969082653*xLimLo1R2)*dyDo*dyLim+(2494.153162899182*xLimUp1R3-2494.153162899182*xLimLo1R3)*ySh[1])*sFac*yLimLoR3+((1080.0*xLimUp[0]*xLimUp1R2-1080.0*xLimLo[0]*xLimLo1R2)*ySh[1]+440.9081537009721*ySh[0]*xLimUp1R2-440.9081537009721*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimLoR2)*ycLimR2+(((831.384387633061*xLimLo1R2-831.384387633061*xLimUp1R2)*dyLim*sFac*yLimUpR3+(360.0*xLimLo[0]*xLimLo[1]-360.0*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimUpR2+(831.384387633061*xLimUp1R2-831.384387633061*xLimLo1R2)*dyLim*sFac*yLimLoR3+(360.0*xLimUp[0]*xLimUp[1]-360.0*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimLoR2)*yOff+((311.7691453623978*xLimUp1R2-311.7691453623978*xLimLo1R2)*dyDo*dyLim+(1870.614872174387*xLimUp1R3-1870.614872174387*xLimLo1R3)*ySh[1])*sFac*yLimUpR4+((120.0*xLimUp[0]*xLimUp[1]-120.0*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((1440.0*xLimUp[0]*xLimUp1R2-1440.0*xLimLo[0]*xLimLo1R2)*ySh[1]+587.877538267963*ySh[0]*xLimUp1R2-587.877538267963*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR3+((311.7691453623978*xLimUp0R2*xLimUp[1]-311.7691453623978*xLimLo0R2*xLimLo[1])*ySh[1]+254.5584412271572*xLimUp[0]*ySh[0]*xLimUp[1]-254.5584412271572*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR2+((311.7691453623978*xLimLo1R2-311.7691453623978*xLimUp1R2)*dyDo*dyLim+(1870.614872174387*xLimLo1R3-1870.614872174387*xLimUp1R3)*ySh[1])*sFac*yLimLoR4+((120.0*xLimLo[0]*xLimLo[1]-120.0*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((1440.0*xLimLo[0]*xLimLo1R2-1440.0*xLimUp[0]*xLimUp1R2)*ySh[1]-587.877538267963*ySh[0]*xLimUp1R2+587.877538267963*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR3+((311.7691453623978*xLimLo0R2*xLimLo[1]-311.7691453623978*xLimUp0R2*xLimUp[1])*ySh[1]-254.5584412271572*xLimUp[0]*ySh[0]*xLimUp[1]+254.5584412271572*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimLoR2)*ycLim+((311.7691453623978*xLimUp1R2-311.7691453623978*xLimLo1R2)*dyLim*sFac*yLimUpR4+(240.0*xLimUp[0]*xLimUp[1]-240.0*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR3+(51.96152422706631*xLimUp0R2-51.96152422706631*xLimLo0R2)*dyLimR3*sFac*yLimUpR2+(311.7691453623978*xLimLo1R2-311.7691453623978*xLimUp1R2)*dyLim*sFac*yLimLoR4+(240.0*xLimLo[0]*xLimLo[1]-240.0*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimLoR3+(51.96152422706631*xLimLo0R2-51.96152422706631*xLimUp0R2)*dyLimR3*sFac*yLimLoR2)*yOff+((124.7076581449591*xLimLo1R2-124.7076581449591*xLimUp1R2)*dyDo*dyLim+(498.8306325798365*xLimLo1R3-498.8306325798365*xLimUp1R3)*ySh[1])*sFac*yLimUpR5+((90.0*xLimLo[0]*xLimLo[1]-90.0*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((540.0*xLimLo[0]*xLimLo1R2-540.0*xLimUp[0]*xLimUp1R2)*ySh[1]-220.454076850486*ySh[0]*xLimUp1R2+220.454076850486*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR4+((17.32050807568877*xLimLo0R2-17.32050807568877*xLimUp0R2)*dyDo*dyLimR3+((207.8460969082653*xLimLo0R2*xLimLo[1]-207.8460969082653*xLimUp0R2*xLimUp[1])*ySh[1]-169.7056274847715*xLimUp[0]*ySh[0]*xLimUp[1]+169.7056274847715*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimUpR3+((30.0*xLimLo0R3-30.0*xLimUp0R3)*ySh[1]+(36.74234614174767*xLimLo0R2-36.74234614174767*xLimUp0R2)*ySh[0])*dyLimR3*sFac*yLimUpR2+((124.7076581449591*xLimUp1R2-124.7076581449591*xLimLo1R2)*dyDo*dyLim+(498.8306325798365*xLimUp1R3-498.8306325798365*xLimLo1R3)*ySh[1])*sFac*yLimLoR5+((90.0*xLimUp[0]*xLimUp[1]-90.0*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((540.0*xLimUp[0]*xLimUp1R2-540.0*xLimLo[0]*xLimLo1R2)*ySh[1]+220.454076850486*ySh[0]*xLimUp1R2-220.454076850486*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR4+((17.32050807568877*xLimUp0R2-17.32050807568877*xLimLo0R2)*dyDo*dyLimR3+((207.8460969082653*xLimUp0R2*xLimUp[1]-207.8460969082653*xLimLo0R2*xLimLo[1])*ySh[1]+169.7056274847715*xLimUp[0]*ySh[0]*xLimUp[1]-169.7056274847715*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimLoR3+((30.0*xLimUp0R3-30.0*xLimLo0R3)*ySh[1]+(36.74234614174767*xLimUp0R2-36.74234614174767*xLimLo0R2)*ySh[0])*dyLimR3*sFac*yLimLoR2))/(dyDo*dyLimR3); 
  tsData->mat(3,0) += (0.03125*(((36.0*xLimUp1R2-36.0*xLimLo1R2)*sFac*yLimUpR2+(36.0*xLimLo1R2-36.0*xLimUp1R2)*sFac*yLimLoR2)*ycLimR2+((48.0*xLimLo1R2-48.0*xLimUp1R2)*sFac*yLimUpR3+(20.78460969082652*xLimLo[0]*xLimLo[1]-20.78460969082652*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimUpR2+(48.0*xLimUp1R2-48.0*xLimLo1R2)*sFac*yLimLoR3+(20.78460969082652*xLimUp[0]*xLimUp[1]-20.78460969082652*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimLoR2)*ycLim+(18.0*xLimUp1R2-18.0*xLimLo1R2)*sFac*yLimUpR4+(13.85640646055102*xLimUp[0]*xLimUp[1]-13.85640646055102*xLimLo[0]*xLimLo[1])*dyLim*sFac*yLimUpR3+(3.0*xLimUp0R2-3.0*xLimLo0R2)*dyLimR2*sFac*yLimUpR2+(18.0*xLimLo1R2-18.0*xLimUp1R2)*sFac*yLimLoR4+(13.85640646055102*xLimLo[0]*xLimLo[1]-13.85640646055102*xLimUp[0]*xLimUp[1])*dyLim*sFac*yLimLoR3+(3.0*xLimLo0R2-3.0*xLimUp0R2)*dyLimR2*sFac*yLimLoR2))/dyLimR2; 
  tsData->mat(3,1) += -(0.00625*(((509.1168824543145*xLimUp1R3-509.1168824543145*xLimLo1R3)*sFac*yLimUpR2+(509.1168824543145*xLimLo1R3-509.1168824543145*xLimUp1R3)*sFac*yLimLoR2)*ycLimR3+((1018.233764908629*xLimLo1R3-1018.233764908629*xLimUp1R3)*sFac*yLimUpR3+(440.9081537009721*xLimLo[0]*xLimLo1R2-440.9081537009721*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimUpR2+(1018.233764908629*xLimUp1R3-1018.233764908629*xLimLo1R3)*sFac*yLimLoR3+(440.9081537009721*xLimUp[0]*xLimUp1R2-440.9081537009721*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimLoR2)*ycLimR2+((763.6753236814716*xLimUp1R3-763.6753236814716*xLimLo1R3)*sFac*yLimUpR4+(587.877538267963*xLimUp[0]*xLimUp1R2-587.877538267963*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimUpR3+(127.2792206135786*xLimUp0R2*xLimUp[1]-127.2792206135786*xLimLo0R2*xLimLo[1])*dyLimR2*sFac*yLimUpR2+(763.6753236814716*xLimLo1R3-763.6753236814716*xLimUp1R3)*sFac*yLimLoR4+(587.877538267963*xLimLo[0]*xLimLo1R2-587.877538267963*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimLoR3+(127.2792206135786*xLimLo0R2*xLimLo[1]-127.2792206135786*xLimUp0R2*xLimUp[1])*dyLimR2*sFac*yLimLoR2)*ycLim+(203.6467529817258*xLimLo1R3-203.6467529817258*xLimUp1R3)*sFac*yLimUpR5+(220.454076850486*xLimLo[0]*xLimLo1R2-220.454076850486*xLimUp[0]*xLimUp1R2)*dyLim*sFac*yLimUpR4+(84.85281374238573*xLimLo0R2*xLimLo[1]-84.85281374238573*xLimUp0R2*xLimUp[1])*dyLimR2*sFac*yLimUpR3+(12.24744871391589*xLimLo0R3-12.24744871391589*xLimUp0R3)*dyLimR3*sFac*yLimUpR2+(203.6467529817258*xLimUp1R3-203.6467529817258*xLimLo1R3)*sFac*yLimLoR5+(220.454076850486*xLimUp[0]*xLimUp1R2-220.454076850486*xLimLo[0]*xLimLo1R2)*dyLim*sFac*yLimLoR4+(84.85281374238573*xLimUp0R2*xLimUp[1]-84.85281374238573*xLimLo0R2*xLimLo[1])*dyLimR2*sFac*yLimLoR3+(12.24744871391589*xLimUp0R3-12.24744871391589*xLimLo0R3)*dyLimR3*sFac*yLimLoR2))/dyLimR3; 
  tsData->mat(3,2) += -(0.00625*(((1247.076581449591*xLimUp1R3-1247.076581449591*xLimLo1R3)*ySh[1]*sFac*yLimUpR2+(1247.076581449591*xLimLo1R3-1247.076581449591*xLimUp1R3)*ySh[1]*sFac*yLimLoR2)*ycLimR3+(((623.5382907247956*xLimUp1R2-623.5382907247956*xLimLo1R2)*dyLim*sFac*yLimUpR2+(623.5382907247956*xLimLo1R2-623.5382907247956*xLimUp1R2)*dyLim*sFac*yLimLoR2)*yOff+((207.8460969082653*xLimLo1R2-207.8460969082653*xLimUp1R2)*dyDo*dyLim+(2494.153162899182*xLimLo1R3-2494.153162899182*xLimUp1R3)*ySh[1])*sFac*yLimUpR3+((1080.0*xLimLo[0]*xLimLo1R2-1080.0*xLimUp[0]*xLimUp1R2)*ySh[1]-440.9081537009721*ySh[0]*xLimUp1R2+440.9081537009721*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimUpR2+((207.8460969082653*xLimUp1R2-207.8460969082653*xLimLo1R2)*dyDo*dyLim+(2494.153162899182*xLimUp1R3-2494.153162899182*xLimLo1R3)*ySh[1])*sFac*yLimLoR3+((1080.0*xLimUp[0]*xLimUp1R2-1080.0*xLimLo[0]*xLimLo1R2)*ySh[1]+440.9081537009721*ySh[0]*xLimUp1R2-440.9081537009721*ySh[0]*xLimLo1R2)*dyLim*sFac*yLimLoR2)*ycLimR2+(((831.384387633061*xLimLo1R2-831.384387633061*xLimUp1R2)*dyLim*sFac*yLimUpR3+(360.0*xLimLo[0]*xLimLo[1]-360.0*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimUpR2+(831.384387633061*xLimUp1R2-831.384387633061*xLimLo1R2)*dyLim*sFac*yLimLoR3+(360.0*xLimUp[0]*xLimUp[1]-360.0*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimLoR2)*yOff+((311.7691453623978*xLimUp1R2-311.7691453623978*xLimLo1R2)*dyDo*dyLim+(1870.614872174387*xLimUp1R3-1870.614872174387*xLimLo1R3)*ySh[1])*sFac*yLimUpR4+((120.0*xLimUp[0]*xLimUp[1]-120.0*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((1440.0*xLimUp[0]*xLimUp1R2-1440.0*xLimLo[0]*xLimLo1R2)*ySh[1]+587.877538267963*ySh[0]*xLimUp1R2-587.877538267963*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR3+((311.7691453623978*xLimUp0R2*xLimUp[1]-311.7691453623978*xLimLo0R2*xLimLo[1])*ySh[1]+254.5584412271572*xLimUp[0]*ySh[0]*xLimUp[1]-254.5584412271572*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR2+((311.7691453623978*xLimLo1R2-311.7691453623978*xLimUp1R2)*dyDo*dyLim+(1870.614872174387*xLimLo1R3-1870.614872174387*xLimUp1R3)*ySh[1])*sFac*yLimLoR4+((120.0*xLimLo[0]*xLimLo[1]-120.0*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((1440.0*xLimLo[0]*xLimLo1R2-1440.0*xLimUp[0]*xLimUp1R2)*ySh[1]-587.877538267963*ySh[0]*xLimUp1R2+587.877538267963*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR3+((311.7691453623978*xLimLo0R2*xLimLo[1]-311.7691453623978*xLimUp0R2*xLimUp[1])*ySh[1]-254.5584412271572*xLimUp[0]*ySh[0]*xLimUp[1]+254.5584412271572*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2*sFac*yLimLoR2)*ycLim+((311.7691453623978*xLimUp1R2-311.7691453623978*xLimLo1R2)*dyLim*sFac*yLimUpR4+(240.0*xLimUp[0]*xLimUp[1]-240.0*xLimLo[0]*xLimLo[1])*dyLimR2*sFac*yLimUpR3+(51.96152422706631*xLimUp0R2-51.96152422706631*xLimLo0R2)*dyLimR3*sFac*yLimUpR2+(311.7691453623978*xLimLo1R2-311.7691453623978*xLimUp1R2)*dyLim*sFac*yLimLoR4+(240.0*xLimLo[0]*xLimLo[1]-240.0*xLimUp[0]*xLimUp[1])*dyLimR2*sFac*yLimLoR3+(51.96152422706631*xLimLo0R2-51.96152422706631*xLimUp0R2)*dyLimR3*sFac*yLimLoR2)*yOff+((124.7076581449591*xLimLo1R2-124.7076581449591*xLimUp1R2)*dyDo*dyLim+(498.8306325798365*xLimLo1R3-498.8306325798365*xLimUp1R3)*ySh[1])*sFac*yLimUpR5+((90.0*xLimLo[0]*xLimLo[1]-90.0*xLimUp[0]*xLimUp[1])*dyDo*dyLimR2+((540.0*xLimLo[0]*xLimLo1R2-540.0*xLimUp[0]*xLimUp1R2)*ySh[1]-220.454076850486*ySh[0]*xLimUp1R2+220.454076850486*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimUpR4+((17.32050807568877*xLimLo0R2-17.32050807568877*xLimUp0R2)*dyDo*dyLimR3+((207.8460969082653*xLimLo0R2*xLimLo[1]-207.8460969082653*xLimUp0R2*xLimUp[1])*ySh[1]-169.7056274847715*xLimUp[0]*ySh[0]*xLimUp[1]+169.7056274847715*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimUpR3+((30.0*xLimLo0R3-30.0*xLimUp0R3)*ySh[1]+(36.74234614174767*xLimLo0R2-36.74234614174767*xLimUp0R2)*ySh[0])*dyLimR3*sFac*yLimUpR2+((124.7076581449591*xLimUp1R2-124.7076581449591*xLimLo1R2)*dyDo*dyLim+(498.8306325798365*xLimUp1R3-498.8306325798365*xLimLo1R3)*ySh[1])*sFac*yLimLoR5+((90.0*xLimUp[0]*xLimUp[1]-90.0*xLimLo[0]*xLimLo[1])*dyDo*dyLimR2+((540.0*xLimUp[0]*xLimUp1R2-540.0*xLimLo[0]*xLimLo1R2)*ySh[1]+220.454076850486*ySh[0]*xLimUp1R2-220.454076850486*ySh[0]*xLimLo1R2)*dyLim)*sFac*yLimLoR4+((17.32050807568877*xLimUp0R2-17.32050807568877*xLimLo0R2)*dyDo*dyLimR3+((207.8460969082653*xLimUp0R2*xLimUp[1]-207.8460969082653*xLimLo0R2*xLimLo[1])*ySh[1]+169.7056274847715*xLimUp[0]*ySh[0]*xLimUp[1]-169.7056274847715*xLimLo[0]*ySh[0]*xLimLo[1])*dyLimR2)*sFac*yLimLoR3+((30.0*xLimUp0R3-30.0*xLimLo0R3)*ySh[1]+(36.74234614174767*xLimUp0R2-36.74234614174767*xLimLo0R2)*ySh[0])*dyLimR3*sFac*yLimLoR2))/(dyDo*dyLimR3); 
  tsData->mat(3,3) += (0.0015625*(((15872.69353323499*xLimUp1R4-15872.69353323499*xLimLo1R4)*ySh[1]*sFac*yLimUpR2+(15872.69353323499*xLimLo1R4-15872.69353323499*xLimUp1R4)*ySh[1]*sFac*yLimLoR2)*ycLimR4+(((7054.530459215556*xLimUp1R3-7054.530459215556*xLimLo1R3)*dyLim*sFac*yLimUpR2+(7054.530459215556*xLimLo1R3-7054.530459215556*xLimUp1R3)*dyLim*sFac*yLimLoR2)*yOff+((2351.510153071853*xLimLo1R3-2351.510153071853*xLimUp1R3)*dyDo*dyLim+(42327.18275529335*xLimLo1R4-42327.18275529335*xLimUp1R4)*ySh[1])*sFac*yLimUpR3+((18328.20776835533*xLimLo[0]*xLimLo1R3-18328.20776835533*xLimUp[0]*xLimUp1R3)*ySh[1]-4988.306325798365*ySh[0]*xLimUp1R3+4988.306325798365*ySh[0]*xLimLo1R3)*dyLim*sFac*yLimUpR2+((2351.510153071853*xLimUp1R3-2351.510153071853*xLimLo1R3)*dyDo*dyLim+(42327.18275529335*xLimUp1R4-42327.18275529335*xLimLo1R4)*ySh[1])*sFac*yLimLoR3+((18328.20776835533*xLimUp[0]*xLimUp1R3-18328.20776835533*xLimLo[0]*xLimLo1R3)*ySh[1]+4988.306325798365*ySh[0]*xLimUp1R3-4988.306325798365*ySh[0]*xLimLo1R3)*dyLim*sFac*yLimLoR2)*ycLimR3+(((14109.06091843112*xLimLo1R3-14109.06091843112*xLimUp1R3)*dyLim*sFac*yLimUpR3+(6109.402589451774*xLimLo[0]*xLimLo1R2-6109.402589451774*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimUpR2+(14109.06091843112*xLimUp1R3-14109.06091843112*xLimLo1R3)*dyLim*sFac*yLimLoR3+(6109.402589451774*xLimUp[0]*xLimUp1R2-6109.402589451774*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimLoR2)*yOff+((5290.897844411666*xLimUp1R3-5290.897844411666*xLimLo1R3)*dyDo*dyLim+(47618.08059970498*xLimUp1R4-47618.08059970498*xLimLo1R4)*ySh[1])*sFac*yLimUpR4+((2036.467529817258*xLimUp[0]*xLimUp1R2-2036.467529817258*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((36656.41553671066*xLimUp[0]*xLimUp1R3-36656.41553671066*xLimLo[0]*xLimLo1R3)*ySh[1]+9976.61265159673*ySh[0]*xLimUp1R3-9976.61265159673*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR3+((7936.346766617497*xLimUp0R2*xLimUp1R2-7936.346766617497*xLimLo0R2*xLimLo1R2)*ySh[1]+4320.0*xLimUp[0]*ySh[0]*xLimUp1R2-4320.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2*sFac*yLimUpR2+((5290.897844411666*xLimLo1R3-5290.897844411666*xLimUp1R3)*dyDo*dyLim+(47618.08059970498*xLimLo1R4-47618.08059970498*xLimUp1R4)*ySh[1])*sFac*yLimLoR4+((2036.467529817258*xLimLo[0]*xLimLo1R2-2036.467529817258*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((36656.41553671066*xLimLo[0]*xLimLo1R3-36656.41553671066*xLimUp[0]*xLimUp1R3)*ySh[1]-9976.61265159673*ySh[0]*xLimUp1R3+9976.61265159673*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR3+((7936.346766617497*xLimLo0R2*xLimLo1R2-7936.346766617497*xLimUp0R2*xLimUp1R2)*ySh[1]-4320.0*xLimUp[0]*ySh[0]*xLimUp1R2+4320.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2*sFac*yLimLoR2)*ycLimR2+(((10581.79568882333*xLimUp1R3-10581.79568882333*xLimLo1R3)*dyLim*sFac*yLimUpR4+(8145.870119269036*xLimUp[0]*xLimUp1R2-8145.870119269036*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimUpR3+(1763.632614803889*xLimUp0R2*xLimUp[1]-1763.632614803889*xLimLo0R2*xLimLo[1])*dyLimR3*sFac*yLimUpR2+(10581.79568882333*xLimLo1R3-10581.79568882333*xLimUp1R3)*dyLim*sFac*yLimLoR4+(8145.870119269036*xLimLo[0]*xLimLo1R2-8145.870119269036*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimLoR3+(1763.632614803889*xLimLo0R2*xLimLo[1]-1763.632614803889*xLimUp0R2*xLimUp[1])*dyLimR3*sFac*yLimLoR2)*yOff+((4232.718275529333*xLimLo1R3-4232.718275529333*xLimUp1R3)*dyDo*dyLim+(25396.309653176*xLimLo1R4-25396.309653176*xLimUp1R4)*ySh[1])*sFac*yLimUpR5+((3054.701294725887*xLimLo[0]*xLimLo1R2-3054.701294725887*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((27492.31165253298*xLimLo[0]*xLimLo1R3-27492.31165253298*xLimUp[0]*xLimUp1R3)*ySh[1]-7482.459488697546*ySh[0]*xLimUp1R3+7482.459488697546*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR4+((587.877538267963*xLimLo0R2*xLimLo[1]-587.877538267963*xLimUp0R2*xLimUp[1])*dyDo*dyLimR3+((10581.79568882333*xLimLo0R2*xLimLo1R2-10581.79568882333*xLimUp0R2*xLimUp1R2)*ySh[1]-5760.0*xLimUp[0]*ySh[0]*xLimUp1R2+5760.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimUpR3+((1527.350647362943*xLimLo0R3*xLimLo[1]-1527.350647362943*xLimUp0R3*xLimUp[1])*ySh[1]-1247.076581449591*xLimUp0R2*ySh[0]*xLimUp[1]+1247.076581449591*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3*sFac*yLimUpR2+((4232.718275529333*xLimUp1R3-4232.718275529333*xLimLo1R3)*dyDo*dyLim+(25396.309653176*xLimUp1R4-25396.309653176*xLimLo1R4)*ySh[1])*sFac*yLimLoR5+((3054.701294725887*xLimUp[0]*xLimUp1R2-3054.701294725887*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((27492.31165253298*xLimUp[0]*xLimUp1R3-27492.31165253298*xLimLo[0]*xLimLo1R3)*ySh[1]+7482.459488697546*ySh[0]*xLimUp1R3-7482.459488697546*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR4+((587.877538267963*xLimUp0R2*xLimUp[1]-587.877538267963*xLimLo0R2*xLimLo[1])*dyDo*dyLimR3+((10581.79568882333*xLimUp0R2*xLimUp1R2-10581.79568882333*xLimLo0R2*xLimLo1R2)*ySh[1]+5760.0*xLimUp[0]*ySh[0]*xLimUp1R2-5760.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimLoR3+((1527.350647362943*xLimUp0R3*xLimUp[1]-1527.350647362943*xLimLo0R3*xLimLo[1])*ySh[1]+1247.076581449591*xLimUp0R2*ySh[0]*xLimUp[1]-1247.076581449591*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3*sFac*yLimLoR2)*ycLim+((2821.812183686223*xLimLo1R3-2821.812183686223*xLimUp1R3)*dyLim*sFac*yLimUpR5+(3054.701294725887*xLimLo[0]*xLimLo1R2-3054.701294725887*xLimUp[0]*xLimUp1R2)*dyLimR2*sFac*yLimUpR4+(1175.755076535926*xLimLo0R2*xLimLo[1]-1175.755076535926*xLimUp0R2*xLimUp[1])*dyLimR3*sFac*yLimUpR3+(169.7056274847715*xLimLo0R3-169.7056274847715*xLimUp0R3)*dyLimR4*sFac*yLimUpR2+(2821.812183686223*xLimUp1R3-2821.812183686223*xLimLo1R3)*dyLim*sFac*yLimLoR5+(3054.701294725887*xLimUp[0]*xLimUp1R2-3054.701294725887*xLimLo[0]*xLimLo1R2)*dyLimR2*sFac*yLimLoR4+(1175.755076535926*xLimUp0R2*xLimUp[1]-1175.755076535926*xLimLo0R2*xLimLo[1])*dyLimR3*sFac*yLimLoR3+(169.7056274847715*xLimUp0R3-169.7056274847715*xLimLo0R3)*dyLimR4*sFac*yLimLoR2)*yOff+((1175.755076535926*xLimUp1R3-1175.755076535926*xLimLo1R3)*dyDo*dyLim+(5290.897844411666*xLimUp1R4-5290.897844411666*xLimLo1R4)*ySh[1])*sFac*yLimUpR6+((1221.880517890355*xLimUp[0]*xLimUp1R2-1221.880517890355*xLimLo[0]*xLimLo1R2)*dyDo*dyLimR2+((7331.283107342131*xLimUp[0]*xLimUp1R3-7331.283107342131*xLimLo[0]*xLimLo1R3)*ySh[1]+1995.322530319346*ySh[0]*xLimUp1R3-1995.322530319346*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimUpR5+((440.9081537009721*xLimUp0R2*xLimUp[1]-440.9081537009721*xLimLo0R2*xLimLo[1])*dyDo*dyLimR3+((3968.173383308748*xLimUp0R2*xLimUp1R2-3968.173383308748*xLimLo0R2*xLimLo1R2)*ySh[1]+2160.0*xLimUp[0]*ySh[0]*xLimUp1R2-2160.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimUpR4+((56.56854249492383*xLimUp0R3-56.56854249492383*xLimLo0R3)*dyDo*dyLimR4+((1018.233764908629*xLimUp0R3*xLimUp[1]-1018.233764908629*xLimLo0R3*xLimLo[1])*ySh[1]+831.384387633061*xLimUp0R2*ySh[0]*xLimUp[1]-831.384387633061*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3)*sFac*yLimUpR3+((110.227038425243*xLimUp0R4-110.227038425243*xLimLo0R4)*ySh[1]+(120.0*xLimUp0R3-120.0*xLimLo0R3)*ySh[0])*dyLimR4*sFac*yLimUpR2+((1175.755076535926*xLimLo1R3-1175.755076535926*xLimUp1R3)*dyDo*dyLim+(5290.897844411666*xLimLo1R4-5290.897844411666*xLimUp1R4)*ySh[1])*sFac*yLimLoR6+((1221.880517890355*xLimLo[0]*xLimLo1R2-1221.880517890355*xLimUp[0]*xLimUp1R2)*dyDo*dyLimR2+((7331.283107342131*xLimLo[0]*xLimLo1R3-7331.283107342131*xLimUp[0]*xLimUp1R3)*ySh[1]-1995.322530319346*ySh[0]*xLimUp1R3+1995.322530319346*ySh[0]*xLimLo1R3)*dyLim)*sFac*yLimLoR5+((440.9081537009721*xLimLo0R2*xLimLo[1]-440.9081537009721*xLimUp0R2*xLimUp[1])*dyDo*dyLimR3+((3968.173383308748*xLimLo0R2*xLimLo1R2-3968.173383308748*xLimUp0R2*xLimUp1R2)*ySh[1]-2160.0*xLimUp[0]*ySh[0]*xLimUp1R2+2160.0*xLimLo[0]*ySh[0]*xLimLo1R2)*dyLimR2)*sFac*yLimLoR4+((56.56854249492383*xLimLo0R3-56.56854249492383*xLimUp0R3)*dyDo*dyLimR4+((1018.233764908629*xLimLo0R3*xLimLo[1]-1018.233764908629*xLimUp0R3*xLimUp[1])*ySh[1]-831.384387633061*xLimUp0R2*ySh[0]*xLimUp[1]+831.384387633061*xLimLo0R2*ySh[0]*xLimLo[1])*dyLimR3)*sFac*yLimLoR3+((110.227038425243*xLimLo0R4-110.227038425243*xLimUp0R4)*ySh[1]+(120.0*xLimLo0R3-120.0*xLimUp0R3)*ySh[0])*dyLimR4*sFac*yLimLoR2))/(dyDo*dyLimR4); 

  if (pushNew) {
    tsData->cellMat[xIdx-1].push_back(tsData->mat);
  } else {
    tsData->cellMat[xIdx-1].back() += tsData->mat;
  };

}

void twistShift_yLimDG2xSerP1_yShP1(const double sFac, const double xLimLo, const double xLimUp, const double *yLimLo, const double *yLimUp, const double dyDo, const double yOff, const double *ySh, tsStruct *tsData, const int xIdx, const bool pushNew) 
{ 
  // sFac:    scale factor, typically +/- 1.0.
  // xLimUp:  lower limit of the x integral in [-1,1] logical space.
  // xLimLo:  upper limit of the x integral in [-1,1] logical space.
  // yLimUp:  1D DG expansion of the function yLimLo(x) giving the lower limit of the y integral.
  // yLimLo:  1D DG expansion of the function yLimUp(x) giving the upper limit of the y integral.
  // dyDo:    y cell length of the donor cell.
  // yOff:    yOffset between the donor and target cells (in the direction of the shift).
  // ySh:     yShift translated to [-1,1] logical space.
  // tsData:  twist-shift matrices and vectors.
  // xIdx:    x-index of the cell.
  // pushNew: push_back a new matrix (true) or add contribution to the last matrix (false).

  // Length of the subregion in which the DG expansion of the yLimLo/yLimUp functions are defined.
  double dxLim = xLimUp-xLimLo;

  // Logical center of the subregion in which the DG expansion of the yLimLo/yLimUp functions are defined.
  double xcLim = 0.5*(xLimUp+xLimLo);

  tsData->mat = Eigen::MatrixXd::Zero(4,4);
  double xLimLoR2 = std::pow(xLimLo,2);
  double xLimLoR3 = std::pow(xLimLo,3);
  double xLimLoR4 = std::pow(xLimLo,4);
  double xLimLoR5 = std::pow(xLimLo,5);
  double xLimLoR6 = std::pow(xLimLo,6);
  double xLimUpR2 = std::pow(xLimUp,2);
  double xLimUpR3 = std::pow(xLimUp,3);
  double xLimUpR4 = std::pow(xLimUp,4);
  double xLimUpR5 = std::pow(xLimUp,5);
  double xLimUpR6 = std::pow(xLimUp,6);
  double dxLimR2 = std::pow(dxLim,2);
  double dxLimR3 = std::pow(dxLim,3);
  double xcLimR2 = std::pow(xcLim,2);
  double xcLimR3 = std::pow(xcLim,3);
  double yLimLo0R2 = std::pow(yLimLo[0],2);
  double yLimLo1R2 = std::pow(yLimLo[1],2);
  double yLimLo0R3 = std::pow(yLimLo[0],3);
  double yLimLo1R3 = std::pow(yLimLo[1],3);
  double yLimUp0R2 = std::pow(yLimUp[0],2);
  double yLimUp1R2 = std::pow(yLimUp[1],2);
  double yLimUp0R3 = std::pow(yLimUp[0],3);
  double yLimUp1R3 = std::pow(yLimUp[1],3);

  tsData->mat(0,0) += -(0.125*(((4.898979485566357*yLimUp[1]-4.898979485566357*yLimLo[1])*sFac*xLimUp+(4.898979485566357*yLimLo[1]-4.898979485566357*yLimUp[1])*sFac*xLimLo)*xcLim+(2.449489742783178*yLimLo[1]-2.449489742783178*yLimUp[1])*sFac*xLimUpR2+(1.414213562373095*yLimLo[0]-1.414213562373095*yLimUp[0])*dxLim*sFac*xLimUp+(2.449489742783178*yLimUp[1]-2.449489742783178*yLimLo[1])*sFac*xLimLoR2+(1.414213562373095*yLimUp[0]-1.414213562373095*yLimLo[0])*dxLim*sFac*xLimLo))/dxLim; 
  tsData->mat(0,1) += -(0.0625*(((8.485281374238571*yLimUp[1]-8.485281374238571*yLimLo[1])*sFac*xLimUpR2+(8.485281374238571*yLimLo[1]-8.485281374238571*yLimUp[1])*sFac*xLimLoR2)*xcLim+(5.656854249492382*yLimLo[1]-5.656854249492382*yLimUp[1])*sFac*xLimUpR3+(2.449489742783178*yLimLo[0]-2.449489742783178*yLimUp[0])*dxLim*sFac*xLimUpR2+(5.656854249492382*yLimUp[1]-5.656854249492382*yLimLo[1])*sFac*xLimLoR3+(2.449489742783178*yLimUp[0]-2.449489742783178*yLimLo[0])*dxLim*sFac*xLimLoR2))/dxLim; 
  tsData->mat(0,2) += (0.0625*((((33.9411254969543*yLimUp[1]-33.9411254969543*yLimLo[1])*dxLim*sFac*xLimUp+(33.9411254969543*yLimLo[1]-33.9411254969543*yLimUp[1])*dxLim*sFac*xLimLo)*xcLim+(16.97056274847715*yLimLo[1]-16.97056274847715*yLimUp[1])*dxLim*sFac*xLimUpR2+(9.797958971132715*yLimLo[0]-9.797958971132715*yLimUp[0])*dxLimR2*sFac*xLimUp+(16.97056274847715*yLimUp[1]-16.97056274847715*yLimLo[1])*dxLim*sFac*xLimLoR2+(9.797958971132715*yLimUp[0]-9.797958971132715*yLimLo[0])*dxLimR2*sFac*xLimLo)*yOff+((20.78460969082652*yLimUp1R2-20.78460969082652*yLimLo1R2)*dyDo*sFac*xLimUp+(20.78460969082652*yLimLo1R2-20.78460969082652*yLimUp1R2)*dyDo*sFac*xLimLo)*xcLimR2+(((20.78460969082652*yLimLo1R2-20.78460969082652*yLimUp1R2)*dyDo+(20.78460969082652*yLimLo[1]-20.78460969082652*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimUpR2+((12.0*yLimLo[0]*yLimLo[1]-12.0*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(24.0*ySh[0]*yLimLo[1]-24.0*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimUp+((20.78460969082652*yLimUp1R2-20.78460969082652*yLimLo1R2)*dyDo+(20.78460969082652*yLimUp[1]-20.78460969082652*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimLoR2+((12.0*yLimUp[0]*yLimUp[1]-12.0*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(24.0*ySh[0]*yLimUp[1]-24.0*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimLo)*xcLim+((6.928203230275509*yLimUp1R2-6.928203230275509*yLimLo1R2)*dyDo+(13.85640646055102*yLimUp[1]-13.85640646055102*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimUpR3+((6.0*yLimUp[0]*yLimUp[1]-6.0*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(6.0*yLimUp[0]-6.0*yLimLo[0])*ySh[1]*dxLimR2+(12.0*ySh[0]*yLimUp[1]-12.0*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimUpR2+((1.732050807568877*yLimUp0R2-1.732050807568877*yLimLo0R2)*dxLimR2*dyDo+(6.928203230275509*yLimUp[0]-6.928203230275509*yLimLo[0])*ySh[0]*dxLimR2)*sFac*xLimUp+((6.928203230275509*yLimLo1R2-6.928203230275509*yLimUp1R2)*dyDo+(13.85640646055102*yLimLo[1]-13.85640646055102*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimLoR3+((6.0*yLimLo[0]*yLimLo[1]-6.0*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(6.0*yLimLo[0]-6.0*yLimUp[0])*ySh[1]*dxLimR2+(12.0*ySh[0]*yLimLo[1]-12.0*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimLoR2+((1.732050807568877*yLimLo0R2-1.732050807568877*yLimUp0R2)*dxLimR2*dyDo+(6.928203230275509*yLimLo[0]-6.928203230275509*yLimUp[0])*ySh[0]*dxLimR2)*sFac*xLimLo))/(dxLimR2*dyDo); 
  tsData->mat(0,3) += (0.03125*((((58.7877538267963*yLimUp[1]-58.7877538267963*yLimLo[1])*dxLim*sFac*xLimUpR2+(58.7877538267963*yLimLo[1]-58.7877538267963*yLimUp[1])*dxLim*sFac*xLimLoR2)*xcLim+(39.19183588453087*yLimLo[1]-39.19183588453087*yLimUp[1])*dxLim*sFac*xLimUpR3+(16.97056274847715*yLimLo[0]-16.97056274847715*yLimUp[0])*dxLimR2*sFac*xLimUpR2+(39.19183588453087*yLimUp[1]-39.19183588453087*yLimLo[1])*dxLim*sFac*xLimLoR3+(16.97056274847715*yLimUp[0]-16.97056274847715*yLimLo[0])*dxLimR2*sFac*xLimLoR2)*yOff+((36.0*yLimUp1R2-36.0*yLimLo1R2)*dyDo*sFac*xLimUpR2+(36.0*yLimLo1R2-36.0*yLimUp1R2)*dyDo*sFac*xLimLoR2)*xcLimR2+(((48.0*yLimLo1R2-48.0*yLimUp1R2)*dyDo+(48.0*yLimLo[1]-48.0*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimUpR3+((20.78460969082652*yLimLo[0]*yLimLo[1]-20.78460969082652*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(41.56921938165305*ySh[0]*yLimLo[1]-41.56921938165305*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimUpR2+((48.0*yLimUp1R2-48.0*yLimLo1R2)*dyDo+(48.0*yLimUp[1]-48.0*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimLoR3+((20.78460969082652*yLimUp[0]*yLimUp[1]-20.78460969082652*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(41.56921938165305*ySh[0]*yLimUp[1]-41.56921938165305*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimLoR2)*xcLim+((18.0*yLimUp1R2-18.0*yLimLo1R2)*dyDo+(36.0*yLimUp[1]-36.0*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimUpR4+((13.85640646055102*yLimUp[0]*yLimUp[1]-13.85640646055102*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(13.85640646055102*yLimUp[0]-13.85640646055102*yLimLo[0])*ySh[1]*dxLimR2+(27.71281292110204*ySh[0]*yLimUp[1]-27.71281292110204*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimUpR3+((3.0*yLimUp0R2-3.0*yLimLo0R2)*dxLimR2*dyDo+(12.0*yLimUp[0]-12.0*yLimLo[0])*ySh[0]*dxLimR2)*sFac*xLimUpR2+((18.0*yLimLo1R2-18.0*yLimUp1R2)*dyDo+(36.0*yLimLo[1]-36.0*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimLoR4+((13.85640646055102*yLimLo[0]*yLimLo[1]-13.85640646055102*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(13.85640646055102*yLimLo[0]-13.85640646055102*yLimUp[0])*ySh[1]*dxLimR2+(27.71281292110204*ySh[0]*yLimLo[1]-27.71281292110204*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimLoR3+((3.0*yLimLo0R2-3.0*yLimUp0R2)*dxLimR2*dyDo+(12.0*yLimLo[0]-12.0*yLimUp[0])*ySh[0]*dxLimR2)*sFac*xLimLoR2))/(dxLimR2*dyDo); 
  tsData->mat(1,0) += -(0.0625*(((8.485281374238571*yLimUp[1]-8.485281374238571*yLimLo[1])*sFac*xLimUpR2+(8.485281374238571*yLimLo[1]-8.485281374238571*yLimUp[1])*sFac*xLimLoR2)*xcLim+(5.656854249492382*yLimLo[1]-5.656854249492382*yLimUp[1])*sFac*xLimUpR3+(2.449489742783178*yLimLo[0]-2.449489742783178*yLimUp[0])*dxLim*sFac*xLimUpR2+(5.656854249492382*yLimUp[1]-5.656854249492382*yLimLo[1])*sFac*xLimLoR3+(2.449489742783178*yLimUp[0]-2.449489742783178*yLimLo[0])*dxLim*sFac*xLimLoR2))/dxLim; 
  tsData->mat(1,1) += -(0.0625*(((9.797958971132715*yLimUp[1]-9.797958971132715*yLimLo[1])*sFac*xLimUpR3+(9.797958971132715*yLimLo[1]-9.797958971132715*yLimUp[1])*sFac*xLimLoR3)*xcLim+(7.348469228349534*yLimLo[1]-7.348469228349534*yLimUp[1])*sFac*xLimUpR4+(2.828427124746191*yLimLo[0]-2.828427124746191*yLimUp[0])*dxLim*sFac*xLimUpR3+(7.348469228349534*yLimUp[1]-7.348469228349534*yLimLo[1])*sFac*xLimLoR4+(2.828427124746191*yLimUp[0]-2.828427124746191*yLimLo[0])*dxLim*sFac*xLimLoR3))/dxLim; 
  tsData->mat(1,2) += (0.03125*((((58.7877538267963*yLimUp[1]-58.7877538267963*yLimLo[1])*dxLim*sFac*xLimUpR2+(58.7877538267963*yLimLo[1]-58.7877538267963*yLimUp[1])*dxLim*sFac*xLimLoR2)*xcLim+(39.19183588453087*yLimLo[1]-39.19183588453087*yLimUp[1])*dxLim*sFac*xLimUpR3+(16.97056274847715*yLimLo[0]-16.97056274847715*yLimUp[0])*dxLimR2*sFac*xLimUpR2+(39.19183588453087*yLimUp[1]-39.19183588453087*yLimLo[1])*dxLim*sFac*xLimLoR3+(16.97056274847715*yLimUp[0]-16.97056274847715*yLimLo[0])*dxLimR2*sFac*xLimLoR2)*yOff+((36.0*yLimUp1R2-36.0*yLimLo1R2)*dyDo*sFac*xLimUpR2+(36.0*yLimLo1R2-36.0*yLimUp1R2)*dyDo*sFac*xLimLoR2)*xcLimR2+(((48.0*yLimLo1R2-48.0*yLimUp1R2)*dyDo+(48.0*yLimLo[1]-48.0*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimUpR3+((20.78460969082652*yLimLo[0]*yLimLo[1]-20.78460969082652*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(41.56921938165305*ySh[0]*yLimLo[1]-41.56921938165305*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimUpR2+((48.0*yLimUp1R2-48.0*yLimLo1R2)*dyDo+(48.0*yLimUp[1]-48.0*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimLoR3+((20.78460969082652*yLimUp[0]*yLimUp[1]-20.78460969082652*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(41.56921938165305*ySh[0]*yLimUp[1]-41.56921938165305*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimLoR2)*xcLim+((18.0*yLimUp1R2-18.0*yLimLo1R2)*dyDo+(36.0*yLimUp[1]-36.0*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimUpR4+((13.85640646055102*yLimUp[0]*yLimUp[1]-13.85640646055102*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(13.85640646055102*yLimUp[0]-13.85640646055102*yLimLo[0])*ySh[1]*dxLimR2+(27.71281292110204*ySh[0]*yLimUp[1]-27.71281292110204*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimUpR3+((3.0*yLimUp0R2-3.0*yLimLo0R2)*dxLimR2*dyDo+(12.0*yLimUp[0]-12.0*yLimLo[0])*ySh[0]*dxLimR2)*sFac*xLimUpR2+((18.0*yLimLo1R2-18.0*yLimUp1R2)*dyDo+(36.0*yLimLo[1]-36.0*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimLoR4+((13.85640646055102*yLimLo[0]*yLimLo[1]-13.85640646055102*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(13.85640646055102*yLimLo[0]-13.85640646055102*yLimUp[0])*ySh[1]*dxLimR2+(27.71281292110204*ySh[0]*yLimLo[1]-27.71281292110204*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimLoR3+((3.0*yLimLo0R2-3.0*yLimUp0R2)*dxLimR2*dyDo+(12.0*yLimLo[0]-12.0*yLimUp[0])*ySh[0]*dxLimR2)*sFac*xLimLoR2))/(dxLimR2*dyDo); 
  tsData->mat(1,3) += (0.0125*((((169.7056274847715*yLimUp[1]-169.7056274847715*yLimLo[1])*dxLim*sFac*xLimUpR3+(169.7056274847715*yLimLo[1]-169.7056274847715*yLimUp[1])*dxLim*sFac*xLimLoR3)*xcLim+(127.2792206135786*yLimLo[1]-127.2792206135786*yLimUp[1])*dxLim*sFac*xLimUpR4+(48.98979485566358*yLimLo[0]-48.98979485566358*yLimUp[0])*dxLimR2*sFac*xLimUpR3+(127.2792206135786*yLimUp[1]-127.2792206135786*yLimLo[1])*dxLim*sFac*xLimLoR4+(48.98979485566358*yLimUp[0]-48.98979485566358*yLimLo[0])*dxLimR2*sFac*xLimLoR3)*yOff+((103.9230484541326*yLimUp1R2-103.9230484541326*yLimLo1R2)*dyDo*sFac*xLimUpR3+(103.9230484541326*yLimLo1R2-103.9230484541326*yLimUp1R2)*dyDo*sFac*xLimLoR3)*xcLimR2+(((155.8845726811989*yLimLo1R2-155.8845726811989*yLimUp1R2)*dyDo+(155.8845726811989*yLimLo[1]-155.8845726811989*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimUpR4+((60.0*yLimLo[0]*yLimLo[1]-60.0*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(120.0*ySh[0]*yLimLo[1]-120.0*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimUpR3+((155.8845726811989*yLimUp1R2-155.8845726811989*yLimLo1R2)*dyDo+(155.8845726811989*yLimUp[1]-155.8845726811989*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimLoR4+((60.0*yLimUp[0]*yLimUp[1]-60.0*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(120.0*ySh[0]*yLimUp[1]-120.0*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimLoR3)*xcLim+((62.35382907247956*yLimUp1R2-62.35382907247956*yLimLo1R2)*dyDo+(124.7076581449591*yLimUp[1]-124.7076581449591*yLimLo[1])*ySh[1]*dxLim)*sFac*xLimUpR5+((45.0*yLimUp[0]*yLimUp[1]-45.0*yLimLo[0]*yLimLo[1])*dxLim*dyDo+(45.0*yLimUp[0]-45.0*yLimLo[0])*ySh[1]*dxLimR2+(90.0*ySh[0]*yLimUp[1]-90.0*ySh[0]*yLimLo[1])*dxLim)*sFac*xLimUpR4+((8.660254037844386*yLimUp0R2-8.660254037844386*yLimLo0R2)*dxLimR2*dyDo+(34.64101615137754*yLimUp[0]-34.64101615137754*yLimLo[0])*ySh[0]*dxLimR2)*sFac*xLimUpR3+((62.35382907247956*yLimLo1R2-62.35382907247956*yLimUp1R2)*dyDo+(124.7076581449591*yLimLo[1]-124.7076581449591*yLimUp[1])*ySh[1]*dxLim)*sFac*xLimLoR5+((45.0*yLimLo[0]*yLimLo[1]-45.0*yLimUp[0]*yLimUp[1])*dxLim*dyDo+(45.0*yLimLo[0]-45.0*yLimUp[0])*ySh[1]*dxLimR2+(90.0*ySh[0]*yLimLo[1]-90.0*ySh[0]*yLimUp[1])*dxLim)*sFac*xLimLoR4+((8.660254037844386*yLimLo0R2-8.660254037844386*yLimUp0R2)*dxLimR2*dyDo+(34.64101615137754*yLimLo[0]-34.64101615137754*yLimUp[0])*ySh[0]*dxLimR2)*sFac*xLimLoR3))/(dxLimR2*dyDo); 
  tsData->mat(2,0) += (0.0625*(((20.78460969082652*yLimUp1R2-20.78460969082652*yLimLo1R2)*sFac*xLimUp+(20.78460969082652*yLimLo1R2-20.78460969082652*yLimUp1R2)*sFac*xLimLo)*xcLimR2+((20.78460969082652*yLimLo1R2-20.78460969082652*yLimUp1R2)*sFac*xLimUpR2+(12.0*yLimLo[0]*yLimLo[1]-12.0*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimUp+(20.78460969082652*yLimUp1R2-20.78460969082652*yLimLo1R2)*sFac*xLimLoR2+(12.0*yLimUp[0]*yLimUp[1]-12.0*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimLo)*xcLim+(6.928203230275509*yLimUp1R2-6.928203230275509*yLimLo1R2)*sFac*xLimUpR3+(6.0*yLimUp[0]*yLimUp[1]-6.0*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimUpR2+(1.732050807568877*yLimUp0R2-1.732050807568877*yLimLo0R2)*dxLimR2*sFac*xLimUp+(6.928203230275509*yLimLo1R2-6.928203230275509*yLimUp1R2)*sFac*xLimLoR3+(6.0*yLimLo[0]*yLimLo[1]-6.0*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimLoR2+(1.732050807568877*yLimLo0R2-1.732050807568877*yLimUp0R2)*dxLimR2*sFac*xLimLo))/dxLimR2; 
  tsData->mat(2,1) += (0.03125*(((36.0*yLimUp1R2-36.0*yLimLo1R2)*sFac*xLimUpR2+(36.0*yLimLo1R2-36.0*yLimUp1R2)*sFac*xLimLoR2)*xcLimR2+((48.0*yLimLo1R2-48.0*yLimUp1R2)*sFac*xLimUpR3+(20.78460969082652*yLimLo[0]*yLimLo[1]-20.78460969082652*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimUpR2+(48.0*yLimUp1R2-48.0*yLimLo1R2)*sFac*xLimLoR3+(20.78460969082652*yLimUp[0]*yLimUp[1]-20.78460969082652*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimLoR2)*xcLim+(18.0*yLimUp1R2-18.0*yLimLo1R2)*sFac*xLimUpR4+(13.85640646055102*yLimUp[0]*yLimUp[1]-13.85640646055102*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimUpR3+(3.0*yLimUp0R2-3.0*yLimLo0R2)*dxLimR2*sFac*xLimUpR2+(18.0*yLimLo1R2-18.0*yLimUp1R2)*sFac*xLimLoR4+(13.85640646055102*yLimLo[0]*yLimLo[1]-13.85640646055102*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimLoR3+(3.0*yLimLo0R2-3.0*yLimUp0R2)*dxLimR2*sFac*xLimLoR2))/dxLimR2; 
  tsData->mat(2,2) += -(0.03125*((((144.0*yLimUp1R2-144.0*yLimLo1R2)*dxLim*sFac*xLimUp+(144.0*yLimLo1R2-144.0*yLimUp1R2)*dxLim*sFac*xLimLo)*xcLimR2+((144.0*yLimLo1R2-144.0*yLimUp1R2)*dxLim*sFac*xLimUpR2+(83.1384387633061*yLimLo[0]*yLimLo[1]-83.1384387633061*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimUp+(144.0*yLimUp1R2-144.0*yLimLo1R2)*dxLim*sFac*xLimLoR2+(83.1384387633061*yLimUp[0]*yLimUp[1]-83.1384387633061*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimLo)*xcLim+(48.0*yLimUp1R2-48.0*yLimLo1R2)*dxLim*sFac*xLimUpR3+(41.56921938165305*yLimUp[0]*yLimUp[1]-41.56921938165305*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimUpR2+(12.0*yLimUp0R2-12.0*yLimLo0R2)*dxLimR3*sFac*xLimUp+(48.0*yLimLo1R2-48.0*yLimUp1R2)*dxLim*sFac*xLimLoR3+(41.56921938165305*yLimLo[0]*yLimLo[1]-41.56921938165305*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimLoR2+(12.0*yLimLo0R2-12.0*yLimUp0R2)*dxLimR3*sFac*xLimLo)*yOff+((117.5755076535926*yLimUp1R3-117.5755076535926*yLimLo1R3)*dyDo*sFac*xLimUp+(117.5755076535926*yLimLo1R3-117.5755076535926*yLimUp1R3)*dyDo*sFac*xLimLo)*xcLimR3+(((176.3632614803889*yLimLo1R3-176.3632614803889*yLimUp1R3)*dyDo+(88.18163074019442*yLimLo1R2-88.18163074019442*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR2+((101.8233764908629*yLimLo[0]*yLimLo1R2-101.8233764908629*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(101.8233764908629*ySh[0]*yLimLo1R2-101.8233764908629*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUp+((176.3632614803889*yLimUp1R3-176.3632614803889*yLimLo1R3)*dyDo+(88.18163074019442*yLimUp1R2-88.18163074019442*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR2+((101.8233764908629*yLimUp[0]*yLimUp1R2-101.8233764908629*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(101.8233764908629*ySh[0]*yLimUp1R2-101.8233764908629*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLo)*xcLimR2+(((117.5755076535926*yLimUp1R3-117.5755076535926*yLimLo1R3)*dyDo+(117.5755076535926*yLimUp1R2-117.5755076535926*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimUpR3+((101.8233764908629*yLimUp[0]*yLimUp1R2-101.8233764908629*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(50.91168824543144*yLimUp[0]*yLimUp[1]-50.91168824543144*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(101.8233764908629*ySh[0]*yLimUp1R2-101.8233764908629*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimUpR2+((29.39387691339815*yLimUp0R2*yLimUp[1]-29.39387691339815*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(58.7877538267963*yLimUp[0]*ySh[0]*yLimUp[1]-58.7877538267963*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimUp+((117.5755076535926*yLimLo1R3-117.5755076535926*yLimUp1R3)*dyDo+(117.5755076535926*yLimLo1R2-117.5755076535926*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimLoR3+((101.8233764908629*yLimLo[0]*yLimLo1R2-101.8233764908629*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(50.91168824543144*yLimLo[0]*yLimLo[1]-50.91168824543144*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(101.8233764908629*ySh[0]*yLimLo1R2-101.8233764908629*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimLoR2+((29.39387691339815*yLimLo0R2*yLimLo[1]-29.39387691339815*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(58.7877538267963*yLimLo[0]*ySh[0]*yLimLo[1]-58.7877538267963*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimLo)*xcLim+((29.39387691339815*yLimLo1R3-29.39387691339815*yLimUp1R3)*dyDo+(44.0908153700972*yLimLo1R2-44.0908153700972*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR4+((33.9411254969543*yLimLo[0]*yLimLo1R2-33.9411254969543*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(33.9411254969543*yLimLo[0]*yLimLo[1]-33.9411254969543*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(33.9411254969543*ySh[0]*yLimLo1R2-33.9411254969543*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR3+((14.69693845669907*yLimLo0R2*yLimLo[1]-14.69693845669907*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(7.348469228349534*yLimLo0R2-7.348469228349534*yLimUp0R2)*ySh[1]*dxLimR3+(29.39387691339815*yLimLo[0]*ySh[0]*yLimLo[1]-29.39387691339815*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimUpR2+((2.828427124746191*yLimLo0R3-2.828427124746191*yLimUp0R3)*dxLimR3*dyDo+(8.485281374238571*yLimLo0R2-8.485281374238571*yLimUp0R2)*ySh[0]*dxLimR3)*sFac*xLimUp+((29.39387691339815*yLimUp1R3-29.39387691339815*yLimLo1R3)*dyDo+(44.0908153700972*yLimUp1R2-44.0908153700972*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR4+((33.9411254969543*yLimUp[0]*yLimUp1R2-33.9411254969543*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(33.9411254969543*yLimUp[0]*yLimUp[1]-33.9411254969543*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(33.9411254969543*ySh[0]*yLimUp1R2-33.9411254969543*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR3+((14.69693845669907*yLimUp0R2*yLimUp[1]-14.69693845669907*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(7.348469228349534*yLimUp0R2-7.348469228349534*yLimLo0R2)*ySh[1]*dxLimR3+(29.39387691339815*yLimUp[0]*ySh[0]*yLimUp[1]-29.39387691339815*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimLoR2+((2.828427124746191*yLimUp0R3-2.828427124746191*yLimLo0R3)*dxLimR3*dyDo+(8.485281374238571*yLimUp0R2-8.485281374238571*yLimLo0R2)*ySh[0]*dxLimR3)*sFac*xLimLo))/(dxLimR3*dyDo); 
  tsData->mat(2,3) += -(0.00625*((((623.5382907247956*yLimUp1R2-623.5382907247956*yLimLo1R2)*dxLim*sFac*xLimUpR2+(623.5382907247956*yLimLo1R2-623.5382907247956*yLimUp1R2)*dxLim*sFac*xLimLoR2)*xcLimR2+((831.384387633061*yLimLo1R2-831.384387633061*yLimUp1R2)*dxLim*sFac*xLimUpR3+(360.0*yLimLo[0]*yLimLo[1]-360.0*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimUpR2+(831.384387633061*yLimUp1R2-831.384387633061*yLimLo1R2)*dxLim*sFac*xLimLoR3+(360.0*yLimUp[0]*yLimUp[1]-360.0*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimLoR2)*xcLim+(311.7691453623978*yLimUp1R2-311.7691453623978*yLimLo1R2)*dxLim*sFac*xLimUpR4+(240.0*yLimUp[0]*yLimUp[1]-240.0*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimUpR3+(51.96152422706631*yLimUp0R2-51.96152422706631*yLimLo0R2)*dxLimR3*sFac*xLimUpR2+(311.7691453623978*yLimLo1R2-311.7691453623978*yLimUp1R2)*dxLim*sFac*xLimLoR4+(240.0*yLimLo[0]*yLimLo[1]-240.0*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimLoR3+(51.96152422706631*yLimLo0R2-51.96152422706631*yLimUp0R2)*dxLimR3*sFac*xLimLoR2)*yOff+((509.1168824543145*yLimUp1R3-509.1168824543145*yLimLo1R3)*dyDo*sFac*xLimUpR2+(509.1168824543145*yLimLo1R3-509.1168824543145*yLimUp1R3)*dyDo*sFac*xLimLoR2)*xcLimR3+(((1018.233764908629*yLimLo1R3-1018.233764908629*yLimUp1R3)*dyDo+(509.1168824543145*yLimLo1R2-509.1168824543145*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR3+((440.9081537009721*yLimLo[0]*yLimLo1R2-440.9081537009721*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(440.9081537009721*ySh[0]*yLimLo1R2-440.9081537009721*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR2+((1018.233764908629*yLimUp1R3-1018.233764908629*yLimLo1R3)*dyDo+(509.1168824543145*yLimUp1R2-509.1168824543145*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR3+((440.9081537009721*yLimUp[0]*yLimUp1R2-440.9081537009721*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(440.9081537009721*ySh[0]*yLimUp1R2-440.9081537009721*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR2)*xcLimR2+(((763.6753236814716*yLimUp1R3-763.6753236814716*yLimLo1R3)*dyDo+(763.6753236814716*yLimUp1R2-763.6753236814716*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimUpR4+((587.877538267963*yLimUp[0]*yLimUp1R2-587.877538267963*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(293.9387691339815*yLimUp[0]*yLimUp[1]-293.9387691339815*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(587.877538267963*ySh[0]*yLimUp1R2-587.877538267963*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimUpR3+((127.2792206135786*yLimUp0R2*yLimUp[1]-127.2792206135786*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(254.5584412271572*yLimUp[0]*ySh[0]*yLimUp[1]-254.5584412271572*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimUpR2+((763.6753236814716*yLimLo1R3-763.6753236814716*yLimUp1R3)*dyDo+(763.6753236814716*yLimLo1R2-763.6753236814716*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimLoR4+((587.877538267963*yLimLo[0]*yLimLo1R2-587.877538267963*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(293.9387691339815*yLimLo[0]*yLimLo[1]-293.9387691339815*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(587.877538267963*ySh[0]*yLimLo1R2-587.877538267963*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimLoR3+((127.2792206135786*yLimLo0R2*yLimLo[1]-127.2792206135786*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(254.5584412271572*yLimLo[0]*ySh[0]*yLimLo[1]-254.5584412271572*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimLoR2)*xcLim+((203.6467529817258*yLimLo1R3-203.6467529817258*yLimUp1R3)*dyDo+(305.4701294725887*yLimLo1R2-305.4701294725887*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR5+((220.454076850486*yLimLo[0]*yLimLo1R2-220.454076850486*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(220.454076850486*yLimLo[0]*yLimLo[1]-220.454076850486*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(220.454076850486*ySh[0]*yLimLo1R2-220.454076850486*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR4+((84.85281374238573*yLimLo0R2*yLimLo[1]-84.85281374238573*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(42.42640687119286*yLimLo0R2-42.42640687119286*yLimUp0R2)*ySh[1]*dxLimR3+(169.7056274847715*yLimLo[0]*ySh[0]*yLimLo[1]-169.7056274847715*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimUpR3+((12.24744871391589*yLimLo0R3-12.24744871391589*yLimUp0R3)*dxLimR3*dyDo+(36.74234614174767*yLimLo0R2-36.74234614174767*yLimUp0R2)*ySh[0]*dxLimR3)*sFac*xLimUpR2+((203.6467529817258*yLimUp1R3-203.6467529817258*yLimLo1R3)*dyDo+(305.4701294725887*yLimUp1R2-305.4701294725887*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR5+((220.454076850486*yLimUp[0]*yLimUp1R2-220.454076850486*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(220.454076850486*yLimUp[0]*yLimUp[1]-220.454076850486*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(220.454076850486*ySh[0]*yLimUp1R2-220.454076850486*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR4+((84.85281374238573*yLimUp0R2*yLimUp[1]-84.85281374238573*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(42.42640687119286*yLimUp0R2-42.42640687119286*yLimLo0R2)*ySh[1]*dxLimR3+(169.7056274847715*yLimUp[0]*ySh[0]*yLimUp[1]-169.7056274847715*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimLoR3+((12.24744871391589*yLimUp0R3-12.24744871391589*yLimLo0R3)*dxLimR3*dyDo+(36.74234614174767*yLimUp0R2-36.74234614174767*yLimLo0R2)*ySh[0]*dxLimR3)*sFac*xLimLoR2))/(dxLimR3*dyDo); 
  tsData->mat(3,0) += (0.03125*(((36.0*yLimUp1R2-36.0*yLimLo1R2)*sFac*xLimUpR2+(36.0*yLimLo1R2-36.0*yLimUp1R2)*sFac*xLimLoR2)*xcLimR2+((48.0*yLimLo1R2-48.0*yLimUp1R2)*sFac*xLimUpR3+(20.78460969082652*yLimLo[0]*yLimLo[1]-20.78460969082652*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimUpR2+(48.0*yLimUp1R2-48.0*yLimLo1R2)*sFac*xLimLoR3+(20.78460969082652*yLimUp[0]*yLimUp[1]-20.78460969082652*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimLoR2)*xcLim+(18.0*yLimUp1R2-18.0*yLimLo1R2)*sFac*xLimUpR4+(13.85640646055102*yLimUp[0]*yLimUp[1]-13.85640646055102*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimUpR3+(3.0*yLimUp0R2-3.0*yLimLo0R2)*dxLimR2*sFac*xLimUpR2+(18.0*yLimLo1R2-18.0*yLimUp1R2)*sFac*xLimLoR4+(13.85640646055102*yLimLo[0]*yLimLo[1]-13.85640646055102*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimLoR3+(3.0*yLimLo0R2-3.0*yLimUp0R2)*dxLimR2*sFac*xLimLoR2))/dxLimR2; 
  tsData->mat(3,1) += (0.0125*(((103.9230484541326*yLimUp1R2-103.9230484541326*yLimLo1R2)*sFac*xLimUpR3+(103.9230484541326*yLimLo1R2-103.9230484541326*yLimUp1R2)*sFac*xLimLoR3)*xcLimR2+((155.8845726811989*yLimLo1R2-155.8845726811989*yLimUp1R2)*sFac*xLimUpR4+(60.0*yLimLo[0]*yLimLo[1]-60.0*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimUpR3+(155.8845726811989*yLimUp1R2-155.8845726811989*yLimLo1R2)*sFac*xLimLoR4+(60.0*yLimUp[0]*yLimUp[1]-60.0*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimLoR3)*xcLim+(62.35382907247956*yLimUp1R2-62.35382907247956*yLimLo1R2)*sFac*xLimUpR5+(45.0*yLimUp[0]*yLimUp[1]-45.0*yLimLo[0]*yLimLo[1])*dxLim*sFac*xLimUpR4+(8.660254037844386*yLimUp0R2-8.660254037844386*yLimLo0R2)*dxLimR2*sFac*xLimUpR3+(62.35382907247956*yLimLo1R2-62.35382907247956*yLimUp1R2)*sFac*xLimLoR5+(45.0*yLimLo[0]*yLimLo[1]-45.0*yLimUp[0]*yLimUp[1])*dxLim*sFac*xLimLoR4+(8.660254037844386*yLimLo0R2-8.660254037844386*yLimUp0R2)*dxLimR2*sFac*xLimLoR3))/dxLimR2; 
  tsData->mat(3,2) += -(0.00625*((((623.5382907247956*yLimUp1R2-623.5382907247956*yLimLo1R2)*dxLim*sFac*xLimUpR2+(623.5382907247956*yLimLo1R2-623.5382907247956*yLimUp1R2)*dxLim*sFac*xLimLoR2)*xcLimR2+((831.384387633061*yLimLo1R2-831.384387633061*yLimUp1R2)*dxLim*sFac*xLimUpR3+(360.0*yLimLo[0]*yLimLo[1]-360.0*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimUpR2+(831.384387633061*yLimUp1R2-831.384387633061*yLimLo1R2)*dxLim*sFac*xLimLoR3+(360.0*yLimUp[0]*yLimUp[1]-360.0*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimLoR2)*xcLim+(311.7691453623978*yLimUp1R2-311.7691453623978*yLimLo1R2)*dxLim*sFac*xLimUpR4+(240.0*yLimUp[0]*yLimUp[1]-240.0*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimUpR3+(51.96152422706631*yLimUp0R2-51.96152422706631*yLimLo0R2)*dxLimR3*sFac*xLimUpR2+(311.7691453623978*yLimLo1R2-311.7691453623978*yLimUp1R2)*dxLim*sFac*xLimLoR4+(240.0*yLimLo[0]*yLimLo[1]-240.0*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimLoR3+(51.96152422706631*yLimLo0R2-51.96152422706631*yLimUp0R2)*dxLimR3*sFac*xLimLoR2)*yOff+((509.1168824543145*yLimUp1R3-509.1168824543145*yLimLo1R3)*dyDo*sFac*xLimUpR2+(509.1168824543145*yLimLo1R3-509.1168824543145*yLimUp1R3)*dyDo*sFac*xLimLoR2)*xcLimR3+(((1018.233764908629*yLimLo1R3-1018.233764908629*yLimUp1R3)*dyDo+(509.1168824543145*yLimLo1R2-509.1168824543145*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR3+((440.9081537009721*yLimLo[0]*yLimLo1R2-440.9081537009721*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(440.9081537009721*ySh[0]*yLimLo1R2-440.9081537009721*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR2+((1018.233764908629*yLimUp1R3-1018.233764908629*yLimLo1R3)*dyDo+(509.1168824543145*yLimUp1R2-509.1168824543145*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR3+((440.9081537009721*yLimUp[0]*yLimUp1R2-440.9081537009721*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(440.9081537009721*ySh[0]*yLimUp1R2-440.9081537009721*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR2)*xcLimR2+(((763.6753236814716*yLimUp1R3-763.6753236814716*yLimLo1R3)*dyDo+(763.6753236814716*yLimUp1R2-763.6753236814716*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimUpR4+((587.877538267963*yLimUp[0]*yLimUp1R2-587.877538267963*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(293.9387691339815*yLimUp[0]*yLimUp[1]-293.9387691339815*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(587.877538267963*ySh[0]*yLimUp1R2-587.877538267963*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimUpR3+((127.2792206135786*yLimUp0R2*yLimUp[1]-127.2792206135786*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(254.5584412271572*yLimUp[0]*ySh[0]*yLimUp[1]-254.5584412271572*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimUpR2+((763.6753236814716*yLimLo1R3-763.6753236814716*yLimUp1R3)*dyDo+(763.6753236814716*yLimLo1R2-763.6753236814716*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimLoR4+((587.877538267963*yLimLo[0]*yLimLo1R2-587.877538267963*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(293.9387691339815*yLimLo[0]*yLimLo[1]-293.9387691339815*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(587.877538267963*ySh[0]*yLimLo1R2-587.877538267963*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimLoR3+((127.2792206135786*yLimLo0R2*yLimLo[1]-127.2792206135786*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(254.5584412271572*yLimLo[0]*ySh[0]*yLimLo[1]-254.5584412271572*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimLoR2)*xcLim+((203.6467529817258*yLimLo1R3-203.6467529817258*yLimUp1R3)*dyDo+(305.4701294725887*yLimLo1R2-305.4701294725887*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR5+((220.454076850486*yLimLo[0]*yLimLo1R2-220.454076850486*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(220.454076850486*yLimLo[0]*yLimLo[1]-220.454076850486*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(220.454076850486*ySh[0]*yLimLo1R2-220.454076850486*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR4+((84.85281374238573*yLimLo0R2*yLimLo[1]-84.85281374238573*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(42.42640687119286*yLimLo0R2-42.42640687119286*yLimUp0R2)*ySh[1]*dxLimR3+(169.7056274847715*yLimLo[0]*ySh[0]*yLimLo[1]-169.7056274847715*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimUpR3+((12.24744871391589*yLimLo0R3-12.24744871391589*yLimUp0R3)*dxLimR3*dyDo+(36.74234614174767*yLimLo0R2-36.74234614174767*yLimUp0R2)*ySh[0]*dxLimR3)*sFac*xLimUpR2+((203.6467529817258*yLimUp1R3-203.6467529817258*yLimLo1R3)*dyDo+(305.4701294725887*yLimUp1R2-305.4701294725887*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR5+((220.454076850486*yLimUp[0]*yLimUp1R2-220.454076850486*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(220.454076850486*yLimUp[0]*yLimUp[1]-220.454076850486*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(220.454076850486*ySh[0]*yLimUp1R2-220.454076850486*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR4+((84.85281374238573*yLimUp0R2*yLimUp[1]-84.85281374238573*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(42.42640687119286*yLimUp0R2-42.42640687119286*yLimLo0R2)*ySh[1]*dxLimR3+(169.7056274847715*yLimUp[0]*ySh[0]*yLimUp[1]-169.7056274847715*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimLoR3+((12.24744871391589*yLimUp0R3-12.24744871391589*yLimLo0R3)*dxLimR3*dyDo+(36.74234614174767*yLimUp0R2-36.74234614174767*yLimLo0R2)*ySh[0]*dxLimR3)*sFac*xLimLoR2))/(dxLimR3*dyDo); 
  tsData->mat(3,3) += -(0.003125*((((1440.0*yLimUp1R2-1440.0*yLimLo1R2)*dxLim*sFac*xLimUpR3+(1440.0*yLimLo1R2-1440.0*yLimUp1R2)*dxLim*sFac*xLimLoR3)*xcLimR2+((2160.0*yLimLo1R2-2160.0*yLimUp1R2)*dxLim*sFac*xLimUpR4+(831.384387633061*yLimLo[0]*yLimLo[1]-831.384387633061*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimUpR3+(2160.0*yLimUp1R2-2160.0*yLimLo1R2)*dxLim*sFac*xLimLoR4+(831.384387633061*yLimUp[0]*yLimUp[1]-831.384387633061*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimLoR3)*xcLim+(864.0*yLimUp1R2-864.0*yLimLo1R2)*dxLim*sFac*xLimUpR5+(623.5382907247956*yLimUp[0]*yLimUp[1]-623.5382907247956*yLimLo[0]*yLimLo[1])*dxLimR2*sFac*xLimUpR4+(120.0*yLimUp0R2-120.0*yLimLo0R2)*dxLimR3*sFac*xLimUpR3+(864.0*yLimLo1R2-864.0*yLimUp1R2)*dxLim*sFac*xLimLoR5+(623.5382907247956*yLimLo[0]*yLimLo[1]-623.5382907247956*yLimUp[0]*yLimUp[1])*dxLimR2*sFac*xLimLoR4+(120.0*yLimLo0R2-120.0*yLimUp0R2)*dxLimR3*sFac*xLimLoR3)*yOff+((1175.755076535926*yLimUp1R3-1175.755076535926*yLimLo1R3)*dyDo*sFac*xLimUpR3+(1175.755076535926*yLimLo1R3-1175.755076535926*yLimUp1R3)*dyDo*sFac*xLimLoR3)*xcLimR3+(((2645.448922205833*yLimLo1R3-2645.448922205833*yLimUp1R3)*dyDo+(1322.724461102916*yLimLo1R2-1322.724461102916*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR4+((1018.233764908629*yLimLo[0]*yLimLo1R2-1018.233764908629*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(1018.233764908629*ySh[0]*yLimLo1R2-1018.233764908629*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR3+((2645.448922205833*yLimUp1R3-2645.448922205833*yLimLo1R3)*dyDo+(1322.724461102916*yLimUp1R2-1322.724461102916*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR4+((1018.233764908629*yLimUp[0]*yLimUp1R2-1018.233764908629*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(1018.233764908629*ySh[0]*yLimUp1R2-1018.233764908629*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR3)*xcLimR2+(((2116.359137764666*yLimUp1R3-2116.359137764666*yLimLo1R3)*dyDo+(2116.359137764666*yLimUp1R2-2116.359137764666*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimUpR5+((1527.350647362943*yLimUp[0]*yLimUp1R2-1527.350647362943*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(763.6753236814716*yLimUp[0]*yLimUp[1]-763.6753236814716*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(1527.350647362943*ySh[0]*yLimUp1R2-1527.350647362943*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimUpR4+((293.9387691339815*yLimUp0R2*yLimUp[1]-293.9387691339815*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(587.877538267963*yLimUp[0]*ySh[0]*yLimUp[1]-587.877538267963*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimUpR3+((2116.359137764666*yLimLo1R3-2116.359137764666*yLimUp1R3)*dyDo+(2116.359137764666*yLimLo1R2-2116.359137764666*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimLoR5+((1527.350647362943*yLimLo[0]*yLimLo1R2-1527.350647362943*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(763.6753236814716*yLimLo[0]*yLimLo[1]-763.6753236814716*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(1527.350647362943*ySh[0]*yLimLo1R2-1527.350647362943*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimLoR4+((293.9387691339815*yLimLo0R2*yLimLo[1]-293.9387691339815*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(587.877538267963*yLimLo[0]*ySh[0]*yLimLo[1]-587.877538267963*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimLoR3)*xcLim+((587.877538267963*yLimLo1R3-587.877538267963*yLimUp1R3)*dyDo+(881.8163074019443*yLimLo1R2-881.8163074019443*yLimUp1R2)*ySh[1]*dxLim)*sFac*xLimUpR6+((610.9402589451774*yLimLo[0]*yLimLo1R2-610.9402589451774*yLimUp[0]*yLimUp1R2)*dxLim*dyDo+(610.9402589451774*yLimLo[0]*yLimLo[1]-610.9402589451774*yLimUp[0]*yLimUp[1])*ySh[1]*dxLimR2+(610.9402589451774*ySh[0]*yLimLo1R2-610.9402589451774*ySh[0]*yLimUp1R2)*dxLim)*sFac*xLimUpR5+((220.454076850486*yLimLo0R2*yLimLo[1]-220.454076850486*yLimUp0R2*yLimUp[1])*dxLimR2*dyDo+(110.227038425243*yLimLo0R2-110.227038425243*yLimUp0R2)*ySh[1]*dxLimR3+(440.9081537009721*yLimLo[0]*ySh[0]*yLimLo[1]-440.9081537009721*yLimUp[0]*ySh[0]*yLimUp[1])*dxLimR2)*sFac*xLimUpR4+((28.28427124746191*yLimLo0R3-28.28427124746191*yLimUp0R3)*dxLimR3*dyDo+(84.85281374238573*yLimLo0R2-84.85281374238573*yLimUp0R2)*ySh[0]*dxLimR3)*sFac*xLimUpR3+((587.877538267963*yLimUp1R3-587.877538267963*yLimLo1R3)*dyDo+(881.8163074019443*yLimUp1R2-881.8163074019443*yLimLo1R2)*ySh[1]*dxLim)*sFac*xLimLoR6+((610.9402589451774*yLimUp[0]*yLimUp1R2-610.9402589451774*yLimLo[0]*yLimLo1R2)*dxLim*dyDo+(610.9402589451774*yLimUp[0]*yLimUp[1]-610.9402589451774*yLimLo[0]*yLimLo[1])*ySh[1]*dxLimR2+(610.9402589451774*ySh[0]*yLimUp1R2-610.9402589451774*ySh[0]*yLimLo1R2)*dxLim)*sFac*xLimLoR5+((220.454076850486*yLimUp0R2*yLimUp[1]-220.454076850486*yLimLo0R2*yLimLo[1])*dxLimR2*dyDo+(110.227038425243*yLimUp0R2-110.227038425243*yLimLo0R2)*ySh[1]*dxLimR3+(440.9081537009721*yLimUp[0]*ySh[0]*yLimUp[1]-440.9081537009721*yLimLo[0]*ySh[0]*yLimLo[1])*dxLimR2)*sFac*xLimLoR4+((28.28427124746191*yLimUp0R3-28.28427124746191*yLimLo0R3)*dxLimR3*dyDo+(84.85281374238573*yLimUp0R2-84.85281374238573*yLimLo0R2)*ySh[0]*dxLimR3)*sFac*xLimLoR3))/(dxLimR3*dyDo); 

  if (pushNew) {
    tsData->cellMat[xIdx-1].push_back(tsData->mat);
  } else {
    tsData->cellMat[xIdx-1].back() += tsData->mat;
  };

}

void twistShift_fullCell2xSerP1_yShP1(const double dyDo, const double yOff, const double *ySh, tsStruct *tsData, const int xIdx, const bool pushNew) 
{ 
  // dyDo:   y cell length of the donor cell.
  // yOff:   yOffset between the donor and target cells (in the direction of the shift).
  // ySh:    yShift translated to [-1,1] logical space.
  // tsData: twist-shift matrices and vectors.
  // xIdx:   x-index of the cell.
  // pushNew: push_back a new matrix (true) or add contribution to the last matrix (false).

  tsData->mat = Eigen::MatrixXd::Zero(4,4);

  tsData->mat(0,0) += 1.0; 
  tsData->mat(0,2) += -(1.0*(3.464101615137754*yOff-2.449489742783178*ySh[0]))/dyDo; 
  tsData->mat(0,3) += (2.449489742783178*ySh[1])/dyDo; 
  tsData->mat(1,1) += 1.0; 
  tsData->mat(1,2) += (2.449489742783178*ySh[1])/dyDo; 
  tsData->mat(1,3) += -(1.0*(3.464101615137754*yOff-2.449489742783178*ySh[0]))/dyDo; 
  tsData->mat(2,2) += 1.0; 
  tsData->mat(3,3) += 1.0; 

  if (pushNew) {
    tsData->cellMat[xIdx-1].push_back(tsData->mat);
  } else {
    tsData->cellMat[xIdx-1].back() += tsData->mat;
  };

}

void twistShift_matVecMult2xSerP1(tsStruct *tsData, const int xIdx, const int matIdx, const double *fldDo, double *fldTar) 
{ 
  // tsData: twist-shift matrices and vectors.
  // xIdx:   x-index of the cell.
  // matIdx: index of the matrix to be assigned.
  // fldDo:  donor field.
  // fldTar: target field.

  tsData->vecDo << fldDo[0],fldDo[1],fldDo[2],fldDo[3];

  tsData->vecTar = tsData->cellMat[xIdx-1][matIdx-1] * tsData->vecDo;

  Eigen::Map<Eigen::VectorXd>(fldTar,4,1) += tsData->vecTar;

}

